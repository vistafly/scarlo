(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function i(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=i(o);fetch(o.href,a)}})();const bv={apiKey:"AIzaSyCT-kY_DS5WTZ0RhMR4qXzII0pSPYNPOMQ",authDomain:"csites-b6d37.firebaseapp.com",projectId:"csites-b6d37",storageBucket:"csites-b6d37.firebasestorage.app",messagingSenderId:"877559835942",appId:"1:877559835942:web:0a573534ae0ac3e056a5e7"};window.VITE_DEVELOPER_EMAIL="vistafly.services@gmail.com";bv.apiKey||(console.error("Firebase configuration error: Missing environment variables!"),console.error("Please create a .env file based on .env.example"),console.error("Add your Firebase credentials from Firebase Console"));window.VITE_DEVELOPER_EMAIL||(console.error("VITE_DEVELOPER_EMAIL not set in .env file!"),console.error("Add this line to your .env: VITE_DEVELOPER_EMAIL=your-email@gmail.com"));function V1(e=50){return new Promise((t,i)=>{let s=0;const o=()=>{s++,typeof firebase<"u"&&firebase.initializeApp&&firebase.auth&&firebase.firestore?t():s>=e?i(new Error("Firebase SDK failed to load")):setTimeout(o,100)};o()})}window.firebaseReady=V1().then(()=>(firebase.initializeApp(bv),window.auth=firebase.auth(),window.db=firebase.firestore(),window.googleProvider=new firebase.auth.GoogleAuthProvider,window.auth.settings.appVerificationDisabledForTesting=!0,console.log("Firebase initialized successfully"),window.dispatchEvent(new Event("firebaseReady")),{auth:window.auth,db:window.db,googleProvider:window.googleProvider})).catch(e=>{throw console.error("Failed to initialize Firebase:",e),e});class U1{constructor(){this.position={x:window.innerWidth/2,y:window.innerHeight/2},this.listeners=new Set,this.ready=!1,this.init()}init(){const t=this;let i=!1;document.addEventListener("pointermove",function(s){t.position.x=s.clientX,t.position.y=s.clientY,i||(i=!0,requestAnimationFrame(function(){i=!1,t.listeners.forEach(o=>o(t.position))}))},{passive:!0}),document.addEventListener("pointerleave",function(){t.position.x=window.innerWidth/2,t.position.y=window.innerHeight/2,t.listeners.forEach(s=>s(t.position))},{passive:!0}),this.ready=!0}subscribe(t){return this.listeners.add(t),t(this.position),()=>{this.listeners.delete(t)}}getNormalizedPosition(t){if(!t)return{x:.5,y:.5};const i=t.getBoundingClientRect(),s=this.position.x,o=this.position.y;return s<i.left||s>i.right||o<i.top||o>i.bottom?{x:.5,y:.5}:{x:(s-i.left)/i.width,y:1-(o-i.top)/i.height}}}window.mouseTracker=new U1;function xv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ku={exports:{}},La={},_u={exports:{}},Je={};var cm;function W1(){if(cm)return Je;cm=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),x=Symbol.iterator;function k(p){return p===null||typeof p!="object"?null:(p=x&&p[x]||p["@@iterator"],typeof p=="function"?p:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,E={};function R(p,g,b){this.props=p,this.context=g,this.refs=E,this.updater=b||C}R.prototype.isReactComponent={},R.prototype.setState=function(p,g){if(typeof p!="object"&&typeof p!="function"&&p!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,p,g,"setState")},R.prototype.forceUpdate=function(p){this.updater.enqueueForceUpdate(this,p,"forceUpdate")};function O(){}O.prototype=R.prototype;function j(p,g,b){this.props=p,this.context=g,this.refs=E,this.updater=b||C}var z=j.prototype=new O;z.constructor=j,M(z,R.prototype),z.isPureReactComponent=!0;var W=Array.isArray,V=Object.prototype.hasOwnProperty,H={current:null},J={key:!0,ref:!0,__self:!0,__source:!0};function N(p,g,b){var S,_={},D=null,T=null;if(g!=null)for(S in g.ref!==void 0&&(T=g.ref),g.key!==void 0&&(D=""+g.key),g)V.call(g,S)&&!J.hasOwnProperty(S)&&(_[S]=g[S]);var L=arguments.length-2;if(L===1)_.children=b;else if(1<L){for(var F=Array(L),U=0;U<L;U++)F[U]=arguments[U+2];_.children=F}if(p&&p.defaultProps)for(S in L=p.defaultProps,L)_[S]===void 0&&(_[S]=L[S]);return{$$typeof:e,type:p,key:D,ref:T,props:_,_owner:H.current}}function G(p,g){return{$$typeof:e,type:p.type,key:g,ref:p.ref,props:p.props,_owner:p._owner}}function se(p){return typeof p=="object"&&p!==null&&p.$$typeof===e}function fe(p){var g={"=":"=0",":":"=2"};return"$"+p.replace(/[=:]/g,function(b){return g[b]})}var me=/\/+/g;function be(p,g){return typeof p=="object"&&p!==null&&p.key!=null?fe(""+p.key):g.toString(36)}function ye(p,g,b,S,_){var D=typeof p;(D==="undefined"||D==="boolean")&&(p=null);var T=!1;if(p===null)T=!0;else switch(D){case"string":case"number":T=!0;break;case"object":switch(p.$$typeof){case e:case t:T=!0}}if(T)return T=p,_=_(T),p=S===""?"."+be(T,0):S,W(_)?(b="",p!=null&&(b=p.replace(me,"$&/")+"/"),ye(_,g,b,"",function(U){return U})):_!=null&&(se(_)&&(_=G(_,b+(!_.key||T&&T.key===_.key?"":(""+_.key).replace(me,"$&/")+"/")+p)),g.push(_)),1;if(T=0,S=S===""?".":S+":",W(p))for(var L=0;L<p.length;L++){D=p[L];var F=S+be(D,L);T+=ye(D,g,b,F,_)}else if(F=k(p),typeof F=="function")for(p=F.call(p),L=0;!(D=p.next()).done;)D=D.value,F=S+be(D,L++),T+=ye(D,g,b,F,_);else if(D==="object")throw g=String(p),Error("Objects are not valid as a React child (found: "+(g==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":g)+"). If you meant to render a collection of children, use an array instead.");return T}function We(p,g,b){if(p==null)return p;var S=[],_=0;return ye(p,S,"","",function(D){return g.call(b,D,_++)}),S}function Ae(p){if(p._status===-1){var g=p._result;g=g(),g.then(function(b){(p._status===0||p._status===-1)&&(p._status=1,p._result=b)},function(b){(p._status===0||p._status===-1)&&(p._status=2,p._result=b)}),p._status===-1&&(p._status=0,p._result=g)}if(p._status===1)return p._result.default;throw p._result}var ke={current:null},oe={transition:null},_e={ReactCurrentDispatcher:ke,ReactCurrentBatchConfig:oe,ReactCurrentOwner:H};function u(){throw Error("act(...) is not supported in production builds of React.")}return Je.Children={map:We,forEach:function(p,g,b){We(p,function(){g.apply(this,arguments)},b)},count:function(p){var g=0;return We(p,function(){g++}),g},toArray:function(p){return We(p,function(g){return g})||[]},only:function(p){if(!se(p))throw Error("React.Children.only expected to receive a single React element child.");return p}},Je.Component=R,Je.Fragment=i,Je.Profiler=o,Je.PureComponent=j,Je.StrictMode=s,Je.Suspense=h,Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_e,Je.act=u,Je.cloneElement=function(p,g,b){if(p==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+p+".");var S=M({},p.props),_=p.key,D=p.ref,T=p._owner;if(g!=null){if(g.ref!==void 0&&(D=g.ref,T=H.current),g.key!==void 0&&(_=""+g.key),p.type&&p.type.defaultProps)var L=p.type.defaultProps;for(F in g)V.call(g,F)&&!J.hasOwnProperty(F)&&(S[F]=g[F]===void 0&&L!==void 0?L[F]:g[F])}var F=arguments.length-2;if(F===1)S.children=b;else if(1<F){L=Array(F);for(var U=0;U<F;U++)L[U]=arguments[U+2];S.children=L}return{$$typeof:e,type:p.type,key:_,ref:D,props:S,_owner:T}},Je.createContext=function(p){return p={$$typeof:c,_currentValue:p,_currentValue2:p,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},p.Provider={$$typeof:a,_context:p},p.Consumer=p},Je.createElement=N,Je.createFactory=function(p){var g=N.bind(null,p);return g.type=p,g},Je.createRef=function(){return{current:null}},Je.forwardRef=function(p){return{$$typeof:f,render:p}},Je.isValidElement=se,Je.lazy=function(p){return{$$typeof:y,_payload:{_status:-1,_result:p},_init:Ae}},Je.memo=function(p,g){return{$$typeof:v,type:p,compare:g===void 0?null:g}},Je.startTransition=function(p){var g=oe.transition;oe.transition={};try{p()}finally{oe.transition=g}},Je.unstable_act=u,Je.useCallback=function(p,g){return ke.current.useCallback(p,g)},Je.useContext=function(p){return ke.current.useContext(p)},Je.useDebugValue=function(){},Je.useDeferredValue=function(p){return ke.current.useDeferredValue(p)},Je.useEffect=function(p,g){return ke.current.useEffect(p,g)},Je.useId=function(){return ke.current.useId()},Je.useImperativeHandle=function(p,g,b){return ke.current.useImperativeHandle(p,g,b)},Je.useInsertionEffect=function(p,g){return ke.current.useInsertionEffect(p,g)},Je.useLayoutEffect=function(p,g){return ke.current.useLayoutEffect(p,g)},Je.useMemo=function(p,g){return ke.current.useMemo(p,g)},Je.useReducer=function(p,g,b){return ke.current.useReducer(p,g,b)},Je.useRef=function(p){return ke.current.useRef(p)},Je.useState=function(p){return ke.current.useState(p)},Je.useSyncExternalStore=function(p,g,b){return ke.current.useSyncExternalStore(p,g,b)},Je.useTransition=function(){return ke.current.useTransition()},Je.version="18.3.1",Je}var um;function Vd(){return um||(um=1,_u.exports=W1()),_u.exports}var dm;function j1(){if(dm)return La;dm=1;var e=Vd(),t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(f,h,v){var y,x={},k=null,C=null;v!==void 0&&(k=""+v),h.key!==void 0&&(k=""+h.key),h.ref!==void 0&&(C=h.ref);for(y in h)s.call(h,y)&&!a.hasOwnProperty(y)&&(x[y]=h[y]);if(f&&f.defaultProps)for(y in h=f.defaultProps,h)x[y]===void 0&&(x[y]=h[y]);return{$$typeof:t,type:f,key:k,ref:C,props:x,_owner:o.current}}return La.Fragment=i,La.jsx=c,La.jsxs=c,La}var fm;function q1(){return fm||(fm=1,ku.exports=j1()),ku.exports}var we=q1(),ie=Vd();const Sv=xv(ie);var fl={},Cu={exports:{}},Bn={},Tu={exports:{}},Eu={};var pm;function H1(){return pm||(pm=1,(function(e){function t(oe,_e){var u=oe.length;oe.push(_e);e:for(;0<u;){var p=u-1>>>1,g=oe[p];if(0<o(g,_e))oe[p]=_e,oe[u]=g,u=p;else break e}}function i(oe){return oe.length===0?null:oe[0]}function s(oe){if(oe.length===0)return null;var _e=oe[0],u=oe.pop();if(u!==_e){oe[0]=u;e:for(var p=0,g=oe.length,b=g>>>1;p<b;){var S=2*(p+1)-1,_=oe[S],D=S+1,T=oe[D];if(0>o(_,u))D<g&&0>o(T,_)?(oe[p]=T,oe[D]=u,p=D):(oe[p]=_,oe[S]=u,p=S);else if(D<g&&0>o(T,u))oe[p]=T,oe[D]=u,p=D;else break e}}return _e}function o(oe,_e){var u=oe.sortIndex-_e.sortIndex;return u!==0?u:oe.id-_e.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var c=Date,f=c.now();e.unstable_now=function(){return c.now()-f}}var h=[],v=[],y=1,x=null,k=3,C=!1,M=!1,E=!1,R=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function z(oe){for(var _e=i(v);_e!==null;){if(_e.callback===null)s(v);else if(_e.startTime<=oe)s(v),_e.sortIndex=_e.expirationTime,t(h,_e);else break;_e=i(v)}}function W(oe){if(E=!1,z(oe),!M)if(i(h)!==null)M=!0,Ae(V);else{var _e=i(v);_e!==null&&ke(W,_e.startTime-oe)}}function V(oe,_e){M=!1,E&&(E=!1,O(N),N=-1),C=!0;var u=k;try{for(z(_e),x=i(h);x!==null&&(!(x.expirationTime>_e)||oe&&!fe());){var p=x.callback;if(typeof p=="function"){x.callback=null,k=x.priorityLevel;var g=p(x.expirationTime<=_e);_e=e.unstable_now(),typeof g=="function"?x.callback=g:x===i(h)&&s(h),z(_e)}else s(h);x=i(h)}if(x!==null)var b=!0;else{var S=i(v);S!==null&&ke(W,S.startTime-_e),b=!1}return b}finally{x=null,k=u,C=!1}}var H=!1,J=null,N=-1,G=5,se=-1;function fe(){return!(e.unstable_now()-se<G)}function me(){if(J!==null){var oe=e.unstable_now();se=oe;var _e=!0;try{_e=J(!0,oe)}finally{_e?be():(H=!1,J=null)}}else H=!1}var be;if(typeof j=="function")be=function(){j(me)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,We=ye.port2;ye.port1.onmessage=me,be=function(){We.postMessage(null)}}else be=function(){R(me,0)};function Ae(oe){J=oe,H||(H=!0,be())}function ke(oe,_e){N=R(function(){oe(e.unstable_now())},_e)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(oe){oe.callback=null},e.unstable_continueExecution=function(){M||C||(M=!0,Ae(V))},e.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<oe?Math.floor(1e3/oe):5},e.unstable_getCurrentPriorityLevel=function(){return k},e.unstable_getFirstCallbackNode=function(){return i(h)},e.unstable_next=function(oe){switch(k){case 1:case 2:case 3:var _e=3;break;default:_e=k}var u=k;k=_e;try{return oe()}finally{k=u}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(oe,_e){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var u=k;k=oe;try{return _e()}finally{k=u}},e.unstable_scheduleCallback=function(oe,_e,u){var p=e.unstable_now();switch(typeof u=="object"&&u!==null?(u=u.delay,u=typeof u=="number"&&0<u?p+u:p):u=p,oe){case 1:var g=-1;break;case 2:g=250;break;case 5:g=1073741823;break;case 4:g=1e4;break;default:g=5e3}return g=u+g,oe={id:y++,callback:_e,priorityLevel:oe,startTime:u,expirationTime:g,sortIndex:-1},u>p?(oe.sortIndex=u,t(v,oe),i(h)===null&&oe===i(v)&&(E?(O(N),N=-1):E=!0,ke(W,u-p))):(oe.sortIndex=g,t(h,oe),M||C||(M=!0,Ae(V))),oe},e.unstable_shouldYield=fe,e.unstable_wrapCallback=function(oe){var _e=k;return function(){var u=k;k=_e;try{return oe.apply(this,arguments)}finally{k=u}}}})(Eu)),Eu}var hm;function $1(){return hm||(hm=1,Tu.exports=H1()),Tu.exports}var mm;function Y1(){if(mm)return Bn;mm=1;var e=Vd(),t=$1();function i(n){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function a(n,r){c(n,r),c(n+"Capture",r)}function c(n,r){for(o[n]=r,n=0;n<r.length;n++)s.add(r[n])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},x={};function k(n){return h.call(x,n)?!0:h.call(y,n)?!1:v.test(n)?x[n]=!0:(y[n]=!0,!1)}function C(n,r,l,d){if(l!==null&&l.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return d?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function M(n,r,l,d){if(r===null||typeof r>"u"||C(n,r,l,d))return!0;if(d)return!1;if(l!==null)switch(l.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function E(n,r,l,d,m,w,P){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=d,this.attributeNamespace=m,this.mustUseProperty=l,this.propertyName=n,this.type=r,this.sanitizeURL=w,this.removeEmptyString=P}var R={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){R[n]=new E(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var r=n[0];R[r]=new E(r,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){R[n]=new E(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){R[n]=new E(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){R[n]=new E(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){R[n]=new E(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){R[n]=new E(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){R[n]=new E(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){R[n]=new E(n,5,!1,n.toLowerCase(),null,!1,!1)});var O=/[\-:]([a-z])/g;function j(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var r=n.replace(O,j);R[r]=new E(r,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var r=n.replace(O,j);R[r]=new E(r,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var r=n.replace(O,j);R[r]=new E(r,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){R[n]=new E(n,1,!1,n.toLowerCase(),null,!1,!1)}),R.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){R[n]=new E(n,1,!1,n.toLowerCase(),null,!0,!0)});function z(n,r,l,d){var m=R.hasOwnProperty(r)?R[r]:null;(m!==null?m.type!==0:d||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(M(r,l,m,d)&&(l=null),d||m===null?k(r)&&(l===null?n.removeAttribute(r):n.setAttribute(r,""+l)):m.mustUseProperty?n[m.propertyName]=l===null?m.type===3?!1:"":l:(r=m.attributeName,d=m.attributeNamespace,l===null?n.removeAttribute(r):(m=m.type,l=m===3||m===4&&l===!0?"":""+l,d?n.setAttributeNS(d,r,l):n.setAttribute(r,l))))}var W=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,V=Symbol.for("react.element"),H=Symbol.for("react.portal"),J=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),se=Symbol.for("react.provider"),fe=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),be=Symbol.for("react.suspense"),ye=Symbol.for("react.suspense_list"),We=Symbol.for("react.memo"),Ae=Symbol.for("react.lazy"),ke=Symbol.for("react.offscreen"),oe=Symbol.iterator;function _e(n){return n===null||typeof n!="object"?null:(n=oe&&n[oe]||n["@@iterator"],typeof n=="function"?n:null)}var u=Object.assign,p;function g(n){if(p===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);p=r&&r[1]||""}return`
`+p+n}var b=!1;function S(n,r){if(!n||b)return"";b=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(ne){var d=ne}Reflect.construct(n,[],r)}else{try{r.call()}catch(ne){d=ne}n.call(r.prototype)}else{try{throw Error()}catch(ne){d=ne}n()}}catch(ne){if(ne&&d&&typeof ne.stack=="string"){for(var m=ne.stack.split(`
`),w=d.stack.split(`
`),P=m.length-1,I=w.length-1;1<=P&&0<=I&&m[P]!==w[I];)I--;for(;1<=P&&0<=I;P--,I--)if(m[P]!==w[I]){if(P!==1||I!==1)do if(P--,I--,0>I||m[P]!==w[I]){var q=`
`+m[P].replace(" at new "," at ");return n.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",n.displayName)),q}while(1<=P&&0<=I);break}}}finally{b=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?g(n):""}function _(n){switch(n.tag){case 5:return g(n.type);case 16:return g("Lazy");case 13:return g("Suspense");case 19:return g("SuspenseList");case 0:case 2:case 15:return n=S(n.type,!1),n;case 11:return n=S(n.type.render,!1),n;case 1:return n=S(n.type,!0),n;default:return""}}function D(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case J:return"Fragment";case H:return"Portal";case G:return"Profiler";case N:return"StrictMode";case be:return"Suspense";case ye:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case fe:return(n.displayName||"Context")+".Consumer";case se:return(n._context.displayName||"Context")+".Provider";case me:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case We:return r=n.displayName||null,r!==null?r:D(n.type)||"Memo";case Ae:r=n._payload,n=n._init;try{return D(n(r))}catch{}}return null}function T(n){var r=n.type;switch(n.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=r.render,n=n.displayName||n.name||"",r.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return D(r);case 8:return r===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function L(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function F(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function U(n){var r=F(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,r),d=""+n[r];if(!n.hasOwnProperty(r)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,w=l.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return m.call(this)},set:function(P){d=""+P,w.call(this,P)}}),Object.defineProperty(n,r,{enumerable:l.enumerable}),{getValue:function(){return d},setValue:function(P){d=""+P},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function A(n){n._valueTracker||(n._valueTracker=U(n))}function B(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var l=r.getValue(),d="";return n&&(d=F(n)?n.checked?"true":"false":n.value),n=d,n!==l?(r.setValue(n),!0):!1}function $(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function K(n,r){var l=r.checked;return u({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function Y(n,r){var l=r.defaultValue==null?"":r.defaultValue,d=r.checked!=null?r.checked:r.defaultChecked;l=L(r.value!=null?r.value:l),n._wrapperState={initialChecked:d,initialValue:l,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function Q(n,r){r=r.checked,r!=null&&z(n,"checked",r,!1)}function te(n,r){Q(n,r);var l=L(r.value),d=r.type;if(l!=null)d==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(d==="submit"||d==="reset"){n.removeAttribute("value");return}r.hasOwnProperty("value")?pe(n,r.type,l):r.hasOwnProperty("defaultValue")&&pe(n,r.type,L(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(n.defaultChecked=!!r.defaultChecked)}function ce(n,r,l){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var d=r.type;if(!(d!=="submit"&&d!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+n._wrapperState.initialValue,l||r===n.value||(n.value=r),n.defaultValue=r}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function pe(n,r,l){(r!=="number"||$(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var ge=Array.isArray;function Se(n,r,l,d){if(n=n.options,r){r={};for(var m=0;m<l.length;m++)r["$"+l[m]]=!0;for(l=0;l<n.length;l++)m=r.hasOwnProperty("$"+n[l].value),n[l].selected!==m&&(n[l].selected=m),m&&d&&(n[l].defaultSelected=!0)}else{for(l=""+L(l),r=null,m=0;m<n.length;m++){if(n[m].value===l){n[m].selected=!0,d&&(n[m].defaultSelected=!0);return}r!==null||n[m].disabled||(r=n[m])}r!==null&&(r.selected=!0)}}function Ee(n,r){if(r.dangerouslySetInnerHTML!=null)throw Error(i(91));return u({},r,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function re(n,r){var l=r.value;if(l==null){if(l=r.children,r=r.defaultValue,l!=null){if(r!=null)throw Error(i(92));if(ge(l)){if(1<l.length)throw Error(i(93));l=l[0]}r=l}r==null&&(r=""),l=r}n._wrapperState={initialValue:L(l)}}function xe(n,r){var l=L(r.value),d=L(r.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),r.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),d!=null&&(n.defaultValue=""+d)}function $e(n){var r=n.textContent;r===n._wrapperState.initialValue&&r!==""&&r!==null&&(n.value=r)}function it(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function je(n,r){return n==null||n==="http://www.w3.org/1999/xhtml"?it(r):n==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var nt,Qe=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,l,d,m){MSApp.execUnsafeLocalFunction(function(){return n(r,l,d,m)})}:n})(function(n,r){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=r;else{for(nt=nt||document.createElement("div"),nt.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=nt.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;r.firstChild;)n.appendChild(r.firstChild)}});function at(n,r){if(r){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=r;return}}n.textContent=r}var Ye={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pt=["Webkit","ms","Moz","O"];Object.keys(Ye).forEach(function(n){pt.forEach(function(r){r=r+n.charAt(0).toUpperCase()+n.substring(1),Ye[r]=Ye[n]})});function Xt(n,r,l){return r==null||typeof r=="boolean"||r===""?"":l||typeof r!="number"||r===0||Ye.hasOwnProperty(n)&&Ye[n]?(""+r).trim():r+"px"}function Wt(n,r){n=n.style;for(var l in r)if(r.hasOwnProperty(l)){var d=l.indexOf("--")===0,m=Xt(l,r[l],d);l==="float"&&(l="cssFloat"),d?n.setProperty(l,m):n[l]=m}}var Oe=u({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function De(n,r){if(r){if(Oe[n]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(i(137,n));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(i(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(i(61))}if(r.style!=null&&typeof r.style!="object")throw Error(i(62))}}function xt(n,r){if(n.indexOf("-")===-1)return typeof r.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ge=null;function vt(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Nt=null,St=null,Ze=null;function st(n){if(n=ma(n)){if(typeof Nt!="function")throw Error(i(280));var r=n.stateNode;r&&(r=Eo(r),Nt(n.stateNode,n.type,r))}}function ht(n){St?Ze?Ze.push(n):Ze=[n]:St=n}function Zt(){if(St){var n=St,r=Ze;if(Ze=St=null,st(n),r)for(n=0;n<r.length;n++)st(r[n])}}function En(n,r){return n(r)}function rn(){}var Pn=!1;function yt(n,r,l){if(Pn)return n(r,l);Pn=!0;try{return En(n,r,l)}finally{Pn=!1,(St!==null||Ze!==null)&&(rn(),Zt())}}function ii(n,r){var l=n.stateNode;if(l===null)return null;var d=Eo(l);if(d===null)return null;l=d[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(n=n.type,d=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!d;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var Dn=!1;if(f)try{var Ln={};Object.defineProperty(Ln,"passive",{get:function(){Dn=!0}}),window.addEventListener("test",Ln,Ln),window.removeEventListener("test",Ln,Ln)}catch{Dn=!1}function yn(n,r,l,d,m,w,P,I,q){var ne=Array.prototype.slice.call(arguments,3);try{r.apply(l,ne)}catch(de){this.onError(de)}}var wt=!1,wn=null,jt=!1,bn=null,xn={onError:function(n){wt=!0,wn=n}};function Hn(n,r,l,d,m,w,P,I,q){wt=!1,wn=null,yn.apply(xn,arguments)}function Sn(n,r,l,d,m,w,P,I,q){if(Hn.apply(this,arguments),wt){if(wt){var ne=wn;wt=!1,wn=null}else throw Error(i(198));jt||(jt=!0,bn=ne)}}function sn(n){var r=n,l=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(l=r.return),n=r.return;while(n)}return r.tag===3?l:null}function Mn(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function Ce(n){if(sn(n)!==n)throw Error(i(188))}function It(n){var r=n.alternate;if(!r){if(r=sn(n),r===null)throw Error(i(188));return r!==n?null:n}for(var l=n,d=r;;){var m=l.return;if(m===null)break;var w=m.alternate;if(w===null){if(d=m.return,d!==null){l=d;continue}break}if(m.child===w.child){for(w=m.child;w;){if(w===l)return Ce(m),n;if(w===d)return Ce(m),r;w=w.sibling}throw Error(i(188))}if(l.return!==d.return)l=m,d=w;else{for(var P=!1,I=m.child;I;){if(I===l){P=!0,l=m,d=w;break}if(I===d){P=!0,d=m,l=w;break}I=I.sibling}if(!P){for(I=w.child;I;){if(I===l){P=!0,l=w,d=m;break}if(I===d){P=!0,d=w,l=m;break}I=I.sibling}if(!P)throw Error(i(189))}}if(l.alternate!==d)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?n:r}function ot(n){return n=It(n),n!==null?Bt(n):null}function Bt(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var r=Bt(n);if(r!==null)return r;n=n.sibling}return null}var An=t.unstable_scheduleCallback,Zi=t.unstable_cancelCallback,et=t.unstable_shouldYield,le=t.unstable_requestPaint,ae=t.unstable_now,Ie=t.unstable_getCurrentPriorityLevel,Fe=t.unstable_ImmediatePriority,Te=t.unstable_UserBlockingPriority,Le=t.unstable_NormalPriority,Be=t.unstable_LowPriority,lt=t.unstable_IdlePriority,tt=null,Xe=null;function $n(n){if(Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(tt,n,void 0,(n.current.flags&128)===128)}catch{}}var zt=Math.clz32?Math.clz32:un,ss=Math.log,Ke=Math.LN2;function un(n){return n>>>=0,n===0?32:31-(ss(n)/Ke|0)|0}var Ei=64,as=4194304;function Qs(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function uo(n,r){var l=n.pendingLanes;if(l===0)return 0;var d=0,m=n.suspendedLanes,w=n.pingedLanes,P=l&268435455;if(P!==0){var I=P&~m;I!==0?d=Qs(I):(w&=P,w!==0&&(d=Qs(w)))}else P=l&~m,P!==0?d=Qs(P):w!==0&&(d=Qs(w));if(d===0)return 0;if(r!==0&&r!==d&&(r&m)===0&&(m=d&-d,w=r&-r,m>=w||m===16&&(w&4194240)!==0))return r;if((d&4)!==0&&(d|=l&16),r=n.entangledLanes,r!==0)for(n=n.entanglements,r&=d;0<r;)l=31-zt(r),m=1<<l,d|=n[l],r&=~m;return d}function sw(n,r){switch(n){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function aw(n,r){for(var l=n.suspendedLanes,d=n.pingedLanes,m=n.expirationTimes,w=n.pendingLanes;0<w;){var P=31-zt(w),I=1<<P,q=m[P];q===-1?((I&l)===0||(I&d)!==0)&&(m[P]=sw(I,r)):q<=r&&(n.expiredLanes|=I),w&=~I}}function ql(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Vf(){var n=Ei;return Ei<<=1,(Ei&4194240)===0&&(Ei=64),n}function Hl(n){for(var r=[],l=0;31>l;l++)r.push(n);return r}function Zs(n,r,l){n.pendingLanes|=r,r!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,r=31-zt(r),n[r]=l}function ow(n,r){var l=n.pendingLanes&~r;n.pendingLanes=r,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=r,n.mutableReadLanes&=r,n.entangledLanes&=r,r=n.entanglements;var d=n.eventTimes;for(n=n.expirationTimes;0<l;){var m=31-zt(l),w=1<<m;r[m]=0,d[m]=-1,n[m]=-1,l&=~w}}function $l(n,r){var l=n.entangledLanes|=r;for(n=n.entanglements;l;){var d=31-zt(l),m=1<<d;m&r|n[d]&r&&(n[d]|=r),l&=~m}}var ft=0;function Uf(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Wf,Yl,jf,qf,Hf,Xl=!1,fo=[],Ji=null,er=null,tr=null,Js=new Map,ea=new Map,nr=[],lw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $f(n,r){switch(n){case"focusin":case"focusout":Ji=null;break;case"dragenter":case"dragleave":er=null;break;case"mouseover":case"mouseout":tr=null;break;case"pointerover":case"pointerout":Js.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":ea.delete(r.pointerId)}}function ta(n,r,l,d,m,w){return n===null||n.nativeEvent!==w?(n={blockedOn:r,domEventName:l,eventSystemFlags:d,nativeEvent:w,targetContainers:[m]},r!==null&&(r=ma(r),r!==null&&Yl(r)),n):(n.eventSystemFlags|=d,r=n.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),n)}function cw(n,r,l,d,m){switch(r){case"focusin":return Ji=ta(Ji,n,r,l,d,m),!0;case"dragenter":return er=ta(er,n,r,l,d,m),!0;case"mouseover":return tr=ta(tr,n,r,l,d,m),!0;case"pointerover":var w=m.pointerId;return Js.set(w,ta(Js.get(w)||null,n,r,l,d,m)),!0;case"gotpointercapture":return w=m.pointerId,ea.set(w,ta(ea.get(w)||null,n,r,l,d,m)),!0}return!1}function Yf(n){var r=Lr(n.target);if(r!==null){var l=sn(r);if(l!==null){if(r=l.tag,r===13){if(r=Mn(l),r!==null){n.blockedOn=r,Hf(n.priority,function(){jf(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function po(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var l=Kl(n.domEventName,n.eventSystemFlags,r[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var d=new l.constructor(l.type,l);Ge=d,l.target.dispatchEvent(d),Ge=null}else return r=ma(l),r!==null&&Yl(r),n.blockedOn=l,!1;r.shift()}return!0}function Xf(n,r,l){po(n)&&l.delete(r)}function uw(){Xl=!1,Ji!==null&&po(Ji)&&(Ji=null),er!==null&&po(er)&&(er=null),tr!==null&&po(tr)&&(tr=null),Js.forEach(Xf),ea.forEach(Xf)}function na(n,r){n.blockedOn===r&&(n.blockedOn=null,Xl||(Xl=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,uw)))}function ia(n){function r(m){return na(m,n)}if(0<fo.length){na(fo[0],n);for(var l=1;l<fo.length;l++){var d=fo[l];d.blockedOn===n&&(d.blockedOn=null)}}for(Ji!==null&&na(Ji,n),er!==null&&na(er,n),tr!==null&&na(tr,n),Js.forEach(r),ea.forEach(r),l=0;l<nr.length;l++)d=nr[l],d.blockedOn===n&&(d.blockedOn=null);for(;0<nr.length&&(l=nr[0],l.blockedOn===null);)Yf(l),l.blockedOn===null&&nr.shift()}var os=W.ReactCurrentBatchConfig,ho=!0;function dw(n,r,l,d){var m=ft,w=os.transition;os.transition=null;try{ft=1,Gl(n,r,l,d)}finally{ft=m,os.transition=w}}function fw(n,r,l,d){var m=ft,w=os.transition;os.transition=null;try{ft=4,Gl(n,r,l,d)}finally{ft=m,os.transition=w}}function Gl(n,r,l,d){if(ho){var m=Kl(n,r,l,d);if(m===null)pc(n,r,d,mo,l),$f(n,d);else if(cw(m,n,r,l,d))d.stopPropagation();else if($f(n,d),r&4&&-1<lw.indexOf(n)){for(;m!==null;){var w=ma(m);if(w!==null&&Wf(w),w=Kl(n,r,l,d),w===null&&pc(n,r,d,mo,l),w===m)break;m=w}m!==null&&d.stopPropagation()}else pc(n,r,d,null,l)}}var mo=null;function Kl(n,r,l,d){if(mo=null,n=vt(d),n=Lr(n),n!==null)if(r=sn(n),r===null)n=null;else if(l=r.tag,l===13){if(n=Mn(r),n!==null)return n;n=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null);return mo=n,null}function Gf(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ie()){case Fe:return 1;case Te:return 4;case Le:case Be:return 16;case lt:return 536870912;default:return 16}default:return 16}}var ir=null,Ql=null,go=null;function Kf(){if(go)return go;var n,r=Ql,l=r.length,d,m="value"in ir?ir.value:ir.textContent,w=m.length;for(n=0;n<l&&r[n]===m[n];n++);var P=l-n;for(d=1;d<=P&&r[l-d]===m[w-d];d++);return go=m.slice(n,1<d?1-d:void 0)}function vo(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function yo(){return!0}function Qf(){return!1}function Yn(n){function r(l,d,m,w,P){this._reactName=l,this._targetInst=m,this.type=d,this.nativeEvent=w,this.target=P,this.currentTarget=null;for(var I in n)n.hasOwnProperty(I)&&(l=n[I],this[I]=l?l(w):w[I]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?yo:Qf,this.isPropagationStopped=Qf,this}return u(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=yo)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=yo)},persist:function(){},isPersistent:yo}),r}var ls={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zl=Yn(ls),ra=u({},ls,{view:0,detail:0}),pw=Yn(ra),Jl,ec,sa,wo=u({},ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==sa&&(sa&&n.type==="mousemove"?(Jl=n.screenX-sa.screenX,ec=n.screenY-sa.screenY):ec=Jl=0,sa=n),Jl)},movementY:function(n){return"movementY"in n?n.movementY:ec}}),Zf=Yn(wo),hw=u({},wo,{dataTransfer:0}),mw=Yn(hw),gw=u({},ra,{relatedTarget:0}),tc=Yn(gw),vw=u({},ls,{animationName:0,elapsedTime:0,pseudoElement:0}),yw=Yn(vw),ww=u({},ls,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),bw=Yn(ww),xw=u({},ls,{data:0}),Jf=Yn(xw),Sw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_w={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cw(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=_w[n])?!!r[n]:!1}function nc(){return Cw}var Tw=u({},ra,{key:function(n){if(n.key){var r=Sw[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=vo(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?kw[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nc,charCode:function(n){return n.type==="keypress"?vo(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?vo(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Ew=Yn(Tw),Pw=u({},wo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ep=Yn(Pw),Dw=u({},ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nc}),Lw=Yn(Dw),Mw=u({},ls,{propertyName:0,elapsedTime:0,pseudoElement:0}),Aw=Yn(Mw),Rw=u({},wo,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Fw=Yn(Rw),Ow=[9,13,27,32],ic=f&&"CompositionEvent"in window,aa=null;f&&"documentMode"in document&&(aa=document.documentMode);var Nw=f&&"TextEvent"in window&&!aa,tp=f&&(!ic||aa&&8<aa&&11>=aa),np=" ",ip=!1;function rp(n,r){switch(n){case"keyup":return Ow.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sp(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var cs=!1;function Iw(n,r){switch(n){case"compositionend":return sp(r);case"keypress":return r.which!==32?null:(ip=!0,np);case"textInput":return n=r.data,n===np&&ip?null:n;default:return null}}function Bw(n,r){if(cs)return n==="compositionend"||!ic&&rp(n,r)?(n=Kf(),go=Ql=ir=null,cs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return tp&&r.locale!=="ko"?null:r.data;default:return null}}var zw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ap(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!zw[n.type]:r==="textarea"}function op(n,r,l,d){ht(d),r=_o(r,"onChange"),0<r.length&&(l=new Zl("onChange","change",null,l,d),n.push({event:l,listeners:r}))}var oa=null,la=null;function Vw(n){Cp(n,0)}function bo(n){var r=hs(n);if(B(r))return n}function Uw(n,r){if(n==="change")return r}var lp=!1;if(f){var rc;if(f){var sc="oninput"in document;if(!sc){var cp=document.createElement("div");cp.setAttribute("oninput","return;"),sc=typeof cp.oninput=="function"}rc=sc}else rc=!1;lp=rc&&(!document.documentMode||9<document.documentMode)}function up(){oa&&(oa.detachEvent("onpropertychange",dp),la=oa=null)}function dp(n){if(n.propertyName==="value"&&bo(la)){var r=[];op(r,la,n,vt(n)),yt(Vw,r)}}function Ww(n,r,l){n==="focusin"?(up(),oa=r,la=l,oa.attachEvent("onpropertychange",dp)):n==="focusout"&&up()}function jw(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return bo(la)}function qw(n,r){if(n==="click")return bo(r)}function Hw(n,r){if(n==="input"||n==="change")return bo(r)}function $w(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var yi=typeof Object.is=="function"?Object.is:$w;function ca(n,r){if(yi(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var l=Object.keys(n),d=Object.keys(r);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var m=l[d];if(!h.call(r,m)||!yi(n[m],r[m]))return!1}return!0}function fp(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function pp(n,r){var l=fp(n);n=0;for(var d;l;){if(l.nodeType===3){if(d=n+l.textContent.length,n<=r&&d>=r)return{node:l,offset:r-n};n=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=fp(l)}}function hp(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?hp(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function mp(){for(var n=window,r=$();r instanceof n.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)n=r.contentWindow;else break;r=$(n.document)}return r}function ac(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}function Yw(n){var r=mp(),l=n.focusedElem,d=n.selectionRange;if(r!==l&&l&&l.ownerDocument&&hp(l.ownerDocument.documentElement,l)){if(d!==null&&ac(l)){if(r=d.start,n=d.end,n===void 0&&(n=r),"selectionStart"in l)l.selectionStart=r,l.selectionEnd=Math.min(n,l.value.length);else if(n=(r=l.ownerDocument||document)&&r.defaultView||window,n.getSelection){n=n.getSelection();var m=l.textContent.length,w=Math.min(d.start,m);d=d.end===void 0?w:Math.min(d.end,m),!n.extend&&w>d&&(m=d,d=w,w=m),m=pp(l,w);var P=pp(l,d);m&&P&&(n.rangeCount!==1||n.anchorNode!==m.node||n.anchorOffset!==m.offset||n.focusNode!==P.node||n.focusOffset!==P.offset)&&(r=r.createRange(),r.setStart(m.node,m.offset),n.removeAllRanges(),w>d?(n.addRange(r),n.extend(P.node,P.offset)):(r.setEnd(P.node,P.offset),n.addRange(r)))}}for(r=[],n=l;n=n.parentNode;)n.nodeType===1&&r.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<r.length;l++)n=r[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Xw=f&&"documentMode"in document&&11>=document.documentMode,us=null,oc=null,ua=null,lc=!1;function gp(n,r,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;lc||us==null||us!==$(d)||(d=us,"selectionStart"in d&&ac(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),ua&&ca(ua,d)||(ua=d,d=_o(oc,"onSelect"),0<d.length&&(r=new Zl("onSelect","select",null,r,l),n.push({event:r,listeners:d}),r.target=us)))}function xo(n,r){var l={};return l[n.toLowerCase()]=r.toLowerCase(),l["Webkit"+n]="webkit"+r,l["Moz"+n]="moz"+r,l}var ds={animationend:xo("Animation","AnimationEnd"),animationiteration:xo("Animation","AnimationIteration"),animationstart:xo("Animation","AnimationStart"),transitionend:xo("Transition","TransitionEnd")},cc={},vp={};f&&(vp=document.createElement("div").style,"AnimationEvent"in window||(delete ds.animationend.animation,delete ds.animationiteration.animation,delete ds.animationstart.animation),"TransitionEvent"in window||delete ds.transitionend.transition);function So(n){if(cc[n])return cc[n];if(!ds[n])return n;var r=ds[n],l;for(l in r)if(r.hasOwnProperty(l)&&l in vp)return cc[n]=r[l];return n}var yp=So("animationend"),wp=So("animationiteration"),bp=So("animationstart"),xp=So("transitionend"),Sp=new Map,kp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rr(n,r){Sp.set(n,r),a(r,[n])}for(var uc=0;uc<kp.length;uc++){var dc=kp[uc],Gw=dc.toLowerCase(),Kw=dc[0].toUpperCase()+dc.slice(1);rr(Gw,"on"+Kw)}rr(yp,"onAnimationEnd"),rr(wp,"onAnimationIteration"),rr(bp,"onAnimationStart"),rr("dblclick","onDoubleClick"),rr("focusin","onFocus"),rr("focusout","onBlur"),rr(xp,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var da="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qw=new Set("cancel close invalid load scroll toggle".split(" ").concat(da));function _p(n,r,l){var d=n.type||"unknown-event";n.currentTarget=l,Sn(d,r,void 0,n),n.currentTarget=null}function Cp(n,r){r=(r&4)!==0;for(var l=0;l<n.length;l++){var d=n[l],m=d.event;d=d.listeners;e:{var w=void 0;if(r)for(var P=d.length-1;0<=P;P--){var I=d[P],q=I.instance,ne=I.currentTarget;if(I=I.listener,q!==w&&m.isPropagationStopped())break e;_p(m,I,ne),w=q}else for(P=0;P<d.length;P++){if(I=d[P],q=I.instance,ne=I.currentTarget,I=I.listener,q!==w&&m.isPropagationStopped())break e;_p(m,I,ne),w=q}}}if(jt)throw n=bn,jt=!1,bn=null,n}function kt(n,r){var l=r[wc];l===void 0&&(l=r[wc]=new Set);var d=n+"__bubble";l.has(d)||(Tp(r,n,2,!1),l.add(d))}function fc(n,r,l){var d=0;r&&(d|=4),Tp(l,n,d,r)}var ko="_reactListening"+Math.random().toString(36).slice(2);function fa(n){if(!n[ko]){n[ko]=!0,s.forEach(function(l){l!=="selectionchange"&&(Qw.has(l)||fc(l,!1,n),fc(l,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[ko]||(r[ko]=!0,fc("selectionchange",!1,r))}}function Tp(n,r,l,d){switch(Gf(r)){case 1:var m=dw;break;case 4:m=fw;break;default:m=Gl}l=m.bind(null,r,l,n),m=void 0,!Dn||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),d?m!==void 0?n.addEventListener(r,l,{capture:!0,passive:m}):n.addEventListener(r,l,!0):m!==void 0?n.addEventListener(r,l,{passive:m}):n.addEventListener(r,l,!1)}function pc(n,r,l,d,m){var w=d;if((r&1)===0&&(r&2)===0&&d!==null)e:for(;;){if(d===null)return;var P=d.tag;if(P===3||P===4){var I=d.stateNode.containerInfo;if(I===m||I.nodeType===8&&I.parentNode===m)break;if(P===4)for(P=d.return;P!==null;){var q=P.tag;if((q===3||q===4)&&(q=P.stateNode.containerInfo,q===m||q.nodeType===8&&q.parentNode===m))return;P=P.return}for(;I!==null;){if(P=Lr(I),P===null)return;if(q=P.tag,q===5||q===6){d=w=P;continue e}I=I.parentNode}}d=d.return}yt(function(){var ne=w,de=vt(l),he=[];e:{var ue=Sp.get(n);if(ue!==void 0){var Pe=Zl,Re=n;switch(n){case"keypress":if(vo(l)===0)break e;case"keydown":case"keyup":Pe=Ew;break;case"focusin":Re="focus",Pe=tc;break;case"focusout":Re="blur",Pe=tc;break;case"beforeblur":case"afterblur":Pe=tc;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Pe=Zf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Pe=mw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Pe=Lw;break;case yp:case wp:case bp:Pe=yw;break;case xp:Pe=Aw;break;case"scroll":Pe=pw;break;case"wheel":Pe=Fw;break;case"copy":case"cut":case"paste":Pe=bw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Pe=ep}var Ne=(r&4)!==0,Vt=!Ne&&n==="scroll",Z=Ne?ue!==null?ue+"Capture":null:ue;Ne=[];for(var X=ne,ee;X!==null;){ee=X;var ve=ee.stateNode;if(ee.tag===5&&ve!==null&&(ee=ve,Z!==null&&(ve=ii(X,Z),ve!=null&&Ne.push(pa(X,ve,ee)))),Vt)break;X=X.return}0<Ne.length&&(ue=new Pe(ue,Re,null,l,de),he.push({event:ue,listeners:Ne}))}}if((r&7)===0){e:{if(ue=n==="mouseover"||n==="pointerover",Pe=n==="mouseout"||n==="pointerout",ue&&l!==Ge&&(Re=l.relatedTarget||l.fromElement)&&(Lr(Re)||Re[Bi]))break e;if((Pe||ue)&&(ue=de.window===de?de:(ue=de.ownerDocument)?ue.defaultView||ue.parentWindow:window,Pe?(Re=l.relatedTarget||l.toElement,Pe=ne,Re=Re?Lr(Re):null,Re!==null&&(Vt=sn(Re),Re!==Vt||Re.tag!==5&&Re.tag!==6)&&(Re=null)):(Pe=null,Re=ne),Pe!==Re)){if(Ne=Zf,ve="onMouseLeave",Z="onMouseEnter",X="mouse",(n==="pointerout"||n==="pointerover")&&(Ne=ep,ve="onPointerLeave",Z="onPointerEnter",X="pointer"),Vt=Pe==null?ue:hs(Pe),ee=Re==null?ue:hs(Re),ue=new Ne(ve,X+"leave",Pe,l,de),ue.target=Vt,ue.relatedTarget=ee,ve=null,Lr(de)===ne&&(Ne=new Ne(Z,X+"enter",Re,l,de),Ne.target=ee,Ne.relatedTarget=Vt,ve=Ne),Vt=ve,Pe&&Re)t:{for(Ne=Pe,Z=Re,X=0,ee=Ne;ee;ee=fs(ee))X++;for(ee=0,ve=Z;ve;ve=fs(ve))ee++;for(;0<X-ee;)Ne=fs(Ne),X--;for(;0<ee-X;)Z=fs(Z),ee--;for(;X--;){if(Ne===Z||Z!==null&&Ne===Z.alternate)break t;Ne=fs(Ne),Z=fs(Z)}Ne=null}else Ne=null;Pe!==null&&Ep(he,ue,Pe,Ne,!1),Re!==null&&Vt!==null&&Ep(he,Vt,Re,Ne,!0)}}e:{if(ue=ne?hs(ne):window,Pe=ue.nodeName&&ue.nodeName.toLowerCase(),Pe==="select"||Pe==="input"&&ue.type==="file")var ze=Uw;else if(ap(ue))if(lp)ze=Hw;else{ze=jw;var Ve=Ww}else(Pe=ue.nodeName)&&Pe.toLowerCase()==="input"&&(ue.type==="checkbox"||ue.type==="radio")&&(ze=qw);if(ze&&(ze=ze(n,ne))){op(he,ze,l,de);break e}Ve&&Ve(n,ue,ne),n==="focusout"&&(Ve=ue._wrapperState)&&Ve.controlled&&ue.type==="number"&&pe(ue,"number",ue.value)}switch(Ve=ne?hs(ne):window,n){case"focusin":(ap(Ve)||Ve.contentEditable==="true")&&(us=Ve,oc=ne,ua=null);break;case"focusout":ua=oc=us=null;break;case"mousedown":lc=!0;break;case"contextmenu":case"mouseup":case"dragend":lc=!1,gp(he,l,de);break;case"selectionchange":if(Xw)break;case"keydown":case"keyup":gp(he,l,de)}var Ue;if(ic)e:{switch(n){case"compositionstart":var He="onCompositionStart";break e;case"compositionend":He="onCompositionEnd";break e;case"compositionupdate":He="onCompositionUpdate";break e}He=void 0}else cs?rp(n,l)&&(He="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(He="onCompositionStart");He&&(tp&&l.locale!=="ko"&&(cs||He!=="onCompositionStart"?He==="onCompositionEnd"&&cs&&(Ue=Kf()):(ir=de,Ql="value"in ir?ir.value:ir.textContent,cs=!0)),Ve=_o(ne,He),0<Ve.length&&(He=new Jf(He,n,null,l,de),he.push({event:He,listeners:Ve}),Ue?He.data=Ue:(Ue=sp(l),Ue!==null&&(He.data=Ue)))),(Ue=Nw?Iw(n,l):Bw(n,l))&&(ne=_o(ne,"onBeforeInput"),0<ne.length&&(de=new Jf("onBeforeInput","beforeinput",null,l,de),he.push({event:de,listeners:ne}),de.data=Ue))}Cp(he,r)})}function pa(n,r,l){return{instance:n,listener:r,currentTarget:l}}function _o(n,r){for(var l=r+"Capture",d=[];n!==null;){var m=n,w=m.stateNode;m.tag===5&&w!==null&&(m=w,w=ii(n,l),w!=null&&d.unshift(pa(n,w,m)),w=ii(n,r),w!=null&&d.push(pa(n,w,m))),n=n.return}return d}function fs(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Ep(n,r,l,d,m){for(var w=r._reactName,P=[];l!==null&&l!==d;){var I=l,q=I.alternate,ne=I.stateNode;if(q!==null&&q===d)break;I.tag===5&&ne!==null&&(I=ne,m?(q=ii(l,w),q!=null&&P.unshift(pa(l,q,I))):m||(q=ii(l,w),q!=null&&P.push(pa(l,q,I)))),l=l.return}P.length!==0&&n.push({event:r,listeners:P})}var Zw=/\r\n?/g,Jw=/\u0000|\uFFFD/g;function Pp(n){return(typeof n=="string"?n:""+n).replace(Zw,`
`).replace(Jw,"")}function Co(n,r,l){if(r=Pp(r),Pp(n)!==r&&l)throw Error(i(425))}function To(){}var hc=null,mc=null;function gc(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var vc=typeof setTimeout=="function"?setTimeout:void 0,e1=typeof clearTimeout=="function"?clearTimeout:void 0,Dp=typeof Promise=="function"?Promise:void 0,t1=typeof queueMicrotask=="function"?queueMicrotask:typeof Dp<"u"?function(n){return Dp.resolve(null).then(n).catch(n1)}:vc;function n1(n){setTimeout(function(){throw n})}function yc(n,r){var l=r,d=0;do{var m=l.nextSibling;if(n.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"){if(d===0){n.removeChild(m),ia(r);return}d--}else l!=="$"&&l!=="$?"&&l!=="$!"||d++;l=m}while(l);ia(r)}function sr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return n}function Lp(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(r===0)return n;r--}else l==="/$"&&r++}n=n.previousSibling}return null}var ps=Math.random().toString(36).slice(2),Pi="__reactFiber$"+ps,ha="__reactProps$"+ps,Bi="__reactContainer$"+ps,wc="__reactEvents$"+ps,i1="__reactListeners$"+ps,r1="__reactHandles$"+ps;function Lr(n){var r=n[Pi];if(r)return r;for(var l=n.parentNode;l;){if(r=l[Bi]||l[Pi]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(n=Lp(n);n!==null;){if(l=n[Pi])return l;n=Lp(n)}return r}n=l,l=n.parentNode}return null}function ma(n){return n=n[Pi]||n[Bi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function hs(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(i(33))}function Eo(n){return n[ha]||null}var bc=[],ms=-1;function ar(n){return{current:n}}function _t(n){0>ms||(n.current=bc[ms],bc[ms]=null,ms--)}function bt(n,r){ms++,bc[ms]=n.current,n.current=r}var or={},dn=ar(or),Rn=ar(!1),Mr=or;function gs(n,r){var l=n.type.contextTypes;if(!l)return or;var d=n.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===r)return d.__reactInternalMemoizedMaskedChildContext;var m={},w;for(w in l)m[w]=r[w];return d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=m),m}function Fn(n){return n=n.childContextTypes,n!=null}function Po(){_t(Rn),_t(dn)}function Mp(n,r,l){if(dn.current!==or)throw Error(i(168));bt(dn,r),bt(Rn,l)}function Ap(n,r,l){var d=n.stateNode;if(r=r.childContextTypes,typeof d.getChildContext!="function")return l;d=d.getChildContext();for(var m in d)if(!(m in r))throw Error(i(108,T(n)||"Unknown",m));return u({},l,d)}function Do(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||or,Mr=dn.current,bt(dn,n),bt(Rn,Rn.current),!0}function Rp(n,r,l){var d=n.stateNode;if(!d)throw Error(i(169));l?(n=Ap(n,r,Mr),d.__reactInternalMemoizedMergedChildContext=n,_t(Rn),_t(dn),bt(dn,n)):_t(Rn),bt(Rn,l)}var zi=null,Lo=!1,xc=!1;function Fp(n){zi===null?zi=[n]:zi.push(n)}function s1(n){Lo=!0,Fp(n)}function lr(){if(!xc&&zi!==null){xc=!0;var n=0,r=ft;try{var l=zi;for(ft=1;n<l.length;n++){var d=l[n];do d=d(!0);while(d!==null)}zi=null,Lo=!1}catch(m){throw zi!==null&&(zi=zi.slice(n+1)),An(Fe,lr),m}finally{ft=r,xc=!1}}return null}var vs=[],ys=0,Mo=null,Ao=0,ri=[],si=0,Ar=null,Vi=1,Ui="";function Rr(n,r){vs[ys++]=Ao,vs[ys++]=Mo,Mo=n,Ao=r}function Op(n,r,l){ri[si++]=Vi,ri[si++]=Ui,ri[si++]=Ar,Ar=n;var d=Vi;n=Ui;var m=32-zt(d)-1;d&=~(1<<m),l+=1;var w=32-zt(r)+m;if(30<w){var P=m-m%5;w=(d&(1<<P)-1).toString(32),d>>=P,m-=P,Vi=1<<32-zt(r)+m|l<<m|d,Ui=w+n}else Vi=1<<w|l<<m|d,Ui=n}function Sc(n){n.return!==null&&(Rr(n,1),Op(n,1,0))}function kc(n){for(;n===Mo;)Mo=vs[--ys],vs[ys]=null,Ao=vs[--ys],vs[ys]=null;for(;n===Ar;)Ar=ri[--si],ri[si]=null,Ui=ri[--si],ri[si]=null,Vi=ri[--si],ri[si]=null}var Xn=null,Gn=null,Ct=!1,wi=null;function Np(n,r){var l=ci(5,null,null,0);l.elementType="DELETED",l.stateNode=r,l.return=n,r=n.deletions,r===null?(n.deletions=[l],n.flags|=16):r.push(l)}function Ip(n,r){switch(n.tag){case 5:var l=n.type;return r=r.nodeType!==1||l.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(n.stateNode=r,Xn=n,Gn=sr(r.firstChild),!0):!1;case 6:return r=n.pendingProps===""||r.nodeType!==3?null:r,r!==null?(n.stateNode=r,Xn=n,Gn=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(l=Ar!==null?{id:Vi,overflow:Ui}:null,n.memoizedState={dehydrated:r,treeContext:l,retryLane:1073741824},l=ci(18,null,null,0),l.stateNode=r,l.return=n,n.child=l,Xn=n,Gn=null,!0):!1;default:return!1}}function _c(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Cc(n){if(Ct){var r=Gn;if(r){var l=r;if(!Ip(n,r)){if(_c(n))throw Error(i(418));r=sr(l.nextSibling);var d=Xn;r&&Ip(n,r)?Np(d,l):(n.flags=n.flags&-4097|2,Ct=!1,Xn=n)}}else{if(_c(n))throw Error(i(418));n.flags=n.flags&-4097|2,Ct=!1,Xn=n}}}function Bp(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Xn=n}function Ro(n){if(n!==Xn)return!1;if(!Ct)return Bp(n),Ct=!0,!1;var r;if((r=n.tag!==3)&&!(r=n.tag!==5)&&(r=n.type,r=r!=="head"&&r!=="body"&&!gc(n.type,n.memoizedProps)),r&&(r=Gn)){if(_c(n))throw zp(),Error(i(418));for(;r;)Np(n,r),r=sr(r.nextSibling)}if(Bp(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));e:{for(n=n.nextSibling,r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(r===0){Gn=sr(n.nextSibling);break e}r--}else l!=="$"&&l!=="$!"&&l!=="$?"||r++}n=n.nextSibling}Gn=null}}else Gn=Xn?sr(n.stateNode.nextSibling):null;return!0}function zp(){for(var n=Gn;n;)n=sr(n.nextSibling)}function ws(){Gn=Xn=null,Ct=!1}function Tc(n){wi===null?wi=[n]:wi.push(n)}var a1=W.ReactCurrentBatchConfig;function ga(n,r,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(i(309));var d=l.stateNode}if(!d)throw Error(i(147,n));var m=d,w=""+n;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===w?r.ref:(r=function(P){var I=m.refs;P===null?delete I[w]:I[w]=P},r._stringRef=w,r)}if(typeof n!="string")throw Error(i(284));if(!l._owner)throw Error(i(290,n))}return n}function Fo(n,r){throw n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n))}function Vp(n){var r=n._init;return r(n._payload)}function Up(n){function r(Z,X){if(n){var ee=Z.deletions;ee===null?(Z.deletions=[X],Z.flags|=16):ee.push(X)}}function l(Z,X){if(!n)return null;for(;X!==null;)r(Z,X),X=X.sibling;return null}function d(Z,X){for(Z=new Map;X!==null;)X.key!==null?Z.set(X.key,X):Z.set(X.index,X),X=X.sibling;return Z}function m(Z,X){return Z=gr(Z,X),Z.index=0,Z.sibling=null,Z}function w(Z,X,ee){return Z.index=ee,n?(ee=Z.alternate,ee!==null?(ee=ee.index,ee<X?(Z.flags|=2,X):ee):(Z.flags|=2,X)):(Z.flags|=1048576,X)}function P(Z){return n&&Z.alternate===null&&(Z.flags|=2),Z}function I(Z,X,ee,ve){return X===null||X.tag!==6?(X=vu(ee,Z.mode,ve),X.return=Z,X):(X=m(X,ee),X.return=Z,X)}function q(Z,X,ee,ve){var ze=ee.type;return ze===J?de(Z,X,ee.props.children,ve,ee.key):X!==null&&(X.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===Ae&&Vp(ze)===X.type)?(ve=m(X,ee.props),ve.ref=ga(Z,X,ee),ve.return=Z,ve):(ve=rl(ee.type,ee.key,ee.props,null,Z.mode,ve),ve.ref=ga(Z,X,ee),ve.return=Z,ve)}function ne(Z,X,ee,ve){return X===null||X.tag!==4||X.stateNode.containerInfo!==ee.containerInfo||X.stateNode.implementation!==ee.implementation?(X=yu(ee,Z.mode,ve),X.return=Z,X):(X=m(X,ee.children||[]),X.return=Z,X)}function de(Z,X,ee,ve,ze){return X===null||X.tag!==7?(X=Ur(ee,Z.mode,ve,ze),X.return=Z,X):(X=m(X,ee),X.return=Z,X)}function he(Z,X,ee){if(typeof X=="string"&&X!==""||typeof X=="number")return X=vu(""+X,Z.mode,ee),X.return=Z,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case V:return ee=rl(X.type,X.key,X.props,null,Z.mode,ee),ee.ref=ga(Z,null,X),ee.return=Z,ee;case H:return X=yu(X,Z.mode,ee),X.return=Z,X;case Ae:var ve=X._init;return he(Z,ve(X._payload),ee)}if(ge(X)||_e(X))return X=Ur(X,Z.mode,ee,null),X.return=Z,X;Fo(Z,X)}return null}function ue(Z,X,ee,ve){var ze=X!==null?X.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ze!==null?null:I(Z,X,""+ee,ve);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case V:return ee.key===ze?q(Z,X,ee,ve):null;case H:return ee.key===ze?ne(Z,X,ee,ve):null;case Ae:return ze=ee._init,ue(Z,X,ze(ee._payload),ve)}if(ge(ee)||_e(ee))return ze!==null?null:de(Z,X,ee,ve,null);Fo(Z,ee)}return null}function Pe(Z,X,ee,ve,ze){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return Z=Z.get(ee)||null,I(X,Z,""+ve,ze);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case V:return Z=Z.get(ve.key===null?ee:ve.key)||null,q(X,Z,ve,ze);case H:return Z=Z.get(ve.key===null?ee:ve.key)||null,ne(X,Z,ve,ze);case Ae:var Ve=ve._init;return Pe(Z,X,ee,Ve(ve._payload),ze)}if(ge(ve)||_e(ve))return Z=Z.get(ee)||null,de(X,Z,ve,ze,null);Fo(X,ve)}return null}function Re(Z,X,ee,ve){for(var ze=null,Ve=null,Ue=X,He=X=0,tn=null;Ue!==null&&He<ee.length;He++){Ue.index>He?(tn=Ue,Ue=null):tn=Ue.sibling;var ut=ue(Z,Ue,ee[He],ve);if(ut===null){Ue===null&&(Ue=tn);break}n&&Ue&&ut.alternate===null&&r(Z,Ue),X=w(ut,X,He),Ve===null?ze=ut:Ve.sibling=ut,Ve=ut,Ue=tn}if(He===ee.length)return l(Z,Ue),Ct&&Rr(Z,He),ze;if(Ue===null){for(;He<ee.length;He++)Ue=he(Z,ee[He],ve),Ue!==null&&(X=w(Ue,X,He),Ve===null?ze=Ue:Ve.sibling=Ue,Ve=Ue);return Ct&&Rr(Z,He),ze}for(Ue=d(Z,Ue);He<ee.length;He++)tn=Pe(Ue,Z,He,ee[He],ve),tn!==null&&(n&&tn.alternate!==null&&Ue.delete(tn.key===null?He:tn.key),X=w(tn,X,He),Ve===null?ze=tn:Ve.sibling=tn,Ve=tn);return n&&Ue.forEach(function(vr){return r(Z,vr)}),Ct&&Rr(Z,He),ze}function Ne(Z,X,ee,ve){var ze=_e(ee);if(typeof ze!="function")throw Error(i(150));if(ee=ze.call(ee),ee==null)throw Error(i(151));for(var Ve=ze=null,Ue=X,He=X=0,tn=null,ut=ee.next();Ue!==null&&!ut.done;He++,ut=ee.next()){Ue.index>He?(tn=Ue,Ue=null):tn=Ue.sibling;var vr=ue(Z,Ue,ut.value,ve);if(vr===null){Ue===null&&(Ue=tn);break}n&&Ue&&vr.alternate===null&&r(Z,Ue),X=w(vr,X,He),Ve===null?ze=vr:Ve.sibling=vr,Ve=vr,Ue=tn}if(ut.done)return l(Z,Ue),Ct&&Rr(Z,He),ze;if(Ue===null){for(;!ut.done;He++,ut=ee.next())ut=he(Z,ut.value,ve),ut!==null&&(X=w(ut,X,He),Ve===null?ze=ut:Ve.sibling=ut,Ve=ut);return Ct&&Rr(Z,He),ze}for(Ue=d(Z,Ue);!ut.done;He++,ut=ee.next())ut=Pe(Ue,Z,He,ut.value,ve),ut!==null&&(n&&ut.alternate!==null&&Ue.delete(ut.key===null?He:ut.key),X=w(ut,X,He),Ve===null?ze=ut:Ve.sibling=ut,Ve=ut);return n&&Ue.forEach(function(z1){return r(Z,z1)}),Ct&&Rr(Z,He),ze}function Vt(Z,X,ee,ve){if(typeof ee=="object"&&ee!==null&&ee.type===J&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case V:e:{for(var ze=ee.key,Ve=X;Ve!==null;){if(Ve.key===ze){if(ze=ee.type,ze===J){if(Ve.tag===7){l(Z,Ve.sibling),X=m(Ve,ee.props.children),X.return=Z,Z=X;break e}}else if(Ve.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===Ae&&Vp(ze)===Ve.type){l(Z,Ve.sibling),X=m(Ve,ee.props),X.ref=ga(Z,Ve,ee),X.return=Z,Z=X;break e}l(Z,Ve);break}else r(Z,Ve);Ve=Ve.sibling}ee.type===J?(X=Ur(ee.props.children,Z.mode,ve,ee.key),X.return=Z,Z=X):(ve=rl(ee.type,ee.key,ee.props,null,Z.mode,ve),ve.ref=ga(Z,X,ee),ve.return=Z,Z=ve)}return P(Z);case H:e:{for(Ve=ee.key;X!==null;){if(X.key===Ve)if(X.tag===4&&X.stateNode.containerInfo===ee.containerInfo&&X.stateNode.implementation===ee.implementation){l(Z,X.sibling),X=m(X,ee.children||[]),X.return=Z,Z=X;break e}else{l(Z,X);break}else r(Z,X);X=X.sibling}X=yu(ee,Z.mode,ve),X.return=Z,Z=X}return P(Z);case Ae:return Ve=ee._init,Vt(Z,X,Ve(ee._payload),ve)}if(ge(ee))return Re(Z,X,ee,ve);if(_e(ee))return Ne(Z,X,ee,ve);Fo(Z,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"?(ee=""+ee,X!==null&&X.tag===6?(l(Z,X.sibling),X=m(X,ee),X.return=Z,Z=X):(l(Z,X),X=vu(ee,Z.mode,ve),X.return=Z,Z=X),P(Z)):l(Z,X)}return Vt}var bs=Up(!0),Wp=Up(!1),Oo=ar(null),No=null,xs=null,Ec=null;function Pc(){Ec=xs=No=null}function Dc(n){var r=Oo.current;_t(Oo),n._currentValue=r}function Lc(n,r,l){for(;n!==null;){var d=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,d!==null&&(d.childLanes|=r)):d!==null&&(d.childLanes&r)!==r&&(d.childLanes|=r),n===l)break;n=n.return}}function Ss(n,r){No=n,Ec=xs=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&r)!==0&&(On=!0),n.firstContext=null)}function ai(n){var r=n._currentValue;if(Ec!==n)if(n={context:n,memoizedValue:r,next:null},xs===null){if(No===null)throw Error(i(308));xs=n,No.dependencies={lanes:0,firstContext:n}}else xs=xs.next=n;return r}var Fr=null;function Mc(n){Fr===null?Fr=[n]:Fr.push(n)}function jp(n,r,l,d){var m=r.interleaved;return m===null?(l.next=l,Mc(r)):(l.next=m.next,m.next=l),r.interleaved=l,Wi(n,d)}function Wi(n,r){n.lanes|=r;var l=n.alternate;for(l!==null&&(l.lanes|=r),l=n,n=n.return;n!==null;)n.childLanes|=r,l=n.alternate,l!==null&&(l.childLanes|=r),l=n,n=n.return;return l.tag===3?l.stateNode:null}var cr=!1;function Ac(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qp(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ji(n,r){return{eventTime:n,lane:r,tag:0,payload:null,callback:null,next:null}}function ur(n,r,l){var d=n.updateQueue;if(d===null)return null;if(d=d.shared,(ct&2)!==0){var m=d.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),d.pending=r,Wi(n,l)}return m=d.interleaved,m===null?(r.next=r,Mc(d)):(r.next=m.next,m.next=r),d.interleaved=r,Wi(n,l)}function Io(n,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194240)!==0)){var d=r.lanes;d&=n.pendingLanes,l|=d,r.lanes=l,$l(n,l)}}function Hp(n,r){var l=n.updateQueue,d=n.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var m=null,w=null;if(l=l.firstBaseUpdate,l!==null){do{var P={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};w===null?m=w=P:w=w.next=P,l=l.next}while(l!==null);w===null?m=w=r:w=w.next=r}else m=w=r;l={baseState:d.baseState,firstBaseUpdate:m,lastBaseUpdate:w,shared:d.shared,effects:d.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=r:n.next=r,l.lastBaseUpdate=r}function Bo(n,r,l,d){var m=n.updateQueue;cr=!1;var w=m.firstBaseUpdate,P=m.lastBaseUpdate,I=m.shared.pending;if(I!==null){m.shared.pending=null;var q=I,ne=q.next;q.next=null,P===null?w=ne:P.next=ne,P=q;var de=n.alternate;de!==null&&(de=de.updateQueue,I=de.lastBaseUpdate,I!==P&&(I===null?de.firstBaseUpdate=ne:I.next=ne,de.lastBaseUpdate=q))}if(w!==null){var he=m.baseState;P=0,de=ne=q=null,I=w;do{var ue=I.lane,Pe=I.eventTime;if((d&ue)===ue){de!==null&&(de=de.next={eventTime:Pe,lane:0,tag:I.tag,payload:I.payload,callback:I.callback,next:null});e:{var Re=n,Ne=I;switch(ue=r,Pe=l,Ne.tag){case 1:if(Re=Ne.payload,typeof Re=="function"){he=Re.call(Pe,he,ue);break e}he=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Ne.payload,ue=typeof Re=="function"?Re.call(Pe,he,ue):Re,ue==null)break e;he=u({},he,ue);break e;case 2:cr=!0}}I.callback!==null&&I.lane!==0&&(n.flags|=64,ue=m.effects,ue===null?m.effects=[I]:ue.push(I))}else Pe={eventTime:Pe,lane:ue,tag:I.tag,payload:I.payload,callback:I.callback,next:null},de===null?(ne=de=Pe,q=he):de=de.next=Pe,P|=ue;if(I=I.next,I===null){if(I=m.shared.pending,I===null)break;ue=I,I=ue.next,ue.next=null,m.lastBaseUpdate=ue,m.shared.pending=null}}while(!0);if(de===null&&(q=he),m.baseState=q,m.firstBaseUpdate=ne,m.lastBaseUpdate=de,r=m.shared.interleaved,r!==null){m=r;do P|=m.lane,m=m.next;while(m!==r)}else w===null&&(m.shared.lanes=0);Ir|=P,n.lanes=P,n.memoizedState=he}}function $p(n,r,l){if(n=r.effects,r.effects=null,n!==null)for(r=0;r<n.length;r++){var d=n[r],m=d.callback;if(m!==null){if(d.callback=null,d=l,typeof m!="function")throw Error(i(191,m));m.call(d)}}}var va={},Di=ar(va),ya=ar(va),wa=ar(va);function Or(n){if(n===va)throw Error(i(174));return n}function Rc(n,r){switch(bt(wa,r),bt(ya,n),bt(Di,va),n=r.nodeType,n){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:je(null,"");break;default:n=n===8?r.parentNode:r,r=n.namespaceURI||null,n=n.tagName,r=je(r,n)}_t(Di),bt(Di,r)}function ks(){_t(Di),_t(ya),_t(wa)}function Yp(n){Or(wa.current);var r=Or(Di.current),l=je(r,n.type);r!==l&&(bt(ya,n),bt(Di,l))}function Fc(n){ya.current===n&&(_t(Di),_t(ya))}var Pt=ar(0);function zo(n){for(var r=n;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Oc=[];function Nc(){for(var n=0;n<Oc.length;n++)Oc[n]._workInProgressVersionPrimary=null;Oc.length=0}var Vo=W.ReactCurrentDispatcher,Ic=W.ReactCurrentBatchConfig,Nr=0,Dt=null,Gt=null,Jt=null,Uo=!1,ba=!1,xa=0,o1=0;function fn(){throw Error(i(321))}function Bc(n,r){if(r===null)return!1;for(var l=0;l<r.length&&l<n.length;l++)if(!yi(n[l],r[l]))return!1;return!0}function zc(n,r,l,d,m,w){if(Nr=w,Dt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Vo.current=n===null||n.memoizedState===null?d1:f1,n=l(d,m),ba){w=0;do{if(ba=!1,xa=0,25<=w)throw Error(i(301));w+=1,Jt=Gt=null,r.updateQueue=null,Vo.current=p1,n=l(d,m)}while(ba)}if(Vo.current=qo,r=Gt!==null&&Gt.next!==null,Nr=0,Jt=Gt=Dt=null,Uo=!1,r)throw Error(i(300));return n}function Vc(){var n=xa!==0;return xa=0,n}function Li(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?Dt.memoizedState=Jt=n:Jt=Jt.next=n,Jt}function oi(){if(Gt===null){var n=Dt.alternate;n=n!==null?n.memoizedState:null}else n=Gt.next;var r=Jt===null?Dt.memoizedState:Jt.next;if(r!==null)Jt=r,Gt=n;else{if(n===null)throw Error(i(310));Gt=n,n={memoizedState:Gt.memoizedState,baseState:Gt.baseState,baseQueue:Gt.baseQueue,queue:Gt.queue,next:null},Jt===null?Dt.memoizedState=Jt=n:Jt=Jt.next=n}return Jt}function Sa(n,r){return typeof r=="function"?r(n):r}function Uc(n){var r=oi(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var d=Gt,m=d.baseQueue,w=l.pending;if(w!==null){if(m!==null){var P=m.next;m.next=w.next,w.next=P}d.baseQueue=m=w,l.pending=null}if(m!==null){w=m.next,d=d.baseState;var I=P=null,q=null,ne=w;do{var de=ne.lane;if((Nr&de)===de)q!==null&&(q=q.next={lane:0,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),d=ne.hasEagerState?ne.eagerState:n(d,ne.action);else{var he={lane:de,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null};q===null?(I=q=he,P=d):q=q.next=he,Dt.lanes|=de,Ir|=de}ne=ne.next}while(ne!==null&&ne!==w);q===null?P=d:q.next=I,yi(d,r.memoizedState)||(On=!0),r.memoizedState=d,r.baseState=P,r.baseQueue=q,l.lastRenderedState=d}if(n=l.interleaved,n!==null){m=n;do w=m.lane,Dt.lanes|=w,Ir|=w,m=m.next;while(m!==n)}else m===null&&(l.lanes=0);return[r.memoizedState,l.dispatch]}function Wc(n){var r=oi(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var d=l.dispatch,m=l.pending,w=r.memoizedState;if(m!==null){l.pending=null;var P=m=m.next;do w=n(w,P.action),P=P.next;while(P!==m);yi(w,r.memoizedState)||(On=!0),r.memoizedState=w,r.baseQueue===null&&(r.baseState=w),l.lastRenderedState=w}return[w,d]}function Xp(){}function Gp(n,r){var l=Dt,d=oi(),m=r(),w=!yi(d.memoizedState,m);if(w&&(d.memoizedState=m,On=!0),d=d.queue,jc(Zp.bind(null,l,d,n),[n]),d.getSnapshot!==r||w||Jt!==null&&Jt.memoizedState.tag&1){if(l.flags|=2048,ka(9,Qp.bind(null,l,d,m,r),void 0,null),en===null)throw Error(i(349));(Nr&30)!==0||Kp(l,r,m)}return m}function Kp(n,r,l){n.flags|=16384,n={getSnapshot:r,value:l},r=Dt.updateQueue,r===null?(r={lastEffect:null,stores:null},Dt.updateQueue=r,r.stores=[n]):(l=r.stores,l===null?r.stores=[n]:l.push(n))}function Qp(n,r,l,d){r.value=l,r.getSnapshot=d,Jp(r)&&eh(n)}function Zp(n,r,l){return l(function(){Jp(r)&&eh(n)})}function Jp(n){var r=n.getSnapshot;n=n.value;try{var l=r();return!yi(n,l)}catch{return!0}}function eh(n){var r=Wi(n,1);r!==null&&ki(r,n,1,-1)}function th(n){var r=Li();return typeof n=="function"&&(n=n()),r.memoizedState=r.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sa,lastRenderedState:n},r.queue=n,n=n.dispatch=u1.bind(null,Dt,n),[r.memoizedState,n]}function ka(n,r,l,d){return n={tag:n,create:r,destroy:l,deps:d,next:null},r=Dt.updateQueue,r===null?(r={lastEffect:null,stores:null},Dt.updateQueue=r,r.lastEffect=n.next=n):(l=r.lastEffect,l===null?r.lastEffect=n.next=n:(d=l.next,l.next=n,n.next=d,r.lastEffect=n)),n}function nh(){return oi().memoizedState}function Wo(n,r,l,d){var m=Li();Dt.flags|=n,m.memoizedState=ka(1|r,l,void 0,d===void 0?null:d)}function jo(n,r,l,d){var m=oi();d=d===void 0?null:d;var w=void 0;if(Gt!==null){var P=Gt.memoizedState;if(w=P.destroy,d!==null&&Bc(d,P.deps)){m.memoizedState=ka(r,l,w,d);return}}Dt.flags|=n,m.memoizedState=ka(1|r,l,w,d)}function ih(n,r){return Wo(8390656,8,n,r)}function jc(n,r){return jo(2048,8,n,r)}function rh(n,r){return jo(4,2,n,r)}function sh(n,r){return jo(4,4,n,r)}function ah(n,r){if(typeof r=="function")return n=n(),r(n),function(){r(null)};if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function oh(n,r,l){return l=l!=null?l.concat([n]):null,jo(4,4,ah.bind(null,r,n),l)}function qc(){}function lh(n,r){var l=oi();r=r===void 0?null:r;var d=l.memoizedState;return d!==null&&r!==null&&Bc(r,d[1])?d[0]:(l.memoizedState=[n,r],n)}function ch(n,r){var l=oi();r=r===void 0?null:r;var d=l.memoizedState;return d!==null&&r!==null&&Bc(r,d[1])?d[0]:(n=n(),l.memoizedState=[n,r],n)}function uh(n,r,l){return(Nr&21)===0?(n.baseState&&(n.baseState=!1,On=!0),n.memoizedState=l):(yi(l,r)||(l=Vf(),Dt.lanes|=l,Ir|=l,n.baseState=!0),r)}function l1(n,r){var l=ft;ft=l!==0&&4>l?l:4,n(!0);var d=Ic.transition;Ic.transition={};try{n(!1),r()}finally{ft=l,Ic.transition=d}}function dh(){return oi().memoizedState}function c1(n,r,l){var d=hr(n);if(l={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null},fh(n))ph(r,l);else if(l=jp(n,r,l,d),l!==null){var m=_n();ki(l,n,d,m),hh(l,r,d)}}function u1(n,r,l){var d=hr(n),m={lane:d,action:l,hasEagerState:!1,eagerState:null,next:null};if(fh(n))ph(r,m);else{var w=n.alternate;if(n.lanes===0&&(w===null||w.lanes===0)&&(w=r.lastRenderedReducer,w!==null))try{var P=r.lastRenderedState,I=w(P,l);if(m.hasEagerState=!0,m.eagerState=I,yi(I,P)){var q=r.interleaved;q===null?(m.next=m,Mc(r)):(m.next=q.next,q.next=m),r.interleaved=m;return}}catch{}l=jp(n,r,m,d),l!==null&&(m=_n(),ki(l,n,d,m),hh(l,r,d))}}function fh(n){var r=n.alternate;return n===Dt||r!==null&&r===Dt}function ph(n,r){ba=Uo=!0;var l=n.pending;l===null?r.next=r:(r.next=l.next,l.next=r),n.pending=r}function hh(n,r,l){if((l&4194240)!==0){var d=r.lanes;d&=n.pendingLanes,l|=d,r.lanes=l,$l(n,l)}}var qo={readContext:ai,useCallback:fn,useContext:fn,useEffect:fn,useImperativeHandle:fn,useInsertionEffect:fn,useLayoutEffect:fn,useMemo:fn,useReducer:fn,useRef:fn,useState:fn,useDebugValue:fn,useDeferredValue:fn,useTransition:fn,useMutableSource:fn,useSyncExternalStore:fn,useId:fn,unstable_isNewReconciler:!1},d1={readContext:ai,useCallback:function(n,r){return Li().memoizedState=[n,r===void 0?null:r],n},useContext:ai,useEffect:ih,useImperativeHandle:function(n,r,l){return l=l!=null?l.concat([n]):null,Wo(4194308,4,ah.bind(null,r,n),l)},useLayoutEffect:function(n,r){return Wo(4194308,4,n,r)},useInsertionEffect:function(n,r){return Wo(4,2,n,r)},useMemo:function(n,r){var l=Li();return r=r===void 0?null:r,n=n(),l.memoizedState=[n,r],n},useReducer:function(n,r,l){var d=Li();return r=l!==void 0?l(r):r,d.memoizedState=d.baseState=r,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:r},d.queue=n,n=n.dispatch=c1.bind(null,Dt,n),[d.memoizedState,n]},useRef:function(n){var r=Li();return n={current:n},r.memoizedState=n},useState:th,useDebugValue:qc,useDeferredValue:function(n){return Li().memoizedState=n},useTransition:function(){var n=th(!1),r=n[0];return n=l1.bind(null,n[1]),Li().memoizedState=n,[r,n]},useMutableSource:function(){},useSyncExternalStore:function(n,r,l){var d=Dt,m=Li();if(Ct){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),en===null)throw Error(i(349));(Nr&30)!==0||Kp(d,r,l)}m.memoizedState=l;var w={value:l,getSnapshot:r};return m.queue=w,ih(Zp.bind(null,d,w,n),[n]),d.flags|=2048,ka(9,Qp.bind(null,d,w,l,r),void 0,null),l},useId:function(){var n=Li(),r=en.identifierPrefix;if(Ct){var l=Ui,d=Vi;l=(d&~(1<<32-zt(d)-1)).toString(32)+l,r=":"+r+"R"+l,l=xa++,0<l&&(r+="H"+l.toString(32)),r+=":"}else l=o1++,r=":"+r+"r"+l.toString(32)+":";return n.memoizedState=r},unstable_isNewReconciler:!1},f1={readContext:ai,useCallback:lh,useContext:ai,useEffect:jc,useImperativeHandle:oh,useInsertionEffect:rh,useLayoutEffect:sh,useMemo:ch,useReducer:Uc,useRef:nh,useState:function(){return Uc(Sa)},useDebugValue:qc,useDeferredValue:function(n){var r=oi();return uh(r,Gt.memoizedState,n)},useTransition:function(){var n=Uc(Sa)[0],r=oi().memoizedState;return[n,r]},useMutableSource:Xp,useSyncExternalStore:Gp,useId:dh,unstable_isNewReconciler:!1},p1={readContext:ai,useCallback:lh,useContext:ai,useEffect:jc,useImperativeHandle:oh,useInsertionEffect:rh,useLayoutEffect:sh,useMemo:ch,useReducer:Wc,useRef:nh,useState:function(){return Wc(Sa)},useDebugValue:qc,useDeferredValue:function(n){var r=oi();return Gt===null?r.memoizedState=n:uh(r,Gt.memoizedState,n)},useTransition:function(){var n=Wc(Sa)[0],r=oi().memoizedState;return[n,r]},useMutableSource:Xp,useSyncExternalStore:Gp,useId:dh,unstable_isNewReconciler:!1};function bi(n,r){if(n&&n.defaultProps){r=u({},r),n=n.defaultProps;for(var l in n)r[l]===void 0&&(r[l]=n[l]);return r}return r}function Hc(n,r,l,d){r=n.memoizedState,l=l(d,r),l=l==null?r:u({},r,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var Ho={isMounted:function(n){return(n=n._reactInternals)?sn(n)===n:!1},enqueueSetState:function(n,r,l){n=n._reactInternals;var d=_n(),m=hr(n),w=ji(d,m);w.payload=r,l!=null&&(w.callback=l),r=ur(n,w,m),r!==null&&(ki(r,n,m,d),Io(r,n,m))},enqueueReplaceState:function(n,r,l){n=n._reactInternals;var d=_n(),m=hr(n),w=ji(d,m);w.tag=1,w.payload=r,l!=null&&(w.callback=l),r=ur(n,w,m),r!==null&&(ki(r,n,m,d),Io(r,n,m))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var l=_n(),d=hr(n),m=ji(l,d);m.tag=2,r!=null&&(m.callback=r),r=ur(n,m,d),r!==null&&(ki(r,n,d,l),Io(r,n,d))}};function mh(n,r,l,d,m,w,P){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(d,w,P):r.prototype&&r.prototype.isPureReactComponent?!ca(l,d)||!ca(m,w):!0}function gh(n,r,l){var d=!1,m=or,w=r.contextType;return typeof w=="object"&&w!==null?w=ai(w):(m=Fn(r)?Mr:dn.current,d=r.contextTypes,w=(d=d!=null)?gs(n,m):or),r=new r(l,w),n.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Ho,n.stateNode=r,r._reactInternals=n,d&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=m,n.__reactInternalMemoizedMaskedChildContext=w),r}function vh(n,r,l,d){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,d),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,d),r.state!==n&&Ho.enqueueReplaceState(r,r.state,null)}function $c(n,r,l,d){var m=n.stateNode;m.props=l,m.state=n.memoizedState,m.refs={},Ac(n);var w=r.contextType;typeof w=="object"&&w!==null?m.context=ai(w):(w=Fn(r)?Mr:dn.current,m.context=gs(n,w)),m.state=n.memoizedState,w=r.getDerivedStateFromProps,typeof w=="function"&&(Hc(n,r,w,l),m.state=n.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(r=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),r!==m.state&&Ho.enqueueReplaceState(m,m.state,null),Bo(n,l,m,d),m.state=n.memoizedState),typeof m.componentDidMount=="function"&&(n.flags|=4194308)}function _s(n,r){try{var l="",d=r;do l+=_(d),d=d.return;while(d);var m=l}catch(w){m=`
Error generating stack: `+w.message+`
`+w.stack}return{value:n,source:r,stack:m,digest:null}}function Yc(n,r,l){return{value:n,source:null,stack:l??null,digest:r??null}}function Xc(n,r){try{console.error(r.value)}catch(l){setTimeout(function(){throw l})}}var h1=typeof WeakMap=="function"?WeakMap:Map;function yh(n,r,l){l=ji(-1,l),l.tag=3,l.payload={element:null};var d=r.value;return l.callback=function(){Zo||(Zo=!0,cu=d),Xc(n,r)},l}function wh(n,r,l){l=ji(-1,l),l.tag=3;var d=n.type.getDerivedStateFromError;if(typeof d=="function"){var m=r.value;l.payload=function(){return d(m)},l.callback=function(){Xc(n,r)}}var w=n.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(l.callback=function(){Xc(n,r),typeof d!="function"&&(fr===null?fr=new Set([this]):fr.add(this));var P=r.stack;this.componentDidCatch(r.value,{componentStack:P!==null?P:""})}),l}function bh(n,r,l){var d=n.pingCache;if(d===null){d=n.pingCache=new h1;var m=new Set;d.set(r,m)}else m=d.get(r),m===void 0&&(m=new Set,d.set(r,m));m.has(l)||(m.add(l),n=P1.bind(null,n,r,l),r.then(n,n))}function xh(n){do{var r;if((r=n.tag===13)&&(r=n.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return n;n=n.return}while(n!==null);return null}function Sh(n,r,l,d,m){return(n.mode&1)===0?(n===r?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(r=ji(-1,1),r.tag=2,ur(l,r,1))),l.lanes|=1),n):(n.flags|=65536,n.lanes=m,n)}var m1=W.ReactCurrentOwner,On=!1;function kn(n,r,l,d){r.child=n===null?Wp(r,null,l,d):bs(r,n.child,l,d)}function kh(n,r,l,d,m){l=l.render;var w=r.ref;return Ss(r,m),d=zc(n,r,l,d,w,m),l=Vc(),n!==null&&!On?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~m,qi(n,r,m)):(Ct&&l&&Sc(r),r.flags|=1,kn(n,r,d,m),r.child)}function _h(n,r,l,d,m){if(n===null){var w=l.type;return typeof w=="function"&&!gu(w)&&w.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(r.tag=15,r.type=w,Ch(n,r,w,d,m)):(n=rl(l.type,null,d,r,r.mode,m),n.ref=r.ref,n.return=r,r.child=n)}if(w=n.child,(n.lanes&m)===0){var P=w.memoizedProps;if(l=l.compare,l=l!==null?l:ca,l(P,d)&&n.ref===r.ref)return qi(n,r,m)}return r.flags|=1,n=gr(w,d),n.ref=r.ref,n.return=r,r.child=n}function Ch(n,r,l,d,m){if(n!==null){var w=n.memoizedProps;if(ca(w,d)&&n.ref===r.ref)if(On=!1,r.pendingProps=d=w,(n.lanes&m)!==0)(n.flags&131072)!==0&&(On=!0);else return r.lanes=n.lanes,qi(n,r,m)}return Gc(n,r,l,d,m)}function Th(n,r,l){var d=r.pendingProps,m=d.children,w=n!==null?n.memoizedState:null;if(d.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null,transitions:null},bt(Ts,Kn),Kn|=l;else{if((l&1073741824)===0)return n=w!==null?w.baseLanes|l:l,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:n,cachePool:null,transitions:null},r.updateQueue=null,bt(Ts,Kn),Kn|=n,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=w!==null?w.baseLanes:l,bt(Ts,Kn),Kn|=d}else w!==null?(d=w.baseLanes|l,r.memoizedState=null):d=l,bt(Ts,Kn),Kn|=d;return kn(n,r,m,l),r.child}function Eh(n,r){var l=r.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(r.flags|=512,r.flags|=2097152)}function Gc(n,r,l,d,m){var w=Fn(l)?Mr:dn.current;return w=gs(r,w),Ss(r,m),l=zc(n,r,l,d,w,m),d=Vc(),n!==null&&!On?(r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~m,qi(n,r,m)):(Ct&&d&&Sc(r),r.flags|=1,kn(n,r,l,m),r.child)}function Ph(n,r,l,d,m){if(Fn(l)){var w=!0;Do(r)}else w=!1;if(Ss(r,m),r.stateNode===null)Yo(n,r),gh(r,l,d),$c(r,l,d,m),d=!0;else if(n===null){var P=r.stateNode,I=r.memoizedProps;P.props=I;var q=P.context,ne=l.contextType;typeof ne=="object"&&ne!==null?ne=ai(ne):(ne=Fn(l)?Mr:dn.current,ne=gs(r,ne));var de=l.getDerivedStateFromProps,he=typeof de=="function"||typeof P.getSnapshotBeforeUpdate=="function";he||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(I!==d||q!==ne)&&vh(r,P,d,ne),cr=!1;var ue=r.memoizedState;P.state=ue,Bo(r,d,P,m),q=r.memoizedState,I!==d||ue!==q||Rn.current||cr?(typeof de=="function"&&(Hc(r,l,de,d),q=r.memoizedState),(I=cr||mh(r,l,I,d,ue,q,ne))?(he||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(r.flags|=4194308)):(typeof P.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=d,r.memoizedState=q),P.props=d,P.state=q,P.context=ne,d=I):(typeof P.componentDidMount=="function"&&(r.flags|=4194308),d=!1)}else{P=r.stateNode,qp(n,r),I=r.memoizedProps,ne=r.type===r.elementType?I:bi(r.type,I),P.props=ne,he=r.pendingProps,ue=P.context,q=l.contextType,typeof q=="object"&&q!==null?q=ai(q):(q=Fn(l)?Mr:dn.current,q=gs(r,q));var Pe=l.getDerivedStateFromProps;(de=typeof Pe=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(I!==he||ue!==q)&&vh(r,P,d,q),cr=!1,ue=r.memoizedState,P.state=ue,Bo(r,d,P,m);var Re=r.memoizedState;I!==he||ue!==Re||Rn.current||cr?(typeof Pe=="function"&&(Hc(r,l,Pe,d),Re=r.memoizedState),(ne=cr||mh(r,l,ne,d,ue,Re,q)||!1)?(de||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(d,Re,q),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(d,Re,q)),typeof P.componentDidUpdate=="function"&&(r.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof P.componentDidUpdate!="function"||I===n.memoizedProps&&ue===n.memoizedState||(r.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||I===n.memoizedProps&&ue===n.memoizedState||(r.flags|=1024),r.memoizedProps=d,r.memoizedState=Re),P.props=d,P.state=Re,P.context=q,d=ne):(typeof P.componentDidUpdate!="function"||I===n.memoizedProps&&ue===n.memoizedState||(r.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||I===n.memoizedProps&&ue===n.memoizedState||(r.flags|=1024),d=!1)}return Kc(n,r,l,d,w,m)}function Kc(n,r,l,d,m,w){Eh(n,r);var P=(r.flags&128)!==0;if(!d&&!P)return m&&Rp(r,l,!1),qi(n,r,w);d=r.stateNode,m1.current=r;var I=P&&typeof l.getDerivedStateFromError!="function"?null:d.render();return r.flags|=1,n!==null&&P?(r.child=bs(r,n.child,null,w),r.child=bs(r,null,I,w)):kn(n,r,I,w),r.memoizedState=d.state,m&&Rp(r,l,!0),r.child}function Dh(n){var r=n.stateNode;r.pendingContext?Mp(n,r.pendingContext,r.pendingContext!==r.context):r.context&&Mp(n,r.context,!1),Rc(n,r.containerInfo)}function Lh(n,r,l,d,m){return ws(),Tc(m),r.flags|=256,kn(n,r,l,d),r.child}var Qc={dehydrated:null,treeContext:null,retryLane:0};function Zc(n){return{baseLanes:n,cachePool:null,transitions:null}}function Mh(n,r,l){var d=r.pendingProps,m=Pt.current,w=!1,P=(r.flags&128)!==0,I;if((I=P)||(I=n!==null&&n.memoizedState===null?!1:(m&2)!==0),I?(w=!0,r.flags&=-129):(n===null||n.memoizedState!==null)&&(m|=1),bt(Pt,m&1),n===null)return Cc(r),n=r.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((r.mode&1)===0?r.lanes=1:n.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(P=d.children,n=d.fallback,w?(d=r.mode,w=r.child,P={mode:"hidden",children:P},(d&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=P):w=sl(P,d,0,null),n=Ur(n,d,l,null),w.return=r,n.return=r,w.sibling=n,r.child=w,r.child.memoizedState=Zc(l),r.memoizedState=Qc,n):Jc(r,P));if(m=n.memoizedState,m!==null&&(I=m.dehydrated,I!==null))return g1(n,r,P,d,I,m,l);if(w){w=d.fallback,P=r.mode,m=n.child,I=m.sibling;var q={mode:"hidden",children:d.children};return(P&1)===0&&r.child!==m?(d=r.child,d.childLanes=0,d.pendingProps=q,r.deletions=null):(d=gr(m,q),d.subtreeFlags=m.subtreeFlags&14680064),I!==null?w=gr(I,w):(w=Ur(w,P,l,null),w.flags|=2),w.return=r,d.return=r,d.sibling=w,r.child=d,d=w,w=r.child,P=n.child.memoizedState,P=P===null?Zc(l):{baseLanes:P.baseLanes|l,cachePool:null,transitions:P.transitions},w.memoizedState=P,w.childLanes=n.childLanes&~l,r.memoizedState=Qc,d}return w=n.child,n=w.sibling,d=gr(w,{mode:"visible",children:d.children}),(r.mode&1)===0&&(d.lanes=l),d.return=r,d.sibling=null,n!==null&&(l=r.deletions,l===null?(r.deletions=[n],r.flags|=16):l.push(n)),r.child=d,r.memoizedState=null,d}function Jc(n,r){return r=sl({mode:"visible",children:r},n.mode,0,null),r.return=n,n.child=r}function $o(n,r,l,d){return d!==null&&Tc(d),bs(r,n.child,null,l),n=Jc(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function g1(n,r,l,d,m,w,P){if(l)return r.flags&256?(r.flags&=-257,d=Yc(Error(i(422))),$o(n,r,P,d)):r.memoizedState!==null?(r.child=n.child,r.flags|=128,null):(w=d.fallback,m=r.mode,d=sl({mode:"visible",children:d.children},m,0,null),w=Ur(w,m,P,null),w.flags|=2,d.return=r,w.return=r,d.sibling=w,r.child=d,(r.mode&1)!==0&&bs(r,n.child,null,P),r.child.memoizedState=Zc(P),r.memoizedState=Qc,w);if((r.mode&1)===0)return $o(n,r,P,null);if(m.data==="$!"){if(d=m.nextSibling&&m.nextSibling.dataset,d)var I=d.dgst;return d=I,w=Error(i(419)),d=Yc(w,d,void 0),$o(n,r,P,d)}if(I=(P&n.childLanes)!==0,On||I){if(d=en,d!==null){switch(P&-P){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(d.suspendedLanes|P))!==0?0:m,m!==0&&m!==w.retryLane&&(w.retryLane=m,Wi(n,m),ki(d,n,m,-1))}return mu(),d=Yc(Error(i(421))),$o(n,r,P,d)}return m.data==="$?"?(r.flags|=128,r.child=n.child,r=D1.bind(null,n),m._reactRetry=r,null):(n=w.treeContext,Gn=sr(m.nextSibling),Xn=r,Ct=!0,wi=null,n!==null&&(ri[si++]=Vi,ri[si++]=Ui,ri[si++]=Ar,Vi=n.id,Ui=n.overflow,Ar=r),r=Jc(r,d.children),r.flags|=4096,r)}function Ah(n,r,l){n.lanes|=r;var d=n.alternate;d!==null&&(d.lanes|=r),Lc(n.return,r,l)}function eu(n,r,l,d,m){var w=n.memoizedState;w===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:m}:(w.isBackwards=r,w.rendering=null,w.renderingStartTime=0,w.last=d,w.tail=l,w.tailMode=m)}function Rh(n,r,l){var d=r.pendingProps,m=d.revealOrder,w=d.tail;if(kn(n,r,d.children,l),d=Pt.current,(d&2)!==0)d=d&1|2,r.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Ah(n,l,r);else if(n.tag===19)Ah(n,l,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}d&=1}if(bt(Pt,d),(r.mode&1)===0)r.memoizedState=null;else switch(m){case"forwards":for(l=r.child,m=null;l!==null;)n=l.alternate,n!==null&&zo(n)===null&&(m=l),l=l.sibling;l=m,l===null?(m=r.child,r.child=null):(m=l.sibling,l.sibling=null),eu(r,!1,m,l,w);break;case"backwards":for(l=null,m=r.child,r.child=null;m!==null;){if(n=m.alternate,n!==null&&zo(n)===null){r.child=m;break}n=m.sibling,m.sibling=l,l=m,m=n}eu(r,!0,l,null,w);break;case"together":eu(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Yo(n,r){(r.mode&1)===0&&n!==null&&(n.alternate=null,r.alternate=null,r.flags|=2)}function qi(n,r,l){if(n!==null&&(r.dependencies=n.dependencies),Ir|=r.lanes,(l&r.childLanes)===0)return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,l=gr(n,n.pendingProps),r.child=l,l.return=r;n.sibling!==null;)n=n.sibling,l=l.sibling=gr(n,n.pendingProps),l.return=r;l.sibling=null}return r.child}function v1(n,r,l){switch(r.tag){case 3:Dh(r),ws();break;case 5:Yp(r);break;case 1:Fn(r.type)&&Do(r);break;case 4:Rc(r,r.stateNode.containerInfo);break;case 10:var d=r.type._context,m=r.memoizedProps.value;bt(Oo,d._currentValue),d._currentValue=m;break;case 13:if(d=r.memoizedState,d!==null)return d.dehydrated!==null?(bt(Pt,Pt.current&1),r.flags|=128,null):(l&r.child.childLanes)!==0?Mh(n,r,l):(bt(Pt,Pt.current&1),n=qi(n,r,l),n!==null?n.sibling:null);bt(Pt,Pt.current&1);break;case 19:if(d=(l&r.childLanes)!==0,(n.flags&128)!==0){if(d)return Rh(n,r,l);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),bt(Pt,Pt.current),d)break;return null;case 22:case 23:return r.lanes=0,Th(n,r,l)}return qi(n,r,l)}var Fh,tu,Oh,Nh;Fh=function(n,r){for(var l=r.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},tu=function(){},Oh=function(n,r,l,d){var m=n.memoizedProps;if(m!==d){n=r.stateNode,Or(Di.current);var w=null;switch(l){case"input":m=K(n,m),d=K(n,d),w=[];break;case"select":m=u({},m,{value:void 0}),d=u({},d,{value:void 0}),w=[];break;case"textarea":m=Ee(n,m),d=Ee(n,d),w=[];break;default:typeof m.onClick!="function"&&typeof d.onClick=="function"&&(n.onclick=To)}De(l,d);var P;l=null;for(ne in m)if(!d.hasOwnProperty(ne)&&m.hasOwnProperty(ne)&&m[ne]!=null)if(ne==="style"){var I=m[ne];for(P in I)I.hasOwnProperty(P)&&(l||(l={}),l[P]="")}else ne!=="dangerouslySetInnerHTML"&&ne!=="children"&&ne!=="suppressContentEditableWarning"&&ne!=="suppressHydrationWarning"&&ne!=="autoFocus"&&(o.hasOwnProperty(ne)?w||(w=[]):(w=w||[]).push(ne,null));for(ne in d){var q=d[ne];if(I=m?.[ne],d.hasOwnProperty(ne)&&q!==I&&(q!=null||I!=null))if(ne==="style")if(I){for(P in I)!I.hasOwnProperty(P)||q&&q.hasOwnProperty(P)||(l||(l={}),l[P]="");for(P in q)q.hasOwnProperty(P)&&I[P]!==q[P]&&(l||(l={}),l[P]=q[P])}else l||(w||(w=[]),w.push(ne,l)),l=q;else ne==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,I=I?I.__html:void 0,q!=null&&I!==q&&(w=w||[]).push(ne,q)):ne==="children"?typeof q!="string"&&typeof q!="number"||(w=w||[]).push(ne,""+q):ne!=="suppressContentEditableWarning"&&ne!=="suppressHydrationWarning"&&(o.hasOwnProperty(ne)?(q!=null&&ne==="onScroll"&&kt("scroll",n),w||I===q||(w=[])):(w=w||[]).push(ne,q))}l&&(w=w||[]).push("style",l);var ne=w;(r.updateQueue=ne)&&(r.flags|=4)}},Nh=function(n,r,l,d){l!==d&&(r.flags|=4)};function _a(n,r){if(!Ct)switch(n.tailMode){case"hidden":r=n.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:d.sibling=null}}function pn(n){var r=n.alternate!==null&&n.alternate.child===n.child,l=0,d=0;if(r)for(var m=n.child;m!==null;)l|=m.lanes|m.childLanes,d|=m.subtreeFlags&14680064,d|=m.flags&14680064,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)l|=m.lanes|m.childLanes,d|=m.subtreeFlags,d|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=d,n.childLanes=l,r}function y1(n,r,l){var d=r.pendingProps;switch(kc(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pn(r),null;case 1:return Fn(r.type)&&Po(),pn(r),null;case 3:return d=r.stateNode,ks(),_t(Rn),_t(dn),Nc(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(n===null||n.child===null)&&(Ro(r)?r.flags|=4:n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,wi!==null&&(fu(wi),wi=null))),tu(n,r),pn(r),null;case 5:Fc(r);var m=Or(wa.current);if(l=r.type,n!==null&&r.stateNode!=null)Oh(n,r,l,d,m),n.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!d){if(r.stateNode===null)throw Error(i(166));return pn(r),null}if(n=Or(Di.current),Ro(r)){d=r.stateNode,l=r.type;var w=r.memoizedProps;switch(d[Pi]=r,d[ha]=w,n=(r.mode&1)!==0,l){case"dialog":kt("cancel",d),kt("close",d);break;case"iframe":case"object":case"embed":kt("load",d);break;case"video":case"audio":for(m=0;m<da.length;m++)kt(da[m],d);break;case"source":kt("error",d);break;case"img":case"image":case"link":kt("error",d),kt("load",d);break;case"details":kt("toggle",d);break;case"input":Y(d,w),kt("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!w.multiple},kt("invalid",d);break;case"textarea":re(d,w),kt("invalid",d)}De(l,w),m=null;for(var P in w)if(w.hasOwnProperty(P)){var I=w[P];P==="children"?typeof I=="string"?d.textContent!==I&&(w.suppressHydrationWarning!==!0&&Co(d.textContent,I,n),m=["children",I]):typeof I=="number"&&d.textContent!==""+I&&(w.suppressHydrationWarning!==!0&&Co(d.textContent,I,n),m=["children",""+I]):o.hasOwnProperty(P)&&I!=null&&P==="onScroll"&&kt("scroll",d)}switch(l){case"input":A(d),ce(d,w,!0);break;case"textarea":A(d),$e(d);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(d.onclick=To)}d=m,r.updateQueue=d,d!==null&&(r.flags|=4)}else{P=m.nodeType===9?m:m.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=it(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=P.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof d.is=="string"?n=P.createElement(l,{is:d.is}):(n=P.createElement(l),l==="select"&&(P=n,d.multiple?P.multiple=!0:d.size&&(P.size=d.size))):n=P.createElementNS(n,l),n[Pi]=r,n[ha]=d,Fh(n,r,!1,!1),r.stateNode=n;e:{switch(P=xt(l,d),l){case"dialog":kt("cancel",n),kt("close",n),m=d;break;case"iframe":case"object":case"embed":kt("load",n),m=d;break;case"video":case"audio":for(m=0;m<da.length;m++)kt(da[m],n);m=d;break;case"source":kt("error",n),m=d;break;case"img":case"image":case"link":kt("error",n),kt("load",n),m=d;break;case"details":kt("toggle",n),m=d;break;case"input":Y(n,d),m=K(n,d),kt("invalid",n);break;case"option":m=d;break;case"select":n._wrapperState={wasMultiple:!!d.multiple},m=u({},d,{value:void 0}),kt("invalid",n);break;case"textarea":re(n,d),m=Ee(n,d),kt("invalid",n);break;default:m=d}De(l,m),I=m;for(w in I)if(I.hasOwnProperty(w)){var q=I[w];w==="style"?Wt(n,q):w==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,q!=null&&Qe(n,q)):w==="children"?typeof q=="string"?(l!=="textarea"||q!=="")&&at(n,q):typeof q=="number"&&at(n,""+q):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(o.hasOwnProperty(w)?q!=null&&w==="onScroll"&&kt("scroll",n):q!=null&&z(n,w,q,P))}switch(l){case"input":A(n),ce(n,d,!1);break;case"textarea":A(n),$e(n);break;case"option":d.value!=null&&n.setAttribute("value",""+L(d.value));break;case"select":n.multiple=!!d.multiple,w=d.value,w!=null?Se(n,!!d.multiple,w,!1):d.defaultValue!=null&&Se(n,!!d.multiple,d.defaultValue,!0);break;default:typeof m.onClick=="function"&&(n.onclick=To)}switch(l){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return pn(r),null;case 6:if(n&&r.stateNode!=null)Nh(n,r,n.memoizedProps,d);else{if(typeof d!="string"&&r.stateNode===null)throw Error(i(166));if(l=Or(wa.current),Or(Di.current),Ro(r)){if(d=r.stateNode,l=r.memoizedProps,d[Pi]=r,(w=d.nodeValue!==l)&&(n=Xn,n!==null))switch(n.tag){case 3:Co(d.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Co(d.nodeValue,l,(n.mode&1)!==0)}w&&(r.flags|=4)}else d=(l.nodeType===9?l:l.ownerDocument).createTextNode(d),d[Pi]=r,r.stateNode=d}return pn(r),null;case 13:if(_t(Pt),d=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ct&&Gn!==null&&(r.mode&1)!==0&&(r.flags&128)===0)zp(),ws(),r.flags|=98560,w=!1;else if(w=Ro(r),d!==null&&d.dehydrated!==null){if(n===null){if(!w)throw Error(i(318));if(w=r.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(i(317));w[Pi]=r}else ws(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;pn(r),w=!1}else wi!==null&&(fu(wi),wi=null),w=!0;if(!w)return r.flags&65536?r:null}return(r.flags&128)!==0?(r.lanes=l,r):(d=d!==null,d!==(n!==null&&n.memoizedState!==null)&&d&&(r.child.flags|=8192,(r.mode&1)!==0&&(n===null||(Pt.current&1)!==0?Kt===0&&(Kt=3):mu())),r.updateQueue!==null&&(r.flags|=4),pn(r),null);case 4:return ks(),tu(n,r),n===null&&fa(r.stateNode.containerInfo),pn(r),null;case 10:return Dc(r.type._context),pn(r),null;case 17:return Fn(r.type)&&Po(),pn(r),null;case 19:if(_t(Pt),w=r.memoizedState,w===null)return pn(r),null;if(d=(r.flags&128)!==0,P=w.rendering,P===null)if(d)_a(w,!1);else{if(Kt!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(P=zo(n),P!==null){for(r.flags|=128,_a(w,!1),d=P.updateQueue,d!==null&&(r.updateQueue=d,r.flags|=4),r.subtreeFlags=0,d=l,l=r.child;l!==null;)w=l,n=d,w.flags&=14680066,P=w.alternate,P===null?(w.childLanes=0,w.lanes=n,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=P.childLanes,w.lanes=P.lanes,w.child=P.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=P.memoizedProps,w.memoizedState=P.memoizedState,w.updateQueue=P.updateQueue,w.type=P.type,n=P.dependencies,w.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return bt(Pt,Pt.current&1|2),r.child}n=n.sibling}w.tail!==null&&ae()>Es&&(r.flags|=128,d=!0,_a(w,!1),r.lanes=4194304)}else{if(!d)if(n=zo(P),n!==null){if(r.flags|=128,d=!0,l=n.updateQueue,l!==null&&(r.updateQueue=l,r.flags|=4),_a(w,!0),w.tail===null&&w.tailMode==="hidden"&&!P.alternate&&!Ct)return pn(r),null}else 2*ae()-w.renderingStartTime>Es&&l!==1073741824&&(r.flags|=128,d=!0,_a(w,!1),r.lanes=4194304);w.isBackwards?(P.sibling=r.child,r.child=P):(l=w.last,l!==null?l.sibling=P:r.child=P,w.last=P)}return w.tail!==null?(r=w.tail,w.rendering=r,w.tail=r.sibling,w.renderingStartTime=ae(),r.sibling=null,l=Pt.current,bt(Pt,d?l&1|2:l&1),r):(pn(r),null);case 22:case 23:return hu(),d=r.memoizedState!==null,n!==null&&n.memoizedState!==null!==d&&(r.flags|=8192),d&&(r.mode&1)!==0?(Kn&1073741824)!==0&&(pn(r),r.subtreeFlags&6&&(r.flags|=8192)):pn(r),null;case 24:return null;case 25:return null}throw Error(i(156,r.tag))}function w1(n,r){switch(kc(r),r.tag){case 1:return Fn(r.type)&&Po(),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return ks(),_t(Rn),_t(dn),Nc(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 5:return Fc(r),null;case 13:if(_t(Pt),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));ws()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return _t(Pt),null;case 4:return ks(),null;case 10:return Dc(r.type._context),null;case 22:case 23:return hu(),null;case 24:return null;default:return null}}var Xo=!1,hn=!1,b1=typeof WeakSet=="function"?WeakSet:Set,Me=null;function Cs(n,r){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(d){Rt(n,r,d)}else l.current=null}function nu(n,r,l){try{l()}catch(d){Rt(n,r,d)}}var Ih=!1;function x1(n,r){if(hc=ho,n=mp(),ac(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var m=d.anchorOffset,w=d.focusNode;d=d.focusOffset;try{l.nodeType,w.nodeType}catch{l=null;break e}var P=0,I=-1,q=-1,ne=0,de=0,he=n,ue=null;t:for(;;){for(var Pe;he!==l||m!==0&&he.nodeType!==3||(I=P+m),he!==w||d!==0&&he.nodeType!==3||(q=P+d),he.nodeType===3&&(P+=he.nodeValue.length),(Pe=he.firstChild)!==null;)ue=he,he=Pe;for(;;){if(he===n)break t;if(ue===l&&++ne===m&&(I=P),ue===w&&++de===d&&(q=P),(Pe=he.nextSibling)!==null)break;he=ue,ue=he.parentNode}he=Pe}l=I===-1||q===-1?null:{start:I,end:q}}else l=null}l=l||{start:0,end:0}}else l=null;for(mc={focusedElem:n,selectionRange:l},ho=!1,Me=r;Me!==null;)if(r=Me,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Me=n;else for(;Me!==null;){r=Me;try{var Re=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(Re!==null){var Ne=Re.memoizedProps,Vt=Re.memoizedState,Z=r.stateNode,X=Z.getSnapshotBeforeUpdate(r.elementType===r.type?Ne:bi(r.type,Ne),Vt);Z.__reactInternalSnapshotBeforeUpdate=X}break;case 3:var ee=r.stateNode.containerInfo;ee.nodeType===1?ee.textContent="":ee.nodeType===9&&ee.documentElement&&ee.removeChild(ee.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(ve){Rt(r,r.return,ve)}if(n=r.sibling,n!==null){n.return=r.return,Me=n;break}Me=r.return}return Re=Ih,Ih=!1,Re}function Ca(n,r,l){var d=r.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var m=d=d.next;do{if((m.tag&n)===n){var w=m.destroy;m.destroy=void 0,w!==void 0&&nu(r,l,w)}m=m.next}while(m!==d)}}function Go(n,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&n)===n){var d=l.create;l.destroy=d()}l=l.next}while(l!==r)}}function iu(n){var r=n.ref;if(r!==null){var l=n.stateNode;n.tag,n=l,typeof r=="function"?r(n):r.current=n}}function Bh(n){var r=n.alternate;r!==null&&(n.alternate=null,Bh(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&(delete r[Pi],delete r[ha],delete r[wc],delete r[i1],delete r[r1])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function zh(n){return n.tag===5||n.tag===3||n.tag===4}function Vh(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||zh(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ru(n,r,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,r?l.nodeType===8?l.parentNode.insertBefore(n,r):l.insertBefore(n,r):(l.nodeType===8?(r=l.parentNode,r.insertBefore(n,l)):(r=l,r.appendChild(n)),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=To));else if(d!==4&&(n=n.child,n!==null))for(ru(n,r,l),n=n.sibling;n!==null;)ru(n,r,l),n=n.sibling}function su(n,r,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,r?l.insertBefore(n,r):l.appendChild(n);else if(d!==4&&(n=n.child,n!==null))for(su(n,r,l),n=n.sibling;n!==null;)su(n,r,l),n=n.sibling}var an=null,xi=!1;function dr(n,r,l){for(l=l.child;l!==null;)Uh(n,r,l),l=l.sibling}function Uh(n,r,l){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(tt,l)}catch{}switch(l.tag){case 5:hn||Cs(l,r);case 6:var d=an,m=xi;an=null,dr(n,r,l),an=d,xi=m,an!==null&&(xi?(n=an,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):an.removeChild(l.stateNode));break;case 18:an!==null&&(xi?(n=an,l=l.stateNode,n.nodeType===8?yc(n.parentNode,l):n.nodeType===1&&yc(n,l),ia(n)):yc(an,l.stateNode));break;case 4:d=an,m=xi,an=l.stateNode.containerInfo,xi=!0,dr(n,r,l),an=d,xi=m;break;case 0:case 11:case 14:case 15:if(!hn&&(d=l.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){m=d=d.next;do{var w=m,P=w.destroy;w=w.tag,P!==void 0&&((w&2)!==0||(w&4)!==0)&&nu(l,r,P),m=m.next}while(m!==d)}dr(n,r,l);break;case 1:if(!hn&&(Cs(l,r),d=l.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=l.memoizedProps,d.state=l.memoizedState,d.componentWillUnmount()}catch(I){Rt(l,r,I)}dr(n,r,l);break;case 21:dr(n,r,l);break;case 22:l.mode&1?(hn=(d=hn)||l.memoizedState!==null,dr(n,r,l),hn=d):dr(n,r,l);break;default:dr(n,r,l)}}function Wh(n){var r=n.updateQueue;if(r!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new b1),r.forEach(function(d){var m=L1.bind(null,n,d);l.has(d)||(l.add(d),d.then(m,m))})}}function Si(n,r){var l=r.deletions;if(l!==null)for(var d=0;d<l.length;d++){var m=l[d];try{var w=n,P=r,I=P;e:for(;I!==null;){switch(I.tag){case 5:an=I.stateNode,xi=!1;break e;case 3:an=I.stateNode.containerInfo,xi=!0;break e;case 4:an=I.stateNode.containerInfo,xi=!0;break e}I=I.return}if(an===null)throw Error(i(160));Uh(w,P,m),an=null,xi=!1;var q=m.alternate;q!==null&&(q.return=null),m.return=null}catch(ne){Rt(m,r,ne)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)jh(r,n),r=r.sibling}function jh(n,r){var l=n.alternate,d=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Si(r,n),Mi(n),d&4){try{Ca(3,n,n.return),Go(3,n)}catch(Ne){Rt(n,n.return,Ne)}try{Ca(5,n,n.return)}catch(Ne){Rt(n,n.return,Ne)}}break;case 1:Si(r,n),Mi(n),d&512&&l!==null&&Cs(l,l.return);break;case 5:if(Si(r,n),Mi(n),d&512&&l!==null&&Cs(l,l.return),n.flags&32){var m=n.stateNode;try{at(m,"")}catch(Ne){Rt(n,n.return,Ne)}}if(d&4&&(m=n.stateNode,m!=null)){var w=n.memoizedProps,P=l!==null?l.memoizedProps:w,I=n.type,q=n.updateQueue;if(n.updateQueue=null,q!==null)try{I==="input"&&w.type==="radio"&&w.name!=null&&Q(m,w),xt(I,P);var ne=xt(I,w);for(P=0;P<q.length;P+=2){var de=q[P],he=q[P+1];de==="style"?Wt(m,he):de==="dangerouslySetInnerHTML"?Qe(m,he):de==="children"?at(m,he):z(m,de,he,ne)}switch(I){case"input":te(m,w);break;case"textarea":xe(m,w);break;case"select":var ue=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!w.multiple;var Pe=w.value;Pe!=null?Se(m,!!w.multiple,Pe,!1):ue!==!!w.multiple&&(w.defaultValue!=null?Se(m,!!w.multiple,w.defaultValue,!0):Se(m,!!w.multiple,w.multiple?[]:"",!1))}m[ha]=w}catch(Ne){Rt(n,n.return,Ne)}}break;case 6:if(Si(r,n),Mi(n),d&4){if(n.stateNode===null)throw Error(i(162));m=n.stateNode,w=n.memoizedProps;try{m.nodeValue=w}catch(Ne){Rt(n,n.return,Ne)}}break;case 3:if(Si(r,n),Mi(n),d&4&&l!==null&&l.memoizedState.isDehydrated)try{ia(r.containerInfo)}catch(Ne){Rt(n,n.return,Ne)}break;case 4:Si(r,n),Mi(n);break;case 13:Si(r,n),Mi(n),m=n.child,m.flags&8192&&(w=m.memoizedState!==null,m.stateNode.isHidden=w,!w||m.alternate!==null&&m.alternate.memoizedState!==null||(lu=ae())),d&4&&Wh(n);break;case 22:if(de=l!==null&&l.memoizedState!==null,n.mode&1?(hn=(ne=hn)||de,Si(r,n),hn=ne):Si(r,n),Mi(n),d&8192){if(ne=n.memoizedState!==null,(n.stateNode.isHidden=ne)&&!de&&(n.mode&1)!==0)for(Me=n,de=n.child;de!==null;){for(he=Me=de;Me!==null;){switch(ue=Me,Pe=ue.child,ue.tag){case 0:case 11:case 14:case 15:Ca(4,ue,ue.return);break;case 1:Cs(ue,ue.return);var Re=ue.stateNode;if(typeof Re.componentWillUnmount=="function"){d=ue,l=ue.return;try{r=d,Re.props=r.memoizedProps,Re.state=r.memoizedState,Re.componentWillUnmount()}catch(Ne){Rt(d,l,Ne)}}break;case 5:Cs(ue,ue.return);break;case 22:if(ue.memoizedState!==null){$h(he);continue}}Pe!==null?(Pe.return=ue,Me=Pe):$h(he)}de=de.sibling}e:for(de=null,he=n;;){if(he.tag===5){if(de===null){de=he;try{m=he.stateNode,ne?(w=m.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(I=he.stateNode,q=he.memoizedProps.style,P=q!=null&&q.hasOwnProperty("display")?q.display:null,I.style.display=Xt("display",P))}catch(Ne){Rt(n,n.return,Ne)}}}else if(he.tag===6){if(de===null)try{he.stateNode.nodeValue=ne?"":he.memoizedProps}catch(Ne){Rt(n,n.return,Ne)}}else if((he.tag!==22&&he.tag!==23||he.memoizedState===null||he===n)&&he.child!==null){he.child.return=he,he=he.child;continue}if(he===n)break e;for(;he.sibling===null;){if(he.return===null||he.return===n)break e;de===he&&(de=null),he=he.return}de===he&&(de=null),he.sibling.return=he.return,he=he.sibling}}break;case 19:Si(r,n),Mi(n),d&4&&Wh(n);break;case 21:break;default:Si(r,n),Mi(n)}}function Mi(n){var r=n.flags;if(r&2){try{e:{for(var l=n.return;l!==null;){if(zh(l)){var d=l;break e}l=l.return}throw Error(i(160))}switch(d.tag){case 5:var m=d.stateNode;d.flags&32&&(at(m,""),d.flags&=-33);var w=Vh(n);su(n,w,m);break;case 3:case 4:var P=d.stateNode.containerInfo,I=Vh(n);ru(n,I,P);break;default:throw Error(i(161))}}catch(q){Rt(n,n.return,q)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function S1(n,r,l){Me=n,qh(n)}function qh(n,r,l){for(var d=(n.mode&1)!==0;Me!==null;){var m=Me,w=m.child;if(m.tag===22&&d){var P=m.memoizedState!==null||Xo;if(!P){var I=m.alternate,q=I!==null&&I.memoizedState!==null||hn;I=Xo;var ne=hn;if(Xo=P,(hn=q)&&!ne)for(Me=m;Me!==null;)P=Me,q=P.child,P.tag===22&&P.memoizedState!==null?Yh(m):q!==null?(q.return=P,Me=q):Yh(m);for(;w!==null;)Me=w,qh(w),w=w.sibling;Me=m,Xo=I,hn=ne}Hh(n)}else(m.subtreeFlags&8772)!==0&&w!==null?(w.return=m,Me=w):Hh(n)}}function Hh(n){for(;Me!==null;){var r=Me;if((r.flags&8772)!==0){var l=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:hn||Go(5,r);break;case 1:var d=r.stateNode;if(r.flags&4&&!hn)if(l===null)d.componentDidMount();else{var m=r.elementType===r.type?l.memoizedProps:bi(r.type,l.memoizedProps);d.componentDidUpdate(m,l.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var w=r.updateQueue;w!==null&&$p(r,w,d);break;case 3:var P=r.updateQueue;if(P!==null){if(l=null,r.child!==null)switch(r.child.tag){case 5:l=r.child.stateNode;break;case 1:l=r.child.stateNode}$p(r,P,l)}break;case 5:var I=r.stateNode;if(l===null&&r.flags&4){l=I;var q=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":q.autoFocus&&l.focus();break;case"img":q.src&&(l.src=q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var ne=r.alternate;if(ne!==null){var de=ne.memoizedState;if(de!==null){var he=de.dehydrated;he!==null&&ia(he)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}hn||r.flags&512&&iu(r)}catch(ue){Rt(r,r.return,ue)}}if(r===n){Me=null;break}if(l=r.sibling,l!==null){l.return=r.return,Me=l;break}Me=r.return}}function $h(n){for(;Me!==null;){var r=Me;if(r===n){Me=null;break}var l=r.sibling;if(l!==null){l.return=r.return,Me=l;break}Me=r.return}}function Yh(n){for(;Me!==null;){var r=Me;try{switch(r.tag){case 0:case 11:case 15:var l=r.return;try{Go(4,r)}catch(q){Rt(r,l,q)}break;case 1:var d=r.stateNode;if(typeof d.componentDidMount=="function"){var m=r.return;try{d.componentDidMount()}catch(q){Rt(r,m,q)}}var w=r.return;try{iu(r)}catch(q){Rt(r,w,q)}break;case 5:var P=r.return;try{iu(r)}catch(q){Rt(r,P,q)}}}catch(q){Rt(r,r.return,q)}if(r===n){Me=null;break}var I=r.sibling;if(I!==null){I.return=r.return,Me=I;break}Me=r.return}}var k1=Math.ceil,Ko=W.ReactCurrentDispatcher,au=W.ReactCurrentOwner,li=W.ReactCurrentBatchConfig,ct=0,en=null,qt=null,on=0,Kn=0,Ts=ar(0),Kt=0,Ta=null,Ir=0,Qo=0,ou=0,Ea=null,Nn=null,lu=0,Es=1/0,Hi=null,Zo=!1,cu=null,fr=null,Jo=!1,pr=null,el=0,Pa=0,uu=null,tl=-1,nl=0;function _n(){return(ct&6)!==0?ae():tl!==-1?tl:tl=ae()}function hr(n){return(n.mode&1)===0?1:(ct&2)!==0&&on!==0?on&-on:a1.transition!==null?(nl===0&&(nl=Vf()),nl):(n=ft,n!==0||(n=window.event,n=n===void 0?16:Gf(n.type)),n)}function ki(n,r,l,d){if(50<Pa)throw Pa=0,uu=null,Error(i(185));Zs(n,l,d),((ct&2)===0||n!==en)&&(n===en&&((ct&2)===0&&(Qo|=l),Kt===4&&mr(n,on)),In(n,d),l===1&&ct===0&&(r.mode&1)===0&&(Es=ae()+500,Lo&&lr()))}function In(n,r){var l=n.callbackNode;aw(n,r);var d=uo(n,n===en?on:0);if(d===0)l!==null&&Zi(l),n.callbackNode=null,n.callbackPriority=0;else if(r=d&-d,n.callbackPriority!==r){if(l!=null&&Zi(l),r===1)n.tag===0?s1(Gh.bind(null,n)):Fp(Gh.bind(null,n)),t1(function(){(ct&6)===0&&lr()}),l=null;else{switch(Uf(d)){case 1:l=Fe;break;case 4:l=Te;break;case 16:l=Le;break;case 536870912:l=lt;break;default:l=Le}l=im(l,Xh.bind(null,n))}n.callbackPriority=r,n.callbackNode=l}}function Xh(n,r){if(tl=-1,nl=0,(ct&6)!==0)throw Error(i(327));var l=n.callbackNode;if(Ps()&&n.callbackNode!==l)return null;var d=uo(n,n===en?on:0);if(d===0)return null;if((d&30)!==0||(d&n.expiredLanes)!==0||r)r=il(n,d);else{r=d;var m=ct;ct|=2;var w=Qh();(en!==n||on!==r)&&(Hi=null,Es=ae()+500,zr(n,r));do try{T1();break}catch(I){Kh(n,I)}while(!0);Pc(),Ko.current=w,ct=m,qt!==null?r=0:(en=null,on=0,r=Kt)}if(r!==0){if(r===2&&(m=ql(n),m!==0&&(d=m,r=du(n,m))),r===1)throw l=Ta,zr(n,0),mr(n,d),In(n,ae()),l;if(r===6)mr(n,d);else{if(m=n.current.alternate,(d&30)===0&&!_1(m)&&(r=il(n,d),r===2&&(w=ql(n),w!==0&&(d=w,r=du(n,w))),r===1))throw l=Ta,zr(n,0),mr(n,d),In(n,ae()),l;switch(n.finishedWork=m,n.finishedLanes=d,r){case 0:case 1:throw Error(i(345));case 2:Vr(n,Nn,Hi);break;case 3:if(mr(n,d),(d&130023424)===d&&(r=lu+500-ae(),10<r)){if(uo(n,0)!==0)break;if(m=n.suspendedLanes,(m&d)!==d){_n(),n.pingedLanes|=n.suspendedLanes&m;break}n.timeoutHandle=vc(Vr.bind(null,n,Nn,Hi),r);break}Vr(n,Nn,Hi);break;case 4:if(mr(n,d),(d&4194240)===d)break;for(r=n.eventTimes,m=-1;0<d;){var P=31-zt(d);w=1<<P,P=r[P],P>m&&(m=P),d&=~w}if(d=m,d=ae()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*k1(d/1960))-d,10<d){n.timeoutHandle=vc(Vr.bind(null,n,Nn,Hi),d);break}Vr(n,Nn,Hi);break;case 5:Vr(n,Nn,Hi);break;default:throw Error(i(329))}}}return In(n,ae()),n.callbackNode===l?Xh.bind(null,n):null}function du(n,r){var l=Ea;return n.current.memoizedState.isDehydrated&&(zr(n,r).flags|=256),n=il(n,r),n!==2&&(r=Nn,Nn=l,r!==null&&fu(r)),n}function fu(n){Nn===null?Nn=n:Nn.push.apply(Nn,n)}function _1(n){for(var r=n;;){if(r.flags&16384){var l=r.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var d=0;d<l.length;d++){var m=l[d],w=m.getSnapshot;m=m.value;try{if(!yi(w(),m))return!1}catch{return!1}}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function mr(n,r){for(r&=~ou,r&=~Qo,n.suspendedLanes|=r,n.pingedLanes&=~r,n=n.expirationTimes;0<r;){var l=31-zt(r),d=1<<l;n[l]=-1,r&=~d}}function Gh(n){if((ct&6)!==0)throw Error(i(327));Ps();var r=uo(n,0);if((r&1)===0)return In(n,ae()),null;var l=il(n,r);if(n.tag!==0&&l===2){var d=ql(n);d!==0&&(r=d,l=du(n,d))}if(l===1)throw l=Ta,zr(n,0),mr(n,r),In(n,ae()),l;if(l===6)throw Error(i(345));return n.finishedWork=n.current.alternate,n.finishedLanes=r,Vr(n,Nn,Hi),In(n,ae()),null}function pu(n,r){var l=ct;ct|=1;try{return n(r)}finally{ct=l,ct===0&&(Es=ae()+500,Lo&&lr())}}function Br(n){pr!==null&&pr.tag===0&&(ct&6)===0&&Ps();var r=ct;ct|=1;var l=li.transition,d=ft;try{if(li.transition=null,ft=1,n)return n()}finally{ft=d,li.transition=l,ct=r,(ct&6)===0&&lr()}}function hu(){Kn=Ts.current,_t(Ts)}function zr(n,r){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,e1(l)),qt!==null)for(l=qt.return;l!==null;){var d=l;switch(kc(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&Po();break;case 3:ks(),_t(Rn),_t(dn),Nc();break;case 5:Fc(d);break;case 4:ks();break;case 13:_t(Pt);break;case 19:_t(Pt);break;case 10:Dc(d.type._context);break;case 22:case 23:hu()}l=l.return}if(en=n,qt=n=gr(n.current,null),on=Kn=r,Kt=0,Ta=null,ou=Qo=Ir=0,Nn=Ea=null,Fr!==null){for(r=0;r<Fr.length;r++)if(l=Fr[r],d=l.interleaved,d!==null){l.interleaved=null;var m=d.next,w=l.pending;if(w!==null){var P=w.next;w.next=m,d.next=P}l.pending=d}Fr=null}return n}function Kh(n,r){do{var l=qt;try{if(Pc(),Vo.current=qo,Uo){for(var d=Dt.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}Uo=!1}if(Nr=0,Jt=Gt=Dt=null,ba=!1,xa=0,au.current=null,l===null||l.return===null){Kt=1,Ta=r,qt=null;break}e:{var w=n,P=l.return,I=l,q=r;if(r=on,I.flags|=32768,q!==null&&typeof q=="object"&&typeof q.then=="function"){var ne=q,de=I,he=de.tag;if((de.mode&1)===0&&(he===0||he===11||he===15)){var ue=de.alternate;ue?(de.updateQueue=ue.updateQueue,de.memoizedState=ue.memoizedState,de.lanes=ue.lanes):(de.updateQueue=null,de.memoizedState=null)}var Pe=xh(P);if(Pe!==null){Pe.flags&=-257,Sh(Pe,P,I,w,r),Pe.mode&1&&bh(w,ne,r),r=Pe,q=ne;var Re=r.updateQueue;if(Re===null){var Ne=new Set;Ne.add(q),r.updateQueue=Ne}else Re.add(q);break e}else{if((r&1)===0){bh(w,ne,r),mu();break e}q=Error(i(426))}}else if(Ct&&I.mode&1){var Vt=xh(P);if(Vt!==null){(Vt.flags&65536)===0&&(Vt.flags|=256),Sh(Vt,P,I,w,r),Tc(_s(q,I));break e}}w=q=_s(q,I),Kt!==4&&(Kt=2),Ea===null?Ea=[w]:Ea.push(w),w=P;do{switch(w.tag){case 3:w.flags|=65536,r&=-r,w.lanes|=r;var Z=yh(w,q,r);Hp(w,Z);break e;case 1:I=q;var X=w.type,ee=w.stateNode;if((w.flags&128)===0&&(typeof X.getDerivedStateFromError=="function"||ee!==null&&typeof ee.componentDidCatch=="function"&&(fr===null||!fr.has(ee)))){w.flags|=65536,r&=-r,w.lanes|=r;var ve=wh(w,I,r);Hp(w,ve);break e}}w=w.return}while(w!==null)}Jh(l)}catch(ze){r=ze,qt===l&&l!==null&&(qt=l=l.return);continue}break}while(!0)}function Qh(){var n=Ko.current;return Ko.current=qo,n===null?qo:n}function mu(){(Kt===0||Kt===3||Kt===2)&&(Kt=4),en===null||(Ir&268435455)===0&&(Qo&268435455)===0||mr(en,on)}function il(n,r){var l=ct;ct|=2;var d=Qh();(en!==n||on!==r)&&(Hi=null,zr(n,r));do try{C1();break}catch(m){Kh(n,m)}while(!0);if(Pc(),ct=l,Ko.current=d,qt!==null)throw Error(i(261));return en=null,on=0,Kt}function C1(){for(;qt!==null;)Zh(qt)}function T1(){for(;qt!==null&&!et();)Zh(qt)}function Zh(n){var r=nm(n.alternate,n,Kn);n.memoizedProps=n.pendingProps,r===null?Jh(n):qt=r,au.current=null}function Jh(n){var r=n;do{var l=r.alternate;if(n=r.return,(r.flags&32768)===0){if(l=y1(l,r,Kn),l!==null){qt=l;return}}else{if(l=w1(l,r),l!==null){l.flags&=32767,qt=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Kt=6,qt=null;return}}if(r=r.sibling,r!==null){qt=r;return}qt=r=n}while(r!==null);Kt===0&&(Kt=5)}function Vr(n,r,l){var d=ft,m=li.transition;try{li.transition=null,ft=1,E1(n,r,l,d)}finally{li.transition=m,ft=d}return null}function E1(n,r,l,d){do Ps();while(pr!==null);if((ct&6)!==0)throw Error(i(327));l=n.finishedWork;var m=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(i(177));n.callbackNode=null,n.callbackPriority=0;var w=l.lanes|l.childLanes;if(ow(n,w),n===en&&(qt=en=null,on=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||Jo||(Jo=!0,im(Le,function(){return Ps(),null})),w=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||w){w=li.transition,li.transition=null;var P=ft;ft=1;var I=ct;ct|=4,au.current=null,x1(n,l),jh(l,n),Yw(mc),ho=!!hc,mc=hc=null,n.current=l,S1(l),le(),ct=I,ft=P,li.transition=w}else n.current=l;if(Jo&&(Jo=!1,pr=n,el=m),w=n.pendingLanes,w===0&&(fr=null),$n(l.stateNode),In(n,ae()),r!==null)for(d=n.onRecoverableError,l=0;l<r.length;l++)m=r[l],d(m.value,{componentStack:m.stack,digest:m.digest});if(Zo)throw Zo=!1,n=cu,cu=null,n;return(el&1)!==0&&n.tag!==0&&Ps(),w=n.pendingLanes,(w&1)!==0?n===uu?Pa++:(Pa=0,uu=n):Pa=0,lr(),null}function Ps(){if(pr!==null){var n=Uf(el),r=li.transition,l=ft;try{if(li.transition=null,ft=16>n?16:n,pr===null)var d=!1;else{if(n=pr,pr=null,el=0,(ct&6)!==0)throw Error(i(331));var m=ct;for(ct|=4,Me=n.current;Me!==null;){var w=Me,P=w.child;if((Me.flags&16)!==0){var I=w.deletions;if(I!==null){for(var q=0;q<I.length;q++){var ne=I[q];for(Me=ne;Me!==null;){var de=Me;switch(de.tag){case 0:case 11:case 15:Ca(8,de,w)}var he=de.child;if(he!==null)he.return=de,Me=he;else for(;Me!==null;){de=Me;var ue=de.sibling,Pe=de.return;if(Bh(de),de===ne){Me=null;break}if(ue!==null){ue.return=Pe,Me=ue;break}Me=Pe}}}var Re=w.alternate;if(Re!==null){var Ne=Re.child;if(Ne!==null){Re.child=null;do{var Vt=Ne.sibling;Ne.sibling=null,Ne=Vt}while(Ne!==null)}}Me=w}}if((w.subtreeFlags&2064)!==0&&P!==null)P.return=w,Me=P;else e:for(;Me!==null;){if(w=Me,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:Ca(9,w,w.return)}var Z=w.sibling;if(Z!==null){Z.return=w.return,Me=Z;break e}Me=w.return}}var X=n.current;for(Me=X;Me!==null;){P=Me;var ee=P.child;if((P.subtreeFlags&2064)!==0&&ee!==null)ee.return=P,Me=ee;else e:for(P=X;Me!==null;){if(I=Me,(I.flags&2048)!==0)try{switch(I.tag){case 0:case 11:case 15:Go(9,I)}}catch(ze){Rt(I,I.return,ze)}if(I===P){Me=null;break e}var ve=I.sibling;if(ve!==null){ve.return=I.return,Me=ve;break e}Me=I.return}}if(ct=m,lr(),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(tt,n)}catch{}d=!0}return d}finally{ft=l,li.transition=r}}return!1}function em(n,r,l){r=_s(l,r),r=yh(n,r,1),n=ur(n,r,1),r=_n(),n!==null&&(Zs(n,1,r),In(n,r))}function Rt(n,r,l){if(n.tag===3)em(n,n,l);else for(;r!==null;){if(r.tag===3){em(r,n,l);break}else if(r.tag===1){var d=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(fr===null||!fr.has(d))){n=_s(l,n),n=wh(r,n,1),r=ur(r,n,1),n=_n(),r!==null&&(Zs(r,1,n),In(r,n));break}}r=r.return}}function P1(n,r,l){var d=n.pingCache;d!==null&&d.delete(r),r=_n(),n.pingedLanes|=n.suspendedLanes&l,en===n&&(on&l)===l&&(Kt===4||Kt===3&&(on&130023424)===on&&500>ae()-lu?zr(n,0):ou|=l),In(n,r)}function tm(n,r){r===0&&((n.mode&1)===0?r=1:(r=as,as<<=1,(as&130023424)===0&&(as=4194304)));var l=_n();n=Wi(n,r),n!==null&&(Zs(n,r,l),In(n,l))}function D1(n){var r=n.memoizedState,l=0;r!==null&&(l=r.retryLane),tm(n,l)}function L1(n,r){var l=0;switch(n.tag){case 13:var d=n.stateNode,m=n.memoizedState;m!==null&&(l=m.retryLane);break;case 19:d=n.stateNode;break;default:throw Error(i(314))}d!==null&&d.delete(r),tm(n,l)}var nm;nm=function(n,r,l){if(n!==null)if(n.memoizedProps!==r.pendingProps||Rn.current)On=!0;else{if((n.lanes&l)===0&&(r.flags&128)===0)return On=!1,v1(n,r,l);On=(n.flags&131072)!==0}else On=!1,Ct&&(r.flags&1048576)!==0&&Op(r,Ao,r.index);switch(r.lanes=0,r.tag){case 2:var d=r.type;Yo(n,r),n=r.pendingProps;var m=gs(r,dn.current);Ss(r,l),m=zc(null,r,d,n,m,l);var w=Vc();return r.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Fn(d)?(w=!0,Do(r)):w=!1,r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,Ac(r),m.updater=Ho,r.stateNode=m,m._reactInternals=r,$c(r,d,n,l),r=Kc(null,r,d,!0,w,l)):(r.tag=0,Ct&&w&&Sc(r),kn(null,r,m,l),r=r.child),r;case 16:d=r.elementType;e:{switch(Yo(n,r),n=r.pendingProps,m=d._init,d=m(d._payload),r.type=d,m=r.tag=A1(d),n=bi(d,n),m){case 0:r=Gc(null,r,d,n,l);break e;case 1:r=Ph(null,r,d,n,l);break e;case 11:r=kh(null,r,d,n,l);break e;case 14:r=_h(null,r,d,bi(d.type,n),l);break e}throw Error(i(306,d,""))}return r;case 0:return d=r.type,m=r.pendingProps,m=r.elementType===d?m:bi(d,m),Gc(n,r,d,m,l);case 1:return d=r.type,m=r.pendingProps,m=r.elementType===d?m:bi(d,m),Ph(n,r,d,m,l);case 3:e:{if(Dh(r),n===null)throw Error(i(387));d=r.pendingProps,w=r.memoizedState,m=w.element,qp(n,r),Bo(r,d,null,l);var P=r.memoizedState;if(d=P.element,w.isDehydrated)if(w={element:d,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},r.updateQueue.baseState=w,r.memoizedState=w,r.flags&256){m=_s(Error(i(423)),r),r=Lh(n,r,d,l,m);break e}else if(d!==m){m=_s(Error(i(424)),r),r=Lh(n,r,d,l,m);break e}else for(Gn=sr(r.stateNode.containerInfo.firstChild),Xn=r,Ct=!0,wi=null,l=Wp(r,null,d,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(ws(),d===m){r=qi(n,r,l);break e}kn(n,r,d,l)}r=r.child}return r;case 5:return Yp(r),n===null&&Cc(r),d=r.type,m=r.pendingProps,w=n!==null?n.memoizedProps:null,P=m.children,gc(d,m)?P=null:w!==null&&gc(d,w)&&(r.flags|=32),Eh(n,r),kn(n,r,P,l),r.child;case 6:return n===null&&Cc(r),null;case 13:return Mh(n,r,l);case 4:return Rc(r,r.stateNode.containerInfo),d=r.pendingProps,n===null?r.child=bs(r,null,d,l):kn(n,r,d,l),r.child;case 11:return d=r.type,m=r.pendingProps,m=r.elementType===d?m:bi(d,m),kh(n,r,d,m,l);case 7:return kn(n,r,r.pendingProps,l),r.child;case 8:return kn(n,r,r.pendingProps.children,l),r.child;case 12:return kn(n,r,r.pendingProps.children,l),r.child;case 10:e:{if(d=r.type._context,m=r.pendingProps,w=r.memoizedProps,P=m.value,bt(Oo,d._currentValue),d._currentValue=P,w!==null)if(yi(w.value,P)){if(w.children===m.children&&!Rn.current){r=qi(n,r,l);break e}}else for(w=r.child,w!==null&&(w.return=r);w!==null;){var I=w.dependencies;if(I!==null){P=w.child;for(var q=I.firstContext;q!==null;){if(q.context===d){if(w.tag===1){q=ji(-1,l&-l),q.tag=2;var ne=w.updateQueue;if(ne!==null){ne=ne.shared;var de=ne.pending;de===null?q.next=q:(q.next=de.next,de.next=q),ne.pending=q}}w.lanes|=l,q=w.alternate,q!==null&&(q.lanes|=l),Lc(w.return,l,r),I.lanes|=l;break}q=q.next}}else if(w.tag===10)P=w.type===r.type?null:w.child;else if(w.tag===18){if(P=w.return,P===null)throw Error(i(341));P.lanes|=l,I=P.alternate,I!==null&&(I.lanes|=l),Lc(P,l,r),P=w.sibling}else P=w.child;if(P!==null)P.return=w;else for(P=w;P!==null;){if(P===r){P=null;break}if(w=P.sibling,w!==null){w.return=P.return,P=w;break}P=P.return}w=P}kn(n,r,m.children,l),r=r.child}return r;case 9:return m=r.type,d=r.pendingProps.children,Ss(r,l),m=ai(m),d=d(m),r.flags|=1,kn(n,r,d,l),r.child;case 14:return d=r.type,m=bi(d,r.pendingProps),m=bi(d.type,m),_h(n,r,d,m,l);case 15:return Ch(n,r,r.type,r.pendingProps,l);case 17:return d=r.type,m=r.pendingProps,m=r.elementType===d?m:bi(d,m),Yo(n,r),r.tag=1,Fn(d)?(n=!0,Do(r)):n=!1,Ss(r,l),gh(r,d,m),$c(r,d,m,l),Kc(null,r,d,!0,n,l);case 19:return Rh(n,r,l);case 22:return Th(n,r,l)}throw Error(i(156,r.tag))};function im(n,r){return An(n,r)}function M1(n,r,l,d){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ci(n,r,l,d){return new M1(n,r,l,d)}function gu(n){return n=n.prototype,!(!n||!n.isReactComponent)}function A1(n){if(typeof n=="function")return gu(n)?1:0;if(n!=null){if(n=n.$$typeof,n===me)return 11;if(n===We)return 14}return 2}function gr(n,r){var l=n.alternate;return l===null?(l=ci(n.tag,r,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=r,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,r=n.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function rl(n,r,l,d,m,w){var P=2;if(d=n,typeof n=="function")gu(n)&&(P=1);else if(typeof n=="string")P=5;else e:switch(n){case J:return Ur(l.children,m,w,r);case N:P=8,m|=8;break;case G:return n=ci(12,l,r,m|2),n.elementType=G,n.lanes=w,n;case be:return n=ci(13,l,r,m),n.elementType=be,n.lanes=w,n;case ye:return n=ci(19,l,r,m),n.elementType=ye,n.lanes=w,n;case ke:return sl(l,m,w,r);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case se:P=10;break e;case fe:P=9;break e;case me:P=11;break e;case We:P=14;break e;case Ae:P=16,d=null;break e}throw Error(i(130,n==null?n:typeof n,""))}return r=ci(P,l,r,m),r.elementType=n,r.type=d,r.lanes=w,r}function Ur(n,r,l,d){return n=ci(7,n,d,r),n.lanes=l,n}function sl(n,r,l,d){return n=ci(22,n,d,r),n.elementType=ke,n.lanes=l,n.stateNode={isHidden:!1},n}function vu(n,r,l){return n=ci(6,n,null,r),n.lanes=l,n}function yu(n,r,l){return r=ci(4,n.children!==null?n.children:[],n.key,r),r.lanes=l,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}function R1(n,r,l,d,m){this.tag=r,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hl(0),this.expirationTimes=Hl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hl(0),this.identifierPrefix=d,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function wu(n,r,l,d,m,w,P,I,q){return n=new R1(n,r,l,I,q),r===1?(r=1,w===!0&&(r|=8)):r=0,w=ci(3,null,null,r),n.current=w,w.stateNode=n,w.memoizedState={element:d,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ac(w),n}function F1(n,r,l){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:H,key:d==null?null:""+d,children:n,containerInfo:r,implementation:l}}function rm(n){if(!n)return or;n=n._reactInternals;e:{if(sn(n)!==n||n.tag!==1)throw Error(i(170));var r=n;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Fn(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(i(171))}if(n.tag===1){var l=n.type;if(Fn(l))return Ap(n,l,r)}return r}function sm(n,r,l,d,m,w,P,I,q){return n=wu(l,d,!0,n,m,w,P,I,q),n.context=rm(null),l=n.current,d=_n(),m=hr(l),w=ji(d,m),w.callback=r??null,ur(l,w,m),n.current.lanes=m,Zs(n,m,d),In(n,d),n}function al(n,r,l,d){var m=r.current,w=_n(),P=hr(m);return l=rm(l),r.context===null?r.context=l:r.pendingContext=l,r=ji(w,P),r.payload={element:n},d=d===void 0?null:d,d!==null&&(r.callback=d),n=ur(m,r,P),n!==null&&(ki(n,m,P,w),Io(n,m,P)),P}function ol(n){return n=n.current,n.child?(n.child.tag===5,n.child.stateNode):null}function am(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<r?l:r}}function bu(n,r){am(n,r),(n=n.alternate)&&am(n,r)}function O1(){return null}var om=typeof reportError=="function"?reportError:function(n){console.error(n)};function xu(n){this._internalRoot=n}ll.prototype.render=xu.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));al(n,r,null,null)},ll.prototype.unmount=xu.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;Br(function(){al(null,n,null,null)}),r[Bi]=null}};function ll(n){this._internalRoot=n}ll.prototype.unstable_scheduleHydration=function(n){if(n){var r=qf();n={blockedOn:null,target:n,priority:r};for(var l=0;l<nr.length&&r!==0&&r<nr[l].priority;l++);nr.splice(l,0,n),l===0&&Yf(n)}};function Su(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function cl(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function lm(){}function N1(n,r,l,d,m){if(m){if(typeof d=="function"){var w=d;d=function(){var ne=ol(P);w.call(ne)}}var P=sm(r,d,n,0,null,!1,!1,"",lm);return n._reactRootContainer=P,n[Bi]=P.current,fa(n.nodeType===8?n.parentNode:n),Br(),P}for(;m=n.lastChild;)n.removeChild(m);if(typeof d=="function"){var I=d;d=function(){var ne=ol(q);I.call(ne)}}var q=wu(n,0,!1,null,null,!1,!1,"",lm);return n._reactRootContainer=q,n[Bi]=q.current,fa(n.nodeType===8?n.parentNode:n),Br(function(){al(r,q,l,d)}),q}function ul(n,r,l,d,m){var w=l._reactRootContainer;if(w){var P=w;if(typeof m=="function"){var I=m;m=function(){var q=ol(P);I.call(q)}}al(r,P,n,m)}else P=N1(l,r,n,m,d);return ol(P)}Wf=function(n){switch(n.tag){case 3:var r=n.stateNode;if(r.current.memoizedState.isDehydrated){var l=Qs(r.pendingLanes);l!==0&&($l(r,l|1),In(r,ae()),(ct&6)===0&&(Es=ae()+500,lr()))}break;case 13:Br(function(){var d=Wi(n,1);if(d!==null){var m=_n();ki(d,n,1,m)}}),bu(n,1)}},Yl=function(n){if(n.tag===13){var r=Wi(n,134217728);if(r!==null){var l=_n();ki(r,n,134217728,l)}bu(n,134217728)}},jf=function(n){if(n.tag===13){var r=hr(n),l=Wi(n,r);if(l!==null){var d=_n();ki(l,n,r,d)}bu(n,r)}},qf=function(){return ft},Hf=function(n,r){var l=ft;try{return ft=n,r()}finally{ft=l}},Nt=function(n,r,l){switch(r){case"input":if(te(n,l),r=l.name,l.type==="radio"&&r!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<l.length;r++){var d=l[r];if(d!==n&&d.form===n.form){var m=Eo(d);if(!m)throw Error(i(90));B(d),te(d,m)}}}break;case"textarea":xe(n,l);break;case"select":r=l.value,r!=null&&Se(n,!!l.multiple,r,!1)}},En=pu,rn=Br;var I1={usingClientEntryPoint:!1,Events:[ma,hs,Eo,ht,Zt,pu]},Da={findFiberByHostInstance:Lr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},B1={bundleType:Da.bundleType,version:Da.version,rendererPackageName:Da.rendererPackageName,rendererConfig:Da.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:W.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=ot(n),n===null?null:n.stateNode},findFiberByHostInstance:Da.findFiberByHostInstance||O1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dl.isDisabled&&dl.supportsFiber)try{tt=dl.inject(B1),Xe=dl}catch{}}return Bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I1,Bn.createPortal=function(n,r){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Su(r))throw Error(i(200));return F1(n,r,null,l)},Bn.createRoot=function(n,r){if(!Su(n))throw Error(i(299));var l=!1,d="",m=om;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(d=r.identifierPrefix),r.onRecoverableError!==void 0&&(m=r.onRecoverableError)),r=wu(n,1,!1,null,null,l,!1,d,m),n[Bi]=r.current,fa(n.nodeType===8?n.parentNode:n),new xu(r)},Bn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=ot(r),n=n===null?null:n.stateNode,n},Bn.flushSync=function(n){return Br(n)},Bn.hydrate=function(n,r,l){if(!cl(r))throw Error(i(200));return ul(null,n,r,!0,l)},Bn.hydrateRoot=function(n,r,l){if(!Su(n))throw Error(i(405));var d=l!=null&&l.hydratedSources||null,m=!1,w="",P=om;if(l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(w=l.identifierPrefix),l.onRecoverableError!==void 0&&(P=l.onRecoverableError)),r=sm(r,null,n,1,l??null,m,!1,w,P),n[Bi]=r.current,fa(n),d)for(n=0;n<d.length;n++)l=d[n],m=l._getVersion,m=m(l._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[l,m]:r.mutableSourceEagerHydrationData.push(l,m);return new ll(r)},Bn.render=function(n,r,l){if(!cl(r))throw Error(i(200));return ul(null,n,r,!1,l)},Bn.unmountComponentAtNode=function(n){if(!cl(n))throw Error(i(40));return n._reactRootContainer?(Br(function(){ul(null,null,n,!1,function(){n._reactRootContainer=null,n[Bi]=null})}),!0):!1},Bn.unstable_batchedUpdates=pu,Bn.unstable_renderSubtreeIntoContainer=function(n,r,l,d){if(!cl(l))throw Error(i(200));if(n==null||n._reactInternals===void 0)throw Error(i(38));return ul(n,r,l,!1,d)},Bn.version="18.3.1-next-f1338f8080-20240426",Bn}var gm;function X1(){if(gm)return Cu.exports;gm=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Cu.exports=Y1(),Cu.exports}var vm;function G1(){if(vm)return fl;vm=1;var e=X1();return fl.createRoot=e.createRoot,fl.hydrateRoot=e.hydrateRoot,fl}var kv=G1();const Ud=xv(kv);function Ba(e){let t=e[0],i=e[1],s=e[2];return Math.sqrt(t*t+i*i+s*s)}function td(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function K1(e,t,i,s){return e[0]=t,e[1]=i,e[2]=s,e}function ym(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e}function wm(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function Q1(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function Z1(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e}function Pu(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function J1(e,t){let i=t[0]-e[0],s=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(i*i+s*s+o*o)}function eb(e,t){let i=t[0]-e[0],s=t[1]-e[1],o=t[2]-e[2];return i*i+s*s+o*o}function bm(e){let t=e[0],i=e[1],s=e[2];return t*t+i*i+s*s}function tb(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function nb(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function nd(e,t){let i=t[0],s=t[1],o=t[2],a=i*i+s*s+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function _v(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function xm(e,t,i){let s=t[0],o=t[1],a=t[2],c=i[0],f=i[1],h=i[2];return e[0]=o*h-a*f,e[1]=a*c-s*h,e[2]=s*f-o*c,e}function ib(e,t,i,s){let o=t[0],a=t[1],c=t[2];return e[0]=o+s*(i[0]-o),e[1]=a+s*(i[1]-a),e[2]=c+s*(i[2]-c),e}function rb(e,t,i,s,o){const a=Math.exp(-s*o);let c=t[0],f=t[1],h=t[2];return e[0]=i[0]+(c-i[0])*a,e[1]=i[1]+(f-i[1])*a,e[2]=i[2]+(h-i[2])*a,e}function sb(e,t,i){let s=t[0],o=t[1],a=t[2],c=i[3]*s+i[7]*o+i[11]*a+i[15];return c=c||1,e[0]=(i[0]*s+i[4]*o+i[8]*a+i[12])/c,e[1]=(i[1]*s+i[5]*o+i[9]*a+i[13])/c,e[2]=(i[2]*s+i[6]*o+i[10]*a+i[14])/c,e}function ab(e,t,i){let s=t[0],o=t[1],a=t[2],c=i[3]*s+i[7]*o+i[11]*a+i[15];return c=c||1,e[0]=(i[0]*s+i[4]*o+i[8]*a)/c,e[1]=(i[1]*s+i[5]*o+i[9]*a)/c,e[2]=(i[2]*s+i[6]*o+i[10]*a)/c,e}function ob(e,t,i){let s=t[0],o=t[1],a=t[2];return e[0]=s*i[0]+o*i[3]+a*i[6],e[1]=s*i[1]+o*i[4]+a*i[7],e[2]=s*i[2]+o*i[5]+a*i[8],e}function lb(e,t,i){let s=t[0],o=t[1],a=t[2],c=i[0],f=i[1],h=i[2],v=i[3],y=f*a-h*o,x=h*s-c*a,k=c*o-f*s,C=f*k-h*x,M=h*y-c*k,E=c*x-f*y,R=v*2;return y*=R,x*=R,k*=R,C*=2,M*=2,E*=2,e[0]=s+y+C,e[1]=o+x+M,e[2]=a+k+E,e}const cb=(function(){const e=[0,0,0],t=[0,0,0];return function(i,s){td(e,i),td(t,s),nd(e,e),nd(t,t);let o=_v(e,t);return o>1?0:o<-1?Math.PI:Math.acos(o)}})();function ub(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}class Ti extends Array{constructor(t=0,i=t,s=t){return super(t,i,s),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this[0]=t}set y(t){this[1]=t}set z(t){this[2]=t}set(t,i=t,s=t){return t.length?this.copy(t):(K1(this,t,i,s),this)}copy(t){return td(this,t),this}add(t,i){return i?ym(this,t,i):ym(this,this,t),this}sub(t,i){return i?wm(this,t,i):wm(this,this,t),this}multiply(t){return t.length?Q1(this,this,t):Pu(this,this,t),this}divide(t){return t.length?Z1(this,this,t):Pu(this,this,1/t),this}inverse(t=this){return nb(this,t),this}len(){return Ba(this)}distance(t){return t?J1(this,t):Ba(this)}squaredLen(){return bm(this)}squaredDistance(t){return t?eb(this,t):bm(this)}negate(t=this){return tb(this,t),this}cross(t,i){return i?xm(this,t,i):xm(this,this,t),this}scale(t){return Pu(this,this,t),this}normalize(){return nd(this,this),this}dot(t){return _v(this,t)}equals(t){return ub(this,t)}applyMatrix3(t){return ob(this,this,t),this}applyMatrix4(t){return sb(this,this,t),this}scaleRotateMatrix4(t){return ab(this,this,t),this}applyQuaternion(t){return lb(this,this,t),this}angle(t){return cb(this,t)}lerp(t,i){return ib(this,this,t,i),this}smoothLerp(t,i,s){return rb(this,this,t,i,s),this}clone(){return new Ti(this[0],this[1],this[2])}fromArray(t,i=0){return this[0]=t[i],this[1]=t[i+1],this[2]=t[i+2],this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t}transformDirection(t){const i=this[0],s=this[1],o=this[2];return this[0]=t[0]*i+t[4]*s+t[8]*o,this[1]=t[1]*i+t[5]*s+t[9]*o,this[2]=t[2]*i+t[6]*s+t[10]*o,this.normalize()}}const Sm=new Ti;let db=1,fb=1,km=!1;class pb{constructor(t,i={}){t.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=t,this.attributes=i,this.id=db++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let s in i)this.addAttribute(s,i[s])}addAttribute(t,i){if(this.attributes[t]=i,i.id=fb++,i.size=i.size||1,i.type=i.type||(i.data.constructor===Float32Array?this.gl.FLOAT:i.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),i.target=t==="index"?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,i.normalized=i.normalized||!1,i.stride=i.stride||0,i.offset=i.offset||0,i.count=i.count||(i.stride?i.data.byteLength/i.stride:i.data.length/i.size),i.divisor=i.instanced||0,i.needsUpdate=!1,i.usage=i.usage||this.gl.STATIC_DRAW,i.buffer||this.updateAttribute(i),i.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==i.count*i.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,i.count*i.divisor);this.instancedCount=i.count*i.divisor}else t==="index"?this.drawRange.count=i.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,i.count))}updateAttribute(t){const i=!t.buffer;i&&(t.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==t.buffer&&(this.gl.bindBuffer(t.target,t.buffer),this.glState.boundBuffer=t.buffer),i?this.gl.bufferData(t.target,t.data,t.usage):this.gl.bufferSubData(t.target,0,t.data),t.needsUpdate=!1}setIndex(t){this.addAttribute("index",t)}setDrawRange(t,i){this.drawRange.start=t,this.drawRange.count=i}setInstancedCount(t){this.instancedCount=t}createVAO(t){this.VAOs[t.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.bindAttributes(t)}bindAttributes(t){t.attributeLocations.forEach((i,{name:s,type:o})=>{if(!this.attributes[s]){console.warn(`active attribute ${s} not being supplied`);return}const a=this.attributes[s];this.gl.bindBuffer(a.target,a.buffer),this.glState.boundBuffer=a.buffer;let c=1;o===35674&&(c=2),o===35675&&(c=3),o===35676&&(c=4);const f=a.size/c,h=c===1?0:c*c*4,v=c===1?0:c*4;for(let y=0;y<c;y++)this.gl.vertexAttribPointer(i+y,f,a.type,a.normalized,a.stride+h,a.offset+y*v),this.gl.enableVertexAttribArray(i+y),this.gl.renderer.vertexAttribDivisor(i+y,a.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:t,mode:i=this.gl.TRIANGLES}){this.gl.renderer.currentGeometry!==`${this.id}_${t.attributeOrder}`&&(this.VAOs[t.attributeOrder]||this.createVAO(t),this.gl.renderer.bindVertexArray(this.VAOs[t.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${t.attributeOrder}`),t.attributeLocations.forEach((o,{name:a})=>{const c=this.attributes[a];c.needsUpdate&&this.updateAttribute(c)});let s=2;this.attributes.index?.type===this.gl.UNSIGNED_INT&&(s=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(i,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*s,this.instancedCount):this.gl.renderer.drawArraysInstanced(i,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(i,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*s):this.gl.drawArrays(i,this.drawRange.start,this.drawRange.count)}getPosition(){const t=this.attributes.position;if(t.data)return t;if(!km)return console.warn("No position buffer data found to compute bounds"),km=!0}computeBoundingBox(t){t||(t=this.getPosition());const i=t.data,s=t.size;this.bounds||(this.bounds={min:new Ti,max:new Ti,center:new Ti,scale:new Ti,radius:1/0});const o=this.bounds.min,a=this.bounds.max,c=this.bounds.center,f=this.bounds.scale;o.set(1/0),a.set(-1/0);for(let h=0,v=i.length;h<v;h+=s){const y=i[h],x=i[h+1],k=i[h+2];o.x=Math.min(y,o.x),o.y=Math.min(x,o.y),o.z=Math.min(k,o.z),a.x=Math.max(y,a.x),a.y=Math.max(x,a.y),a.z=Math.max(k,a.z)}f.sub(a,o),c.add(o,a).divide(2)}computeBoundingSphere(t){t||(t=this.getPosition());const i=t.data,s=t.size;this.bounds||this.computeBoundingBox(t);let o=0;for(let a=0,c=i.length;a<c;a+=s)Sm.fromArray(i,a),o=Math.max(o,this.bounds.center.squaredDistance(Sm));this.bounds.radius=Math.sqrt(o)}remove(){for(let t in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[t]),delete this.VAOs[t];for(let t in this.attributes)this.gl.deleteBuffer(this.attributes[t].buffer),delete this.attributes[t]}}let hb=1;const _m={};class mb{constructor(t,{vertex:i,fragment:s,uniforms:o={},transparent:a=!1,cullFace:c=t.BACK,frontFace:f=t.CCW,depthTest:h=!0,depthWrite:v=!0,depthFunc:y=t.LEQUAL}={}){t.canvas||console.error("gl not passed as first argument to Program"),this.gl=t,this.uniforms=o,this.id=hb++,i||console.warn("vertex shader not supplied"),s||console.warn("fragment shader not supplied"),this.transparent=a,this.cullFace=c,this.frontFace=f,this.depthTest=h,this.depthWrite=v,this.depthFunc=y,this.blendFunc={},this.blendEquation={},this.stencilFunc={},this.stencilOp={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this.vertexShader=t.createShader(t.VERTEX_SHADER),this.fragmentShader=t.createShader(t.FRAGMENT_SHADER),this.program=t.createProgram(),t.attachShader(this.program,this.vertexShader),t.attachShader(this.program,this.fragmentShader),this.setShaders({vertex:i,fragment:s})}setShaders({vertex:t,fragment:i}){if(t&&(this.gl.shaderSource(this.vertexShader,t),this.gl.compileShader(this.vertexShader),this.gl.getShaderInfoLog(this.vertexShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.vertexShader)}
Vertex Shader
${Cm(t)}`)),i&&(this.gl.shaderSource(this.fragmentShader,i),this.gl.compileShader(this.fragmentShader),this.gl.getShaderInfoLog(this.fragmentShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.fragmentShader)}
Fragment Shader
${Cm(i)}`)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.warn(this.gl.getProgramInfoLog(this.program));this.uniformLocations=new Map;let s=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let c=0;c<s;c++){let f=this.gl.getActiveUniform(this.program,c);this.uniformLocations.set(f,this.gl.getUniformLocation(this.program,f.name));const h=f.name.match(/(\w+)/g);f.uniformName=h[0],f.nameComponents=h.slice(1)}this.attributeLocations=new Map;const o=[],a=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let c=0;c<a;c++){const f=this.gl.getActiveAttrib(this.program,c),h=this.gl.getAttribLocation(this.program,f.name);h!==-1&&(o[h]=f.name,this.attributeLocations.set(f,h))}this.attributeOrder=o.join("")}setBlendFunc(t,i,s,o){this.blendFunc.src=t,this.blendFunc.dst=i,this.blendFunc.srcAlpha=s,this.blendFunc.dstAlpha=o,t&&(this.transparent=!0)}setBlendEquation(t,i){this.blendEquation.modeRGB=t,this.blendEquation.modeAlpha=i}setStencilFunc(t,i,s){this.stencilRef=i,this.stencilFunc.func=t,this.stencilFunc.ref=i,this.stencilFunc.mask=s}setStencilOp(t,i,s){this.stencilOp.stencilFail=t,this.stencilOp.depthFail=i,this.stencilOp.depthPass=s}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha),this.stencilFunc.func||this.stencilOp.stencilFail?this.gl.renderer.enable(this.gl.STENCIL_TEST):this.gl.renderer.disable(this.gl.STENCIL_TEST),this.gl.renderer.setStencilFunc(this.stencilFunc.func,this.stencilFunc.ref,this.stencilFunc.mask),this.gl.renderer.setStencilOp(this.stencilOp.stencilFail,this.stencilOp.depthFail,this.stencilOp.depthPass)}use({flipFaces:t=!1}={}){let i=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((o,a)=>{let c=this.uniforms[a.uniformName];for(const f of a.nameComponents){if(!c)break;if(f in c)c=c[f];else{if(Array.isArray(c.value))break;c=void 0;break}}if(!c)return Tm(`Active uniform ${a.name} has not been supplied`);if(c&&c.value===void 0)return Tm(`${a.name} uniform is missing a value parameter`);if(c.value.texture)return i=i+1,c.value.update(i),Du(this.gl,a.type,o,i);if(c.value.length&&c.value[0].texture){const f=[];return c.value.forEach(h=>{i=i+1,h.update(i),f.push(i)}),Du(this.gl,a.type,o,f)}Du(this.gl,a.type,o,c.value)}),this.applyState(),t&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function Du(e,t,i,s){s=s.length?gb(s):s;const o=e.renderer.state.uniformLocations.get(i);if(s.length)if(o===void 0||o.length!==s.length)e.renderer.state.uniformLocations.set(i,s.slice(0));else{if(vb(o,s))return;o.set?o.set(s):yb(o,s),e.renderer.state.uniformLocations.set(i,o)}else{if(o===s)return;e.renderer.state.uniformLocations.set(i,s)}switch(t){case 5126:return s.length?e.uniform1fv(i,s):e.uniform1f(i,s);case 35664:return e.uniform2fv(i,s);case 35665:return e.uniform3fv(i,s);case 35666:return e.uniform4fv(i,s);case 35670:case 5124:case 35678:case 36306:case 35680:case 36289:return s.length?e.uniform1iv(i,s):e.uniform1i(i,s);case 35671:case 35667:return e.uniform2iv(i,s);case 35672:case 35668:return e.uniform3iv(i,s);case 35673:case 35669:return e.uniform4iv(i,s);case 35674:return e.uniformMatrix2fv(i,!1,s);case 35675:return e.uniformMatrix3fv(i,!1,s);case 35676:return e.uniformMatrix4fv(i,!1,s)}}function Cm(e){let t=e.split(`
`);for(let i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join(`
`)}function gb(e){const t=e.length,i=e[0].length;if(i===void 0)return e;const s=t*i;let o=_m[s];o||(_m[s]=o=new Float32Array(s));for(let a=0;a<t;a++)o.set(e[a],a*i);return o}function vb(e,t){if(e.length!==t.length)return!1;for(let i=0,s=e.length;i<s;i++)if(e[i]!==t[i])return!1;return!0}function yb(e,t){for(let i=0,s=e.length;i<s;i++)e[i]=t[i]}let Lu=0;function Tm(e){Lu>100||(console.warn(e),Lu++,Lu>100&&console.warn("More than 100 program warnings - stopping logs."))}const Mu=new Ti;let wb=1;class bb{constructor({canvas:t=document.createElement("canvas"),width:i=300,height:s=150,dpr:o=1,alpha:a=!1,depth:c=!0,stencil:f=!1,antialias:h=!1,premultipliedAlpha:v=!1,preserveDrawingBuffer:y=!1,powerPreference:x="default",autoClear:k=!0,webgl:C=2}={}){const M={alpha:a,depth:c,stencil:f,antialias:h,premultipliedAlpha:v,preserveDrawingBuffer:y,powerPreference:x};this.dpr=o,this.alpha=a,this.color=!0,this.depth=c,this.stencil=f,this.premultipliedAlpha=v,this.autoClear=k,this.id=wb++,C===2&&(this.gl=t.getContext("webgl2",M)),this.isWebgl2=!!this.gl,this.gl||(this.gl=t.getContext("webgl",M)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(i,s),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=!1,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LEQUAL,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(t,i){this.width=t,this.height=i,this.gl.canvas.width=t*this.dpr,this.gl.canvas.height=i*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:t+"px",height:i+"px"})}setViewport(t,i,s=0,o=0){this.state.viewport.width===t&&this.state.viewport.height===i||(this.state.viewport.width=t,this.state.viewport.height=i,this.state.viewport.x=s,this.state.viewport.y=o,this.gl.viewport(s,o,t,i))}setScissor(t,i,s=0,o=0){this.gl.scissor(s,o,t,i)}enable(t){this.state[t]!==!0&&(this.gl.enable(t),this.state[t]=!0)}disable(t){this.state[t]!==!1&&(this.gl.disable(t),this.state[t]=!1)}setBlendFunc(t,i,s,o){this.state.blendFunc.src===t&&this.state.blendFunc.dst===i&&this.state.blendFunc.srcAlpha===s&&this.state.blendFunc.dstAlpha===o||(this.state.blendFunc.src=t,this.state.blendFunc.dst=i,this.state.blendFunc.srcAlpha=s,this.state.blendFunc.dstAlpha=o,s!==void 0?this.gl.blendFuncSeparate(t,i,s,o):this.gl.blendFunc(t,i))}setBlendEquation(t,i){t=t||this.gl.FUNC_ADD,!(this.state.blendEquation.modeRGB===t&&this.state.blendEquation.modeAlpha===i)&&(this.state.blendEquation.modeRGB=t,this.state.blendEquation.modeAlpha=i,i!==void 0?this.gl.blendEquationSeparate(t,i):this.gl.blendEquation(t))}setCullFace(t){this.state.cullFace!==t&&(this.state.cullFace=t,this.gl.cullFace(t))}setFrontFace(t){this.state.frontFace!==t&&(this.state.frontFace=t,this.gl.frontFace(t))}setDepthMask(t){this.state.depthMask!==t&&(this.state.depthMask=t,this.gl.depthMask(t))}setDepthFunc(t){this.state.depthFunc!==t&&(this.state.depthFunc=t,this.gl.depthFunc(t))}setStencilMask(t){this.state.stencilMask!==t&&(this.state.stencilMask=t,this.gl.stencilMask(t))}setStencilFunc(t,i,s){this.state.stencilFunc===t&&this.state.stencilRef===i&&this.state.stencilFuncMask===s||(this.state.stencilFunc=t||this.gl.ALWAYS,this.state.stencilRef=i||0,this.state.stencilFuncMask=s||0,this.gl.stencilFunc(t||this.gl.ALWAYS,i||0,s||0))}setStencilOp(t,i,s){this.state.stencilFail===t&&this.state.stencilDepthFail===i&&this.state.stencilDepthPass===s||(this.state.stencilFail=t,this.state.stencilDepthFail=i,this.state.stencilDepthPass=s,this.gl.stencilOp(t,i,s))}activeTexture(t){this.state.activeTextureUnit!==t&&(this.state.activeTextureUnit=t,this.gl.activeTexture(this.gl.TEXTURE0+t))}bindFramebuffer({target:t=this.gl.FRAMEBUFFER,buffer:i=null}={}){this.state.framebuffer!==i&&(this.state.framebuffer=i,this.gl.bindFramebuffer(t,i))}getExtension(t,i,s){return i&&this.gl[i]?this.gl[i].bind(this.gl):(this.extensions[t]||(this.extensions[t]=this.gl.getExtension(t)),i?this.extensions[t]?this.extensions[t][s].bind(this.extensions[t]):null:this.extensions[t])}sortOpaque(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.program.id!==i.program.id?t.program.id-i.program.id:t.zDepth!==i.zDepth?t.zDepth-i.zDepth:i.id-t.id}sortTransparent(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.zDepth!==i.zDepth?i.zDepth-t.zDepth:i.id-t.id}sortUI(t,i){return t.renderOrder!==i.renderOrder?t.renderOrder-i.renderOrder:t.program.id!==i.program.id?t.program.id-i.program.id:i.id-t.id}getRenderList({scene:t,camera:i,frustumCull:s,sort:o}){let a=[];if(i&&s&&i.updateFrustum(),t.traverse(c=>{if(!c.visible)return!0;c.draw&&(s&&c.frustumCulled&&i&&!i.frustumIntersectsMesh(c)||a.push(c))}),o){const c=[],f=[],h=[];a.forEach(v=>{v.program.transparent?v.program.depthTest?f.push(v):h.push(v):c.push(v),v.zDepth=0,!(v.renderOrder!==0||!v.program.depthTest||!i)&&(v.worldMatrix.getTranslation(Mu),Mu.applyMatrix4(i.projectionViewMatrix),v.zDepth=Mu.z)}),c.sort(this.sortOpaque),f.sort(this.sortTransparent),h.sort(this.sortUI),a=c.concat(f,h)}return a}render({scene:t,camera:i,target:s=null,update:o=!0,sort:a=!0,frustumCull:c=!0,clear:f}){s===null?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(s),this.setViewport(s.width,s.height)),(f||this.autoClear&&f!==!1)&&(this.depth&&(!s||s.depth)&&(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),(this.stencil||!s||s.stencil)&&(this.enable(this.gl.STENCIL_TEST),this.setStencilMask(255)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),o&&t.updateMatrixWorld(),i&&i.updateMatrixWorld(),this.getRenderList({scene:t,camera:i,frustumCull:c,sort:a}).forEach(v=>{v.draw({camera:i})})}}function xb(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Sb(e,t,i,s,o){return e[0]=t,e[1]=i,e[2]=s,e[3]=o,e}function kb(e,t){let i=t[0],s=t[1],o=t[2],a=t[3],c=i*i+s*s+o*o+a*a;return c>0&&(c=1/Math.sqrt(c)),e[0]=i*c,e[1]=s*c,e[2]=o*c,e[3]=a*c,e}function _b(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Cb(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Tb(e,t,i){i=i*.5;let s=Math.sin(i);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(i),e}function Em(e,t,i){let s=t[0],o=t[1],a=t[2],c=t[3],f=i[0],h=i[1],v=i[2],y=i[3];return e[0]=s*y+c*f+o*v-a*h,e[1]=o*y+c*h+a*f-s*v,e[2]=a*y+c*v+s*h-o*f,e[3]=c*y-s*f-o*h-a*v,e}function Eb(e,t,i){i*=.5;let s=t[0],o=t[1],a=t[2],c=t[3],f=Math.sin(i),h=Math.cos(i);return e[0]=s*h+c*f,e[1]=o*h+a*f,e[2]=a*h-o*f,e[3]=c*h-s*f,e}function Pb(e,t,i){i*=.5;let s=t[0],o=t[1],a=t[2],c=t[3],f=Math.sin(i),h=Math.cos(i);return e[0]=s*h-a*f,e[1]=o*h+c*f,e[2]=a*h+s*f,e[3]=c*h-o*f,e}function Db(e,t,i){i*=.5;let s=t[0],o=t[1],a=t[2],c=t[3],f=Math.sin(i),h=Math.cos(i);return e[0]=s*h+o*f,e[1]=o*h-s*f,e[2]=a*h+c*f,e[3]=c*h-a*f,e}function Lb(e,t,i,s){let o=t[0],a=t[1],c=t[2],f=t[3],h=i[0],v=i[1],y=i[2],x=i[3],k,C,M,E,R;return C=o*h+a*v+c*y+f*x,C<0&&(C=-C,h=-h,v=-v,y=-y,x=-x),1-C>1e-6?(k=Math.acos(C),M=Math.sin(k),E=Math.sin((1-s)*k)/M,R=Math.sin(s*k)/M):(E=1-s,R=s),e[0]=E*o+R*h,e[1]=E*a+R*v,e[2]=E*c+R*y,e[3]=E*f+R*x,e}function Mb(e,t){let i=t[0],s=t[1],o=t[2],a=t[3],c=i*i+s*s+o*o+a*a,f=c?1/c:0;return e[0]=-i*f,e[1]=-s*f,e[2]=-o*f,e[3]=a*f,e}function Ab(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Rb(e,t){let i=t[0]+t[4]+t[8],s;if(i>0)s=Math.sqrt(i+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{let o=0;t[4]>t[0]&&(o=1),t[8]>t[o*3+o]&&(o=2);let a=(o+1)%3,c=(o+2)%3;s=Math.sqrt(t[o*3+o]-t[a*3+a]-t[c*3+c]+1),e[o]=.5*s,s=.5/s,e[3]=(t[a*3+c]-t[c*3+a])*s,e[a]=(t[a*3+o]+t[o*3+a])*s,e[c]=(t[c*3+o]+t[o*3+c])*s}return e}function Fb(e,t,i="YXZ"){let s=Math.sin(t[0]*.5),o=Math.cos(t[0]*.5),a=Math.sin(t[1]*.5),c=Math.cos(t[1]*.5),f=Math.sin(t[2]*.5),h=Math.cos(t[2]*.5);return i==="XYZ"?(e[0]=s*c*h+o*a*f,e[1]=o*a*h-s*c*f,e[2]=o*c*f+s*a*h,e[3]=o*c*h-s*a*f):i==="YXZ"?(e[0]=s*c*h+o*a*f,e[1]=o*a*h-s*c*f,e[2]=o*c*f-s*a*h,e[3]=o*c*h+s*a*f):i==="ZXY"?(e[0]=s*c*h-o*a*f,e[1]=o*a*h+s*c*f,e[2]=o*c*f+s*a*h,e[3]=o*c*h-s*a*f):i==="ZYX"?(e[0]=s*c*h-o*a*f,e[1]=o*a*h+s*c*f,e[2]=o*c*f-s*a*h,e[3]=o*c*h+s*a*f):i==="YZX"?(e[0]=s*c*h+o*a*f,e[1]=o*a*h+s*c*f,e[2]=o*c*f-s*a*h,e[3]=o*c*h-s*a*f):i==="XZY"&&(e[0]=s*c*h-o*a*f,e[1]=o*a*h-s*c*f,e[2]=o*c*f+s*a*h,e[3]=o*c*h+s*a*f),e}const Ob=xb,Nb=Sb,Ib=_b,Bb=kb;class zb extends Array{constructor(t=0,i=0,s=0,o=1){super(t,i,s,o),this.onChange=()=>{},this._target=this;const a=["0","1","2","3"];return new Proxy(this,{set(c,f){const h=Reflect.set(...arguments);return h&&a.includes(f)&&c.onChange(),h}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(t){this._target[0]=t,this.onChange()}set y(t){this._target[1]=t,this.onChange()}set z(t){this._target[2]=t,this.onChange()}set w(t){this._target[3]=t,this.onChange()}identity(){return Cb(this._target),this.onChange(),this}set(t,i,s,o){return t.length?this.copy(t):(Nb(this._target,t,i,s,o),this.onChange(),this)}rotateX(t){return Eb(this._target,this._target,t),this.onChange(),this}rotateY(t){return Pb(this._target,this._target,t),this.onChange(),this}rotateZ(t){return Db(this._target,this._target,t),this.onChange(),this}inverse(t=this._target){return Mb(this._target,t),this.onChange(),this}conjugate(t=this._target){return Ab(this._target,t),this.onChange(),this}copy(t){return Ob(this._target,t),this.onChange(),this}normalize(t=this._target){return Bb(this._target,t),this.onChange(),this}multiply(t,i){return i?Em(this._target,t,i):Em(this._target,this._target,t),this.onChange(),this}dot(t){return Ib(this._target,t)}fromMatrix3(t){return Rb(this._target,t),this.onChange(),this}fromEuler(t,i){return Fb(this._target,t,t.order),i||this.onChange(),this}fromAxisAngle(t,i){return Tb(this._target,t,i),this.onChange(),this}slerp(t,i){return Lb(this._target,this._target,t,i),this.onChange(),this}fromArray(t,i=0){return this._target[0]=t[i],this._target[1]=t[i+1],this._target[2]=t[i+2],this._target[3]=t[i+3],this.onChange(),this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t[i+3]=this[3],t}}const Vb=1e-6;function Ub(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Wb(e,t,i,s,o,a,c,f,h,v,y,x,k,C,M,E,R){return e[0]=t,e[1]=i,e[2]=s,e[3]=o,e[4]=a,e[5]=c,e[6]=f,e[7]=h,e[8]=v,e[9]=y,e[10]=x,e[11]=k,e[12]=C,e[13]=M,e[14]=E,e[15]=R,e}function jb(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qb(e,t){let i=t[0],s=t[1],o=t[2],a=t[3],c=t[4],f=t[5],h=t[6],v=t[7],y=t[8],x=t[9],k=t[10],C=t[11],M=t[12],E=t[13],R=t[14],O=t[15],j=i*f-s*c,z=i*h-o*c,W=i*v-a*c,V=s*h-o*f,H=s*v-a*f,J=o*v-a*h,N=y*E-x*M,G=y*R-k*M,se=y*O-C*M,fe=x*R-k*E,me=x*O-C*E,be=k*O-C*R,ye=j*be-z*me+W*fe+V*se-H*G+J*N;return ye?(ye=1/ye,e[0]=(f*be-h*me+v*fe)*ye,e[1]=(o*me-s*be-a*fe)*ye,e[2]=(E*J-R*H+O*V)*ye,e[3]=(k*H-x*J-C*V)*ye,e[4]=(h*se-c*be-v*G)*ye,e[5]=(i*be-o*se+a*G)*ye,e[6]=(R*W-M*J-O*z)*ye,e[7]=(y*J-k*W+C*z)*ye,e[8]=(c*me-f*se+v*N)*ye,e[9]=(s*se-i*me-a*N)*ye,e[10]=(M*H-E*W+O*j)*ye,e[11]=(x*W-y*H-C*j)*ye,e[12]=(f*G-c*fe-h*N)*ye,e[13]=(i*fe-s*G+o*N)*ye,e[14]=(E*z-M*V-R*j)*ye,e[15]=(y*V-x*z+k*j)*ye,e):null}function Cv(e){let t=e[0],i=e[1],s=e[2],o=e[3],a=e[4],c=e[5],f=e[6],h=e[7],v=e[8],y=e[9],x=e[10],k=e[11],C=e[12],M=e[13],E=e[14],R=e[15],O=t*c-i*a,j=t*f-s*a,z=t*h-o*a,W=i*f-s*c,V=i*h-o*c,H=s*h-o*f,J=v*M-y*C,N=v*E-x*C,G=v*R-k*C,se=y*E-x*M,fe=y*R-k*M,me=x*R-k*E;return O*me-j*fe+z*se+W*G-V*N+H*J}function Pm(e,t,i){let s=t[0],o=t[1],a=t[2],c=t[3],f=t[4],h=t[5],v=t[6],y=t[7],x=t[8],k=t[9],C=t[10],M=t[11],E=t[12],R=t[13],O=t[14],j=t[15],z=i[0],W=i[1],V=i[2],H=i[3];return e[0]=z*s+W*f+V*x+H*E,e[1]=z*o+W*h+V*k+H*R,e[2]=z*a+W*v+V*C+H*O,e[3]=z*c+W*y+V*M+H*j,z=i[4],W=i[5],V=i[6],H=i[7],e[4]=z*s+W*f+V*x+H*E,e[5]=z*o+W*h+V*k+H*R,e[6]=z*a+W*v+V*C+H*O,e[7]=z*c+W*y+V*M+H*j,z=i[8],W=i[9],V=i[10],H=i[11],e[8]=z*s+W*f+V*x+H*E,e[9]=z*o+W*h+V*k+H*R,e[10]=z*a+W*v+V*C+H*O,e[11]=z*c+W*y+V*M+H*j,z=i[12],W=i[13],V=i[14],H=i[15],e[12]=z*s+W*f+V*x+H*E,e[13]=z*o+W*h+V*k+H*R,e[14]=z*a+W*v+V*C+H*O,e[15]=z*c+W*y+V*M+H*j,e}function Hb(e,t,i){let s=i[0],o=i[1],a=i[2],c,f,h,v,y,x,k,C,M,E,R,O;return t===e?(e[12]=t[0]*s+t[4]*o+t[8]*a+t[12],e[13]=t[1]*s+t[5]*o+t[9]*a+t[13],e[14]=t[2]*s+t[6]*o+t[10]*a+t[14],e[15]=t[3]*s+t[7]*o+t[11]*a+t[15]):(c=t[0],f=t[1],h=t[2],v=t[3],y=t[4],x=t[5],k=t[6],C=t[7],M=t[8],E=t[9],R=t[10],O=t[11],e[0]=c,e[1]=f,e[2]=h,e[3]=v,e[4]=y,e[5]=x,e[6]=k,e[7]=C,e[8]=M,e[9]=E,e[10]=R,e[11]=O,e[12]=c*s+y*o+M*a+t[12],e[13]=f*s+x*o+E*a+t[13],e[14]=h*s+k*o+R*a+t[14],e[15]=v*s+C*o+O*a+t[15]),e}function $b(e,t,i){let s=i[0],o=i[1],a=i[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Yb(e,t,i,s){let o=s[0],a=s[1],c=s[2],f=Math.hypot(o,a,c),h,v,y,x,k,C,M,E,R,O,j,z,W,V,H,J,N,G,se,fe,me,be,ye,We;return Math.abs(f)<Vb?null:(f=1/f,o*=f,a*=f,c*=f,h=Math.sin(i),v=Math.cos(i),y=1-v,x=t[0],k=t[1],C=t[2],M=t[3],E=t[4],R=t[5],O=t[6],j=t[7],z=t[8],W=t[9],V=t[10],H=t[11],J=o*o*y+v,N=a*o*y+c*h,G=c*o*y-a*h,se=o*a*y-c*h,fe=a*a*y+v,me=c*a*y+o*h,be=o*c*y+a*h,ye=a*c*y-o*h,We=c*c*y+v,e[0]=x*J+E*N+z*G,e[1]=k*J+R*N+W*G,e[2]=C*J+O*N+V*G,e[3]=M*J+j*N+H*G,e[4]=x*se+E*fe+z*me,e[5]=k*se+R*fe+W*me,e[6]=C*se+O*fe+V*me,e[7]=M*se+j*fe+H*me,e[8]=x*be+E*ye+z*We,e[9]=k*be+R*ye+W*We,e[10]=C*be+O*ye+V*We,e[11]=M*be+j*ye+H*We,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Xb(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Tv(e,t){let i=t[0],s=t[1],o=t[2],a=t[4],c=t[5],f=t[6],h=t[8],v=t[9],y=t[10];return e[0]=Math.hypot(i,s,o),e[1]=Math.hypot(a,c,f),e[2]=Math.hypot(h,v,y),e}function Gb(e){let t=e[0],i=e[1],s=e[2],o=e[4],a=e[5],c=e[6],f=e[8],h=e[9],v=e[10];const y=t*t+i*i+s*s,x=o*o+a*a+c*c,k=f*f+h*h+v*v;return Math.sqrt(Math.max(y,x,k))}const Ev=(function(){const e=[1,1,1];return function(t,i){let s=e;Tv(s,i);let o=1/s[0],a=1/s[1],c=1/s[2],f=i[0]*o,h=i[1]*a,v=i[2]*c,y=i[4]*o,x=i[5]*a,k=i[6]*c,C=i[8]*o,M=i[9]*a,E=i[10]*c,R=f+x+E,O=0;return R>0?(O=Math.sqrt(R+1)*2,t[3]=.25*O,t[0]=(k-M)/O,t[1]=(C-v)/O,t[2]=(h-y)/O):f>x&&f>E?(O=Math.sqrt(1+f-x-E)*2,t[3]=(k-M)/O,t[0]=.25*O,t[1]=(h+y)/O,t[2]=(C+v)/O):x>E?(O=Math.sqrt(1+x-f-E)*2,t[3]=(C-v)/O,t[0]=(h+y)/O,t[1]=.25*O,t[2]=(k+M)/O):(O=Math.sqrt(1+E-f-x)*2,t[3]=(h-y)/O,t[0]=(C+v)/O,t[1]=(k+M)/O,t[2]=.25*O),t}})();function Kb(e,t,i,s){let o=Ba([e[0],e[1],e[2]]);const a=Ba([e[4],e[5],e[6]]),c=Ba([e[8],e[9],e[10]]);Cv(e)<0&&(o=-o),i[0]=e[12],i[1]=e[13],i[2]=e[14];const h=e.slice(),v=1/o,y=1/a,x=1/c;h[0]*=v,h[1]*=v,h[2]*=v,h[4]*=y,h[5]*=y,h[6]*=y,h[8]*=x,h[9]*=x,h[10]*=x,Ev(t,h),s[0]=o,s[1]=a,s[2]=c}function Qb(e,t,i,s){const o=e,a=t[0],c=t[1],f=t[2],h=t[3],v=a+a,y=c+c,x=f+f,k=a*v,C=a*y,M=a*x,E=c*y,R=c*x,O=f*x,j=h*v,z=h*y,W=h*x,V=s[0],H=s[1],J=s[2];return o[0]=(1-(E+O))*V,o[1]=(C+W)*V,o[2]=(M-z)*V,o[3]=0,o[4]=(C-W)*H,o[5]=(1-(k+O))*H,o[6]=(R+j)*H,o[7]=0,o[8]=(M+z)*J,o[9]=(R-j)*J,o[10]=(1-(k+E))*J,o[11]=0,o[12]=i[0],o[13]=i[1],o[14]=i[2],o[15]=1,o}function Zb(e,t){let i=t[0],s=t[1],o=t[2],a=t[3],c=i+i,f=s+s,h=o+o,v=i*c,y=s*c,x=s*f,k=o*c,C=o*f,M=o*h,E=a*c,R=a*f,O=a*h;return e[0]=1-x-M,e[1]=y+O,e[2]=k-R,e[3]=0,e[4]=y-O,e[5]=1-v-M,e[6]=C+E,e[7]=0,e[8]=k+R,e[9]=C-E,e[10]=1-v-x,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Jb(e,t,i,s,o){let a=1/Math.tan(t/2),c=1/(s-o);return e[0]=a/i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(o+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*o*s*c,e[15]=0,e}function ex(e,t,i,s,o,a,c){let f=1/(t-i),h=1/(s-o),v=1/(a-c);return e[0]=-2*f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*v,e[11]=0,e[12]=(t+i)*f,e[13]=(o+s)*h,e[14]=(c+a)*v,e[15]=1,e}function tx(e,t,i,s){let o=t[0],a=t[1],c=t[2],f=s[0],h=s[1],v=s[2],y=o-i[0],x=a-i[1],k=c-i[2],C=y*y+x*x+k*k;C===0?k=1:(C=1/Math.sqrt(C),y*=C,x*=C,k*=C);let M=h*k-v*x,E=v*y-f*k,R=f*x-h*y;return C=M*M+E*E+R*R,C===0&&(v?f+=1e-6:h?v+=1e-6:h+=1e-6,M=h*k-v*x,E=v*y-f*k,R=f*x-h*y,C=M*M+E*E+R*R),C=1/Math.sqrt(C),M*=C,E*=C,R*=C,e[0]=M,e[1]=E,e[2]=R,e[3]=0,e[4]=x*R-k*E,e[5]=k*M-y*R,e[6]=y*E-x*M,e[7]=0,e[8]=y,e[9]=x,e[10]=k,e[11]=0,e[12]=o,e[13]=a,e[14]=c,e[15]=1,e}function Dm(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e[6]=t[6]+i[6],e[7]=t[7]+i[7],e[8]=t[8]+i[8],e[9]=t[9]+i[9],e[10]=t[10]+i[10],e[11]=t[11]+i[11],e[12]=t[12]+i[12],e[13]=t[13]+i[13],e[14]=t[14]+i[14],e[15]=t[15]+i[15],e}function Lm(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e[6]=t[6]-i[6],e[7]=t[7]-i[7],e[8]=t[8]-i[8],e[9]=t[9]-i[9],e[10]=t[10]-i[10],e[11]=t[11]-i[11],e[12]=t[12]-i[12],e[13]=t[13]-i[13],e[14]=t[14]-i[14],e[15]=t[15]-i[15],e}function nx(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12]*i,e[13]=t[13]*i,e[14]=t[14]*i,e[15]=t[15]*i,e}class _l extends Array{constructor(t=1,i=0,s=0,o=0,a=0,c=1,f=0,h=0,v=0,y=0,x=1,k=0,C=0,M=0,E=0,R=1){return super(t,i,s,o,a,c,f,h,v,y,x,k,C,M,E,R),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(t){this[12]=t}set y(t){this[13]=t}set z(t){this[14]=t}set w(t){this[15]=t}set(t,i,s,o,a,c,f,h,v,y,x,k,C,M,E,R){return t.length?this.copy(t):(Wb(this,t,i,s,o,a,c,f,h,v,y,x,k,C,M,E,R),this)}translate(t,i=this){return Hb(this,i,t),this}rotate(t,i,s=this){return Yb(this,s,t,i),this}scale(t,i=this){return $b(this,i,typeof t=="number"?[t,t,t]:t),this}add(t,i){return i?Dm(this,t,i):Dm(this,this,t),this}sub(t,i){return i?Lm(this,t,i):Lm(this,this,t),this}multiply(t,i){return t.length?i?Pm(this,t,i):Pm(this,this,t):nx(this,this,t),this}identity(){return jb(this),this}copy(t){return Ub(this,t),this}fromPerspective({fov:t,aspect:i,near:s,far:o}={}){return Jb(this,t,i,s,o),this}fromOrthogonal({left:t,right:i,bottom:s,top:o,near:a,far:c}){return ex(this,t,i,s,o,a,c),this}fromQuaternion(t){return Zb(this,t),this}setPosition(t){return this.x=t[0],this.y=t[1],this.z=t[2],this}inverse(t=this){return qb(this,t),this}compose(t,i,s){return Qb(this,t,i,s),this}decompose(t,i,s){return Kb(this,t,i,s),this}getRotation(t){return Ev(t,this),this}getTranslation(t){return Xb(t,this),this}getScaling(t){return Tv(t,this),this}getMaxScaleOnAxis(){return Gb(this)}lookAt(t,i,s){return tx(this,t,i,s),this}determinant(){return Cv(this)}fromArray(t,i=0){return this[0]=t[i],this[1]=t[i+1],this[2]=t[i+2],this[3]=t[i+3],this[4]=t[i+4],this[5]=t[i+5],this[6]=t[i+6],this[7]=t[i+7],this[8]=t[i+8],this[9]=t[i+9],this[10]=t[i+10],this[11]=t[i+11],this[12]=t[i+12],this[13]=t[i+13],this[14]=t[i+14],this[15]=t[i+15],this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t[i+3]=this[3],t[i+4]=this[4],t[i+5]=this[5],t[i+6]=this[6],t[i+7]=this[7],t[i+8]=this[8],t[i+9]=this[9],t[i+10]=this[10],t[i+11]=this[11],t[i+12]=this[12],t[i+13]=this[13],t[i+14]=this[14],t[i+15]=this[15],t}}function ix(e,t,i="YXZ"){return i==="XYZ"?(e[1]=Math.asin(Math.min(Math.max(t[8],-1),1)),Math.abs(t[8])<.99999?(e[0]=Math.atan2(-t[9],t[10]),e[2]=Math.atan2(-t[4],t[0])):(e[0]=Math.atan2(t[6],t[5]),e[2]=0)):i==="YXZ"?(e[0]=Math.asin(-Math.min(Math.max(t[9],-1),1)),Math.abs(t[9])<.99999?(e[1]=Math.atan2(t[8],t[10]),e[2]=Math.atan2(t[1],t[5])):(e[1]=Math.atan2(-t[2],t[0]),e[2]=0)):i==="ZXY"?(e[0]=Math.asin(Math.min(Math.max(t[6],-1),1)),Math.abs(t[6])<.99999?(e[1]=Math.atan2(-t[2],t[10]),e[2]=Math.atan2(-t[4],t[5])):(e[1]=0,e[2]=Math.atan2(t[1],t[0]))):i==="ZYX"?(e[1]=Math.asin(-Math.min(Math.max(t[2],-1),1)),Math.abs(t[2])<.99999?(e[0]=Math.atan2(t[6],t[10]),e[2]=Math.atan2(t[1],t[0])):(e[0]=0,e[2]=Math.atan2(-t[4],t[5]))):i==="YZX"?(e[2]=Math.asin(Math.min(Math.max(t[1],-1),1)),Math.abs(t[1])<.99999?(e[0]=Math.atan2(-t[9],t[5]),e[1]=Math.atan2(-t[2],t[0])):(e[0]=0,e[1]=Math.atan2(t[8],t[10]))):i==="XZY"&&(e[2]=Math.asin(-Math.min(Math.max(t[4],-1),1)),Math.abs(t[4])<.99999?(e[0]=Math.atan2(t[6],t[5]),e[1]=Math.atan2(t[8],t[0])):(e[0]=Math.atan2(-t[9],t[10]),e[1]=0)),e}const Mm=new _l;class rx extends Array{constructor(t=0,i=t,s=t,o="YXZ"){super(t,i,s),this.order=o,this.onChange=()=>{},this._target=this;const a=["0","1","2"];return new Proxy(this,{set(c,f){const h=Reflect.set(...arguments);return h&&a.includes(f)&&c.onChange(),h}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this._target[0]=t,this.onChange()}set y(t){this._target[1]=t,this.onChange()}set z(t){this._target[2]=t,this.onChange()}set(t,i=t,s=t){return t.length?this.copy(t):(this._target[0]=t,this._target[1]=i,this._target[2]=s,this.onChange(),this)}copy(t){return this._target[0]=t[0],this._target[1]=t[1],this._target[2]=t[2],this.onChange(),this}reorder(t){return this._target.order=t,this.onChange(),this}fromRotationMatrix(t,i=this.order){return ix(this._target,t,i),this.onChange(),this}fromQuaternion(t,i=this.order,s){return Mm.fromQuaternion(t),this._target.fromRotationMatrix(Mm,i),s||this.onChange(),this}fromArray(t,i=0){return this._target[0]=t[i],this._target[1]=t[i+1],this._target[2]=t[i+2],this}toArray(t=[],i=0){return t[i]=this[0],t[i+1]=this[1],t[i+2]=this[2],t}}class sx{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new _l,this.worldMatrix=new _l,this.matrixAutoUpdate=!0,this.worldMatrixNeedsUpdate=!1,this.position=new Ti,this.quaternion=new zb,this.scale=new Ti(1),this.rotation=new rx,this.up=new Ti(0,1,0),this.rotation._target.onChange=()=>this.quaternion.fromEuler(this.rotation,!0),this.quaternion._target.onChange=()=>this.rotation.fromQuaternion(this.quaternion,void 0,!0)}setParent(t,i=!0){this.parent&&t!==this.parent&&this.parent.removeChild(this,!1),this.parent=t,i&&t&&t.addChild(this,!1)}addChild(t,i=!0){~this.children.indexOf(t)||this.children.push(t),i&&t.setParent(this,!1)}removeChild(t,i=!0){~this.children.indexOf(t)&&this.children.splice(this.children.indexOf(t),1),i&&t.setParent(null,!1)}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||t)&&(this.parent===null?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,t=!0);for(let i=0,s=this.children.length;i<s;i++)this.children[i].updateMatrixWorld(t)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(t){if(!t(this))for(let i=0,s=this.children.length;i<s;i++)this.children[i].traverse(t)}decompose(){this.matrix.decompose(this.quaternion._target,this.position,this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(t,i=!1){i?this.matrix.lookAt(this.position,t,this.up):this.matrix.lookAt(t,this.position,this.up),this.matrix.getRotation(this.quaternion._target),this.rotation.fromQuaternion(this.quaternion)}}function ax(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function ox(e,t){let i=t[0],s=t[1],o=t[2],a=t[3],c=i+i,f=s+s,h=o+o,v=i*c,y=s*c,x=s*f,k=o*c,C=o*f,M=o*h,E=a*c,R=a*f,O=a*h;return e[0]=1-x-M,e[3]=y-O,e[6]=k+R,e[1]=y+O,e[4]=1-v-M,e[7]=C-E,e[2]=k-R,e[5]=C+E,e[8]=1-v-x,e}function lx(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function cx(e,t,i,s,o,a,c,f,h,v){return e[0]=t,e[1]=i,e[2]=s,e[3]=o,e[4]=a,e[5]=c,e[6]=f,e[7]=h,e[8]=v,e}function ux(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function dx(e,t){let i=t[0],s=t[1],o=t[2],a=t[3],c=t[4],f=t[5],h=t[6],v=t[7],y=t[8],x=y*c-f*v,k=-y*a+f*h,C=v*a-c*h,M=i*x+s*k+o*C;return M?(M=1/M,e[0]=x*M,e[1]=(-y*s+o*v)*M,e[2]=(f*s-o*c)*M,e[3]=k*M,e[4]=(y*i-o*h)*M,e[5]=(-f*i+o*a)*M,e[6]=C*M,e[7]=(-v*i+s*h)*M,e[8]=(c*i-s*a)*M,e):null}function Am(e,t,i){let s=t[0],o=t[1],a=t[2],c=t[3],f=t[4],h=t[5],v=t[6],y=t[7],x=t[8],k=i[0],C=i[1],M=i[2],E=i[3],R=i[4],O=i[5],j=i[6],z=i[7],W=i[8];return e[0]=k*s+C*c+M*v,e[1]=k*o+C*f+M*y,e[2]=k*a+C*h+M*x,e[3]=E*s+R*c+O*v,e[4]=E*o+R*f+O*y,e[5]=E*a+R*h+O*x,e[6]=j*s+z*c+W*v,e[7]=j*o+z*f+W*y,e[8]=j*a+z*h+W*x,e}function fx(e,t,i){let s=t[0],o=t[1],a=t[2],c=t[3],f=t[4],h=t[5],v=t[6],y=t[7],x=t[8],k=i[0],C=i[1];return e[0]=s,e[1]=o,e[2]=a,e[3]=c,e[4]=f,e[5]=h,e[6]=k*s+C*c+v,e[7]=k*o+C*f+y,e[8]=k*a+C*h+x,e}function px(e,t,i){let s=t[0],o=t[1],a=t[2],c=t[3],f=t[4],h=t[5],v=t[6],y=t[7],x=t[8],k=Math.sin(i),C=Math.cos(i);return e[0]=C*s+k*c,e[1]=C*o+k*f,e[2]=C*a+k*h,e[3]=C*c-k*s,e[4]=C*f-k*o,e[5]=C*h-k*a,e[6]=v,e[7]=y,e[8]=x,e}function hx(e,t,i){let s=i[0],o=i[1];return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=o*t[3],e[4]=o*t[4],e[5]=o*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function mx(e,t){let i=t[0],s=t[1],o=t[2],a=t[3],c=t[4],f=t[5],h=t[6],v=t[7],y=t[8],x=t[9],k=t[10],C=t[11],M=t[12],E=t[13],R=t[14],O=t[15],j=i*f-s*c,z=i*h-o*c,W=i*v-a*c,V=s*h-o*f,H=s*v-a*f,J=o*v-a*h,N=y*E-x*M,G=y*R-k*M,se=y*O-C*M,fe=x*R-k*E,me=x*O-C*E,be=k*O-C*R,ye=j*be-z*me+W*fe+V*se-H*G+J*N;return ye?(ye=1/ye,e[0]=(f*be-h*me+v*fe)*ye,e[1]=(h*se-c*be-v*G)*ye,e[2]=(c*me-f*se+v*N)*ye,e[3]=(o*me-s*be-a*fe)*ye,e[4]=(i*be-o*se+a*G)*ye,e[5]=(s*se-i*me-a*N)*ye,e[6]=(E*J-R*H+O*V)*ye,e[7]=(R*W-M*J-O*z)*ye,e[8]=(M*H-E*W+O*j)*ye,e):null}class gx extends Array{constructor(t=1,i=0,s=0,o=0,a=1,c=0,f=0,h=0,v=1){return super(t,i,s,o,a,c,f,h,v),this}set(t,i,s,o,a,c,f,h,v){return t.length?this.copy(t):(cx(this,t,i,s,o,a,c,f,h,v),this)}translate(t,i=this){return fx(this,i,t),this}rotate(t,i=this){return px(this,i,t),this}scale(t,i=this){return hx(this,i,t),this}multiply(t,i){return i?Am(this,t,i):Am(this,this,t),this}identity(){return ux(this),this}copy(t){return lx(this,t),this}fromMatrix4(t){return ax(this,t),this}fromQuaternion(t){return ox(this,t),this}fromBasis(t,i,s){return this.set(t[0],t[1],t[2],i[0],i[1],i[2],s[0],s[1],s[2]),this}inverse(t=this){return dx(this,t),this}getNormalMatrix(t){return mx(this,t),this}}let vx=0;class yx extends sx{constructor(t,{geometry:i,program:s,mode:o=t.TRIANGLES,frustumCulled:a=!0,renderOrder:c=0}={}){super(),t.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=t,this.id=vx++,this.geometry=i,this.program=s,this.mode=o,this.frustumCulled=a,this.renderOrder=c,this.modelViewMatrix=new _l,this.normalMatrix=new gx,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(t){return this.beforeRenderCallbacks.push(t),this}onAfterRender(t){return this.afterRenderCallbacks.push(t),this}draw({camera:t}={}){t&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=t.projectionMatrix,this.program.uniforms.cameraPosition.value=t.worldPosition,this.program.uniforms.viewMatrix.value=t.viewMatrix,this.modelViewMatrix.multiply(t.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix),this.beforeRenderCallbacks.forEach(s=>s&&s({mesh:this,camera:t}));let i=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:i}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(s=>s&&s({mesh:this,camera:t}))}}const Rm={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#00ff00",blue:"#0000ff",fuchsia:"#ff00ff",cyan:"#00ffff",yellow:"#ffff00",orange:"#ff8000"};function Fm(e){e.length===4&&(e=e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t||console.warn(`Unable to convert hex string ${e} to rgb values`),[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255]}function wx(e){return e=parseInt(e),[(e>>16&255)/255,(e>>8&255)/255,(e&255)/255]}function Om(e){return e===void 0?[0,0,0]:arguments.length===3?arguments:isNaN(e)?e[0]==="#"?Fm(e):Rm[e.toLowerCase()]?Fm(Rm[e.toLowerCase()]):(console.warn("Color format not recognised"),[0,0,0]):wx(e)}class Nm extends Array{constructor(t){return Array.isArray(t)?super(...t):super(...Om(...arguments))}get r(){return this[0]}get g(){return this[1]}get b(){return this[2]}set r(t){this[0]=t}set g(t){this[1]=t}set b(t){this[2]=t}set(t){return Array.isArray(t)?this.copy(t):this.copy(Om(...arguments))}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this}}class bx extends pb{constructor(t,{attributes:i={}}={}){Object.assign(i,{position:{size:2,data:new Float32Array([-1,-1,3,-1,-1,3])},uv:{size:2,data:new Float32Array([0,0,2,0,0,2])}}),super(t,i)}}const xx=`
attribute vec2 position;
attribute vec2 uv;
varying vec2 vUv;
void main() {
  vUv = uv;
  gl_Position = vec4(position, 0.0, 1.0);
}
`,Sx=`
precision highp float;

uniform float iTime;
uniform vec3 iResolution;
uniform vec3 uColor;
uniform float uAmplitude;
uniform float uDistance;
uniform vec2 uMouse;

#define PI 3.1415926538

uniform int u_line_count;
const float u_line_width = 7.0;
const float u_line_blur = 10.0;

float Perlin2D(vec2 P) {
    vec2 Pi = floor(P);
    vec4 Pf_Pfmin1 = P.xyxy - vec4(Pi, Pi + 1.0);
    vec4 Pt = vec4(Pi.xy, Pi.xy + 1.0);
    Pt = Pt - floor(Pt * (1.0 / 71.0)) * 71.0;
    Pt += vec2(26.0, 161.0).xyxy;
    Pt *= Pt;
    Pt = Pt.xzxz * Pt.yyww;
    vec4 hash_x = fract(Pt * (1.0 / 951.135664));
    vec4 hash_y = fract(Pt * (1.0 / 642.949883));
    vec4 grad_x = hash_x - 0.49999;
    vec4 grad_y = hash_y - 0.49999;
    vec4 grad_results = inversesqrt(grad_x * grad_x + grad_y * grad_y)
        * (grad_x * Pf_Pfmin1.xzxz + grad_y * Pf_Pfmin1.yyww);
    grad_results *= 1.4142135623730950;
    vec2 blend = Pf_Pfmin1.xy * Pf_Pfmin1.xy * Pf_Pfmin1.xy
               * (Pf_Pfmin1.xy * (Pf_Pfmin1.xy * 6.0 - 15.0) + 10.0);
    vec4 blend2 = vec4(blend, vec2(1.0 - blend));
    return dot(grad_results, blend2.zxzx * blend2.wwyy);
}

float pixel(float count, vec2 resolution) {
    return (1.0 / max(resolution.x, resolution.y)) * count;
}

float lineFn(vec2 st, float width, float perc, float offset, vec2 mouse, float time, float amplitude, float distance) {
    float split_offset = (perc * 0.4);
    float split_point = 0.1 + split_offset;

    float amplitude_normal = smoothstep(split_point, 0.7, st.x);
    float amplitude_strength = 0.5;
    float finalAmplitude = amplitude_normal * amplitude_strength
                           * amplitude * (1.0 + (mouse.y - 0.5) * 0.2);

    float time_scaled = time / 10.0 + (mouse.x - 0.5) * 1.0;
    float blur = smoothstep(split_point, split_point + 0.05, st.x) * perc;

    float xnoise = mix(
        Perlin2D(vec2(time_scaled, st.x + perc) * 2.5),
        Perlin2D(vec2(time_scaled, st.x + time_scaled) * 3.5) / 1.5,
        st.x * 0.3
    );

    float y = 0.5 + (perc - 0.5) * distance + xnoise / 2.0 * finalAmplitude;

    float line_start = smoothstep(
        y + (width / 2.0) + (u_line_blur * pixel(1.0, iResolution.xy) * blur),
        y,
        st.y
    );

    float line_end = smoothstep(
        y,
        y - (width / 2.0) - (u_line_blur * pixel(1.0, iResolution.xy) * blur),
        st.y
    );

    return clamp(
        (line_start - line_end) * (1.0 - smoothstep(0.0, 1.0, pow(perc, 0.3))),
        0.0,
        1.0
    );
}

void mainImage(out vec4 fragColor, in vec2 fragCoord) {
    vec2 uv = fragCoord / iResolution.xy;

    float line_strength = 1.0;
    for (int i = 0; i < 40; i++) {
        if (i >= u_line_count) break;
        float p = float(i) / float(u_line_count);
        line_strength *= (1.0 - lineFn(
            uv,
            u_line_width * pixel(1.0, iResolution.xy) * (1.0 - p),
            p,
            (PI * 1.0) * p,
            uMouse,
            iTime,
            uAmplitude,
            uDistance
        ));
    }

    float colorVal = 1.0 - line_strength;
    fragColor = vec4(uColor * colorVal, colorVal);
}

void main() {
    mainImage(gl_FragColor, gl_FragCoord.xy);
}
`;class kx{constructor(){this.frameTimes=[],this.maxSamples=60,this.lastTime=performance.now()}tick(){const t=performance.now(),i=t-this.lastTime;this.lastTime=t,this.frameTimes.push(i),this.frameTimes.length>this.maxSamples&&this.frameTimes.shift()}getAverageFPS(){if(this.frameTimes.length===0)return 60;const t=this.frameTimes.reduce((i,s)=>i+s,0)/this.frameTimes.length;return Math.round(1e3/t)}isPerformancePoor(){return this.getAverageFPS()<30}isPerformanceGood(){return this.getAverageFPS()>=50}}function Im(){const e=window.innerWidth;let t=1;e<480?t=.4:e<768?t=.55:e<1024?t=.7:e<1440&&(t=.85);let i=1;return e<480?i=.6:e<768?i=.75:e<1024&&(i=.85),{distanceScale:t,amplitudeScale:i}}function _x(){const e="ontouchstart"in window||navigator.maxTouchPoints>0;return window.innerWidth>=1024&&!e}function Cx(e=null){const t=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.innerWidth<768,i="ontouchstart"in window||navigator.maxTouchPoints>0,s=navigator.hardwareConcurrency||4,o=navigator.deviceMemory||4,a=e!==null?e:_x();let c="high",f="";if(!t)try{const y=document.createElement("canvas").getContext("webgl",{powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0});if(y){const x=y.getExtension("WEBGL_debug_renderer_info");x&&(f=y.getParameter(x.UNMASKED_RENDERER_WEBGL).toLowerCase(),f.includes("intel")&&!f.includes("iris xe")&&(c="low"),["mx","max-q","mobile","laptop"].some(C=>f.includes(C))&&(c="mid")),y.getExtension("WEBGL_lose_context")?.loseContext()}}catch{c="low"}const h=i?.12:.06;return(s<4||o<4)&&c==="low"?(console.log("Threads: Ultra-low profile (15 lines)"),{lineCount:15,amplitude:.8,smoothing:h,quality:"ultra-low",isTouch:i,targetFPS:60}):s===4||c==="low"?(console.log("Threads: Low-end profile (20 lines)"),{lineCount:20,amplitude:1,smoothing:h,quality:"low",isTouch:i,targetFPS:60}):t?(console.log("Threads: Mobile profile (25 lines)"),{lineCount:25,amplitude:.8,smoothing:h,quality:"mobile",isTouch:i,targetFPS:60}):a||c==="mid"?(console.log("Threads: Laptop profile (28 lines, 45fps)"),{lineCount:28,amplitude:1.2,smoothing:.09,quality:"laptop",isTouch:i,targetFPS:45}):(console.log("Threads: High-end profile (40 lines)"),{lineCount:40,amplitude:1.5,smoothing:h,quality:"desktop",isTouch:i,targetFPS:60})}const Tx=({color:e=[1,1,1],amplitude:t=1,distance:i=0,enableMouseInteraction:s=!1,externalMouseRef:o=null,...a})=>{const c=ie.useRef(null),f=ie.useRef(),h=ie.useRef(null),v=ie.useRef(Cx()),y=ie.useRef(new kx),x=ie.useRef(v.current.lineCount),k=ie.useRef(!0),C=ie.useRef(Im());return ie.useEffect(()=>{if(!c.current)return;const M=c.current,E=new bb({alpha:!0,antialias:!1,powerPreference:"high-performance",depth:!1,stencil:!1}),R=E.gl;R.clearColor(0,0,0,0),R.enable(R.BLEND),R.blendFunc(R.SRC_ALPHA,R.ONE_MINUS_SRC_ALPHA),R.disable(R.DEPTH_TEST),R.disable(R.CULL_FACE),M.appendChild(R.canvas);const O=new bx(R),j=t*v.current.amplitude*C.current.amplitudeScale,z=i*C.current.distanceScale,W=new mb(R,{vertex:xx,fragment:Sx,uniforms:{iTime:{value:0},iResolution:{value:new Nm(R.canvas.width,R.canvas.height,R.canvas.width/R.canvas.height)},uColor:{value:new Nm(...e)},uAmplitude:{value:j},uDistance:{value:z},uMouse:{value:new Float32Array([.5,.5])},u_line_count:{value:x.current}}});h.current=W;const V=new yx(R,{geometry:O,program:W});function H(){const{clientWidth:p,clientHeight:g}=M,b=v.current.quality==="laptop"?.8:v.current.quality==="low"?.75:v.current.quality==="ultra-low"?.6:1,S=Math.floor(p*b),_=Math.floor(g*b);E.setSize(S,_),R.canvas.style.width=p+"px",R.canvas.style.height=g+"px",W.uniforms.iResolution.value.r=S,W.uniforms.iResolution.value.g=_,W.uniforms.iResolution.value.b=S/_,C.current=Im();const D=t*v.current.amplitude*C.current.amplitudeScale,T=i*C.current.distanceScale;W.uniforms.uAmplitude.value=D,W.uniforms.uDistance.value=T}let J;const N=()=>{clearTimeout(J),J=setTimeout(H,150)};window.addEventListener("resize",N),H();const G=new IntersectionObserver(p=>{k.current=p[0].isIntersecting,k.current&&!f.current&&(be=performance.now(),f.current=requestAnimationFrame(u))},{threshold:.1});G.observe(M);let se=[.5,.5],fe=[.5,.5],me=[0,0],be=performance.now(),ye=0,We=0,Ae=0;const ke=120,oe=10,_e=1e3/(v.current.targetFPS||60);function u(p){if(!k.current){f.current=null;return}if(p-ye<_e){f.current=requestAnimationFrame(u);return}if(ye=p,be=p,y.current.tick(),We++,We>=ke&&(We=0,y.current.isPerformancePoor()&&x.current>10?(x.current=Math.max(10,x.current-5),W.uniforms.u_line_count.value=x.current,console.log(` Threads: Reduced to ${x.current} lines (low FPS)`)):y.current.isPerformanceGood()&&x.current<v.current.lineCount&&(x.current=Math.min(v.current.lineCount,x.current+3),W.uniforms.u_line_count.value=x.current,console.log(` Threads: Increased to ${x.current} lines (good FPS)`))),s&&o){const g=o.current.x,b=o.current.y,S=Math.abs(g-fe[0]),_=Math.abs(b-fe[1]);(S>.5||_>.5)&&Ae===0&&(Ae=oe),fe[0]=g,fe[1]=b;let T=v.current.smoothing;if(Ae>0){const U=Ae/oe;T=T*(.5+.5*(1-U)),Ae--}const L=fe[0]-se[0],F=fe[1]-se[1];me[0]+=(L*.3-me[0])*.4,me[1]+=(F*.3-me[1])*.4,se[0]+=L*T+me[0]*.15,se[1]+=F*T+me[1]*.15,se[0]=Math.max(0,Math.min(1,se[0])),se[1]=Math.max(0,Math.min(1,se[1])),W.uniforms.uMouse.value[0]=se[0],W.uniforms.uMouse.value[1]=se[1]}else se[0]+=(.5-se[0])*.02,se[1]+=(.5-se[1])*.02,me=[0,0],Ae=0,W.uniforms.uMouse.value[0]=se[0],W.uniforms.uMouse.value[1]=se[1];W.uniforms.iTime.value=p*.001,E.render({scene:V}),f.current=requestAnimationFrame(u)}return()=>{f.current&&cancelAnimationFrame(f.current),window.removeEventListener("resize",N),clearTimeout(J),G.disconnect(),M.contains(R.canvas)&&M.removeChild(R.canvas),R.getExtension("WEBGL_lose_context")?.loseContext()}},[e,t,i,s,o]),we.jsx("div",{ref:c,className:"threads-container",...a})};function Ex(){const e=ie.useRef({x:.5,y:.5}),t=ie.useRef(null),i=ie.useRef(0),s=ie.useRef({x:0,y:0}),o=ie.useRef(!1),a=ie.useRef({x:.5,y:.5});return ie.useEffect(()=>{const c=document.getElementById("home");if(t.current=c,!c)return;if(window.mouseTracker){const k=c.getBoundingClientRect(),C=window.mouseTracker.position.x,M=window.mouseTracker.position.y;if(C>=k.left&&C<=k.right&&M>=k.top&&M<=k.bottom){o.current=!0;const E=window.mouseTracker.getNormalizedPosition(c);e.current=E,a.current=E,console.log(" Hero Threads: Mouse detected in section on load",E)}}const f=()=>{o.current=!0},h=()=>{o.current=!1,a.current={...e.current}},v=k=>{const C=Date.now(),M=C-i.current;if(i.current=C,k.touches.length>0){const E=k.touches[0],R=c.getBoundingClientRect(),O=(E.clientX-R.left)/R.width,j=(E.clientY-R.top)/R.height;M>0&&(s.current.x=(O-e.current.x)/M,s.current.y=(j-e.current.y)/M);const z={x:Math.max(0,Math.min(1,O)),y:Math.max(0,Math.min(1,j))};e.current=z,a.current=z}},y=()=>{s.current={x:0,y:0}};c.addEventListener("mouseenter",f),c.addEventListener("mouseleave",h),c.addEventListener("touchmove",v,{passive:!0}),c.addEventListener("touchend",y,{passive:!0}),c.addEventListener("touchcancel",y,{passive:!0});const x=window.mouseTracker.subscribe(k=>{if(o.current){const C=window.mouseTracker.getNormalizedPosition(c);e.current=C,a.current=C}});if(o.current&&window.mouseTracker){const k=window.mouseTracker.getNormalizedPosition(c);e.current=k,a.current=k}return()=>{c.removeEventListener("mouseenter",f),c.removeEventListener("mouseleave",h),c.removeEventListener("touchmove",v),c.removeEventListener("touchend",y),c.removeEventListener("touchcancel",y),typeof x=="function"&&x()}},[]),we.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0,pointerEvents:"none",touchAction:"none",WebkitUserSelect:"none",userSelect:"none"},children:we.jsx(Tx,{color:[.4,.6,1],amplitude:1,distance:.3,enableMouseInteraction:!0,externalMouseRef:e})})}const Bm=document.getElementById("hero-threads-root");Bm&&Ud.createRoot(Bm).render(we.jsx(Ex,{}));const zm=(e,t,i)=>Math.min(Math.max(e,t),i),Px=e=>((e+180)%360+360)%360-180;function Dx(e,t){const i=Array.from({length:t},(C,M)=>-28+M*2),s=[-3,-1,1,3],o=[-2,0,2,4],a=i.flatMap((C,M)=>(M%2===0?s:o).map(R=>({x:C,y:R,sizeX:2,sizeY:2})));if(e.length===0)return a.map(C=>({...C,preview:"",url:"",alt:"",type:"image"}));const c=e.map(C=>({preview:C.preview||C.src||"",url:C.url||C.src||"",alt:C.alt||"",type:C.type||"image"})),f=(C,M)=>{const E=C.x-M.x,R=C.y-M.y,j=Math.min(Math.abs(E),56-Math.abs(E));return Math.sqrt(j*j+R*R)},h=c.length,v=a.length,y=new Array(v).fill(null),x=new Array(h).fill(0),k=Math.ceil(v/h);for(let C=0;C<v;C++){let M=-1,E=-1/0;for(let R=0;R<h;R++){if(x[R]>=k)continue;const O=c[R],j=[];for(let V=0;V<C;V++)y[V]&&y[V].url===O.url&&j.push(V);let z;if(j.length===0)z=1e3;else{let V=1/0;j.forEach(H=>{const J=f(a[C],a[H]);V=Math.min(V,J)}),z=V}const W=(k-x[R])*.5;z+=W,z>E&&(E=z,M=R)}M===-1&&(M=C%h),y[C]=c[M],x[M]++}for(let C=0;C<y.length;C++)y[C]||(console.error("Empty position found at index:",C),y[C]=c[C%h]);return a.map((C,M)=>({...C,preview:y[M].preview,url:y[M].url,alt:y[M].alt,type:y[M].type}))}function Lx({images:e=[],fit:t=.6,minRadius:i=650,maxRadius:s=1e3,segments:o=28,maxVerticalRotationDeg:a=10,dragSensitivity:c=18,openedImageWidth:f="85vw",openedImageHeight:h="85vh",imageBorderRadius:v="12px",openedImageBorderRadius:y="20px",overlayBlurColor:x="#0a0a0a",grayscale:k=!1,pressHoldDuration:C=400,scrollThreshold:M=12}){const E=ie.useRef(null),R=ie.useRef(null),O=ie.useRef(null),j=ie.useRef(null),z=ie.useRef(null),W=ie.useRef({x:0,y:0}),V=ie.useRef({x:0,y:0}),H=ie.useRef(null),J=ie.useRef(!1),N=ie.useRef(!1),G=ie.useRef(0),se=ie.useRef(!1),fe=ie.useRef(null),me=ie.useRef(null),be=ie.useRef(!1),ye=ie.useRef(null),We=ie.useRef(0),Ae=ie.useRef(!1),ke=ie.useRef(null),oe=ie.useMemo(()=>Dx(e,o),[e,o]),_e=ie.useCallback(()=>{try{if(window.navigator&&window.navigator.vibrate&&window.navigator.vibrate(10),window.AudioContext||window.webkitAudioContext){const A=new(window.AudioContext||window.webkitAudioContext),B=A.createOscillator(),$=A.createGain();B.connect($),$.connect(A.destination),B.frequency.value=200,$.gain.value=.1,B.start(A.currentTime),B.stop(A.currentTime+.01)}}catch{}},[]),u=ie.useCallback(A=>{ke.current||(ke.current=requestAnimationFrame(()=>{if(ke.current=null,!O.current)return;O.current.querySelectorAll(".item").forEach($=>{const Y=($.getAttribute("style")||"").match(/--offset-x:\s*(-?\d+(?:\.\d+)?)/),Q=Y?parseFloat(Y[1]):0;let ce=360/o*(Q+.5)-A;for(;ce>180;)ce-=360;for(;ce<-180;)ce+=360;const pe=Math.round(500+499*Math.cos(ce*Math.PI/180));$.style.zIndex=Math.max(1,pe)})}))},[o]),p=ie.useCallback((A,B)=>{O.current&&(O.current.style.transform=`translateZ(calc(var(--radius) * -1)) rotateX(${A}deg) rotateY(${B}deg)`,u(B))},[u]);ie.useEffect(()=>{const A=E.current;if(!A)return;const B=()=>{const K=A.getBoundingClientRect(),Y=Math.max(1,K.width),Q=Math.max(1,K.height);let ce=Math.min(Y,Q)*t;ce=zm(ce,i,s),A.style.setProperty("--radius",`${Math.round(ce)}px`),A.style.setProperty("--segments-x",o),A.style.setProperty("--segments-y",o),A.style.setProperty("--tile-radius",v),A.style.setProperty("--enlarge-radius",y),A.style.setProperty("--overlay-blur-color",x),A.style.setProperty("--image-filter",k?"grayscale(1)":"none"),p(W.current.x,W.current.y)};B();const $=new ResizeObserver(B);return $.observe(A),()=>$.disconnect()},[t,i,s,o,v,y,x,k,p]),ie.useEffect(()=>{const A=setTimeout(()=>{u(0)},100);return()=>clearTimeout(A)},[u]);const g=ie.useCallback((A,B)=>{J.current=!0,N.current=!1,Ae.current=!0,V.current={...W.current},H.current={x:A,y:B}},[]),b=ie.useCallback((A,B)=>{if(!J.current||!H.current)return;const $=A-H.current.x,K=B-H.current.y;!N.current&&$*$+K*K>25&&(N.current=!0);const Y=zm(V.current.x-K/c,-a,a),Q=Px(V.current.y+$/c);W.current={x:Y,y:Q},p(Y,Q)},[c,a,p]),S=ie.useCallback(()=>{J.current&&N.current&&(G.current=performance.now()),J.current=!1,N.current=!1,H.current=null,setTimeout(()=>{Ae.current=!1},100)},[]);ie.useEffect(()=>{const A=Y=>{if(J.current&&Y.touches[0]){const Q=Y.touches[0];b(Q.clientX,Q.clientY)}},B=()=>{S()},$=Y=>{J.current&&b(Y.clientX,Y.clientY)},K=()=>{S()};return window.addEventListener("touchmove",A,{passive:!0}),window.addEventListener("touchend",B),window.addEventListener("touchcancel",B),window.addEventListener("mousemove",$),window.addEventListener("mouseup",K),()=>{window.removeEventListener("touchmove",A),window.removeEventListener("touchend",B),window.removeEventListener("touchcancel",B),window.removeEventListener("mousemove",$),window.removeEventListener("mouseup",K)}},[b,S]),ie.useEffect(()=>{const A=R.current;if(!A)return;const B=K=>{K.button===0&&g(K.clientX,K.clientY)},$=K=>{if(!K.target.closest(".item__image")){const Y=K.touches[0];g(Y.clientX,Y.clientY)}};return A.addEventListener("mousedown",B),A.addEventListener("touchstart",$,{passive:!0}),()=>{A.removeEventListener("mousedown",B),A.removeEventListener("touchstart",$)}},[g]);const _=ie.useCallback(A=>{if(se.current)return;const B=A.dataset.url,$=A.dataset.type,K=A.dataset.preview;se.current=!0;const Y=document.createElement("div");if(Y.className="enlarge",Y.style.cssText=`
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: ${f};
      height: ${h};
      max-width: 92vw;
      max-height: 92vh;
      z-index: 9999;
      border-radius: ${y};
      overflow: hidden;
      box-shadow: 0 25px 80px rgba(92, 92, 92, 0.24);
      background: #000000;
      pointer-events: auto;
    `,$==="iframe"&&B){const Q=document.createElement("iframe");Q.src=B,Q.style.cssText="width:100%;height:100%;border:none;",Q.setAttribute("allowfullscreen",""),Y.appendChild(Q)}else{const Q=document.createElement("img");Q.src=K||B,Q.style.cssText="width:100%;height:100%;object-fit:cover;",Y.appendChild(Q)}Y.addEventListener("wheel",Q=>{Q.stopPropagation()},{passive:!1}),j.current.appendChild(Y),E.current?.setAttribute("data-enlarging","true"),_e()},[f,h,y,_e]),D=ie.useCallback(A=>{const B=A.touches[0],$=A.currentTarget.parentElement;ye.current={x:B.clientX,y:B.clientY},We.current=performance.now(),me.current=$,be.current=!1,Ae.current=!1,fe.current&&clearTimeout(fe.current),fe.current=setTimeout(()=>{me.current&&!Ae.current&&(be.current=!0,_e())},C)},[_e,C]),T=ie.useCallback(A=>{if(Ae.current||!ye.current)return;const B=A.touches[0],$=B.clientX-ye.current.x,K=B.clientY-ye.current.y,Y=$*$+K*K,Q=M*M;Y>Q&&(Ae.current=!0,fe.current&&(clearTimeout(fe.current),fe.current=null),be.current=!1,J.current||g(B.clientX,B.clientY))},[M,g]),L=ie.useCallback(A=>{const B=me.current,$=be.current,K=Ae.current;fe.current&&(clearTimeout(fe.current),fe.current=null),$&&!K&&B&&(A.preventDefault(),A.stopPropagation(),_(B)),me.current=null,ye.current=null,We.current=0,be.current=!1,Ae.current=!1},[_]),F=ie.useCallback(()=>{fe.current&&(clearTimeout(fe.current),fe.current=null),me.current=null,ye.current=null,We.current=0,be.current=!1,Ae.current=!1},[]),U=ie.useCallback(A=>{if("ontouchstart"in window||J.current||N.current||performance.now()-G.current<100)return;const B=A.currentTarget.parentElement;_(B)},[_]);return ie.useEffect(()=>()=>{fe.current&&clearTimeout(fe.current),ke.current&&cancelAnimationFrame(ke.current)},[]),ie.useEffect(()=>{const A=()=>{const K=j.current?.querySelector(".enlarge");K&&K.remove(),E.current?.removeAttribute("data-enlarging"),se.current=!1},B=z.current;if(B&&(B.addEventListener("click",A),B.addEventListener("touchend",A),!("ontouchstart"in window))){const K=Y=>{Y.preventDefault(),A()};return B.addEventListener("wheel",K,{passive:!1}),()=>{B.removeEventListener("click",A),B.removeEventListener("touchend",A),B.removeEventListener("wheel",K)}}const $=K=>{K.key==="Escape"&&A()};return window.addEventListener("keydown",$),()=>{B&&(B.removeEventListener("click",A),B.removeEventListener("touchend",A)),window.removeEventListener("keydown",$)}},[]),we.jsx("div",{ref:E,className:"sphere-root",children:we.jsxs("main",{ref:R,className:"sphere-main",children:[we.jsx("div",{className:"stage",children:we.jsx("div",{ref:O,className:"sphere",children:oe.map((A,B)=>we.jsx("div",{className:"item","data-preview":A.preview,"data-url":A.url,"data-type":A.type,style:{"--offset-x":A.x,"--offset-y":A.y,"--item-size-x":A.sizeX,"--item-size-y":A.sizeY},children:we.jsx("div",{className:"item__image","data-interactive":"true",role:"button",tabIndex:0,onClick:U,onTouchStart:D,onTouchMove:T,onTouchEnd:L,onTouchCancel:F,onKeyDown:$=>{($.key==="Enter"||$.key===" ")&&($.preventDefault(),U($))},children:we.jsx("img",{src:A.preview,draggable:!1,alt:A.alt,loading:"lazy"})})},`${A.x},${A.y},${B}`))})}),we.jsx("div",{className:"viewer",ref:j,children:we.jsx("div",{ref:z,className:"scrim"})})]})})}const ui="./",Mx=[{preview:`${ui}images/logo.png`,url:"https://vistafly.services/",alt:"VistaFly Services - FPV drone videography",type:"iframe"},{preview:`${ui}images/logo1.png`,url:"https://vistafly.github.io/CSAnew/",alt:"CSA Entertainment - Sports & Music Programs",type:"iframe"},{preview:`${ui}images/logo2.png`,url:"https://themorenosband.com/",alt:"The Morenos Band - Official Music Website",type:"iframe"},{preview:`${ui}images/logo3.png`,url:"https://cultivanetwork.com/",alt:"CultivaNetwork - Agricultural Platform",type:"iframe"},{preview:`${ui}images/logo5.png`,url:"https://vistafly.github.io/thebox/",alt:"The Box - Creative Digital Project",type:"iframe"},{preview:`${ui}images/logo6.png`,url:"https://vistafly.github.io/landscapingcultura/",alt:"Landscaping Cultura - Professional Landscaping",type:"iframe"},{preview:`${ui}images/logo7.png`,url:"https://vistafly.github.io/sproutscloth/",alt:"Sprouts Clothing - Sustainable Fashion",type:"iframe"},{preview:`${ui}images/logo8.png`,url:"https://agstounding.com/",alt:"Agstounding - Professional Services",type:"iframe"},{preview:`${ui}images/logo9.png`,url:"https://eltacochingonllc.vercel.app/",alt:"El Taco Chingon - Authentic Mexican Street Food in Fresno, CA",type:"iframe"},{preview:`${ui}images/logo10.png`,url:"https://handyman-sam.vercel.app/",alt:"Handyman Sam - Professional Handyman Services in Fresno, CA",type:"iframe"},{preview:`${ui}images/logo11.png`,url:"https://vistafly.github.io/vistafly-studyguide/",alt:"VistaFly Academy - Drone Pilot Training Portal",type:"iframe"},{preview:`${ui}images/logo12.png`,url:"https://vistafly.github.io/Part-107studyguide/",alt:"Part 107 Study Guide - FAA Drone Certification Prep",type:"iframe"}];function Ax(){const[e,t]=ie.useState({minRadius:1100,maxRadius:1300,fit:1,maxVerticalRotationDeg:2,dragSensitivity:18,segments:30,openedImageWidth:"70vw",openedImageHeight:"70vh",imageBorderRadius:"40px",openedImageBorderRadius:"20px"});return ie.useEffect(()=>{const i=()=>{const s=window.innerWidth;s<=430?t({minRadius:500,maxRadius:650,fit:.9,maxVerticalRotationDeg:1.5,dragSensitivity:16,segments:20,openedImageWidth:"85vw",openedImageHeight:"78vh",imageBorderRadius:"20px",openedImageBorderRadius:"12px"}):s<=768?t({minRadius:700,maxRadius:700,fit:.95,maxVerticalRotationDeg:1.8,dragSensitivity:17,segments:25,openedImageWidth:"90vw",openedImageHeight:"80vh",imageBorderRadius:"30px",openedImageBorderRadius:"15px"}):s<=1024?t({minRadius:1e3,maxRadius:1200,fit:.98,maxVerticalRotationDeg:2,dragSensitivity:19,segments:28,openedImageWidth:"90vw",openedImageHeight:"80vh",imageBorderRadius:"35px",openedImageBorderRadius:"18px"}):t({minRadius:1e3,maxRadius:1200,fit:1,maxVerticalRotationDeg:2,dragSensitivity:18,segments:30,openedImageWidth:"85vw",openedImageHeight:"80vh",imageBorderRadius:"40px",openedImageBorderRadius:"20px"})};return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),we.jsx(Lx,{images:Mx,minRadius:e.minRadius,maxRadius:e.maxRadius,fit:e.fit,maxVerticalRotationDeg:e.maxVerticalRotationDeg,dragSensitivity:e.dragSensitivity,segments:e.segments,openedImageWidth:e.openedImageWidth,openedImageHeight:e.openedImageHeight,imageBorderRadius:e.imageBorderRadius,openedImageBorderRadius:e.openedImageBorderRadius,overlayBlurColor:"#0a0a0a",grayscale:!1})}const Rx=Ud.createRoot(document.getElementById("portfolio-dome-root"));Rx.render(we.jsx(Sv.StrictMode,{children:we.jsx(Ax,{})}));function $i(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pv(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var ei={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Us={duration:.5,overwrite:!1,delay:0},Wd,cn,Tt,pi=1e8,gt=1/pi,id=Math.PI*2,Fx=id/4,Ox=0,Dv=Math.sqrt,Nx=Math.cos,Ix=Math.sin,nn=function(t){return typeof t=="string"},Ot=function(t){return typeof t=="function"},Xi=function(t){return typeof t=="number"},jd=function(t){return typeof t>"u"},Ii=function(t){return typeof t=="object"},Vn=function(t){return t!==!1},qd=function(){return typeof window<"u"},pl=function(t){return Ot(t)||nn(t)},Lv=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},vn=Array.isArray,rd=/(?:-?\.?\d|\.)+/gi,Mv=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Ls=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Au=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Av=/[+-]=-?[.\d]+/,Rv=/[^,'"\[\]\s]+/gi,Bx=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Lt,Ai,sd,Hd,ti={},Cl={},Fv,Ov=function(t){return(Cl=Ws(t,ti))&&qn},$d=function(t,i){return console.warn("Invalid property",t,"set to",i,"Missing plugin? gsap.registerPlugin()")},$a=function(t,i){return!i&&console.warn(t)},Nv=function(t,i){return t&&(ti[t]=i)&&Cl&&(Cl[t]=i)||ti},Ya=function(){return 0},zx={suppressEvents:!0,isStart:!0,kill:!1},vl={suppressEvents:!0,kill:!1},Vx={suppressEvents:!0},Yd={},Sr=[],ad={},Iv,Qn={},Ru={},Vm=30,yl=[],Xd="",Gd=function(t){var i=t[0],s,o;if(Ii(i)||Ot(i)||(t=[t]),!(s=(i._gsap||{}).harness)){for(o=yl.length;o--&&!yl[o].targetTest(i););s=yl[o]}for(o=t.length;o--;)t[o]&&(t[o]._gsap||(t[o]._gsap=new oy(t[o],s)))||t.splice(o,1);return t},Kr=function(t){return t._gsap||Gd(hi(t))[0]._gsap},Bv=function(t,i,s){return(s=t[i])&&Ot(s)?t[i]():jd(s)&&t.getAttribute&&t.getAttribute(i)||s},Un=function(t,i){return(t=t.split(",")).forEach(i)||t},Ut=function(t){return Math.round(t*1e5)/1e5||0},Yt=function(t){return Math.round(t*1e7)/1e7||0},Is=function(t,i){var s=i.charAt(0),o=parseFloat(i.substr(2));return t=parseFloat(t),s==="+"?t+o:s==="-"?t-o:s==="*"?t*o:t/o},Ux=function(t,i){for(var s=i.length,o=0;t.indexOf(i[o])<0&&++o<s;);return o<s},Tl=function(){var t=Sr.length,i=Sr.slice(0),s,o;for(ad={},Sr.length=0,s=0;s<t;s++)o=i[s],o&&o._lazy&&(o.render(o._lazy[0],o._lazy[1],!0)._lazy=0)},Kd=function(t){return!!(t._initted||t._startAt||t.add)},zv=function(t,i,s,o){Sr.length&&!cn&&Tl(),t.render(i,s,!!(cn&&i<0&&Kd(t))),Sr.length&&!cn&&Tl()},Vv=function(t){var i=parseFloat(t);return(i||i===0)&&(t+"").match(Rv).length<2?i:nn(t)?t.trim():t},Uv=function(t){return t},ni=function(t,i){for(var s in i)s in t||(t[s]=i[s]);return t},Wx=function(t){return function(i,s){for(var o in s)o in i||o==="duration"&&t||o==="ease"||(i[o]=s[o])}},Ws=function(t,i){for(var s in i)t[s]=i[s];return t},Um=function e(t,i){for(var s in i)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(t[s]=Ii(i[s])?e(t[s]||(t[s]={}),i[s]):i[s]);return t},El=function(t,i){var s={},o;for(o in t)o in i||(s[o]=t[o]);return s},za=function(t){var i=t.parent||Lt,s=t.keyframes?Wx(vn(t.keyframes)):ni;if(Vn(t.inherit))for(;i;)s(t,i.vars.defaults),i=i.parent||i._dp;return t},jx=function(t,i){for(var s=t.length,o=s===i.length;o&&s--&&t[s]===i[s];);return s<0},Wv=function(t,i,s,o,a){var c=t[o],f;if(a)for(f=i[a];c&&c[a]>f;)c=c._prev;return c?(i._next=c._next,c._next=i):(i._next=t[s],t[s]=i),i._next?i._next._prev=i:t[o]=i,i._prev=c,i.parent=i._dp=t,i},Bl=function(t,i,s,o){s===void 0&&(s="_first"),o===void 0&&(o="_last");var a=i._prev,c=i._next;a?a._next=c:t[s]===i&&(t[s]=c),c?c._prev=a:t[o]===i&&(t[o]=a),i._next=i._prev=i.parent=null},_r=function(t,i){t.parent&&(!i||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},Qr=function(t,i){if(t&&(!i||i._end>t._dur||i._start<0))for(var s=t;s;)s._dirty=1,s=s.parent;return t},qx=function(t){for(var i=t.parent;i&&i.parent;)i._dirty=1,i.totalDuration(),i=i.parent;return t},od=function(t,i,s,o){return t._startAt&&(cn?t._startAt.revert(vl):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(i,!0,o))},Hx=function e(t){return!t||t._ts&&e(t.parent)},Wm=function(t){return t._repeat?js(t._tTime,t=t.duration()+t._rDelay)*t:0},js=function(t,i){var s=Math.floor(t=Yt(t/i));return t&&s===t?s-1:s},Pl=function(t,i){return(t-i._start)*i._ts+(i._ts>=0?0:i._dirty?i.totalDuration():i._tDur)},zl=function(t){return t._end=Yt(t._start+(t._tDur/Math.abs(t._ts||t._rts||gt)||0))},Vl=function(t,i){var s=t._dp;return s&&s.smoothChildTiming&&t._ts&&(t._start=Yt(s._time-(t._ts>0?i/t._ts:((t._dirty?t.totalDuration():t._tDur)-i)/-t._ts)),zl(t),s._dirty||Qr(s,t)),t},jv=function(t,i){var s;if((i._time||!i._dur&&i._initted||i._start<t._time&&(i._dur||!i.add))&&(s=Pl(t.rawTime(),i),(!i._dur||so(0,i.totalDuration(),s)-i._tTime>gt)&&i.render(s,!0)),Qr(t,i)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(s=t;s._dp;)s.rawTime()>=0&&s.totalTime(s._tTime),s=s._dp;t._zTime=-gt}},Ri=function(t,i,s,o){return i.parent&&_r(i),i._start=Yt((Xi(s)?s:s||t!==Lt?di(t,s,i):t._time)+i._delay),i._end=Yt(i._start+(i.totalDuration()/Math.abs(i.timeScale())||0)),Wv(t,i,"_first","_last",t._sort?"_start":0),ld(i)||(t._recent=i),o||jv(t,i),t._ts<0&&Vl(t,t._tTime),t},qv=function(t,i){return(ti.ScrollTrigger||$d("scrollTrigger",i))&&ti.ScrollTrigger.create(i,t)},Hv=function(t,i,s,o,a){if(Zd(t,i,a),!t._initted)return 1;if(!s&&t._pt&&!cn&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&Iv!==Zn.frame)return Sr.push(t),t._lazy=[a,o],1},$x=function e(t){var i=t.parent;return i&&i._ts&&i._initted&&!i._lock&&(i.rawTime()<0||e(i))},ld=function(t){var i=t.data;return i==="isFromStart"||i==="isStart"},Yx=function(t,i,s,o){var a=t.ratio,c=i<0||!i&&(!t._start&&$x(t)&&!(!t._initted&&ld(t))||(t._ts<0||t._dp._ts<0)&&!ld(t))?0:1,f=t._rDelay,h=0,v,y,x;if(f&&t._repeat&&(h=so(0,t._tDur,i),y=js(h,f),t._yoyo&&y&1&&(c=1-c),y!==js(t._tTime,f)&&(a=1-c,t.vars.repeatRefresh&&t._initted&&t.invalidate())),c!==a||cn||o||t._zTime===gt||!i&&t._zTime){if(!t._initted&&Hv(t,i,o,s,h))return;for(x=t._zTime,t._zTime=i||(s?gt:0),s||(s=i&&!x),t.ratio=c,t._from&&(c=1-c),t._time=0,t._tTime=h,v=t._pt;v;)v.r(c,v.d),v=v._next;i<0&&od(t,i,s,!0),t._onUpdate&&!s&&Jn(t,"onUpdate"),h&&t._repeat&&!s&&t.parent&&Jn(t,"onRepeat"),(i>=t._tDur||i<0)&&t.ratio===c&&(c&&_r(t,1),!s&&!cn&&(Jn(t,c?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=i)},Xx=function(t,i,s){var o;if(s>i)for(o=t._first;o&&o._start<=s;){if(o.data==="isPause"&&o._start>i)return o;o=o._next}else for(o=t._last;o&&o._start>=s;){if(o.data==="isPause"&&o._start<i)return o;o=o._prev}},qs=function(t,i,s,o){var a=t._repeat,c=Yt(i)||0,f=t._tTime/t._tDur;return f&&!o&&(t._time*=c/t._dur),t._dur=c,t._tDur=a?a<0?1e10:Yt(c*(a+1)+t._rDelay*a):c,f>0&&!o&&Vl(t,t._tTime=t._tDur*f),t.parent&&zl(t),s||Qr(t.parent,t),t},jm=function(t){return t instanceof Cn?Qr(t):qs(t,t._dur)},Gx={_start:0,endTime:Ya,totalDuration:Ya},di=function e(t,i,s){var o=t.labels,a=t._recent||Gx,c=t.duration()>=pi?a.endTime(!1):t._dur,f,h,v;return nn(i)&&(isNaN(i)||i in o)?(h=i.charAt(0),v=i.substr(-1)==="%",f=i.indexOf("="),h==="<"||h===">"?(f>=0&&(i=i.replace(/=/,"")),(h==="<"?a._start:a.endTime(a._repeat>=0))+(parseFloat(i.substr(1))||0)*(v?(f<0?a:s).totalDuration()/100:1)):f<0?(i in o||(o[i]=c),o[i]):(h=parseFloat(i.charAt(f-1)+i.substr(f+1)),v&&s&&(h=h/100*(vn(s)?s[0]:s).totalDuration()),f>1?e(t,i.substr(0,f-1),s)+h:c+h)):i==null?c:+i},Va=function(t,i,s){var o=Xi(i[1]),a=(o?2:1)+(t<2?0:1),c=i[a],f,h;if(o&&(c.duration=i[1]),c.parent=s,t){for(f=c,h=s;h&&!("immediateRender"in f);)f=h.vars.defaults||{},h=Vn(h.vars.inherit)&&h.parent;c.immediateRender=Vn(f.immediateRender),t<2?c.runBackwards=1:c.startAt=i[a-1]}return new $t(i[0],c,i[a+1])},Pr=function(t,i){return t||t===0?i(t):i},so=function(t,i,s){return s<t?t:s>i?i:s},mn=function(t,i){return!nn(t)||!(i=Bx.exec(t))?"":i[1]},Kx=function(t,i,s){return Pr(s,function(o){return so(t,i,o)})},cd=[].slice,$v=function(t,i){return t&&Ii(t)&&"length"in t&&(!i&&!t.length||t.length-1 in t&&Ii(t[0]))&&!t.nodeType&&t!==Ai},Qx=function(t,i,s){return s===void 0&&(s=[]),t.forEach(function(o){var a;return nn(o)&&!i||$v(o,1)?(a=s).push.apply(a,hi(o)):s.push(o)})||s},hi=function(t,i,s){return Tt&&!i&&Tt.selector?Tt.selector(t):nn(t)&&!s&&(sd||!Hs())?cd.call((i||Hd).querySelectorAll(t),0):vn(t)?Qx(t,s):$v(t)?cd.call(t,0):t?[t]:[]},ud=function(t){return t=hi(t)[0]||$a("Invalid scope")||{},function(i){var s=t.current||t.nativeElement||t;return hi(i,s.querySelectorAll?s:s===t?$a("Invalid scope")||Hd.createElement("div"):t)}},Yv=function(t){return t.sort(function(){return .5-Math.random()})},Xv=function(t){if(Ot(t))return t;var i=Ii(t)?t:{each:t},s=Zr(i.ease),o=i.from||0,a=parseFloat(i.base)||0,c={},f=o>0&&o<1,h=isNaN(o)||f,v=i.axis,y=o,x=o;return nn(o)?y=x={center:.5,edges:.5,end:1}[o]||0:!f&&h&&(y=o[0],x=o[1]),function(k,C,M){var E=(M||i).length,R=c[E],O,j,z,W,V,H,J,N,G;if(!R){if(G=i.grid==="auto"?0:(i.grid||[1,pi])[1],!G){for(J=-pi;J<(J=M[G++].getBoundingClientRect().left)&&G<E;);G<E&&G--}for(R=c[E]=[],O=h?Math.min(G,E)*y-.5:o%G,j=G===pi?0:h?E*x/G-.5:o/G|0,J=0,N=pi,H=0;H<E;H++)z=H%G-O,W=j-(H/G|0),R[H]=V=v?Math.abs(v==="y"?W:z):Dv(z*z+W*W),V>J&&(J=V),V<N&&(N=V);o==="random"&&Yv(R),R.max=J-N,R.min=N,R.v=E=(parseFloat(i.amount)||parseFloat(i.each)*(G>E?E-1:v?v==="y"?E/G:G:Math.max(G,E/G))||0)*(o==="edges"?-1:1),R.b=E<0?a-E:a,R.u=mn(i.amount||i.each)||0,s=s&&E<0?ry(s):s}return E=(R[k]-R.min)/R.max||0,Yt(R.b+(s?s(E):E)*R.v)+R.u}},dd=function(t){var i=Math.pow(10,((t+"").split(".")[1]||"").length);return function(s){var o=Yt(Math.round(parseFloat(s)/t)*t*i);return(o-o%1)/i+(Xi(s)?0:mn(s))}},Gv=function(t,i){var s=vn(t),o,a;return!s&&Ii(t)&&(o=s=t.radius||pi,t.values?(t=hi(t.values),(a=!Xi(t[0]))&&(o*=o)):t=dd(t.increment)),Pr(i,s?Ot(t)?function(c){return a=t(c),Math.abs(a-c)<=o?a:c}:function(c){for(var f=parseFloat(a?c.x:c),h=parseFloat(a?c.y:0),v=pi,y=0,x=t.length,k,C;x--;)a?(k=t[x].x-f,C=t[x].y-h,k=k*k+C*C):k=Math.abs(t[x]-f),k<v&&(v=k,y=x);return y=!o||v<=o?t[y]:c,a||y===c||Xi(c)?y:y+mn(c)}:dd(t))},Kv=function(t,i,s,o){return Pr(vn(t)?!i:s===!0?!!(s=0):!o,function(){return vn(t)?t[~~(Math.random()*t.length)]:(s=s||1e-5)&&(o=s<1?Math.pow(10,(s+"").length-2):1)&&Math.floor(Math.round((t-s/2+Math.random()*(i-t+s*.99))/s)*s*o)/o})},Zx=function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return function(o){return i.reduce(function(a,c){return c(a)},o)}},Jx=function(t,i){return function(s){return t(parseFloat(s))+(i||mn(s))}},eS=function(t,i,s){return Zv(t,i,0,1,s)},Qv=function(t,i,s){return Pr(s,function(o){return t[~~i(o)]})},tS=function e(t,i,s){var o=i-t;return vn(t)?Qv(t,e(0,t.length),i):Pr(s,function(a){return(o+(a-t)%o)%o+t})},nS=function e(t,i,s){var o=i-t,a=o*2;return vn(t)?Qv(t,e(0,t.length-1),i):Pr(s,function(c){return c=(a+(c-t)%a)%a||0,t+(c>o?a-c:c)})},Xa=function(t){for(var i=0,s="",o,a,c,f;~(o=t.indexOf("random(",i));)c=t.indexOf(")",o),f=t.charAt(o+7)==="[",a=t.substr(o+7,c-o-7).match(f?Rv:rd),s+=t.substr(i,o-i)+Kv(f?a:+a[0],f?0:+a[1],+a[2]||1e-5),i=c+1;return s+t.substr(i,t.length-i)},Zv=function(t,i,s,o,a){var c=i-t,f=o-s;return Pr(a,function(h){return s+((h-t)/c*f||0)})},iS=function e(t,i,s,o){var a=isNaN(t+i)?0:function(C){return(1-C)*t+C*i};if(!a){var c=nn(t),f={},h,v,y,x,k;if(s===!0&&(o=1)&&(s=null),c)t={p:t},i={p:i};else if(vn(t)&&!vn(i)){for(y=[],x=t.length,k=x-2,v=1;v<x;v++)y.push(e(t[v-1],t[v]));x--,a=function(M){M*=x;var E=Math.min(k,~~M);return y[E](M-E)},s=i}else o||(t=Ws(vn(t)?[]:{},t));if(!y){for(h in i)Qd.call(f,t,h,"get",i[h]);a=function(M){return tf(M,f)||(c?t.p:t)}}}return Pr(s,a)},qm=function(t,i,s){var o=t.labels,a=pi,c,f,h;for(c in o)f=o[c]-i,f<0==!!s&&f&&a>(f=Math.abs(f))&&(h=c,a=f);return h},Jn=function(t,i,s){var o=t.vars,a=o[i],c=Tt,f=t._ctx,h,v,y;if(a)return h=o[i+"Params"],v=o.callbackScope||t,s&&Sr.length&&Tl(),f&&(Tt=f),y=h?a.apply(v,h):a.call(v),Tt=c,y},Fa=function(t){return _r(t),t.scrollTrigger&&t.scrollTrigger.kill(!!cn),t.progress()<1&&Jn(t,"onInterrupt"),t},Ms,Jv=[],ey=function(t){if(t)if(t=!t.name&&t.default||t,qd()||t.headless){var i=t.name,s=Ot(t),o=i&&!s&&t.init?function(){this._props=[]}:t,a={init:Ya,render:tf,add:Qd,kill:wS,modifier:yS,rawVars:0},c={targetTest:0,get:0,getSetter:ef,aliases:{},register:0};if(Hs(),t!==o){if(Qn[i])return;ni(o,ni(El(t,a),c)),Ws(o.prototype,Ws(a,El(t,c))),Qn[o.prop=i]=o,t.targetTest&&(yl.push(o),Yd[i]=1),i=(i==="css"?"CSS":i.charAt(0).toUpperCase()+i.substr(1))+"Plugin"}Nv(i,o),t.register&&t.register(qn,o,Wn)}else Jv.push(t)},mt=255,Oa={aqua:[0,mt,mt],lime:[0,mt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,mt],navy:[0,0,128],white:[mt,mt,mt],olive:[128,128,0],yellow:[mt,mt,0],orange:[mt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[mt,0,0],pink:[mt,192,203],cyan:[0,mt,mt],transparent:[mt,mt,mt,0]},Fu=function(t,i,s){return t+=t<0?1:t>1?-1:0,(t*6<1?i+(s-i)*t*6:t<.5?s:t*3<2?i+(s-i)*(2/3-t)*6:i)*mt+.5|0},ty=function(t,i,s){var o=t?Xi(t)?[t>>16,t>>8&mt,t&mt]:0:Oa.black,a,c,f,h,v,y,x,k,C,M;if(!o){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),Oa[t])o=Oa[t];else if(t.charAt(0)==="#"){if(t.length<6&&(a=t.charAt(1),c=t.charAt(2),f=t.charAt(3),t="#"+a+a+c+c+f+f+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return o=parseInt(t.substr(1,6),16),[o>>16,o>>8&mt,o&mt,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),o=[t>>16,t>>8&mt,t&mt]}else if(t.substr(0,3)==="hsl"){if(o=M=t.match(rd),!i)h=+o[0]%360/360,v=+o[1]/100,y=+o[2]/100,c=y<=.5?y*(v+1):y+v-y*v,a=y*2-c,o.length>3&&(o[3]*=1),o[0]=Fu(h+1/3,a,c),o[1]=Fu(h,a,c),o[2]=Fu(h-1/3,a,c);else if(~t.indexOf("="))return o=t.match(Mv),s&&o.length<4&&(o[3]=1),o}else o=t.match(rd)||Oa.transparent;o=o.map(Number)}return i&&!M&&(a=o[0]/mt,c=o[1]/mt,f=o[2]/mt,x=Math.max(a,c,f),k=Math.min(a,c,f),y=(x+k)/2,x===k?h=v=0:(C=x-k,v=y>.5?C/(2-x-k):C/(x+k),h=x===a?(c-f)/C+(c<f?6:0):x===c?(f-a)/C+2:(a-c)/C+4,h*=60),o[0]=~~(h+.5),o[1]=~~(v*100+.5),o[2]=~~(y*100+.5)),s&&o.length<4&&(o[3]=1),o},ny=function(t){var i=[],s=[],o=-1;return t.split(kr).forEach(function(a){var c=a.match(Ls)||[];i.push.apply(i,c),s.push(o+=c.length+1)}),i.c=s,i},Hm=function(t,i,s){var o="",a=(t+o).match(kr),c=i?"hsla(":"rgba(",f=0,h,v,y,x;if(!a)return t;if(a=a.map(function(k){return(k=ty(k,i,1))&&c+(i?k[0]+","+k[1]+"%,"+k[2]+"%,"+k[3]:k.join(","))+")"}),s&&(y=ny(t),h=s.c,h.join(o)!==y.c.join(o)))for(v=t.replace(kr,"1").split(Ls),x=v.length-1;f<x;f++)o+=v[f]+(~h.indexOf(f)?a.shift()||c+"0,0,0,0)":(y.length?y:a.length?a:s).shift());if(!v)for(v=t.split(kr),x=v.length-1;f<x;f++)o+=v[f]+a[f];return o+v[x]},kr=(function(){var e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in Oa)e+="|"+t+"\\b";return new RegExp(e+")","gi")})(),rS=/hsl[a]?\(/,iy=function(t){var i=t.join(" "),s;if(kr.lastIndex=0,kr.test(i))return s=rS.test(i),t[1]=Hm(t[1],s),t[0]=Hm(t[0],s,ny(t[1])),!0},Ga,Zn=(function(){var e=Date.now,t=500,i=33,s=e(),o=s,a=1e3/240,c=a,f=[],h,v,y,x,k,C,M=function E(R){var O=e()-o,j=R===!0,z,W,V,H;if((O>t||O<0)&&(s+=O-i),o+=O,V=o-s,z=V-c,(z>0||j)&&(H=++x.frame,k=V-x.time*1e3,x.time=V=V/1e3,c+=z+(z>=a?4:a-z),W=1),j||(h=v(E)),W)for(C=0;C<f.length;C++)f[C](V,k,H,R)};return x={time:0,frame:0,tick:function(){M(!0)},deltaRatio:function(R){return k/(1e3/(R||60))},wake:function(){Fv&&(!sd&&qd()&&(Ai=sd=window,Hd=Ai.document||{},ti.gsap=qn,(Ai.gsapVersions||(Ai.gsapVersions=[])).push(qn.version),Ov(Cl||Ai.GreenSockGlobals||!Ai.gsap&&Ai||{}),Jv.forEach(ey)),y=typeof requestAnimationFrame<"u"&&requestAnimationFrame,h&&x.sleep(),v=y||function(R){return setTimeout(R,c-x.time*1e3+1|0)},Ga=1,M(2))},sleep:function(){(y?cancelAnimationFrame:clearTimeout)(h),Ga=0,v=Ya},lagSmoothing:function(R,O){t=R||1/0,i=Math.min(O||33,t)},fps:function(R){a=1e3/(R||240),c=x.time*1e3+a},add:function(R,O,j){var z=O?function(W,V,H,J){R(W,V,H,J),x.remove(z)}:R;return x.remove(R),f[j?"unshift":"push"](z),Hs(),z},remove:function(R,O){~(O=f.indexOf(R))&&f.splice(O,1)&&C>=O&&C--},_listeners:f},x})(),Hs=function(){return!Ga&&Zn.wake()},rt={},sS=/^[\d.\-M][\d.\-,\s]/,aS=/["']/g,oS=function(t){for(var i={},s=t.substr(1,t.length-3).split(":"),o=s[0],a=1,c=s.length,f,h,v;a<c;a++)h=s[a],f=a!==c-1?h.lastIndexOf(","):h.length,v=h.substr(0,f),i[o]=isNaN(v)?v.replace(aS,"").trim():+v,o=h.substr(f+1).trim();return i},lS=function(t){var i=t.indexOf("(")+1,s=t.indexOf(")"),o=t.indexOf("(",i);return t.substring(i,~o&&o<s?t.indexOf(")",s+1):s)},cS=function(t){var i=(t+"").split("("),s=rt[i[0]];return s&&i.length>1&&s.config?s.config.apply(null,~t.indexOf("{")?[oS(i[1])]:lS(t).split(",").map(Vv)):rt._CE&&sS.test(t)?rt._CE("",t):s},ry=function(t){return function(i){return 1-t(1-i)}},sy=function e(t,i){for(var s=t._first,o;s;)s instanceof Cn?e(s,i):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==i&&(s.timeline?e(s.timeline,i):(o=s._ease,s._ease=s._yEase,s._yEase=o,s._yoyo=i)),s=s._next},Zr=function(t,i){return t&&(Ot(t)?t:rt[t]||cS(t))||i},rs=function(t,i,s,o){s===void 0&&(s=function(h){return 1-i(1-h)}),o===void 0&&(o=function(h){return h<.5?i(h*2)/2:1-i((1-h)*2)/2});var a={easeIn:i,easeOut:s,easeInOut:o},c;return Un(t,function(f){rt[f]=ti[f]=a,rt[c=f.toLowerCase()]=s;for(var h in a)rt[c+(h==="easeIn"?".in":h==="easeOut"?".out":".inOut")]=rt[f+"."+h]=a[h]}),a},ay=function(t){return function(i){return i<.5?(1-t(1-i*2))/2:.5+t((i-.5)*2)/2}},Ou=function e(t,i,s){var o=i>=1?i:1,a=(s||(t?.3:.45))/(i<1?i:1),c=a/id*(Math.asin(1/o)||0),f=function(y){return y===1?1:o*Math.pow(2,-10*y)*Ix((y-c)*a)+1},h=t==="out"?f:t==="in"?function(v){return 1-f(1-v)}:ay(f);return a=id/a,h.config=function(v,y){return e(t,v,y)},h},Nu=function e(t,i){i===void 0&&(i=1.70158);var s=function(c){return c?--c*c*((i+1)*c+i)+1:0},o=t==="out"?s:t==="in"?function(a){return 1-s(1-a)}:ay(s);return o.config=function(a){return e(t,a)},o};Un("Linear,Quad,Cubic,Quart,Quint,Strong",function(e,t){var i=t<5?t+1:t;rs(e+",Power"+(i-1),t?function(s){return Math.pow(s,i)}:function(s){return s},function(s){return 1-Math.pow(1-s,i)},function(s){return s<.5?Math.pow(s*2,i)/2:1-Math.pow((1-s)*2,i)/2})});rt.Linear.easeNone=rt.none=rt.Linear.easeIn;rs("Elastic",Ou("in"),Ou("out"),Ou());(function(e,t){var i=1/t,s=2*i,o=2.5*i,a=function(f){return f<i?e*f*f:f<s?e*Math.pow(f-1.5/t,2)+.75:f<o?e*(f-=2.25/t)*f+.9375:e*Math.pow(f-2.625/t,2)+.984375};rs("Bounce",function(c){return 1-a(1-c)},a)})(7.5625,2.75);rs("Expo",function(e){return Math.pow(2,10*(e-1))*e+e*e*e*e*e*e*(1-e)});rs("Circ",function(e){return-(Dv(1-e*e)-1)});rs("Sine",function(e){return e===1?1:-Nx(e*Fx)+1});rs("Back",Nu("in"),Nu("out"),Nu());rt.SteppedEase=rt.steps=ti.SteppedEase={config:function(t,i){t===void 0&&(t=1);var s=1/t,o=t+(i?0:1),a=i?1:0,c=1-gt;return function(f){return((o*so(0,c,f)|0)+a)*s}}};Us.ease=rt["quad.out"];Un("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(e){return Xd+=e+","+e+"Params,"});var oy=function(t,i){this.id=Ox++,t._gsap=this,this.target=t,this.harness=i,this.get=i?i.get:Bv,this.set=i?i.getSetter:ef},Ka=(function(){function e(i){this.vars=i,this._delay=+i.delay||0,(this._repeat=i.repeat===1/0?-2:i.repeat||0)&&(this._rDelay=i.repeatDelay||0,this._yoyo=!!i.yoyo||!!i.yoyoEase),this._ts=1,qs(this,+i.duration,1,1),this.data=i.data,Tt&&(this._ctx=Tt,Tt.data.push(this)),Ga||Zn.wake()}var t=e.prototype;return t.delay=function(s){return s||s===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+s-this._delay),this._delay=s,this):this._delay},t.duration=function(s){return arguments.length?this.totalDuration(this._repeat>0?s+(s+this._rDelay)*this._repeat:s):this.totalDuration()&&this._dur},t.totalDuration=function(s){return arguments.length?(this._dirty=0,qs(this,this._repeat<0?s:(s-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(s,o){if(Hs(),!arguments.length)return this._tTime;var a=this._dp;if(a&&a.smoothChildTiming&&this._ts){for(Vl(this,s),!a._dp||a.parent||jv(a,this);a&&a.parent;)a.parent._time!==a._start+(a._ts>=0?a._tTime/a._ts:(a.totalDuration()-a._tTime)/-a._ts)&&a.totalTime(a._tTime,!0),a=a.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&s<this._tDur||this._ts<0&&s>0||!this._tDur&&!s)&&Ri(this._dp,this,this._start-this._delay)}return(this._tTime!==s||!this._dur&&!o||this._initted&&Math.abs(this._zTime)===gt||!s&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=s),zv(this,s,o)),this},t.time=function(s,o){return arguments.length?this.totalTime(Math.min(this.totalDuration(),s+Wm(this))%(this._dur+this._rDelay)||(s?this._dur:0),o):this._time},t.totalProgress=function(s,o){return arguments.length?this.totalTime(this.totalDuration()*s,o):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},t.progress=function(s,o){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-s:s)+Wm(this),o):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(s,o){var a=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(s-1)*a,o):this._repeat?js(this._tTime,a)+1:1},t.timeScale=function(s,o){if(!arguments.length)return this._rts===-gt?0:this._rts;if(this._rts===s)return this;var a=this.parent&&this._ts?Pl(this.parent._time,this):this._tTime;return this._rts=+s||0,this._ts=this._ps||s===-gt?0:this._rts,this.totalTime(so(-Math.abs(this._delay),this.totalDuration(),a),o!==!1),zl(this),qx(this)},t.paused=function(s){return arguments.length?(this._ps!==s&&(this._ps=s,s?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Hs(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==gt&&(this._tTime-=gt)))),this):this._ps},t.startTime=function(s){if(arguments.length){this._start=s;var o=this.parent||this._dp;return o&&(o._sort||!this.parent)&&Ri(o,this,s-this._delay),this}return this._start},t.endTime=function(s){return this._start+(Vn(s)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(s){var o=this.parent||this._dp;return o?s&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Pl(o.rawTime(s),this):this._tTime:this._tTime},t.revert=function(s){s===void 0&&(s=Vx);var o=cn;return cn=s,Kd(this)&&(this.timeline&&this.timeline.revert(s),this.totalTime(-.01,s.suppressEvents)),this.data!=="nested"&&s.kill!==!1&&this.kill(),cn=o,this},t.globalTime=function(s){for(var o=this,a=arguments.length?s:o.rawTime();o;)a=o._start+a/(Math.abs(o._ts)||1),o=o._dp;return!this.parent&&this._sat?this._sat.globalTime(s):a},t.repeat=function(s){return arguments.length?(this._repeat=s===1/0?-2:s,jm(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(s){if(arguments.length){var o=this._time;return this._rDelay=s,jm(this),o?this.time(o):this}return this._rDelay},t.yoyo=function(s){return arguments.length?(this._yoyo=s,this):this._yoyo},t.seek=function(s,o){return this.totalTime(di(this,s),Vn(o))},t.restart=function(s,o){return this.play().totalTime(s?-this._delay:0,Vn(o)),this._dur||(this._zTime=-gt),this},t.play=function(s,o){return s!=null&&this.seek(s,o),this.reversed(!1).paused(!1)},t.reverse=function(s,o){return s!=null&&this.seek(s||this.totalDuration(),o),this.reversed(!0).paused(!1)},t.pause=function(s,o){return s!=null&&this.seek(s,o),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(s){return arguments.length?(!!s!==this.reversed()&&this.timeScale(-this._rts||(s?-gt:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-gt,this},t.isActive=function(){var s=this.parent||this._dp,o=this._start,a;return!!(!s||this._ts&&this._initted&&s.isActive()&&(a=s.rawTime(!0))>=o&&a<this.endTime(!0)-gt)},t.eventCallback=function(s,o,a){var c=this.vars;return arguments.length>1?(o?(c[s]=o,a&&(c[s+"Params"]=a),s==="onUpdate"&&(this._onUpdate=o)):delete c[s],this):c[s]},t.then=function(s){var o=this;return new Promise(function(a){var c=Ot(s)?s:Uv,f=function(){var v=o.then;o.then=null,Ot(c)&&(c=c(o))&&(c.then||c===o)&&(o.then=v),a(c),o.then=v};o._initted&&o.totalProgress()===1&&o._ts>=0||!o._tTime&&o._ts<0?f():o._prom=f})},t.kill=function(){Fa(this)},e})();ni(Ka.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-gt,_prom:0,_ps:!1,_rts:1});var Cn=(function(e){Pv(t,e);function t(s,o){var a;return s===void 0&&(s={}),a=e.call(this,s)||this,a.labels={},a.smoothChildTiming=!!s.smoothChildTiming,a.autoRemoveChildren=!!s.autoRemoveChildren,a._sort=Vn(s.sortChildren),Lt&&Ri(s.parent||Lt,$i(a),o),s.reversed&&a.reverse(),s.paused&&a.paused(!0),s.scrollTrigger&&qv($i(a),s.scrollTrigger),a}var i=t.prototype;return i.to=function(o,a,c){return Va(0,arguments,this),this},i.from=function(o,a,c){return Va(1,arguments,this),this},i.fromTo=function(o,a,c,f){return Va(2,arguments,this),this},i.set=function(o,a,c){return a.duration=0,a.parent=this,za(a).repeatDelay||(a.repeat=0),a.immediateRender=!!a.immediateRender,new $t(o,a,di(this,c),1),this},i.call=function(o,a,c){return Ri(this,$t.delayedCall(0,o,a),c)},i.staggerTo=function(o,a,c,f,h,v,y){return c.duration=a,c.stagger=c.stagger||f,c.onComplete=v,c.onCompleteParams=y,c.parent=this,new $t(o,c,di(this,h)),this},i.staggerFrom=function(o,a,c,f,h,v,y){return c.runBackwards=1,za(c).immediateRender=Vn(c.immediateRender),this.staggerTo(o,a,c,f,h,v,y)},i.staggerFromTo=function(o,a,c,f,h,v,y,x){return f.startAt=c,za(f).immediateRender=Vn(f.immediateRender),this.staggerTo(o,a,f,h,v,y,x)},i.render=function(o,a,c){var f=this._time,h=this._dirty?this.totalDuration():this._tDur,v=this._dur,y=o<=0?0:Yt(o),x=this._zTime<0!=o<0&&(this._initted||!v),k,C,M,E,R,O,j,z,W,V,H,J;if(this!==Lt&&y>h&&o>=0&&(y=h),y!==this._tTime||c||x){if(f!==this._time&&v&&(y+=this._time-f,o+=this._time-f),k=y,W=this._start,z=this._ts,O=!z,x&&(v||(f=this._zTime),(o||!a)&&(this._zTime=o)),this._repeat){if(H=this._yoyo,R=v+this._rDelay,this._repeat<-1&&o<0)return this.totalTime(R*100+o,a,c);if(k=Yt(y%R),y===h?(E=this._repeat,k=v):(V=Yt(y/R),E=~~V,E&&E===V&&(k=v,E--),k>v&&(k=v)),V=js(this._tTime,R),!f&&this._tTime&&V!==E&&this._tTime-V*R-this._dur<=0&&(V=E),H&&E&1&&(k=v-k,J=1),E!==V&&!this._lock){var N=H&&V&1,G=N===(H&&E&1);if(E<V&&(N=!N),f=N?0:y%v?v:y,this._lock=1,this.render(f||(J?0:Yt(E*R)),a,!v)._lock=0,this._tTime=y,!a&&this.parent&&Jn(this,"onRepeat"),this.vars.repeatRefresh&&!J&&(this.invalidate()._lock=1),f&&f!==this._time||O!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(v=this._dur,h=this._tDur,G&&(this._lock=2,f=N?v:-1e-4,this.render(f,!0),this.vars.repeatRefresh&&!J&&this.invalidate()),this._lock=0,!this._ts&&!O)return this;sy(this,J)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(j=Xx(this,Yt(f),Yt(k)),j&&(y-=k-(k=j._start))),this._tTime=y,this._time=k,this._act=!z,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=o,f=0),!f&&y&&!a&&!V&&(Jn(this,"onStart"),this._tTime!==y))return this;if(k>=f&&o>=0)for(C=this._first;C;){if(M=C._next,(C._act||k>=C._start)&&C._ts&&j!==C){if(C.parent!==this)return this.render(o,a,c);if(C.render(C._ts>0?(k-C._start)*C._ts:(C._dirty?C.totalDuration():C._tDur)+(k-C._start)*C._ts,a,c),k!==this._time||!this._ts&&!O){j=0,M&&(y+=this._zTime=-gt);break}}C=M}else{C=this._last;for(var se=o<0?o:k;C;){if(M=C._prev,(C._act||se<=C._end)&&C._ts&&j!==C){if(C.parent!==this)return this.render(o,a,c);if(C.render(C._ts>0?(se-C._start)*C._ts:(C._dirty?C.totalDuration():C._tDur)+(se-C._start)*C._ts,a,c||cn&&Kd(C)),k!==this._time||!this._ts&&!O){j=0,M&&(y+=this._zTime=se?-gt:gt);break}}C=M}}if(j&&!a&&(this.pause(),j.render(k>=f?0:-gt)._zTime=k>=f?1:-1,this._ts))return this._start=W,zl(this),this.render(o,a,c);this._onUpdate&&!a&&Jn(this,"onUpdate",!0),(y===h&&this._tTime>=this.totalDuration()||!y&&f)&&(W===this._start||Math.abs(z)!==Math.abs(this._ts))&&(this._lock||((o||!v)&&(y===h&&this._ts>0||!y&&this._ts<0)&&_r(this,1),!a&&!(o<0&&!f)&&(y||f||!h)&&(Jn(this,y===h&&o>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<h&&this.timeScale()>0)&&this._prom())))}return this},i.add=function(o,a){var c=this;if(Xi(a)||(a=di(this,a,o)),!(o instanceof Ka)){if(vn(o))return o.forEach(function(f){return c.add(f,a)}),this;if(nn(o))return this.addLabel(o,a);if(Ot(o))o=$t.delayedCall(0,o);else return this}return this!==o?Ri(this,o,a):this},i.getChildren=function(o,a,c,f){o===void 0&&(o=!0),a===void 0&&(a=!0),c===void 0&&(c=!0),f===void 0&&(f=-pi);for(var h=[],v=this._first;v;)v._start>=f&&(v instanceof $t?a&&h.push(v):(c&&h.push(v),o&&h.push.apply(h,v.getChildren(!0,a,c)))),v=v._next;return h},i.getById=function(o){for(var a=this.getChildren(1,1,1),c=a.length;c--;)if(a[c].vars.id===o)return a[c]},i.remove=function(o){return nn(o)?this.removeLabel(o):Ot(o)?this.killTweensOf(o):(o.parent===this&&Bl(this,o),o===this._recent&&(this._recent=this._last),Qr(this))},i.totalTime=function(o,a){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Yt(Zn.time-(this._ts>0?o/this._ts:(this.totalDuration()-o)/-this._ts))),e.prototype.totalTime.call(this,o,a),this._forcing=0,this):this._tTime},i.addLabel=function(o,a){return this.labels[o]=di(this,a),this},i.removeLabel=function(o){return delete this.labels[o],this},i.addPause=function(o,a,c){var f=$t.delayedCall(0,a||Ya,c);return f.data="isPause",this._hasPause=1,Ri(this,f,di(this,o))},i.removePause=function(o){var a=this._first;for(o=di(this,o);a;)a._start===o&&a.data==="isPause"&&_r(a),a=a._next},i.killTweensOf=function(o,a,c){for(var f=this.getTweensOf(o,c),h=f.length;h--;)wr!==f[h]&&f[h].kill(o,a);return this},i.getTweensOf=function(o,a){for(var c=[],f=hi(o),h=this._first,v=Xi(a),y;h;)h instanceof $t?Ux(h._targets,f)&&(v?(!wr||h._initted&&h._ts)&&h.globalTime(0)<=a&&h.globalTime(h.totalDuration())>a:!a||h.isActive())&&c.push(h):(y=h.getTweensOf(f,a)).length&&c.push.apply(c,y),h=h._next;return c},i.tweenTo=function(o,a){a=a||{};var c=this,f=di(c,o),h=a,v=h.startAt,y=h.onStart,x=h.onStartParams,k=h.immediateRender,C,M=$t.to(c,ni({ease:a.ease||"none",lazy:!1,immediateRender:!1,time:f,overwrite:"auto",duration:a.duration||Math.abs((f-(v&&"time"in v?v.time:c._time))/c.timeScale())||gt,onStart:function(){if(c.pause(),!C){var R=a.duration||Math.abs((f-(v&&"time"in v?v.time:c._time))/c.timeScale());M._dur!==R&&qs(M,R,0,1).render(M._time,!0,!0),C=1}y&&y.apply(M,x||[])}},a));return k?M.render(0):M},i.tweenFromTo=function(o,a,c){return this.tweenTo(a,ni({startAt:{time:di(this,o)}},c))},i.recent=function(){return this._recent},i.nextLabel=function(o){return o===void 0&&(o=this._time),qm(this,di(this,o))},i.previousLabel=function(o){return o===void 0&&(o=this._time),qm(this,di(this,o),1)},i.currentLabel=function(o){return arguments.length?this.seek(o,!0):this.previousLabel(this._time+gt)},i.shiftChildren=function(o,a,c){c===void 0&&(c=0);for(var f=this._first,h=this.labels,v;f;)f._start>=c&&(f._start+=o,f._end+=o),f=f._next;if(a)for(v in h)h[v]>=c&&(h[v]+=o);return Qr(this)},i.invalidate=function(o){var a=this._first;for(this._lock=0;a;)a.invalidate(o),a=a._next;return e.prototype.invalidate.call(this,o)},i.clear=function(o){o===void 0&&(o=!0);for(var a=this._first,c;a;)c=a._next,this.remove(a),a=c;return this._dp&&(this._time=this._tTime=this._pTime=0),o&&(this.labels={}),Qr(this)},i.totalDuration=function(o){var a=0,c=this,f=c._last,h=pi,v,y,x;if(arguments.length)return c.timeScale((c._repeat<0?c.duration():c.totalDuration())/(c.reversed()?-o:o));if(c._dirty){for(x=c.parent;f;)v=f._prev,f._dirty&&f.totalDuration(),y=f._start,y>h&&c._sort&&f._ts&&!c._lock?(c._lock=1,Ri(c,f,y-f._delay,1)._lock=0):h=y,y<0&&f._ts&&(a-=y,(!x&&!c._dp||x&&x.smoothChildTiming)&&(c._start+=y/c._ts,c._time-=y,c._tTime-=y),c.shiftChildren(-y,!1,-1/0),h=0),f._end>a&&f._ts&&(a=f._end),f=v;qs(c,c===Lt&&c._time>a?c._time:a,1,1),c._dirty=0}return c._tDur},t.updateRoot=function(o){if(Lt._ts&&(zv(Lt,Pl(o,Lt)),Iv=Zn.frame),Zn.frame>=Vm){Vm+=ei.autoSleep||120;var a=Lt._first;if((!a||!a._ts)&&ei.autoSleep&&Zn._listeners.length<2){for(;a&&!a._ts;)a=a._next;a||Zn.sleep()}}},t})(Ka);ni(Cn.prototype,{_lock:0,_hasPause:0,_forcing:0});var uS=function(t,i,s,o,a,c,f){var h=new Wn(this._pt,t,i,0,1,py,null,a),v=0,y=0,x,k,C,M,E,R,O,j;for(h.b=s,h.e=o,s+="",o+="",(O=~o.indexOf("random("))&&(o=Xa(o)),c&&(j=[s,o],c(j,t,i),s=j[0],o=j[1]),k=s.match(Au)||[];x=Au.exec(o);)M=x[0],E=o.substring(v,x.index),C?C=(C+1)%5:E.substr(-5)==="rgba("&&(C=1),M!==k[y++]&&(R=parseFloat(k[y-1])||0,h._pt={_next:h._pt,p:E||y===1?E:",",s:R,c:M.charAt(1)==="="?Is(R,M)-R:parseFloat(M)-R,m:C&&C<4?Math.round:0},v=Au.lastIndex);return h.c=v<o.length?o.substring(v,o.length):"",h.fp=f,(Av.test(o)||O)&&(h.e=0),this._pt=h,h},Qd=function(t,i,s,o,a,c,f,h,v,y){Ot(o)&&(o=o(a||0,t,c));var x=t[i],k=s!=="get"?s:Ot(x)?v?t[i.indexOf("set")||!Ot(t["get"+i.substr(3)])?i:"get"+i.substr(3)](v):t[i]():x,C=Ot(x)?v?mS:dy:Jd,M;if(nn(o)&&(~o.indexOf("random(")&&(o=Xa(o)),o.charAt(1)==="="&&(M=Is(k,o)+(mn(k)||0),(M||M===0)&&(o=M))),!y||k!==o||fd)return!isNaN(k*o)&&o!==""?(M=new Wn(this._pt,t,i,+k||0,o-(k||0),typeof x=="boolean"?vS:fy,0,C),v&&(M.fp=v),f&&M.modifier(f,this,t),this._pt=M):(!x&&!(i in t)&&$d(i,o),uS.call(this,t,i,k,o,C,h||ei.stringFilter,v))},dS=function(t,i,s,o,a){if(Ot(t)&&(t=Ua(t,a,i,s,o)),!Ii(t)||t.style&&t.nodeType||vn(t)||Lv(t))return nn(t)?Ua(t,a,i,s,o):t;var c={},f;for(f in t)c[f]=Ua(t[f],a,i,s,o);return c},ly=function(t,i,s,o,a,c){var f,h,v,y;if(Qn[t]&&(f=new Qn[t]).init(a,f.rawVars?i[t]:dS(i[t],o,a,c,s),s,o,c)!==!1&&(s._pt=h=new Wn(s._pt,a,t,0,1,f.render,f,0,f.priority),s!==Ms))for(v=s._ptLookup[s._targets.indexOf(a)],y=f._props.length;y--;)v[f._props[y]]=h;return f},wr,fd,Zd=function e(t,i,s){var o=t.vars,a=o.ease,c=o.startAt,f=o.immediateRender,h=o.lazy,v=o.onUpdate,y=o.runBackwards,x=o.yoyoEase,k=o.keyframes,C=o.autoRevert,M=t._dur,E=t._startAt,R=t._targets,O=t.parent,j=O&&O.data==="nested"?O.vars.targets:R,z=t._overwrite==="auto"&&!Wd,W=t.timeline,V,H,J,N,G,se,fe,me,be,ye,We,Ae,ke;if(W&&(!k||!a)&&(a="none"),t._ease=Zr(a,Us.ease),t._yEase=x?ry(Zr(x===!0?a:x,Us.ease)):0,x&&t._yoyo&&!t._repeat&&(x=t._yEase,t._yEase=t._ease,t._ease=x),t._from=!W&&!!o.runBackwards,!W||k&&!o.stagger){if(me=R[0]?Kr(R[0]).harness:0,Ae=me&&o[me.prop],V=El(o,Yd),E&&(E._zTime<0&&E.progress(1),i<0&&y&&f&&!C?E.render(-1,!0):E.revert(y&&M?vl:zx),E._lazy=0),c){if(_r(t._startAt=$t.set(R,ni({data:"isStart",overwrite:!1,parent:O,immediateRender:!0,lazy:!E&&Vn(h),startAt:null,delay:0,onUpdate:v&&function(){return Jn(t,"onUpdate")},stagger:0},c))),t._startAt._dp=0,t._startAt._sat=t,i<0&&(cn||!f&&!C)&&t._startAt.revert(vl),f&&M&&i<=0&&s<=0){i&&(t._zTime=i);return}}else if(y&&M&&!E){if(i&&(f=!1),J=ni({overwrite:!1,data:"isFromStart",lazy:f&&!E&&Vn(h),immediateRender:f,stagger:0,parent:O},V),Ae&&(J[me.prop]=Ae),_r(t._startAt=$t.set(R,J)),t._startAt._dp=0,t._startAt._sat=t,i<0&&(cn?t._startAt.revert(vl):t._startAt.render(-1,!0)),t._zTime=i,!f)e(t._startAt,gt,gt);else if(!i)return}for(t._pt=t._ptCache=0,h=M&&Vn(h)||h&&!M,H=0;H<R.length;H++){if(G=R[H],fe=G._gsap||Gd(R)[H]._gsap,t._ptLookup[H]=ye={},ad[fe.id]&&Sr.length&&Tl(),We=j===R?H:j.indexOf(G),me&&(be=new me).init(G,Ae||V,t,We,j)!==!1&&(t._pt=N=new Wn(t._pt,G,be.name,0,1,be.render,be,0,be.priority),be._props.forEach(function(oe){ye[oe]=N}),be.priority&&(se=1)),!me||Ae)for(J in V)Qn[J]&&(be=ly(J,V,t,We,G,j))?be.priority&&(se=1):ye[J]=N=Qd.call(t,G,J,"get",V[J],We,j,0,o.stringFilter);t._op&&t._op[H]&&t.kill(G,t._op[H]),z&&t._pt&&(wr=t,Lt.killTweensOf(G,ye,t.globalTime(i)),ke=!t.parent,wr=0),t._pt&&h&&(ad[fe.id]=1)}se&&hy(t),t._onInit&&t._onInit(t)}t._onUpdate=v,t._initted=(!t._op||t._pt)&&!ke,k&&i<=0&&W.render(pi,!0,!0)},fS=function(t,i,s,o,a,c,f,h){var v=(t._pt&&t._ptCache||(t._ptCache={}))[i],y,x,k,C;if(!v)for(v=t._ptCache[i]=[],k=t._ptLookup,C=t._targets.length;C--;){if(y=k[C][i],y&&y.d&&y.d._pt)for(y=y.d._pt;y&&y.p!==i&&y.fp!==i;)y=y._next;if(!y)return fd=1,t.vars[i]="+=0",Zd(t,f),fd=0,h?$a(i+" not eligible for reset"):1;v.push(y)}for(C=v.length;C--;)x=v[C],y=x._pt||x,y.s=(o||o===0)&&!a?o:y.s+(o||0)+c*y.c,y.c=s-y.s,x.e&&(x.e=Ut(s)+mn(x.e)),x.b&&(x.b=y.s+mn(x.b))},pS=function(t,i){var s=t[0]?Kr(t[0]).harness:0,o=s&&s.aliases,a,c,f,h;if(!o)return i;a=Ws({},i);for(c in o)if(c in a)for(h=o[c].split(","),f=h.length;f--;)a[h[f]]=a[c];return a},hS=function(t,i,s,o){var a=i.ease||o||"power1.inOut",c,f;if(vn(i))f=s[t]||(s[t]=[]),i.forEach(function(h,v){return f.push({t:v/(i.length-1)*100,v:h,e:a})});else for(c in i)f=s[c]||(s[c]=[]),c==="ease"||f.push({t:parseFloat(t),v:i[c],e:a})},Ua=function(t,i,s,o,a){return Ot(t)?t.call(i,s,o,a):nn(t)&&~t.indexOf("random(")?Xa(t):t},cy=Xd+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",uy={};Un(cy+",id,stagger,delay,duration,paused,scrollTrigger",function(e){return uy[e]=1});var $t=(function(e){Pv(t,e);function t(s,o,a,c){var f;typeof o=="number"&&(a.duration=o,o=a,a=null),f=e.call(this,c?o:za(o))||this;var h=f.vars,v=h.duration,y=h.delay,x=h.immediateRender,k=h.stagger,C=h.overwrite,M=h.keyframes,E=h.defaults,R=h.scrollTrigger,O=h.yoyoEase,j=o.parent||Lt,z=(vn(s)||Lv(s)?Xi(s[0]):"length"in o)?[s]:hi(s),W,V,H,J,N,G,se,fe;if(f._targets=z.length?Gd(z):$a("GSAP target "+s+" not found. https://gsap.com",!ei.nullTargetWarn)||[],f._ptLookup=[],f._overwrite=C,M||k||pl(v)||pl(y)){if(o=f.vars,W=f.timeline=new Cn({data:"nested",defaults:E||{},targets:j&&j.data==="nested"?j.vars.targets:z}),W.kill(),W.parent=W._dp=$i(f),W._start=0,k||pl(v)||pl(y)){if(J=z.length,se=k&&Xv(k),Ii(k))for(N in k)~cy.indexOf(N)&&(fe||(fe={}),fe[N]=k[N]);for(V=0;V<J;V++)H=El(o,uy),H.stagger=0,O&&(H.yoyoEase=O),fe&&Ws(H,fe),G=z[V],H.duration=+Ua(v,$i(f),V,G,z),H.delay=(+Ua(y,$i(f),V,G,z)||0)-f._delay,!k&&J===1&&H.delay&&(f._delay=y=H.delay,f._start+=y,H.delay=0),W.to(G,H,se?se(V,G,z):0),W._ease=rt.none;W.duration()?v=y=0:f.timeline=0}else if(M){za(ni(W.vars.defaults,{ease:"none"})),W._ease=Zr(M.ease||o.ease||"none");var me=0,be,ye,We;if(vn(M))M.forEach(function(Ae){return W.to(z,Ae,">")}),W.duration();else{H={};for(N in M)N==="ease"||N==="easeEach"||hS(N,M[N],H,M.easeEach);for(N in H)for(be=H[N].sort(function(Ae,ke){return Ae.t-ke.t}),me=0,V=0;V<be.length;V++)ye=be[V],We={ease:ye.e,duration:(ye.t-(V?be[V-1].t:0))/100*v},We[N]=ye.v,W.to(z,We,me),me+=We.duration;W.duration()<v&&W.to({},{duration:v-W.duration()})}}v||f.duration(v=W.duration())}else f.timeline=0;return C===!0&&!Wd&&(wr=$i(f),Lt.killTweensOf(z),wr=0),Ri(j,$i(f),a),o.reversed&&f.reverse(),o.paused&&f.paused(!0),(x||!v&&!M&&f._start===Yt(j._time)&&Vn(x)&&Hx($i(f))&&j.data!=="nested")&&(f._tTime=-gt,f.render(Math.max(0,-y)||0)),R&&qv($i(f),R),f}var i=t.prototype;return i.render=function(o,a,c){var f=this._time,h=this._tDur,v=this._dur,y=o<0,x=o>h-gt&&!y?h:o<gt?0:o,k,C,M,E,R,O,j,z,W;if(!v)Yx(this,o,a,c);else if(x!==this._tTime||!o||c||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==y||this._lazy){if(k=x,z=this.timeline,this._repeat){if(E=v+this._rDelay,this._repeat<-1&&y)return this.totalTime(E*100+o,a,c);if(k=Yt(x%E),x===h?(M=this._repeat,k=v):(R=Yt(x/E),M=~~R,M&&M===R?(k=v,M--):k>v&&(k=v)),O=this._yoyo&&M&1,O&&(W=this._yEase,k=v-k),R=js(this._tTime,E),k===f&&!c&&this._initted&&M===R)return this._tTime=x,this;M!==R&&(z&&this._yEase&&sy(z,O),this.vars.repeatRefresh&&!O&&!this._lock&&k!==E&&this._initted&&(this._lock=c=1,this.render(Yt(E*M),!0).invalidate()._lock=0))}if(!this._initted){if(Hv(this,y?o:k,c,a,x))return this._tTime=0,this;if(f!==this._time&&!(c&&this.vars.repeatRefresh&&M!==R))return this;if(v!==this._dur)return this.render(o,a,c)}if(this._tTime=x,this._time=k,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=j=(W||this._ease)(k/v),this._from&&(this.ratio=j=1-j),!f&&x&&!a&&!R&&(Jn(this,"onStart"),this._tTime!==x))return this;for(C=this._pt;C;)C.r(j,C.d),C=C._next;z&&z.render(o<0?o:z._dur*z._ease(k/this._dur),a,c)||this._startAt&&(this._zTime=o),this._onUpdate&&!a&&(y&&od(this,o,a,c),Jn(this,"onUpdate")),this._repeat&&M!==R&&this.vars.onRepeat&&!a&&this.parent&&Jn(this,"onRepeat"),(x===this._tDur||!x)&&this._tTime===x&&(y&&!this._onUpdate&&od(this,o,!0,!0),(o||!v)&&(x===this._tDur&&this._ts>0||!x&&this._ts<0)&&_r(this,1),!a&&!(y&&!f)&&(x||f||O)&&(Jn(this,x===h?"onComplete":"onReverseComplete",!0),this._prom&&!(x<h&&this.timeScale()>0)&&this._prom()))}return this},i.targets=function(){return this._targets},i.invalidate=function(o){return(!o||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(o),e.prototype.invalidate.call(this,o)},i.resetTo=function(o,a,c,f,h){Ga||Zn.wake(),this._ts||this.play();var v=Math.min(this._dur,(this._dp._time-this._start)*this._ts),y;return this._initted||Zd(this,v),y=this._ease(v/this._dur),fS(this,o,a,c,f,y,v,h)?this.resetTo(o,a,c,f,1):(Vl(this,0),this.parent||Wv(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},i.kill=function(o,a){if(a===void 0&&(a="all"),!o&&(!a||a==="all"))return this._lazy=this._pt=0,this.parent?Fa(this):this.scrollTrigger&&this.scrollTrigger.kill(!!cn),this;if(this.timeline){var c=this.timeline.totalDuration();return this.timeline.killTweensOf(o,a,wr&&wr.vars.overwrite!==!0)._first||Fa(this),this.parent&&c!==this.timeline.totalDuration()&&qs(this,this._dur*this.timeline._tDur/c,0,1),this}var f=this._targets,h=o?hi(o):f,v=this._ptLookup,y=this._pt,x,k,C,M,E,R,O;if((!a||a==="all")&&jx(f,h))return a==="all"&&(this._pt=0),Fa(this);for(x=this._op=this._op||[],a!=="all"&&(nn(a)&&(E={},Un(a,function(j){return E[j]=1}),a=E),a=pS(f,a)),O=f.length;O--;)if(~h.indexOf(f[O])){k=v[O],a==="all"?(x[O]=a,M=k,C={}):(C=x[O]=x[O]||{},M=a);for(E in M)R=k&&k[E],R&&((!("kill"in R.d)||R.d.kill(E)===!0)&&Bl(this,R,"_pt"),delete k[E]),C!=="all"&&(C[E]=1)}return this._initted&&!this._pt&&y&&Fa(this),this},t.to=function(o,a){return new t(o,a,arguments[2])},t.from=function(o,a){return Va(1,arguments)},t.delayedCall=function(o,a,c,f){return new t(a,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:o,onComplete:a,onReverseComplete:a,onCompleteParams:c,onReverseCompleteParams:c,callbackScope:f})},t.fromTo=function(o,a,c){return Va(2,arguments)},t.set=function(o,a){return a.duration=0,a.repeatDelay||(a.repeat=0),new t(o,a)},t.killTweensOf=function(o,a,c){return Lt.killTweensOf(o,a,c)},t})(Ka);ni($t.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Un("staggerTo,staggerFrom,staggerFromTo",function(e){$t[e]=function(){var t=new Cn,i=cd.call(arguments,0);return i.splice(e==="staggerFromTo"?5:4,0,0),t[e].apply(t,i)}});var Jd=function(t,i,s){return t[i]=s},dy=function(t,i,s){return t[i](s)},mS=function(t,i,s,o){return t[i](o.fp,s)},gS=function(t,i,s){return t.setAttribute(i,s)},ef=function(t,i){return Ot(t[i])?dy:jd(t[i])&&t.setAttribute?gS:Jd},fy=function(t,i){return i.set(i.t,i.p,Math.round((i.s+i.c*t)*1e6)/1e6,i)},vS=function(t,i){return i.set(i.t,i.p,!!(i.s+i.c*t),i)},py=function(t,i){var s=i._pt,o="";if(!t&&i.b)o=i.b;else if(t===1&&i.e)o=i.e;else{for(;s;)o=s.p+(s.m?s.m(s.s+s.c*t):Math.round((s.s+s.c*t)*1e4)/1e4)+o,s=s._next;o+=i.c}i.set(i.t,i.p,o,i)},tf=function(t,i){for(var s=i._pt;s;)s.r(t,s.d),s=s._next},yS=function(t,i,s,o){for(var a=this._pt,c;a;)c=a._next,a.p===o&&a.modifier(t,i,s),a=c},wS=function(t){for(var i=this._pt,s,o;i;)o=i._next,i.p===t&&!i.op||i.op===t?Bl(this,i,"_pt"):i.dep||(s=1),i=o;return!s},bS=function(t,i,s,o){o.mSet(t,i,o.m.call(o.tween,s,o.mt),o)},hy=function(t){for(var i=t._pt,s,o,a,c;i;){for(s=i._next,o=a;o&&o.pr>i.pr;)o=o._next;(i._prev=o?o._prev:c)?i._prev._next=i:a=i,(i._next=o)?o._prev=i:c=i,i=s}t._pt=a},Wn=(function(){function e(i,s,o,a,c,f,h,v,y){this.t=s,this.s=a,this.c=c,this.p=o,this.r=f||fy,this.d=h||this,this.set=v||Jd,this.pr=y||0,this._next=i,i&&(i._prev=this)}var t=e.prototype;return t.modifier=function(s,o,a){this.mSet=this.mSet||this.set,this.set=bS,this.m=s,this.mt=a,this.tween=o},e})();Un(Xd+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(e){return Yd[e]=1});ti.TweenMax=ti.TweenLite=$t;ti.TimelineLite=ti.TimelineMax=Cn;Lt=new Cn({sortChildren:!1,defaults:Us,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});ei.stringFilter=iy;var Jr=[],wl={},xS=[],$m=0,SS=0,Iu=function(t){return(wl[t]||xS).map(function(i){return i()})},pd=function(){var t=Date.now(),i=[];t-$m>2&&(Iu("matchMediaInit"),Jr.forEach(function(s){var o=s.queries,a=s.conditions,c,f,h,v;for(f in o)c=Ai.matchMedia(o[f]).matches,c&&(h=1),c!==a[f]&&(a[f]=c,v=1);v&&(s.revert(),h&&i.push(s))}),Iu("matchMediaRevert"),i.forEach(function(s){return s.onMatch(s,function(o){return s.add(null,o)})}),$m=t,Iu("matchMedia"))},my=(function(){function e(i,s){this.selector=s&&ud(s),this.data=[],this._r=[],this.isReverted=!1,this.id=SS++,i&&this.add(i)}var t=e.prototype;return t.add=function(s,o,a){Ot(s)&&(a=o,o=s,s=Ot);var c=this,f=function(){var v=Tt,y=c.selector,x;return v&&v!==c&&v.data.push(c),a&&(c.selector=ud(a)),Tt=c,x=o.apply(c,arguments),Ot(x)&&c._r.push(x),Tt=v,c.selector=y,c.isReverted=!1,x};return c.last=f,s===Ot?f(c,function(h){return c.add(null,h)}):s?c[s]=f:f},t.ignore=function(s){var o=Tt;Tt=null,s(this),Tt=o},t.getTweens=function(){var s=[];return this.data.forEach(function(o){return o instanceof e?s.push.apply(s,o.getTweens()):o instanceof $t&&!(o.parent&&o.parent.data==="nested")&&s.push(o)}),s},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(s,o){var a=this;if(s?(function(){for(var f=a.getTweens(),h=a.data.length,v;h--;)v=a.data[h],v.data==="isFlip"&&(v.revert(),v.getChildren(!0,!0,!1).forEach(function(y){return f.splice(f.indexOf(y),1)}));for(f.map(function(y){return{g:y._dur||y._delay||y._sat&&!y._sat.vars.immediateRender?y.globalTime(0):-1/0,t:y}}).sort(function(y,x){return x.g-y.g||-1/0}).forEach(function(y){return y.t.revert(s)}),h=a.data.length;h--;)v=a.data[h],v instanceof Cn?v.data!=="nested"&&(v.scrollTrigger&&v.scrollTrigger.revert(),v.kill()):!(v instanceof $t)&&v.revert&&v.revert(s);a._r.forEach(function(y){return y(s,a)}),a.isReverted=!0})():this.data.forEach(function(f){return f.kill&&f.kill()}),this.clear(),o)for(var c=Jr.length;c--;)Jr[c].id===this.id&&Jr.splice(c,1)},t.revert=function(s){this.kill(s||{})},e})(),kS=(function(){function e(i){this.contexts=[],this.scope=i,Tt&&Tt.data.push(this)}var t=e.prototype;return t.add=function(s,o,a){Ii(s)||(s={matches:s});var c=new my(0,a||this.scope),f=c.conditions={},h,v,y;Tt&&!c.selector&&(c.selector=Tt.selector),this.contexts.push(c),o=c.add("onMatch",o),c.queries=s;for(v in s)v==="all"?y=1:(h=Ai.matchMedia(s[v]),h&&(Jr.indexOf(c)<0&&Jr.push(c),(f[v]=h.matches)&&(y=1),h.addListener?h.addListener(pd):h.addEventListener("change",pd)));return y&&o(c,function(x){return c.add(null,x)}),this},t.revert=function(s){this.kill(s||{})},t.kill=function(s){this.contexts.forEach(function(o){return o.kill(s,!0)})},e})(),Dl={registerPlugin:function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];i.forEach(function(o){return ey(o)})},timeline:function(t){return new Cn(t)},getTweensOf:function(t,i){return Lt.getTweensOf(t,i)},getProperty:function(t,i,s,o){nn(t)&&(t=hi(t)[0]);var a=Kr(t||{}).get,c=s?Uv:Vv;return s==="native"&&(s=""),t&&(i?c((Qn[i]&&Qn[i].get||a)(t,i,s,o)):function(f,h,v){return c((Qn[f]&&Qn[f].get||a)(t,f,h,v))})},quickSetter:function(t,i,s){if(t=hi(t),t.length>1){var o=t.map(function(y){return qn.quickSetter(y,i,s)}),a=o.length;return function(y){for(var x=a;x--;)o[x](y)}}t=t[0]||{};var c=Qn[i],f=Kr(t),h=f.harness&&(f.harness.aliases||{})[i]||i,v=c?function(y){var x=new c;Ms._pt=0,x.init(t,s?y+s:y,Ms,0,[t]),x.render(1,x),Ms._pt&&tf(1,Ms)}:f.set(t,h);return c?v:function(y){return v(t,h,s?y+s:y,f,1)}},quickTo:function(t,i,s){var o,a=qn.to(t,ni((o={},o[i]="+=0.1",o.paused=!0,o.stagger=0,o),s||{})),c=function(h,v,y){return a.resetTo(i,h,v,y)};return c.tween=a,c},isTweening:function(t){return Lt.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Zr(t.ease,Us.ease)),Um(Us,t||{})},config:function(t){return Um(ei,t||{})},registerEffect:function(t){var i=t.name,s=t.effect,o=t.plugins,a=t.defaults,c=t.extendTimeline;(o||"").split(",").forEach(function(f){return f&&!Qn[f]&&!ti[f]&&$a(i+" effect requires "+f+" plugin.")}),Ru[i]=function(f,h,v){return s(hi(f),ni(h||{},a),v)},c&&(Cn.prototype[i]=function(f,h,v){return this.add(Ru[i](f,Ii(h)?h:(v=h)&&{},this),v)})},registerEase:function(t,i){rt[t]=Zr(i)},parseEase:function(t,i){return arguments.length?Zr(t,i):rt},getById:function(t){return Lt.getById(t)},exportRoot:function(t,i){t===void 0&&(t={});var s=new Cn(t),o,a;for(s.smoothChildTiming=Vn(t.smoothChildTiming),Lt.remove(s),s._dp=0,s._time=s._tTime=Lt._time,o=Lt._first;o;)a=o._next,(i||!(!o._dur&&o instanceof $t&&o.vars.onComplete===o._targets[0]))&&Ri(s,o,o._start-o._delay),o=a;return Ri(Lt,s,0),s},context:function(t,i){return t?new my(t,i):Tt},matchMedia:function(t){return new kS(t)},matchMediaRefresh:function(){return Jr.forEach(function(t){var i=t.conditions,s,o;for(o in i)i[o]&&(i[o]=!1,s=1);s&&t.revert()})||pd()},addEventListener:function(t,i){var s=wl[t]||(wl[t]=[]);~s.indexOf(i)||s.push(i)},removeEventListener:function(t,i){var s=wl[t],o=s&&s.indexOf(i);o>=0&&s.splice(o,1)},utils:{wrap:tS,wrapYoyo:nS,distribute:Xv,random:Kv,snap:Gv,normalize:eS,getUnit:mn,clamp:Kx,splitColor:ty,toArray:hi,selector:ud,mapRange:Zv,pipe:Zx,unitize:Jx,interpolate:iS,shuffle:Yv},install:Ov,effects:Ru,ticker:Zn,updateRoot:Cn.updateRoot,plugins:Qn,globalTimeline:Lt,core:{PropTween:Wn,globals:Nv,Tween:$t,Timeline:Cn,Animation:Ka,getCache:Kr,_removeLinkedListItem:Bl,reverting:function(){return cn},context:function(t){return t&&Tt&&(Tt.data.push(t),t._ctx=Tt),Tt},suppressOverwrites:function(t){return Wd=t}}};Un("to,from,fromTo,delayedCall,set,killTweensOf",function(e){return Dl[e]=$t[e]});Zn.add(Cn.updateRoot);Ms=Dl.to({},{duration:0});var _S=function(t,i){for(var s=t._pt;s&&s.p!==i&&s.op!==i&&s.fp!==i;)s=s._next;return s},CS=function(t,i){var s=t._targets,o,a,c;for(o in i)for(a=s.length;a--;)c=t._ptLookup[a][o],c&&(c=c.d)&&(c._pt&&(c=_S(c,o)),c&&c.modifier&&c.modifier(i[o],t,s[a],o))},Bu=function(t,i){return{name:t,headless:1,rawVars:1,init:function(o,a,c){c._onInit=function(f){var h,v;if(nn(a)&&(h={},Un(a,function(y){return h[y]=1}),a=h),i){h={};for(v in a)h[v]=i(a[v]);a=h}CS(f,a)}}}},qn=Dl.registerPlugin({name:"attr",init:function(t,i,s,o,a){var c,f,h;this.tween=s;for(c in i)h=t.getAttribute(c)||"",f=this.add(t,"setAttribute",(h||0)+"",i[c],o,a,0,0,c),f.op=c,f.b=h,this._props.push(c)},render:function(t,i){for(var s=i._pt;s;)cn?s.set(s.t,s.p,s.b,s):s.r(t,s.d),s=s._next}},{name:"endArray",headless:1,init:function(t,i){for(var s=i.length;s--;)this.add(t,s,t[s]||0,i[s],0,0,0,0,0,1)}},Bu("roundProps",dd),Bu("modifiers"),Bu("snap",Gv))||Dl;$t.version=Cn.version=qn.version="3.13.0";Fv=1;qd()&&Hs();rt.Power0;rt.Power1;rt.Power2;rt.Power3;rt.Power4;rt.Linear;rt.Quad;rt.Cubic;rt.Quart;rt.Quint;rt.Strong;rt.Elastic;rt.Back;rt.SteppedEase;rt.Bounce;rt.Sine;rt.Expo;rt.Circ;var Ym,br,Bs,nf,Yr,Xm,rf,TS=function(){return typeof window<"u"},Gi={},Hr=180/Math.PI,zs=Math.PI/180,Ds=Math.atan2,Gm=1e8,sf=/([A-Z])/g,ES=/(left|right|width|margin|padding|x)/i,PS=/[\s,\(]\S/,Fi={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},hd=function(t,i){return i.set(i.t,i.p,Math.round((i.s+i.c*t)*1e4)/1e4+i.u,i)},DS=function(t,i){return i.set(i.t,i.p,t===1?i.e:Math.round((i.s+i.c*t)*1e4)/1e4+i.u,i)},LS=function(t,i){return i.set(i.t,i.p,t?Math.round((i.s+i.c*t)*1e4)/1e4+i.u:i.b,i)},MS=function(t,i){var s=i.s+i.c*t;i.set(i.t,i.p,~~(s+(s<0?-.5:.5))+i.u,i)},gy=function(t,i){return i.set(i.t,i.p,t?i.e:i.b,i)},vy=function(t,i){return i.set(i.t,i.p,t!==1?i.b:i.e,i)},AS=function(t,i,s){return t.style[i]=s},RS=function(t,i,s){return t.style.setProperty(i,s)},FS=function(t,i,s){return t._gsap[i]=s},OS=function(t,i,s){return t._gsap.scaleX=t._gsap.scaleY=s},NS=function(t,i,s,o,a){var c=t._gsap;c.scaleX=c.scaleY=s,c.renderTransform(a,c)},IS=function(t,i,s,o,a){var c=t._gsap;c[i]=s,c.renderTransform(a,c)},Mt="transform",jn=Mt+"Origin",BS=function e(t,i){var s=this,o=this.target,a=o.style,c=o._gsap;if(t in Gi&&a){if(this.tfm=this.tfm||{},t!=="transform")t=Fi[t]||t,~t.indexOf(",")?t.split(",").forEach(function(f){return s.tfm[f]=Yi(o,f)}):this.tfm[t]=c.x?c[t]:Yi(o,t),t===jn&&(this.tfm.zOrigin=c.zOrigin);else return Fi.transform.split(",").forEach(function(f){return e.call(s,f,i)});if(this.props.indexOf(Mt)>=0)return;c.svg&&(this.svgo=o.getAttribute("data-svg-origin"),this.props.push(jn,i,"")),t=Mt}(a||i)&&this.props.push(t,i,a[t])},yy=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},zS=function(){var t=this.props,i=this.target,s=i.style,o=i._gsap,a,c;for(a=0;a<t.length;a+=3)t[a+1]?t[a+1]===2?i[t[a]](t[a+2]):i[t[a]]=t[a+2]:t[a+2]?s[t[a]]=t[a+2]:s.removeProperty(t[a].substr(0,2)==="--"?t[a]:t[a].replace(sf,"-$1").toLowerCase());if(this.tfm){for(c in this.tfm)o[c]=this.tfm[c];o.svg&&(o.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),a=rf(),(!a||!a.isStart)&&!s[Mt]&&(yy(s),o.zOrigin&&s[jn]&&(s[jn]+=" "+o.zOrigin+"px",o.zOrigin=0,o.renderTransform()),o.uncache=1)}},wy=function(t,i){var s={target:t,props:[],revert:zS,save:BS};return t._gsap||qn.core.getCache(t),i&&t.style&&t.nodeType&&i.split(",").forEach(function(o){return s.save(o)}),s},by,md=function(t,i){var s=br.createElementNS?br.createElementNS((i||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):br.createElement(t);return s&&s.style?s:br.createElement(t)},mi=function e(t,i,s){var o=getComputedStyle(t);return o[i]||o.getPropertyValue(i.replace(sf,"-$1").toLowerCase())||o.getPropertyValue(i)||!s&&e(t,$s(i)||i,1)||""},Km="O,Moz,ms,Ms,Webkit".split(","),$s=function(t,i,s){var o=i||Yr,a=o.style,c=5;if(t in a&&!s)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);c--&&!(Km[c]+t in a););return c<0?null:(c===3?"ms":c>=0?Km[c]:"")+t},gd=function(){TS()&&window.document&&(Ym=window,br=Ym.document,Bs=br.documentElement,Yr=md("div")||{style:{}},md("div"),Mt=$s(Mt),jn=Mt+"Origin",Yr.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",by=!!$s("perspective"),rf=qn.core.reverting,nf=1)},Qm=function(t){var i=t.ownerSVGElement,s=md("svg",i&&i.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),o=t.cloneNode(!0),a;o.style.display="block",s.appendChild(o),Bs.appendChild(s);try{a=o.getBBox()}catch{}return s.removeChild(o),Bs.removeChild(s),a},Zm=function(t,i){for(var s=i.length;s--;)if(t.hasAttribute(i[s]))return t.getAttribute(i[s])},xy=function(t){var i,s;try{i=t.getBBox()}catch{i=Qm(t),s=1}return i&&(i.width||i.height)||s||(i=Qm(t)),i&&!i.width&&!i.x&&!i.y?{x:+Zm(t,["x","cx","x1"])||0,y:+Zm(t,["y","cy","y1"])||0,width:0,height:0}:i},Sy=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&xy(t))},ns=function(t,i){if(i){var s=t.style,o;i in Gi&&i!==jn&&(i=Mt),s.removeProperty?(o=i.substr(0,2),(o==="ms"||i.substr(0,6)==="webkit")&&(i="-"+i),s.removeProperty(o==="--"?i:i.replace(sf,"-$1").toLowerCase())):s.removeAttribute(i)}},xr=function(t,i,s,o,a,c){var f=new Wn(t._pt,i,s,0,1,c?vy:gy);return t._pt=f,f.b=o,f.e=a,t._props.push(s),f},Jm={deg:1,rad:1,turn:1},VS={grid:1,flex:1},Cr=function e(t,i,s,o){var a=parseFloat(s)||0,c=(s+"").trim().substr((a+"").length)||"px",f=Yr.style,h=ES.test(i),v=t.tagName.toLowerCase()==="svg",y=(v?"client":"offset")+(h?"Width":"Height"),x=100,k=o==="px",C=o==="%",M,E,R,O;if(o===c||!a||Jm[o]||Jm[c])return a;if(c!=="px"&&!k&&(a=e(t,i,s,"px")),O=t.getCTM&&Sy(t),(C||c==="%")&&(Gi[i]||~i.indexOf("adius")))return M=O?t.getBBox()[h?"width":"height"]:t[y],Ut(C?a/M*x:a/100*M);if(f[h?"width":"height"]=x+(k?c:o),E=o!=="rem"&&~i.indexOf("adius")||o==="em"&&t.appendChild&&!v?t:t.parentNode,O&&(E=(t.ownerSVGElement||{}).parentNode),(!E||E===br||!E.appendChild)&&(E=br.body),R=E._gsap,R&&C&&R.width&&h&&R.time===Zn.time&&!R.uncache)return Ut(a/R.width*x);if(C&&(i==="height"||i==="width")){var j=t.style[i];t.style[i]=x+o,M=t[y],j?t.style[i]=j:ns(t,i)}else(C||c==="%")&&!VS[mi(E,"display")]&&(f.position=mi(t,"position")),E===t&&(f.position="static"),E.appendChild(Yr),M=Yr[y],E.removeChild(Yr),f.position="absolute";return h&&C&&(R=Kr(E),R.time=Zn.time,R.width=E[y]),Ut(k?M*a/x:M&&a?x/M*a:0)},Yi=function(t,i,s,o){var a;return nf||gd(),i in Fi&&i!=="transform"&&(i=Fi[i],~i.indexOf(",")&&(i=i.split(",")[0])),Gi[i]&&i!=="transform"?(a=Za(t,o),a=i!=="transformOrigin"?a[i]:a.svg?a.origin:Ml(mi(t,jn))+" "+a.zOrigin+"px"):(a=t.style[i],(!a||a==="auto"||o||~(a+"").indexOf("calc("))&&(a=Ll[i]&&Ll[i](t,i,s)||mi(t,i)||Bv(t,i)||(i==="opacity"?1:0))),s&&!~(a+"").trim().indexOf(" ")?Cr(t,i,a,s)+s:a},US=function(t,i,s,o){if(!s||s==="none"){var a=$s(i,t,1),c=a&&mi(t,a,1);c&&c!==s?(i=a,s=c):i==="borderColor"&&(s=mi(t,"borderTopColor"))}var f=new Wn(this._pt,t.style,i,0,1,py),h=0,v=0,y,x,k,C,M,E,R,O,j,z,W,V;if(f.b=s,f.e=o,s+="",o+="",o.substring(0,6)==="var(--"&&(o=mi(t,o.substring(4,o.indexOf(")")))),o==="auto"&&(E=t.style[i],t.style[i]=o,o=mi(t,i)||o,E?t.style[i]=E:ns(t,i)),y=[s,o],iy(y),s=y[0],o=y[1],k=s.match(Ls)||[],V=o.match(Ls)||[],V.length){for(;x=Ls.exec(o);)R=x[0],j=o.substring(h,x.index),M?M=(M+1)%5:(j.substr(-5)==="rgba("||j.substr(-5)==="hsla(")&&(M=1),R!==(E=k[v++]||"")&&(C=parseFloat(E)||0,W=E.substr((C+"").length),R.charAt(1)==="="&&(R=Is(C,R)+W),O=parseFloat(R),z=R.substr((O+"").length),h=Ls.lastIndex-z.length,z||(z=z||ei.units[i]||W,h===o.length&&(o+=z,f.e+=z)),W!==z&&(C=Cr(t,i,E,z)||0),f._pt={_next:f._pt,p:j||v===1?j:",",s:C,c:O-C,m:M&&M<4||i==="zIndex"?Math.round:0});f.c=h<o.length?o.substring(h,o.length):""}else f.r=i==="display"&&o==="none"?vy:gy;return Av.test(o)&&(f.e=0),this._pt=f,f},eg={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},WS=function(t){var i=t.split(" "),s=i[0],o=i[1]||"50%";return(s==="top"||s==="bottom"||o==="left"||o==="right")&&(t=s,s=o,o=t),i[0]=eg[s]||s,i[1]=eg[o]||o,i.join(" ")},jS=function(t,i){if(i.tween&&i.tween._time===i.tween._dur){var s=i.t,o=s.style,a=i.u,c=s._gsap,f,h,v;if(a==="all"||a===!0)o.cssText="",h=1;else for(a=a.split(","),v=a.length;--v>-1;)f=a[v],Gi[f]&&(h=1,f=f==="transformOrigin"?jn:Mt),ns(s,f);h&&(ns(s,Mt),c&&(c.svg&&s.removeAttribute("transform"),o.scale=o.rotate=o.translate="none",Za(s,1),c.uncache=1,yy(o)))}},Ll={clearProps:function(t,i,s,o,a){if(a.data!=="isFromStart"){var c=t._pt=new Wn(t._pt,i,s,0,0,jS);return c.u=o,c.pr=-10,c.tween=a,t._props.push(s),1}}},Qa=[1,0,0,1,0,0],ky={},_y=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},tg=function(t){var i=mi(t,Mt);return _y(i)?Qa:i.substr(7).match(Mv).map(Ut)},af=function(t,i){var s=t._gsap||Kr(t),o=t.style,a=tg(t),c,f,h,v;return s.svg&&t.getAttribute("transform")?(h=t.transform.baseVal.consolidate().matrix,a=[h.a,h.b,h.c,h.d,h.e,h.f],a.join(",")==="1,0,0,1,0,0"?Qa:a):(a===Qa&&!t.offsetParent&&t!==Bs&&!s.svg&&(h=o.display,o.display="block",c=t.parentNode,(!c||!t.offsetParent&&!t.getBoundingClientRect().width)&&(v=1,f=t.nextElementSibling,Bs.appendChild(t)),a=tg(t),h?o.display=h:ns(t,"display"),v&&(f?c.insertBefore(t,f):c?c.appendChild(t):Bs.removeChild(t))),i&&a.length>6?[a[0],a[1],a[4],a[5],a[12],a[13]]:a)},vd=function(t,i,s,o,a,c){var f=t._gsap,h=a||af(t,!0),v=f.xOrigin||0,y=f.yOrigin||0,x=f.xOffset||0,k=f.yOffset||0,C=h[0],M=h[1],E=h[2],R=h[3],O=h[4],j=h[5],z=i.split(" "),W=parseFloat(z[0])||0,V=parseFloat(z[1])||0,H,J,N,G;s?h!==Qa&&(J=C*R-M*E)&&(N=W*(R/J)+V*(-E/J)+(E*j-R*O)/J,G=W*(-M/J)+V*(C/J)-(C*j-M*O)/J,W=N,V=G):(H=xy(t),W=H.x+(~z[0].indexOf("%")?W/100*H.width:W),V=H.y+(~(z[1]||z[0]).indexOf("%")?V/100*H.height:V)),o||o!==!1&&f.smooth?(O=W-v,j=V-y,f.xOffset=x+(O*C+j*E)-O,f.yOffset=k+(O*M+j*R)-j):f.xOffset=f.yOffset=0,f.xOrigin=W,f.yOrigin=V,f.smooth=!!o,f.origin=i,f.originIsAbsolute=!!s,t.style[jn]="0px 0px",c&&(xr(c,f,"xOrigin",v,W),xr(c,f,"yOrigin",y,V),xr(c,f,"xOffset",x,f.xOffset),xr(c,f,"yOffset",k,f.yOffset)),t.setAttribute("data-svg-origin",W+" "+V)},Za=function(t,i){var s=t._gsap||new oy(t);if("x"in s&&!i&&!s.uncache)return s;var o=t.style,a=s.scaleX<0,c="px",f="deg",h=getComputedStyle(t),v=mi(t,jn)||"0",y,x,k,C,M,E,R,O,j,z,W,V,H,J,N,G,se,fe,me,be,ye,We,Ae,ke,oe,_e,u,p,g,b,S,_;return y=x=k=E=R=O=j=z=W=0,C=M=1,s.svg=!!(t.getCTM&&Sy(t)),h.translate&&((h.translate!=="none"||h.scale!=="none"||h.rotate!=="none")&&(o[Mt]=(h.translate!=="none"?"translate3d("+(h.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(h.rotate!=="none"?"rotate("+h.rotate+") ":"")+(h.scale!=="none"?"scale("+h.scale.split(" ").join(",")+") ":"")+(h[Mt]!=="none"?h[Mt]:"")),o.scale=o.rotate=o.translate="none"),J=af(t,s.svg),s.svg&&(s.uncache?(oe=t.getBBox(),v=s.xOrigin-oe.x+"px "+(s.yOrigin-oe.y)+"px",ke=""):ke=!i&&t.getAttribute("data-svg-origin"),vd(t,ke||v,!!ke||s.originIsAbsolute,s.smooth!==!1,J)),V=s.xOrigin||0,H=s.yOrigin||0,J!==Qa&&(fe=J[0],me=J[1],be=J[2],ye=J[3],y=We=J[4],x=Ae=J[5],J.length===6?(C=Math.sqrt(fe*fe+me*me),M=Math.sqrt(ye*ye+be*be),E=fe||me?Ds(me,fe)*Hr:0,j=be||ye?Ds(be,ye)*Hr+E:0,j&&(M*=Math.abs(Math.cos(j*zs))),s.svg&&(y-=V-(V*fe+H*be),x-=H-(V*me+H*ye))):(_=J[6],b=J[7],u=J[8],p=J[9],g=J[10],S=J[11],y=J[12],x=J[13],k=J[14],N=Ds(_,g),R=N*Hr,N&&(G=Math.cos(-N),se=Math.sin(-N),ke=We*G+u*se,oe=Ae*G+p*se,_e=_*G+g*se,u=We*-se+u*G,p=Ae*-se+p*G,g=_*-se+g*G,S=b*-se+S*G,We=ke,Ae=oe,_=_e),N=Ds(-be,g),O=N*Hr,N&&(G=Math.cos(-N),se=Math.sin(-N),ke=fe*G-u*se,oe=me*G-p*se,_e=be*G-g*se,S=ye*se+S*G,fe=ke,me=oe,be=_e),N=Ds(me,fe),E=N*Hr,N&&(G=Math.cos(N),se=Math.sin(N),ke=fe*G+me*se,oe=We*G+Ae*se,me=me*G-fe*se,Ae=Ae*G-We*se,fe=ke,We=oe),R&&Math.abs(R)+Math.abs(E)>359.9&&(R=E=0,O=180-O),C=Ut(Math.sqrt(fe*fe+me*me+be*be)),M=Ut(Math.sqrt(Ae*Ae+_*_)),N=Ds(We,Ae),j=Math.abs(N)>2e-4?N*Hr:0,W=S?1/(S<0?-S:S):0),s.svg&&(ke=t.getAttribute("transform"),s.forceCSS=t.setAttribute("transform","")||!_y(mi(t,Mt)),ke&&t.setAttribute("transform",ke))),Math.abs(j)>90&&Math.abs(j)<270&&(a?(C*=-1,j+=E<=0?180:-180,E+=E<=0?180:-180):(M*=-1,j+=j<=0?180:-180)),i=i||s.uncache,s.x=y-((s.xPercent=y&&(!i&&s.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-y)?-50:0)))?t.offsetWidth*s.xPercent/100:0)+c,s.y=x-((s.yPercent=x&&(!i&&s.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-x)?-50:0)))?t.offsetHeight*s.yPercent/100:0)+c,s.z=k+c,s.scaleX=Ut(C),s.scaleY=Ut(M),s.rotation=Ut(E)+f,s.rotationX=Ut(R)+f,s.rotationY=Ut(O)+f,s.skewX=j+f,s.skewY=z+f,s.transformPerspective=W+c,(s.zOrigin=parseFloat(v.split(" ")[2])||!i&&s.zOrigin||0)&&(o[jn]=Ml(v)),s.xOffset=s.yOffset=0,s.force3D=ei.force3D,s.renderTransform=s.svg?HS:by?Cy:qS,s.uncache=0,s},Ml=function(t){return(t=t.split(" "))[0]+" "+t[1]},zu=function(t,i,s){var o=mn(i);return Ut(parseFloat(i)+parseFloat(Cr(t,"x",s+"px",o)))+o},qS=function(t,i){i.z="0px",i.rotationY=i.rotationX="0deg",i.force3D=0,Cy(t,i)},Wr="0deg",Ma="0px",jr=") ",Cy=function(t,i){var s=i||this,o=s.xPercent,a=s.yPercent,c=s.x,f=s.y,h=s.z,v=s.rotation,y=s.rotationY,x=s.rotationX,k=s.skewX,C=s.skewY,M=s.scaleX,E=s.scaleY,R=s.transformPerspective,O=s.force3D,j=s.target,z=s.zOrigin,W="",V=O==="auto"&&t&&t!==1||O===!0;if(z&&(x!==Wr||y!==Wr)){var H=parseFloat(y)*zs,J=Math.sin(H),N=Math.cos(H),G;H=parseFloat(x)*zs,G=Math.cos(H),c=zu(j,c,J*G*-z),f=zu(j,f,-Math.sin(H)*-z),h=zu(j,h,N*G*-z+z)}R!==Ma&&(W+="perspective("+R+jr),(o||a)&&(W+="translate("+o+"%, "+a+"%) "),(V||c!==Ma||f!==Ma||h!==Ma)&&(W+=h!==Ma||V?"translate3d("+c+", "+f+", "+h+") ":"translate("+c+", "+f+jr),v!==Wr&&(W+="rotate("+v+jr),y!==Wr&&(W+="rotateY("+y+jr),x!==Wr&&(W+="rotateX("+x+jr),(k!==Wr||C!==Wr)&&(W+="skew("+k+", "+C+jr),(M!==1||E!==1)&&(W+="scale("+M+", "+E+jr),j.style[Mt]=W||"translate(0, 0)"},HS=function(t,i){var s=i||this,o=s.xPercent,a=s.yPercent,c=s.x,f=s.y,h=s.rotation,v=s.skewX,y=s.skewY,x=s.scaleX,k=s.scaleY,C=s.target,M=s.xOrigin,E=s.yOrigin,R=s.xOffset,O=s.yOffset,j=s.forceCSS,z=parseFloat(c),W=parseFloat(f),V,H,J,N,G;h=parseFloat(h),v=parseFloat(v),y=parseFloat(y),y&&(y=parseFloat(y),v+=y,h+=y),h||v?(h*=zs,v*=zs,V=Math.cos(h)*x,H=Math.sin(h)*x,J=Math.sin(h-v)*-k,N=Math.cos(h-v)*k,v&&(y*=zs,G=Math.tan(v-y),G=Math.sqrt(1+G*G),J*=G,N*=G,y&&(G=Math.tan(y),G=Math.sqrt(1+G*G),V*=G,H*=G)),V=Ut(V),H=Ut(H),J=Ut(J),N=Ut(N)):(V=x,N=k,H=J=0),(z&&!~(c+"").indexOf("px")||W&&!~(f+"").indexOf("px"))&&(z=Cr(C,"x",c,"px"),W=Cr(C,"y",f,"px")),(M||E||R||O)&&(z=Ut(z+M-(M*V+E*J)+R),W=Ut(W+E-(M*H+E*N)+O)),(o||a)&&(G=C.getBBox(),z=Ut(z+o/100*G.width),W=Ut(W+a/100*G.height)),G="matrix("+V+","+H+","+J+","+N+","+z+","+W+")",C.setAttribute("transform",G),j&&(C.style[Mt]=G)},$S=function(t,i,s,o,a){var c=360,f=nn(a),h=parseFloat(a)*(f&&~a.indexOf("rad")?Hr:1),v=h-o,y=o+v+"deg",x,k;return f&&(x=a.split("_")[1],x==="short"&&(v%=c,v!==v%(c/2)&&(v+=v<0?c:-c)),x==="cw"&&v<0?v=(v+c*Gm)%c-~~(v/c)*c:x==="ccw"&&v>0&&(v=(v-c*Gm)%c-~~(v/c)*c)),t._pt=k=new Wn(t._pt,i,s,o,v,DS),k.e=y,k.u="deg",t._props.push(s),k},ng=function(t,i){for(var s in i)t[s]=i[s];return t},YS=function(t,i,s){var o=ng({},s._gsap),a="perspective,force3D,transformOrigin,svgOrigin",c=s.style,f,h,v,y,x,k,C,M;o.svg?(v=s.getAttribute("transform"),s.setAttribute("transform",""),c[Mt]=i,f=Za(s,1),ns(s,Mt),s.setAttribute("transform",v)):(v=getComputedStyle(s)[Mt],c[Mt]=i,f=Za(s,1),c[Mt]=v);for(h in Gi)v=o[h],y=f[h],v!==y&&a.indexOf(h)<0&&(C=mn(v),M=mn(y),x=C!==M?Cr(s,h,v,M):parseFloat(v),k=parseFloat(y),t._pt=new Wn(t._pt,f,h,x,k-x,hd),t._pt.u=M||0,t._props.push(h));ng(f,o)};Un("padding,margin,Width,Radius",function(e,t){var i="Top",s="Right",o="Bottom",a="Left",c=(t<3?[i,s,o,a]:[i+a,i+s,o+s,o+a]).map(function(f){return t<2?e+f:"border"+f+e});Ll[t>1?"border"+e:e]=function(f,h,v,y,x){var k,C;if(arguments.length<4)return k=c.map(function(M){return Yi(f,M,v)}),C=k.join(" "),C.split(k[0]).length===5?k[0]:C;k=(y+"").split(" "),C={},c.forEach(function(M,E){return C[M]=k[E]=k[E]||k[(E-1)/2|0]}),f.init(h,C,x)}});var Ty={name:"css",register:gd,targetTest:function(t){return t.style&&t.nodeType},init:function(t,i,s,o,a){var c=this._props,f=t.style,h=s.vars.startAt,v,y,x,k,C,M,E,R,O,j,z,W,V,H,J,N;nf||gd(),this.styles=this.styles||wy(t),N=this.styles.props,this.tween=s;for(E in i)if(E!=="autoRound"&&(y=i[E],!(Qn[E]&&ly(E,i,s,o,t,a)))){if(C=typeof y,M=Ll[E],C==="function"&&(y=y.call(s,o,t,a),C=typeof y),C==="string"&&~y.indexOf("random(")&&(y=Xa(y)),M)M(this,t,E,y,s)&&(J=1);else if(E.substr(0,2)==="--")v=(getComputedStyle(t).getPropertyValue(E)+"").trim(),y+="",kr.lastIndex=0,kr.test(v)||(R=mn(v),O=mn(y)),O?R!==O&&(v=Cr(t,E,v,O)+O):R&&(y+=R),this.add(f,"setProperty",v,y,o,a,0,0,E),c.push(E),N.push(E,0,f[E]);else if(C!=="undefined"){if(h&&E in h?(v=typeof h[E]=="function"?h[E].call(s,o,t,a):h[E],nn(v)&&~v.indexOf("random(")&&(v=Xa(v)),mn(v+"")||v==="auto"||(v+=ei.units[E]||mn(Yi(t,E))||""),(v+"").charAt(1)==="="&&(v=Yi(t,E))):v=Yi(t,E),k=parseFloat(v),j=C==="string"&&y.charAt(1)==="="&&y.substr(0,2),j&&(y=y.substr(2)),x=parseFloat(y),E in Fi&&(E==="autoAlpha"&&(k===1&&Yi(t,"visibility")==="hidden"&&x&&(k=0),N.push("visibility",0,f.visibility),xr(this,f,"visibility",k?"inherit":"hidden",x?"inherit":"hidden",!x)),E!=="scale"&&E!=="transform"&&(E=Fi[E],~E.indexOf(",")&&(E=E.split(",")[0]))),z=E in Gi,z){if(this.styles.save(E),C==="string"&&y.substring(0,6)==="var(--"&&(y=mi(t,y.substring(4,y.indexOf(")"))),x=parseFloat(y)),W||(V=t._gsap,V.renderTransform&&!i.parseTransform||Za(t,i.parseTransform),H=i.smoothOrigin!==!1&&V.smooth,W=this._pt=new Wn(this._pt,f,Mt,0,1,V.renderTransform,V,0,-1),W.dep=1),E==="scale")this._pt=new Wn(this._pt,V,"scaleY",V.scaleY,(j?Is(V.scaleY,j+x):x)-V.scaleY||0,hd),this._pt.u=0,c.push("scaleY",E),E+="X";else if(E==="transformOrigin"){N.push(jn,0,f[jn]),y=WS(y),V.svg?vd(t,y,0,H,0,this):(O=parseFloat(y.split(" ")[2])||0,O!==V.zOrigin&&xr(this,V,"zOrigin",V.zOrigin,O),xr(this,f,E,Ml(v),Ml(y)));continue}else if(E==="svgOrigin"){vd(t,y,1,H,0,this);continue}else if(E in ky){$S(this,V,E,k,j?Is(k,j+y):y);continue}else if(E==="smoothOrigin"){xr(this,V,"smooth",V.smooth,y);continue}else if(E==="force3D"){V[E]=y;continue}else if(E==="transform"){YS(this,y,t);continue}}else E in f||(E=$s(E)||E);if(z||(x||x===0)&&(k||k===0)&&!PS.test(y)&&E in f)R=(v+"").substr((k+"").length),x||(x=0),O=mn(y)||(E in ei.units?ei.units[E]:R),R!==O&&(k=Cr(t,E,v,O)),this._pt=new Wn(this._pt,z?V:f,E,k,(j?Is(k,j+x):x)-k,!z&&(O==="px"||E==="zIndex")&&i.autoRound!==!1?MS:hd),this._pt.u=O||0,R!==O&&O!=="%"&&(this._pt.b=v,this._pt.r=LS);else if(E in f)US.call(this,t,E,v,j?j+y:y);else if(E in t)this.add(t,E,v||t[E],j?j+y:y,o,a);else if(E!=="parseTransform"){$d(E,y);continue}z||(E in f?N.push(E,0,f[E]):typeof t[E]=="function"?N.push(E,2,t[E]()):N.push(E,1,v||t[E])),c.push(E)}}J&&hy(this)},render:function(t,i){if(i.tween._time||!rf())for(var s=i._pt;s;)s.r(t,s.d),s=s._next;else i.styles.revert()},get:Yi,aliases:Fi,getSetter:function(t,i,s){var o=Fi[i];return o&&o.indexOf(",")<0&&(i=o),i in Gi&&i!==jn&&(t._gsap.x||Yi(t,"x"))?s&&Xm===s?i==="scale"?OS:FS:(Xm=s||{})&&(i==="scale"?NS:IS):t.style&&!jd(t.style[i])?AS:~i.indexOf("-")?RS:ef(t,i)},core:{_removeProperty:ns,_getMatrix:af}};qn.utils.checkPrefix=$s;qn.core.getStyleSaver=wy;(function(e,t,i,s){var o=Un(e+","+t+","+i,function(a){Gi[a]=1});Un(t,function(a){ei.units[a]="deg",ky[a]=1}),Fi[o[13]]=e+","+t,Un(s,function(a){var c=a.split(":");Fi[c[1]]=o[c[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Un("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(e){ei.units[e]="px"});qn.registerPlugin(Ty);var dt=qn.registerPlugin(Ty)||qn;dt.core.Tween;const XS=({position:e="right",colors:t=["#1a1a2e","#16213e","#0f3460"],items:i=[],socialItems:s=[],displaySocials:o=!0,displayItemNumbering:a=!0,menuButtonColor:c="#fff",openMenuButtonColor:f="#fff",accentColor:h="#ffffff",changeMenuColorOnOpen:v=!0,onMenuOpen:y,onMenuClose:x,onItemClick:k,languageToggle:C})=>{const[M,E]=ie.useState(!1),R=ie.useRef(!1),O=ie.useRef(null),j=ie.useRef(null),z=ie.useRef([]),W=ie.useRef(null),V=ie.useRef(null),H=ie.useRef(null),J=ie.useRef(null),N=ie.useRef(null),[G,se]=ie.useState(["Menu","Close"]),fe=ie.useRef(null),me=ie.useRef(null),be=ie.useRef(null),ye=ie.useRef(null),We=ie.useRef(null),Ae=ie.useRef(null),ke=ie.useRef(!1),oe=ie.useRef(null);ie.useLayoutEffect(()=>{const L=dt.context(()=>{const F=O.current,U=j.current,A=W.current,B=V.current,$=H.current,K=J.current;if(!F||!A||!B||!$||!K)return;let Y=[];U&&(Y=Array.from(U.querySelectorAll(".sm-prelayer"))),z.current=Y;const Q=e==="left"?-100:100;dt.set([F,...Y],{xPercent:Q}),dt.set(A,{transformOrigin:"50% 50%",rotate:0}),dt.set(B,{transformOrigin:"50% 50%",rotate:90}),dt.set($,{rotate:0,transformOrigin:"50% 50%"}),dt.set(K,{yPercent:0}),Ae.current&&dt.set(Ae.current,{color:c})});return()=>L.revert()},[c,e]);const _e=ie.useCallback(()=>{const L=O.current,F=z.current;if(!L)return null;fe.current?.kill(),me.current&&(me.current.kill(),me.current=null),oe.current?.kill();const U=Array.from(L.querySelectorAll(".sm-panel-itemLabel")),A=Array.from(L.querySelectorAll(".sm-panel-list[data-numbering] .sm-panel-item")),B=L.querySelector(".sm-socials-title"),$=Array.from(L.querySelectorAll(".sm-socials-link")),K=F.map(ge=>({el:ge,start:Number(dt.getProperty(ge,"xPercent"))})),Y=Number(dt.getProperty(L,"xPercent"));U.length&&dt.set(U,{yPercent:140,rotate:10}),A.length&&dt.set(A,{"--sm-num-opacity":0}),B&&dt.set(B,{opacity:0}),$.length&&dt.set($,{y:25,opacity:0});const Q=dt.timeline({paused:!0});K.forEach((ge,Se)=>{Q.fromTo(ge.el,{xPercent:ge.start},{xPercent:0,duration:.5,ease:"power4.out"},Se*.07)});const ce=(K.length?(K.length-1)*.07:0)+(K.length?.08:0),pe=.65;if(Q.fromTo(L,{xPercent:Y},{xPercent:0,duration:pe,ease:"power4.out"},ce),U.length){const Se=ce+pe*.15;Q.to(U,{yPercent:0,rotate:0,duration:1,ease:"power4.out",stagger:{each:.1,from:"start"}},Se),A.length&&Q.to(A,{duration:.6,ease:"power2.out","--sm-num-opacity":1,stagger:{each:.08,from:"start"}},Se+.1)}if(B||$.length){const ge=ce+pe*.4;B&&Q.to(B,{opacity:1,duration:.5,ease:"power2.out"},ge),$.length&&Q.to($,{y:0,opacity:1,duration:.55,ease:"power3.out",stagger:{each:.08,from:"start"},onComplete:()=>{dt.set($,{clearProps:"opacity"})}},ge+.04)}return fe.current=Q,Q},[]),u=ie.useCallback(()=>{if(ke.current)return;ke.current=!0;const L=_e();L?(L.eventCallback("onComplete",()=>{ke.current=!1}),L.play(0)):ke.current=!1},[_e]),p=ie.useCallback(()=>{fe.current?.kill(),fe.current=null,oe.current?.kill();const L=O.current,F=z.current;if(!L)return;const U=[...F,L];me.current?.kill();const A=e==="left"?-100:100;me.current=dt.to(U,{xPercent:A,duration:.32,ease:"power3.in",overwrite:"auto",onComplete:()=>{const B=Array.from(L.querySelectorAll(".sm-panel-itemLabel"));B.length&&dt.set(B,{yPercent:140,rotate:10});const $=Array.from(L.querySelectorAll(".sm-panel-list[data-numbering] .sm-panel-item"));$.length&&dt.set($,{"--sm-num-opacity":0});const K=L.querySelector(".sm-socials-title"),Y=Array.from(L.querySelectorAll(".sm-socials-link"));K&&dt.set(K,{opacity:0}),Y.length&&dt.set(Y,{y:25,opacity:0}),ke.current=!1}})},[e]),g=ie.useCallback(L=>{const F=H.current;F&&(be.current?.kill(),L?be.current=dt.to(F,{rotate:225,duration:.8,ease:"power4.out",overwrite:"auto"}):be.current=dt.to(F,{rotate:0,duration:.35,ease:"power3.inOut",overwrite:"auto"}))},[]),b=ie.useCallback(L=>{const F=Ae.current;if(F)if(We.current?.kill(),v){const U=L?f:c;We.current=dt.to(F,{color:U,delay:.18,duration:.3,ease:"power2.out"})}else dt.set(F,{color:c})},[f,c,v]);ie.useEffect(()=>{if(Ae.current)if(v){const L=R.current?f:c;dt.set(Ae.current,{color:L})}else dt.set(Ae.current,{color:c})},[v,c,f]);const S=ie.useCallback(L=>{const F=J.current;if(!F)return;ye.current?.kill();const U=L?"Menu":"Close",A=L?"Close":"Menu",B=3,$=[U];let K=U;for(let te=0;te<B;te++)K=K==="Menu"?"Close":"Menu",$.push(K);K!==A&&$.push(A),$.push(A),se($),dt.set(F,{yPercent:0});const Y=$.length,Q=(Y-1)/Y*100;ye.current=dt.to(F,{yPercent:-Q,duration:.5+Y*.07,ease:"power4.out"})},[]),_=ie.useCallback(()=>{const L=!R.current;R.current=L,E(L),L?(document.body.style.overflow="hidden",y?.(),u()):(document.body.style.overflow="",x?.(),p()),g(L),b(L),S(L)},[u,p,g,b,S,y,x]),D=ie.useCallback(()=>{R.current&&(R.current=!1,E(!1),document.body.style.overflow="",x?.(),p(),g(!1),b(!1),S(!1))},[p,g,b,S,x]);ie.useEffect(()=>{const L=F=>{F.key==="Escape"&&R.current&&D()};return document.addEventListener("keydown",L),()=>document.removeEventListener("keydown",L)},[D]),ie.useEffect(()=>{const L=F=>{if(!R.current)return;const U=O.current,A=Ae.current;U&&U.contains(F.target)||A&&A.contains(F.target)||D()};return document.addEventListener("mousedown",L),()=>document.removeEventListener("mousedown",L)},[D]),ie.useEffect(()=>{if(!R.current)return;const L=O.current;if(!L)return;const F=Array.from(L.querySelectorAll(".sm-panel-list[data-numbering] .sm-panel-item"));F.length&&dt.set(F,{"--sm-num-opacity":1})},[i]);const T=ie.useCallback((L,F)=>{setTimeout(()=>{D()},150),k&&k(L,F)},[D,k]);return we.jsxs("div",{className:"staggered-menu-wrapper",style:h?{"--sm-accent":h}:void 0,"data-position":e,"data-open":M||void 0,children:[we.jsx("div",{ref:j,className:"sm-prelayers","aria-hidden":"true",children:(()=>{let F=[...t&&t.length?t.slice(0,4):["#1a1a2e","#16213e"]];if(F.length>=3){const U=Math.floor(F.length/2);F.splice(U,1)}return F.map((U,A)=>we.jsx("div",{className:"sm-prelayer",style:{background:U}},A))})()}),we.jsxs("button",{ref:Ae,className:"sm-toggle","aria-label":M?"Close menu":"Open menu","aria-expanded":M,"aria-controls":"staggered-menu-panel",onClick:_,type:"button",children:[we.jsx("span",{ref:N,className:"sm-toggle-textWrap","aria-hidden":"true",children:we.jsx("span",{ref:J,className:"sm-toggle-textInner",children:G.map((L,F)=>we.jsx("span",{className:"sm-toggle-line",children:L},F))})}),we.jsxs("span",{ref:H,className:"sm-icon","aria-hidden":"true",children:[we.jsx("span",{ref:W,className:"sm-icon-line"}),we.jsx("span",{ref:V,className:"sm-icon-line sm-icon-line-v"})]})]}),we.jsxs("aside",{id:"staggered-menu-panel",ref:O,className:"staggered-menu-panel","aria-hidden":!M,children:[C&&we.jsx("div",{className:"sm-lang-section",children:C}),we.jsxs("div",{className:"sm-panel-inner",children:[we.jsx("ul",{className:"sm-panel-list",role:"list","data-numbering":a||void 0,children:i&&i.length?i.map((L,F)=>we.jsx("li",{className:"sm-panel-itemWrap",children:we.jsx("a",{className:"sm-panel-item",href:L.link,"aria-label":L.ariaLabel,"data-index":F+1,onClick:U=>T(L,U),children:we.jsx("span",{className:"sm-panel-itemLabel",children:L.label})})},L.label+F)):we.jsx("li",{className:"sm-panel-itemWrap","aria-hidden":"true",children:we.jsx("span",{className:"sm-panel-item",children:we.jsx("span",{className:"sm-panel-itemLabel",children:"No items"})})})}),o&&s&&s.length>0&&we.jsxs("div",{className:"sm-socials","aria-label":"Social links",children:[we.jsx("h3",{className:"sm-socials-title",children:"Connect"}),we.jsx("ul",{className:"sm-socials-list",role:"list",children:s.map((L,F)=>we.jsx("li",{className:"sm-socials-item",children:we.jsxs("a",{href:L.link,target:"_blank",rel:"noopener noreferrer",className:"sm-socials-link",children:[L.icon&&we.jsx("span",{className:"sm-socials-icon",children:L.icon}),we.jsx("span",{className:"sm-socials-label",children:L.label})]})},L.label+F))})]})]})]}),M&&we.jsx("div",{className:"sm-overlay",onClick:D,"aria-hidden":"true"})]})},GS=[{i18nKey:"nav.home",fallback:"Home",ariaLabel:"Go to home section",link:"#home"},{i18nKey:"nav.services",fallback:"Services",ariaLabel:"View our services",link:"#philosophy"},{i18nKey:"nav.portfolio",fallback:"Portfolio",ariaLabel:"See our work",link:"#portfolio"},{i18nKey:"nav.agreement",fallback:"Agreement",ariaLabel:"View development agreement",link:"#contract"},{i18nKey:"nav.connect",fallback:"Connect",ariaLabel:"Get in touch",link:"#contact"}],Na=(e,t)=>{const i=localStorage.getItem("scarlo-lang")||"en";if(typeof window.t=="function"){const o=window.t(e);if(o&&o!==e)return o}const s=window.TRANSLATIONS;return s&&s[i]&&s[i][e]?s[i][e]:s&&s.en&&s.en[e]?s.en[e]:t},KS=()=>localStorage.getItem("scarlo-lang")||"en",QS=e=>{localStorage.setItem("scarlo-lang",e),document.documentElement.lang=e,typeof window.setLang=="function"&&window.setLang(e)},ZS=()=>GS.map(e=>({label:Na(e.i18nKey,e.fallback),ariaLabel:e.ariaLabel,link:e.link})),ig=()=>we.jsx("svg",{className:"sm-social-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:we.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),JS=[{label:"Personal",link:"https://www.linkedin.com/in/carlos-martin-050876314/",icon:we.jsx(ig,{})},{label:"Scarlo",link:"https://www.linkedin.com/company/110879775/",icon:we.jsx(ig,{})}],ek=(e,t)=>{t.preventDefault();const i=e.link;if(!i||i==="#")return;const s=document.querySelector(i);if(s){const o=document.querySelector(".navbar"),a=o?o.offsetHeight:0,c=s.offsetTop-a;window.scrollTo({top:c,behavior:"smooth"})}},tk=()=>{console.log("Staggered menu opened"),document.body.classList.add("staggered-menu-open")},nk=()=>{console.log("Staggered menu closed"),document.body.classList.remove("staggered-menu-open")},ik=()=>{document.querySelectorAll("[data-i18n]").forEach(i=>{const s=i.getAttribute("data-i18n"),o=Na(s,null);if(o){if(i.classList.contains("rotating-text"))return;i.textContent=o}}),document.querySelectorAll("[data-i18n-html]").forEach(i=>{const s=i.getAttribute("data-i18n-html"),o=Na(s,null);o&&(i.innerHTML=o)}),document.querySelectorAll("[data-i18n-placeholder]").forEach(i=>{const s=i.getAttribute("data-i18n-placeholder"),o=Na(s,null);o&&(i.placeholder=o)});const e=document.getElementById("authActionBtn"),t=document.getElementById("authStatusText");t&&e&&!e.classList.contains("logged-in")&&(t.textContent=Na("nav.signIn","Sign In")),window.rotatingText&&window.rotatingText.switchLanguage&&window.rotatingText.switchLanguage()},rk=({lang:e,onSwitch:t})=>we.jsxs("div",{className:"sm-lang-toggle",role:"radiogroup","aria-label":"Language",children:[we.jsx("button",{className:`sm-lang-btn${e==="en"?" active":""}`,onClick:()=>t("en"),"aria-checked":e==="en",role:"radio",type:"button",children:"EN"}),we.jsx("span",{className:"sm-lang-divider",children:"|"}),we.jsx("button",{className:`sm-lang-btn${e==="es"?" active":""}`,onClick:()=>t("es"),"aria-checked":e==="es",role:"radio",type:"button",children:"ES"})]}),sk=()=>{const[e,t]=ie.useState(KS),i=ie.useCallback(o=>{QS(o),t(o);const a=document.getElementById("langToggle");a&&a.querySelectorAll(".lang-btn").forEach(c=>{c.classList.toggle("active",c.getAttribute("data-lang")===o)}),ik()},[]);ie.useEffect(()=>{const o=document.getElementById("langToggle");if(!o)return;const a=c=>{const f=c.target.closest(".lang-btn");if(!f)return;const h=f.getAttribute("data-lang");h&&t(h)};return o.addEventListener("click",a),()=>o.removeEventListener("click",a)},[]);const s=ZS();return we.jsx(XS,{position:"right",items:s,socialItems:JS,displaySocials:!0,displayItemNumbering:!0,menuButtonColor:"#fff",openMenuButtonColor:"#fff",changeMenuColorOnOpen:!0,colors:["#0a0a12","#12121a","#1a1a24"],accentColor:"rgba(255, 255, 255, 0.9)",onMenuOpen:tk,onMenuClose:nk,onItemClick:ek,languageToggle:we.jsx(rk,{lang:e,onSwitch:i})})},rg=document.getElementById("staggered-menu-root");rg?Ud.createRoot(rg).render(we.jsx(Sv.StrictMode,{children:we.jsx(sk,{})})):console.error("StaggeredMenu mount point not found: #staggered-menu-root");const Ey=ie.createContext({});function Py(e){const t=ie.useRef(null);return t.current===null&&(t.current=e()),t.current}const of=typeof window<"u",ak=of?ie.useLayoutEffect:ie.useEffect,lf=ie.createContext(null);function cf(e,t){e.indexOf(t)===-1&&e.push(t)}function uf(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}const Ki=(e,t,i)=>i>t?t:i<e?e:i;let df=()=>{};const Qi={},Dy=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Ly(e){return typeof e=="object"&&e!==null}const My=e=>/^0[^.\s]+$/u.test(e);function ff(e){let t;return()=>(t===void 0&&(t=e()),t)}const vi=e=>e,ok=(e,t)=>i=>t(e(i)),ao=(...e)=>e.reduce(ok),Ja=(e,t,i)=>{const s=t-e;return s===0?1:(i-e)/s};class pf{constructor(){this.subscriptions=[]}add(t){return cf(this.subscriptions,t),()=>uf(this.subscriptions,t)}notify(t,i,s){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](t,i,s);else for(let a=0;a<o;a++){const c=this.subscriptions[a];c&&c(t,i,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Oi=e=>e*1e3,gi=e=>e/1e3;function Ay(e,t){return t?e*(1e3/t):0}const Ry=(e,t,i)=>(((1-3*i+3*t)*e+(3*i-6*t))*e+3*t)*e,lk=1e-7,ck=12;function uk(e,t,i,s,o){let a,c,f=0;do c=t+(i-t)/2,a=Ry(c,s,o)-e,a>0?i=c:t=c;while(Math.abs(a)>lk&&++f<ck);return c}function oo(e,t,i,s){if(e===t&&i===s)return vi;const o=a=>uk(a,0,1,e,i);return a=>a===0||a===1?a:Ry(o(a),t,s)}const Fy=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Oy=e=>t=>1-e(1-t),Ny=oo(.33,1.53,.69,.99),hf=Oy(Ny),Iy=Fy(hf),By=e=>(e*=2)<1?.5*hf(e):.5*(2-Math.pow(2,-10*(e-1))),mf=e=>1-Math.sin(Math.acos(e)),zy=Oy(mf),Vy=Fy(mf),dk=oo(.42,0,1,1),fk=oo(0,0,.58,1),Uy=oo(.42,0,.58,1),pk=e=>Array.isArray(e)&&typeof e[0]!="number",Wy=e=>Array.isArray(e)&&typeof e[0]=="number",hk={linear:vi,easeIn:dk,easeInOut:Uy,easeOut:fk,circIn:mf,circInOut:Vy,circOut:zy,backIn:hf,backInOut:Iy,backOut:Ny,anticipate:By},mk=e=>typeof e=="string",sg=e=>{if(Wy(e)){df(e.length===4);const[t,i,s,o]=e;return oo(t,i,s,o)}else if(mk(e))return hk[e];return e},hl=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function gk(e,t){let i=new Set,s=new Set,o=!1,a=!1;const c=new WeakSet;let f={delta:0,timestamp:0,isProcessing:!1};function h(y){c.has(y)&&(v.schedule(y),e()),y(f)}const v={schedule:(y,x=!1,k=!1)=>{const M=k&&o?i:s;return x&&c.add(y),M.has(y)||M.add(y),y},cancel:y=>{s.delete(y),c.delete(y)},process:y=>{if(f=y,o){a=!0;return}o=!0,[i,s]=[s,i],i.forEach(h),i.clear(),o=!1,a&&(a=!1,v.process(y))}};return v}const vk=40;function jy(e,t){let i=!1,s=!0;const o={delta:0,timestamp:0,isProcessing:!1},a=()=>i=!0,c=hl.reduce((z,W)=>(z[W]=gk(a),z),{}),{setup:f,read:h,resolveKeyframes:v,preUpdate:y,update:x,preRender:k,render:C,postRender:M}=c,E=()=>{const z=Qi.useManualTiming?o.timestamp:performance.now();i=!1,Qi.useManualTiming||(o.delta=s?1e3/60:Math.max(Math.min(z-o.timestamp,vk),1)),o.timestamp=z,o.isProcessing=!0,f.process(o),h.process(o),v.process(o),y.process(o),x.process(o),k.process(o),C.process(o),M.process(o),o.isProcessing=!1,i&&t&&(s=!1,e(E))},R=()=>{i=!0,s=!0,o.isProcessing||e(E)};return{schedule:hl.reduce((z,W)=>{const V=c[W];return z[W]=(H,J=!1,N=!1)=>(i||R(),V.schedule(H,J,N)),z},{}),cancel:z=>{for(let W=0;W<hl.length;W++)c[hl[W]].cancel(z)},state:o,steps:c}}const{schedule:Et,cancel:Tr,state:ln,steps:Vu}=jy(typeof requestAnimationFrame<"u"?requestAnimationFrame:vi,!0);let bl;function yk(){bl=void 0}const zn={now:()=>(bl===void 0&&zn.set(ln.isProcessing||Qi.useManualTiming?ln.timestamp:performance.now()),bl),set:e=>{bl=e,queueMicrotask(yk)}},qy=e=>t=>typeof t=="string"&&t.startsWith(e),gf=qy("--"),wk=qy("var(--"),vf=e=>wk(e)?bk.test(e.split("/*")[0].trim()):!1,bk=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Xs={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},eo={...Xs,transform:e=>Ki(0,1,e)},ml={...Xs,default:1},Wa=e=>Math.round(e*1e5)/1e5,yf=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function xk(e){return e==null}const Sk=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,wf=(e,t)=>i=>!!(typeof i=="string"&&Sk.test(i)&&i.startsWith(e)||t&&!xk(i)&&Object.prototype.hasOwnProperty.call(i,t)),Hy=(e,t,i)=>s=>{if(typeof s!="string")return s;const[o,a,c,f]=s.match(yf);return{[e]:parseFloat(o),[t]:parseFloat(a),[i]:parseFloat(c),alpha:f!==void 0?parseFloat(f):1}},kk=e=>Ki(0,255,e),Uu={...Xs,transform:e=>Math.round(kk(e))},Xr={test:wf("rgb","red"),parse:Hy("red","green","blue"),transform:({red:e,green:t,blue:i,alpha:s=1})=>"rgba("+Uu.transform(e)+", "+Uu.transform(t)+", "+Uu.transform(i)+", "+Wa(eo.transform(s))+")"};function _k(e){let t="",i="",s="",o="";return e.length>5?(t=e.substring(1,3),i=e.substring(3,5),s=e.substring(5,7),o=e.substring(7,9)):(t=e.substring(1,2),i=e.substring(2,3),s=e.substring(3,4),o=e.substring(4,5),t+=t,i+=i,s+=s,o+=o),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(s,16),alpha:o?parseInt(o,16)/255:1}}const yd={test:wf("#"),parse:_k,transform:Xr.transform},lo=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),yr=lo("deg"),Ni=lo("%"),qe=lo("px"),Ck=lo("vh"),Tk=lo("vw"),ag={...Ni,parse:e=>Ni.parse(e)/100,transform:e=>Ni.transform(e*100)},As={test:wf("hsl","hue"),parse:Hy("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:i,alpha:s=1})=>"hsla("+Math.round(e)+", "+Ni.transform(Wa(t))+", "+Ni.transform(Wa(i))+", "+Wa(eo.transform(s))+")"},Ht={test:e=>Xr.test(e)||yd.test(e)||As.test(e),parse:e=>Xr.test(e)?Xr.parse(e):As.test(e)?As.parse(e):yd.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Xr.transform(e):As.transform(e),getAnimatableNone:e=>{const t=Ht.parse(e);return t.alpha=0,Ht.transform(t)}},Ek=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Pk(e){return isNaN(e)&&typeof e=="string"&&(e.match(yf)?.length||0)+(e.match(Ek)?.length||0)>0}const $y="number",Yy="color",Dk="var",Lk="var(",og="${}",Mk=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function to(e){const t=e.toString(),i=[],s={color:[],number:[],var:[]},o=[];let a=0;const f=t.replace(Mk,h=>(Ht.test(h)?(s.color.push(a),o.push(Yy),i.push(Ht.parse(h))):h.startsWith(Lk)?(s.var.push(a),o.push(Dk),i.push(h)):(s.number.push(a),o.push($y),i.push(parseFloat(h))),++a,og)).split(og);return{values:i,split:f,indexes:s,types:o}}function Xy(e){return to(e).values}function Gy(e){const{split:t,types:i}=to(e),s=t.length;return o=>{let a="";for(let c=0;c<s;c++)if(a+=t[c],o[c]!==void 0){const f=i[c];f===$y?a+=Wa(o[c]):f===Yy?a+=Ht.transform(o[c]):a+=o[c]}return a}}const Ak=e=>typeof e=="number"?0:Ht.test(e)?Ht.getAnimatableNone(e):e;function Rk(e){const t=Xy(e);return Gy(e)(t.map(Ak))}const Er={test:Pk,parse:Xy,createTransformer:Gy,getAnimatableNone:Rk};function Wu(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function Fk({hue:e,saturation:t,lightness:i,alpha:s}){e/=360,t/=100,i/=100;let o=0,a=0,c=0;if(!t)o=a=c=i;else{const f=i<.5?i*(1+t):i+t-i*t,h=2*i-f;o=Wu(h,f,e+1/3),a=Wu(h,f,e),c=Wu(h,f,e-1/3)}return{red:Math.round(o*255),green:Math.round(a*255),blue:Math.round(c*255),alpha:s}}function Al(e,t){return i=>i>0?t:e}const At=(e,t,i)=>e+(t-e)*i,ju=(e,t,i)=>{const s=e*e,o=i*(t*t-s)+s;return o<0?0:Math.sqrt(o)},Ok=[yd,Xr,As],Nk=e=>Ok.find(t=>t.test(e));function lg(e){const t=Nk(e);if(!t)return!1;let i=t.parse(e);return t===As&&(i=Fk(i)),i}const cg=(e,t)=>{const i=lg(e),s=lg(t);if(!i||!s)return Al(e,t);const o={...i};return a=>(o.red=ju(i.red,s.red,a),o.green=ju(i.green,s.green,a),o.blue=ju(i.blue,s.blue,a),o.alpha=At(i.alpha,s.alpha,a),Xr.transform(o))},wd=new Set(["none","hidden"]);function Ik(e,t){return wd.has(e)?i=>i<=0?e:t:i=>i>=1?t:e}function Bk(e,t){return i=>At(e,t,i)}function bf(e){return typeof e=="number"?Bk:typeof e=="string"?vf(e)?Al:Ht.test(e)?cg:Uk:Array.isArray(e)?Ky:typeof e=="object"?Ht.test(e)?cg:zk:Al}function Ky(e,t){const i=[...e],s=i.length,o=e.map((a,c)=>bf(a)(a,t[c]));return a=>{for(let c=0;c<s;c++)i[c]=o[c](a);return i}}function zk(e,t){const i={...e,...t},s={};for(const o in i)e[o]!==void 0&&t[o]!==void 0&&(s[o]=bf(e[o])(e[o],t[o]));return o=>{for(const a in s)i[a]=s[a](o);return i}}function Vk(e,t){const i=[],s={color:0,var:0,number:0};for(let o=0;o<t.values.length;o++){const a=t.types[o],c=e.indexes[a][s[a]],f=e.values[c]??0;i[o]=f,s[a]++}return i}const Uk=(e,t)=>{const i=Er.createTransformer(t),s=to(e),o=to(t);return s.indexes.var.length===o.indexes.var.length&&s.indexes.color.length===o.indexes.color.length&&s.indexes.number.length>=o.indexes.number.length?wd.has(e)&&!o.values.length||wd.has(t)&&!s.values.length?Ik(e,t):ao(Ky(Vk(s,o),o.values),i):Al(e,t)};function Qy(e,t,i){return typeof e=="number"&&typeof t=="number"&&typeof i=="number"?At(e,t,i):bf(e)(e,t)}const Wk=e=>{const t=({timestamp:i})=>e(i);return{start:(i=!0)=>Et.update(t,i),stop:()=>Tr(t),now:()=>ln.isProcessing?ln.timestamp:zn.now()}},Zy=(e,t,i=10)=>{let s="";const o=Math.max(Math.round(t/i),2);for(let a=0;a<o;a++)s+=Math.round(e(a/(o-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},Rl=2e4;function xf(e){let t=0;const i=50;let s=e.next(t);for(;!s.done&&t<Rl;)t+=i,s=e.next(t);return t>=Rl?1/0:t}function jk(e,t=100,i){const s=i({...e,keyframes:[0,t]}),o=Math.min(xf(s),Rl);return{type:"keyframes",ease:a=>s.next(o*a).value/t,duration:gi(o)}}const qk=5;function Jy(e,t,i){const s=Math.max(t-qk,0);return Ay(i-e(s),t-s)}const Ft={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},qu=.001;function Hk({duration:e=Ft.duration,bounce:t=Ft.bounce,velocity:i=Ft.velocity,mass:s=Ft.mass}){let o,a,c=1-t;c=Ki(Ft.minDamping,Ft.maxDamping,c),e=Ki(Ft.minDuration,Ft.maxDuration,gi(e)),c<1?(o=v=>{const y=v*c,x=y*e,k=y-i,C=bd(v,c),M=Math.exp(-x);return qu-k/C*M},a=v=>{const x=v*c*e,k=x*i+i,C=Math.pow(c,2)*Math.pow(v,2)*e,M=Math.exp(-x),E=bd(Math.pow(v,2),c);return(-o(v)+qu>0?-1:1)*((k-C)*M)/E}):(o=v=>{const y=Math.exp(-v*e),x=(v-i)*e+1;return-qu+y*x},a=v=>{const y=Math.exp(-v*e),x=(i-v)*(e*e);return y*x});const f=5/e,h=Yk(o,a,f);if(e=Oi(e),isNaN(h))return{stiffness:Ft.stiffness,damping:Ft.damping,duration:e};{const v=Math.pow(h,2)*s;return{stiffness:v,damping:c*2*Math.sqrt(s*v),duration:e}}}const $k=12;function Yk(e,t,i){let s=i;for(let o=1;o<$k;o++)s=s-e(s)/t(s);return s}function bd(e,t){return e*Math.sqrt(1-t*t)}const Xk=["duration","bounce"],Gk=["stiffness","damping","mass"];function ug(e,t){return t.some(i=>e[i]!==void 0)}function Kk(e){let t={velocity:Ft.velocity,stiffness:Ft.stiffness,damping:Ft.damping,mass:Ft.mass,isResolvedFromDuration:!1,...e};if(!ug(e,Gk)&&ug(e,Xk))if(e.visualDuration){const i=e.visualDuration,s=2*Math.PI/(i*1.2),o=s*s,a=2*Ki(.05,1,1-(e.bounce||0))*Math.sqrt(o);t={...t,mass:Ft.mass,stiffness:o,damping:a}}else{const i=Hk(e);t={...t,...i,mass:Ft.mass},t.isResolvedFromDuration=!0}return t}function Fl(e=Ft.visualDuration,t=Ft.bounce){const i=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:s,restDelta:o}=i;const a=i.keyframes[0],c=i.keyframes[i.keyframes.length-1],f={done:!1,value:a},{stiffness:h,damping:v,mass:y,duration:x,velocity:k,isResolvedFromDuration:C}=Kk({...i,velocity:-gi(i.velocity||0)}),M=k||0,E=v/(2*Math.sqrt(h*y)),R=c-a,O=gi(Math.sqrt(h/y)),j=Math.abs(R)<5;s||(s=j?Ft.restSpeed.granular:Ft.restSpeed.default),o||(o=j?Ft.restDelta.granular:Ft.restDelta.default);let z;if(E<1){const V=bd(O,E);z=H=>{const J=Math.exp(-E*O*H);return c-J*((M+E*O*R)/V*Math.sin(V*H)+R*Math.cos(V*H))}}else if(E===1)z=V=>c-Math.exp(-O*V)*(R+(M+O*R)*V);else{const V=O*Math.sqrt(E*E-1);z=H=>{const J=Math.exp(-E*O*H),N=Math.min(V*H,300);return c-J*((M+E*O*R)*Math.sinh(N)+V*R*Math.cosh(N))/V}}const W={calculatedDuration:C&&x||null,next:V=>{const H=z(V);if(C)f.done=V>=x;else{let J=V===0?M:0;E<1&&(J=V===0?Oi(M):Jy(z,V,H));const N=Math.abs(J)<=s,G=Math.abs(c-H)<=o;f.done=N&&G}return f.value=f.done?c:H,f},toString:()=>{const V=Math.min(xf(W),Rl),H=Zy(J=>W.next(V*J).value,V,30);return V+"ms "+H},toTransition:()=>{}};return W}Fl.applyToOptions=e=>{const t=jk(e,100,Fl);return e.ease=t.ease,e.duration=Oi(t.duration),e.type="keyframes",e};function xd({keyframes:e,velocity:t=0,power:i=.8,timeConstant:s=325,bounceDamping:o=10,bounceStiffness:a=500,modifyTarget:c,min:f,max:h,restDelta:v=.5,restSpeed:y}){const x=e[0],k={done:!1,value:x},C=N=>f!==void 0&&N<f||h!==void 0&&N>h,M=N=>f===void 0?h:h===void 0||Math.abs(f-N)<Math.abs(h-N)?f:h;let E=i*t;const R=x+E,O=c===void 0?R:c(R);O!==R&&(E=O-x);const j=N=>-E*Math.exp(-N/s),z=N=>O+j(N),W=N=>{const G=j(N),se=z(N);k.done=Math.abs(G)<=v,k.value=k.done?O:se};let V,H;const J=N=>{C(k.value)&&(V=N,H=Fl({keyframes:[k.value,M(k.value)],velocity:Jy(z,N,k.value),damping:o,stiffness:a,restDelta:v,restSpeed:y}))};return J(0),{calculatedDuration:null,next:N=>{let G=!1;return!H&&V===void 0&&(G=!0,W(N),J(N)),V!==void 0&&N>=V?H.next(N-V):(!G&&W(N),k)}}}function Qk(e,t,i){const s=[],o=i||Qi.mix||Qy,a=e.length-1;for(let c=0;c<a;c++){let f=o(e[c],e[c+1]);if(t){const h=Array.isArray(t)?t[c]||vi:t;f=ao(h,f)}s.push(f)}return s}function Zk(e,t,{clamp:i=!0,ease:s,mixer:o}={}){const a=e.length;if(df(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const c=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const f=Qk(t,s,o),h=f.length,v=y=>{if(c&&y<e[0])return t[0];let x=0;if(h>1)for(;x<e.length-2&&!(y<e[x+1]);x++);const k=Ja(e[x],e[x+1],y);return f[x](k)};return i?y=>v(Ki(e[0],e[a-1],y)):v}function Jk(e,t){const i=e[e.length-1];for(let s=1;s<=t;s++){const o=Ja(0,t,s);e.push(At(i,1,o))}}function e2(e){const t=[0];return Jk(t,e.length-1),t}function t2(e,t){return e.map(i=>i*t)}function n2(e,t){return e.map(()=>t||Uy).splice(0,e.length-1)}function ja({duration:e=300,keyframes:t,times:i,ease:s="easeInOut"}){const o=pk(s)?s.map(sg):sg(s),a={done:!1,value:t[0]},c=t2(i&&i.length===t.length?i:e2(t),e),f=Zk(c,t,{ease:Array.isArray(o)?o:n2(t,o)});return{calculatedDuration:e,next:h=>(a.value=f(h),a.done=h>=e,a)}}const i2=e=>e!==null;function Sf(e,{repeat:t,repeatType:i="loop"},s,o=1){const a=e.filter(i2),f=o<0||t&&i!=="loop"&&t%2===1?0:a.length-1;return!f||s===void 0?a[f]:s}const r2={decay:xd,inertia:xd,tween:ja,keyframes:ja,spring:Fl};function e0(e){typeof e.type=="string"&&(e.type=r2[e.type])}class kf{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,i){return this.finished.then(t,i)}}const s2=e=>e/100;class _f extends kf{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:i}=this.options;i&&i.updatedAt!==zn.now()&&this.tick(zn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;e0(t);const{type:i=ja,repeat:s=0,repeatDelay:o=0,repeatType:a,velocity:c=0}=t;let{keyframes:f}=t;const h=i||ja;h!==ja&&typeof f[0]!="number"&&(this.mixKeyframes=ao(s2,Qy(f[0],f[1])),f=[0,100]);const v=h({...t,keyframes:f});a==="mirror"&&(this.mirroredGenerator=h({...t,keyframes:[...f].reverse(),velocity:-c})),v.calculatedDuration===null&&(v.calculatedDuration=xf(v));const{calculatedDuration:y}=v;this.calculatedDuration=y,this.resolvedDuration=y+o,this.totalDuration=this.resolvedDuration*(s+1)-o,this.generator=v}updateTime(t){const i=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=i}tick(t,i=!1){const{generator:s,totalDuration:o,mixKeyframes:a,mirroredGenerator:c,resolvedDuration:f,calculatedDuration:h}=this;if(this.startTime===null)return s.next(0);const{delay:v=0,keyframes:y,repeat:x,repeatType:k,repeatDelay:C,type:M,onUpdate:E,finalKeyframe:R}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-o/this.speed,this.startTime)),i?this.currentTime=t:this.updateTime(t);const O=this.currentTime-v*(this.playbackSpeed>=0?1:-1),j=this.playbackSpeed>=0?O<0:O>o;this.currentTime=Math.max(O,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=o);let z=this.currentTime,W=s;if(x){const N=Math.min(this.currentTime,o)/f;let G=Math.floor(N),se=N%1;!se&&N>=1&&(se=1),se===1&&G--,G=Math.min(G,x+1),G%2&&(k==="reverse"?(se=1-se,C&&(se-=C/f)):k==="mirror"&&(W=c)),z=Ki(0,1,se)*f}const V=j?{done:!1,value:y[0]}:W.next(z);a&&(V.value=a(V.value));let{done:H}=V;!j&&h!==null&&(H=this.playbackSpeed>=0?this.currentTime>=o:this.currentTime<=0);const J=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&H);return J&&M!==xd&&(V.value=Sf(y,this.options,R,this.speed)),E&&E(V.value),J&&this.finish(),V}then(t,i){return this.finished.then(t,i)}get duration(){return gi(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+gi(t)}get time(){return gi(this.currentTime)}set time(t){t=Oi(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(zn.now());const i=this.playbackSpeed!==t;this.playbackSpeed=t,i&&(this.time=gi(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=Wk,startTime:i}=this.options;this.driver||(this.driver=t(o=>this.tick(o))),this.options.onPlay?.();const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=i??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(zn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function a2(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Gr=e=>e*180/Math.PI,Sd=e=>{const t=Gr(Math.atan2(e[1],e[0]));return kd(t)},o2={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Sd,rotateZ:Sd,skewX:e=>Gr(Math.atan(e[1])),skewY:e=>Gr(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},kd=e=>(e=e%360,e<0&&(e+=360),e),dg=Sd,fg=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),pg=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),l2={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:fg,scaleY:pg,scale:e=>(fg(e)+pg(e))/2,rotateX:e=>kd(Gr(Math.atan2(e[6],e[5]))),rotateY:e=>kd(Gr(Math.atan2(-e[2],e[0]))),rotateZ:dg,rotate:dg,skewX:e=>Gr(Math.atan(e[4])),skewY:e=>Gr(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function _d(e){return e.includes("scale")?1:0}function Cd(e,t){if(!e||e==="none")return _d(t);const i=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,o;if(i)s=l2,o=i;else{const f=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=o2,o=f}if(!o)return _d(t);const a=s[t],c=o[1].split(",").map(u2);return typeof a=="function"?a(c):c[a]}const c2=(e,t)=>{const{transform:i="none"}=getComputedStyle(e);return Cd(i,t)};function u2(e){return parseFloat(e.trim())}const Gs=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ks=new Set(Gs),hg=e=>e===Xs||e===qe,d2=new Set(["x","y","z"]),f2=Gs.filter(e=>!d2.has(e));function p2(e){const t=[];return f2.forEach(i=>{const s=e.getValue(i);s!==void 0&&(t.push([i,s.get()]),s.set(i.startsWith("scale")?1:0))}),t}const es={width:({x:e},{paddingLeft:t="0",paddingRight:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),height:({y:e},{paddingTop:t="0",paddingBottom:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>Cd(t,"x"),y:(e,{transform:t})=>Cd(t,"y")};es.translateX=es.x;es.translateY=es.y;const ts=new Set;let Td=!1,Ed=!1,Pd=!1;function t0(){if(Ed){const e=Array.from(ts).filter(s=>s.needsMeasurement),t=new Set(e.map(s=>s.element)),i=new Map;t.forEach(s=>{const o=p2(s);o.length&&(i.set(s,o),s.render())}),e.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const o=i.get(s);o&&o.forEach(([a,c])=>{s.getValue(a)?.set(c)})}),e.forEach(s=>s.measureEndState()),e.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Ed=!1,Td=!1,ts.forEach(e=>e.complete(Pd)),ts.clear()}function n0(){ts.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Ed=!0)})}function h2(){Pd=!0,n0(),t0(),Pd=!1}class Cf{constructor(t,i,s,o,a,c=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=i,this.name=s,this.motionValue=o,this.element=a,this.isAsync=c}scheduleResolve(){this.state="scheduled",this.isAsync?(ts.add(this),Td||(Td=!0,Et.read(n0),Et.resolveKeyframes(t0))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:i,element:s,motionValue:o}=this;if(t[0]===null){const a=o?.get(),c=t[t.length-1];if(a!==void 0)t[0]=a;else if(s&&i){const f=s.readValue(i,c);f!=null&&(t[0]=f)}t[0]===void 0&&(t[0]=c),o&&a===void 0&&o.set(t[0])}a2(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),ts.delete(this)}cancel(){this.state==="scheduled"&&(ts.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const m2=e=>e.startsWith("--");function g2(e,t,i){m2(t)?e.style.setProperty(t,i):e.style[t]=i}const v2=ff(()=>window.ScrollTimeline!==void 0),y2={};function w2(e,t){const i=ff(e);return()=>y2[t]??i()}const i0=w2(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Ia=([e,t,i,s])=>`cubic-bezier(${e}, ${t}, ${i}, ${s})`,mg={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ia([0,.65,.55,1]),circOut:Ia([.55,0,1,.45]),backIn:Ia([.31,.01,.66,-.59]),backOut:Ia([.33,1.53,.69,.99])};function r0(e,t){if(e)return typeof e=="function"?i0()?Zy(e,t):"ease-out":Wy(e)?Ia(e):Array.isArray(e)?e.map(i=>r0(i,t)||mg.easeOut):mg[e]}function b2(e,t,i,{delay:s=0,duration:o=300,repeat:a=0,repeatType:c="loop",ease:f="easeOut",times:h}={},v=void 0){const y={[t]:i};h&&(y.offset=h);const x=r0(f,o);Array.isArray(x)&&(y.easing=x);const k={delay:s,duration:o,easing:Array.isArray(x)?"linear":x,fill:"both",iterations:a+1,direction:c==="reverse"?"alternate":"normal"};return v&&(k.pseudoElement=v),e.animate(y,k)}function s0(e){return typeof e=="function"&&"applyToOptions"in e}function x2({type:e,...t}){return s0(e)&&i0()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class S2 extends kf{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:i,name:s,keyframes:o,pseudoElement:a,allowFlatten:c=!1,finalKeyframe:f,onComplete:h}=t;this.isPseudoElement=!!a,this.allowFlatten=c,this.options=t,df(typeof t.type!="string");const v=x2(t);this.animation=b2(i,s,o,v,a),v.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const y=Sf(o,this.options,f,this.speed);this.updateMotionValue?this.updateMotionValue(y):g2(i,s,y),this.animation.cancel()}h?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return gi(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+gi(t)}get time(){return gi(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Oi(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:i}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&v2()?(this.animation.timeline=t,vi):i(this)}}const a0={anticipate:By,backInOut:Iy,circInOut:Vy};function k2(e){return e in a0}function _2(e){typeof e.ease=="string"&&k2(e.ease)&&(e.ease=a0[e.ease])}const gg=10;class C2 extends S2{constructor(t){_2(t),e0(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:i,onUpdate:s,onComplete:o,element:a,...c}=this.options;if(!i)return;if(t!==void 0){i.set(t);return}const f=new _f({...c,autoplay:!1}),h=Oi(this.finishedTime??this.time);i.setWithVelocity(f.sample(h-gg).value,f.sample(h).value,gg),f.stop()}}const vg=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Er.test(e)||e==="0")&&!e.startsWith("url("));function T2(e){const t=e[0];if(e.length===1)return!0;for(let i=0;i<e.length;i++)if(e[i]!==t)return!0}function E2(e,t,i,s){const o=e[0];if(o===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],c=vg(o,t),f=vg(a,t);return!c||!f?!1:T2(e)||(i==="spring"||s0(i))&&s}function Dd(e){e.duration=0,e.type="keyframes"}const P2=new Set(["opacity","clipPath","filter","transform"]),D2=ff(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function L2(e){const{motionValue:t,name:i,repeatDelay:s,repeatType:o,damping:a,type:c}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:h,transformTemplate:v}=t.owner.getProps();return D2()&&i&&P2.has(i)&&(i!=="transform"||!v)&&!h&&!s&&o!=="mirror"&&a!==0&&c!=="inertia"}const M2=40;class A2 extends kf{constructor({autoplay:t=!0,delay:i=0,type:s="keyframes",repeat:o=0,repeatDelay:a=0,repeatType:c="loop",keyframes:f,name:h,motionValue:v,element:y,...x}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=zn.now();const k={autoplay:t,delay:i,type:s,repeat:o,repeatDelay:a,repeatType:c,name:h,motionValue:v,element:y,...x},C=y?.KeyframeResolver||Cf;this.keyframeResolver=new C(f,(M,E,R)=>this.onKeyframesResolved(M,E,k,!R),h,v,y),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,i,s,o){this.keyframeResolver=void 0;const{name:a,type:c,velocity:f,delay:h,isHandoff:v,onUpdate:y}=s;this.resolvedAt=zn.now(),E2(t,a,c,f)||((Qi.instantAnimations||!h)&&y?.(Sf(t,s,i)),t[0]=t[t.length-1],Dd(s),s.repeat=0);const k={startTime:o?this.resolvedAt?this.resolvedAt-this.createdAt>M2?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:i,...s,keyframes:t},C=!v&&L2(k)?new C2({...k,element:k.motionValue.owner.current}):new _f(k);C.finished.then(()=>this.notifyFinished()).catch(vi),this.pendingTimeline&&(this.stopTimeline=C.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=C}get finished(){return this._animation?this.animation.finished:this._finished}then(t,i){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),h2()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const R2=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function F2(e){const t=R2.exec(e);if(!t)return[,];const[,i,s,o]=t;return[`--${i??s}`,o]}function o0(e,t,i=1){const[s,o]=F2(e);if(!s)return;const a=window.getComputedStyle(t).getPropertyValue(s);if(a){const c=a.trim();return Dy(c)?parseFloat(c):c}return vf(o)?o0(o,t,i+1):o}function Tf(e,t){return e?.[t]??e?.default??e}const l0=new Set(["width","height","top","left","right","bottom",...Gs]),O2={test:e=>e==="auto",parse:e=>e},c0=e=>t=>t.test(e),u0=[Xs,qe,Ni,yr,Tk,Ck,O2],yg=e=>u0.find(c0(e));function N2(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||My(e):!0}const I2=new Set(["brightness","contrast","saturate","opacity"]);function B2(e){const[t,i]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[s]=i.match(yf)||[];if(!s)return e;const o=i.replace(s,"");let a=I2.has(t)?1:0;return s!==i&&(a*=100),t+"("+a+o+")"}const z2=/\b([a-z-]*)\(.*?\)/gu,Ld={...Er,getAnimatableNone:e=>{const t=e.match(z2);return t?t.map(B2).join(" "):e}},wg={...Xs,transform:Math.round},V2={rotate:yr,rotateX:yr,rotateY:yr,rotateZ:yr,scale:ml,scaleX:ml,scaleY:ml,scaleZ:ml,skew:yr,skewX:yr,skewY:yr,distance:qe,translateX:qe,translateY:qe,translateZ:qe,x:qe,y:qe,z:qe,perspective:qe,transformPerspective:qe,opacity:eo,originX:ag,originY:ag,originZ:qe},Ef={borderWidth:qe,borderTopWidth:qe,borderRightWidth:qe,borderBottomWidth:qe,borderLeftWidth:qe,borderRadius:qe,radius:qe,borderTopLeftRadius:qe,borderTopRightRadius:qe,borderBottomRightRadius:qe,borderBottomLeftRadius:qe,width:qe,maxWidth:qe,height:qe,maxHeight:qe,top:qe,right:qe,bottom:qe,left:qe,padding:qe,paddingTop:qe,paddingRight:qe,paddingBottom:qe,paddingLeft:qe,margin:qe,marginTop:qe,marginRight:qe,marginBottom:qe,marginLeft:qe,backgroundPositionX:qe,backgroundPositionY:qe,...V2,zIndex:wg,fillOpacity:eo,strokeOpacity:eo,numOctaves:wg},U2={...Ef,color:Ht,backgroundColor:Ht,outlineColor:Ht,fill:Ht,stroke:Ht,borderColor:Ht,borderTopColor:Ht,borderRightColor:Ht,borderBottomColor:Ht,borderLeftColor:Ht,filter:Ld,WebkitFilter:Ld},d0=e=>U2[e];function f0(e,t){let i=d0(e);return i!==Ld&&(i=Er),i.getAnimatableNone?i.getAnimatableNone(t):void 0}const W2=new Set(["auto","none","0"]);function j2(e,t,i){let s=0,o;for(;s<e.length&&!o;){const a=e[s];typeof a=="string"&&!W2.has(a)&&to(a).values.length&&(o=e[s]),s++}if(o&&i)for(const a of t)e[a]=f0(i,o)}class q2 extends Cf{constructor(t,i,s,o,a){super(t,i,s,o,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:i,name:s}=this;if(!i||!i.current)return;super.readKeyframes();for(let h=0;h<t.length;h++){let v=t[h];if(typeof v=="string"&&(v=v.trim(),vf(v))){const y=o0(v,i.current);y!==void 0&&(t[h]=y),h===t.length-1&&(this.finalKeyframe=v)}}if(this.resolveNoneKeyframes(),!l0.has(s)||t.length!==2)return;const[o,a]=t,c=yg(o),f=yg(a);if(c!==f)if(hg(c)&&hg(f))for(let h=0;h<t.length;h++){const v=t[h];typeof v=="string"&&(t[h]=parseFloat(v))}else es[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:i}=this,s=[];for(let o=0;o<t.length;o++)(t[o]===null||N2(t[o]))&&s.push(o);s.length&&j2(t,s,i)}measureInitialState(){const{element:t,unresolvedKeyframes:i,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=es[s](t.measureViewportBox(),window.getComputedStyle(t.current)),i[0]=this.measuredOrigin;const o=i[i.length-1];o!==void 0&&t.getValue(s,o).jump(o,!1)}measureEndState(){const{element:t,name:i,unresolvedKeyframes:s}=this;if(!t||!t.current)return;const o=t.getValue(i);o&&o.jump(this.measuredOrigin,!1);const a=s.length-1,c=s[a];s[a]=es[i](t.measureViewportBox(),window.getComputedStyle(t.current)),c!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=c),this.removedTransforms?.length&&this.removedTransforms.forEach(([f,h])=>{t.getValue(f).set(h)}),this.resolveNoneKeyframes()}}function H2(e,t,i){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let s=document;const o=i?.[e]??s.querySelectorAll(e);return o?Array.from(o):[]}return Array.from(e)}const p0=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function $2(e){return Ly(e)&&"offsetHeight"in e}const bg=30,Y2=e=>!isNaN(parseFloat(e));class X2{constructor(t,i={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{const o=zn.now();if(this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=i.owner}setCurrent(t){this.current=t,this.updatedAt=zn.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=Y2(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,i){this.events[t]||(this.events[t]=new pf);const s=this.events[t].add(i);return t==="change"?()=>{s(),Et.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,i){this.passiveEffect=t,this.stopPassiveEffect=i}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,i,s){this.set(i),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,i=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,i&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=zn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>bg)return 0;const i=Math.min(this.updatedAt-this.prevUpdatedAt,bg);return Ay(parseFloat(this.current)-parseFloat(this.prevFrameValue),i)}start(t){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=t(i),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function is(e,t){return new X2(e,t)}const{schedule:Pf}=jy(queueMicrotask,!1),Ci={x:!1,y:!1};function h0(){return Ci.x||Ci.y}function G2(e){return e==="x"||e==="y"?Ci[e]?null:(Ci[e]=!0,()=>{Ci[e]=!1}):Ci.x||Ci.y?null:(Ci.x=Ci.y=!0,()=>{Ci.x=Ci.y=!1})}function m0(e,t){const i=H2(e),s=new AbortController,o={passive:!0,...t,signal:s.signal};return[i,o,()=>s.abort()]}function xg(e){return!(e.pointerType==="touch"||h0())}function K2(e,t,i={}){const[s,o,a]=m0(e,i),c=f=>{if(!xg(f))return;const{target:h}=f,v=t(h,f);if(typeof v!="function"||!h)return;const y=x=>{xg(x)&&(v(x),h.removeEventListener("pointerleave",y))};h.addEventListener("pointerleave",y,o)};return s.forEach(f=>{f.addEventListener("pointerenter",c,o)}),a}const g0=(e,t)=>t?e===t?!0:g0(e,t.parentElement):!1,Df=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,Q2=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Z2(e){return Q2.has(e.tagName)||e.tabIndex!==-1}const xl=new WeakSet;function Sg(e){return t=>{t.key==="Enter"&&e(t)}}function Hu(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const J2=(e,t)=>{const i=e.currentTarget;if(!i)return;const s=Sg(()=>{if(xl.has(i))return;Hu(i,"down");const o=Sg(()=>{Hu(i,"up")}),a=()=>Hu(i,"cancel");i.addEventListener("keyup",o,t),i.addEventListener("blur",a,t)});i.addEventListener("keydown",s,t),i.addEventListener("blur",()=>i.removeEventListener("keydown",s),t)};function kg(e){return Df(e)&&!h0()}function e_(e,t,i={}){const[s,o,a]=m0(e,i),c=f=>{const h=f.currentTarget;if(!kg(f))return;xl.add(h);const v=t(h,f),y=(C,M)=>{window.removeEventListener("pointerup",x),window.removeEventListener("pointercancel",k),xl.has(h)&&xl.delete(h),kg(C)&&typeof v=="function"&&v(C,{success:M})},x=C=>{y(C,h===window||h===document||i.useGlobalTarget||g0(h,C.target))},k=C=>{y(C,!1)};window.addEventListener("pointerup",x,o),window.addEventListener("pointercancel",k,o)};return s.forEach(f=>{(i.useGlobalTarget?window:f).addEventListener("pointerdown",c,o),$2(f)&&(f.addEventListener("focus",v=>J2(v,o)),!Z2(f)&&!f.hasAttribute("tabindex")&&(f.tabIndex=0))}),a}function v0(e){return Ly(e)&&"ownerSVGElement"in e}function t_(e){return v0(e)&&e.tagName==="svg"}const gn=e=>!!(e&&e.getVelocity),n_=[...u0,Ht,Er],i_=e=>n_.find(c0(e)),Lf=ie.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function r_(e=!0){const t=ie.useContext(lf);if(t===null)return[!0,null];const{isPresent:i,onExitComplete:s,register:o}=t,a=ie.useId();ie.useEffect(()=>{if(e)return o(a)},[e]);const c=ie.useCallback(()=>e&&s&&s(a),[a,s,e]);return!i&&s?[!1,c]:[!0]}const y0=ie.createContext({strict:!1}),_g={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ys={};for(const e in _g)Ys[e]={isEnabled:t=>_g[e].some(i=>!!t[i])};function s_(e){for(const t in e)Ys[t]={...Ys[t],...e[t]}}const a_=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Ol(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||a_.has(e)}let w0=e=>!Ol(e);function o_(e){typeof e=="function"&&(w0=t=>t.startsWith("on")?!Ol(t):e(t))}try{o_(require("@emotion/is-prop-valid").default)}catch{}function l_(e,t,i){const s={};for(const o in e)o==="values"&&typeof e.values=="object"||(w0(o)||i===!0&&Ol(o)||!t&&!Ol(o)||e.draggable&&o.startsWith("onDrag"))&&(s[o]=e[o]);return s}const Ul=ie.createContext({});function Wl(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function no(e){return typeof e=="string"||Array.isArray(e)}const Mf=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Af=["initial",...Mf];function jl(e){return Wl(e.animate)||Af.some(t=>no(e[t]))}function b0(e){return!!(jl(e)||e.variants)}function c_(e,t){if(jl(e)){const{initial:i,animate:s}=e;return{initial:i===!1||no(i)?i:void 0,animate:no(s)?s:void 0}}return e.inherit!==!1?t:{}}function u_(e){const{initial:t,animate:i}=c_(e,ie.useContext(Ul));return ie.useMemo(()=>({initial:t,animate:i}),[Cg(t),Cg(i)])}function Cg(e){return Array.isArray(e)?e.join(" "):e}const io={};function d_(e){for(const t in e)io[t]=e[t],gf(t)&&(io[t].isCSSVariable=!0)}function x0(e,{layout:t,layoutId:i}){return Ks.has(e)||e.startsWith("origin")||(t||i!==void 0)&&(!!io[e]||e==="opacity")}const f_={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},p_=Gs.length;function h_(e,t,i){let s="",o=!0;for(let a=0;a<p_;a++){const c=Gs[a],f=e[c];if(f===void 0)continue;let h=!0;if(typeof f=="number"?h=f===(c.startsWith("scale")?1:0):h=parseFloat(f)===0,!h||i){const v=p0(f,Ef[c]);if(!h){o=!1;const y=f_[c]||c;s+=`${y}(${v}) `}i&&(t[c]=v)}}return s=s.trim(),i?s=i(t,o?"":s):o&&(s="none"),s}function Rf(e,t,i){const{style:s,vars:o,transformOrigin:a}=e;let c=!1,f=!1;for(const h in t){const v=t[h];if(Ks.has(h)){c=!0;continue}else if(gf(h)){o[h]=v;continue}else{const y=p0(v,Ef[h]);h.startsWith("origin")?(f=!0,a[h]=y):s[h]=y}}if(t.transform||(c||i?s.transform=h_(t,e.transform,i):s.transform&&(s.transform="none")),f){const{originX:h="50%",originY:v="50%",originZ:y=0}=a;s.transformOrigin=`${h} ${v} ${y}`}}const Ff=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function S0(e,t,i){for(const s in t)!gn(t[s])&&!x0(s,i)&&(e[s]=t[s])}function m_({transformTemplate:e},t){return ie.useMemo(()=>{const i=Ff();return Rf(i,t,e),Object.assign({},i.vars,i.style)},[t])}function g_(e,t){const i=e.style||{},s={};return S0(s,i,e),Object.assign(s,m_(e,t)),s}function v_(e,t){const i={},s=g_(e,t);return e.drag&&e.dragListener!==!1&&(i.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(i.tabIndex=0),i.style=s,i}const y_={offset:"stroke-dashoffset",array:"stroke-dasharray"},w_={offset:"strokeDashoffset",array:"strokeDasharray"};function b_(e,t,i=1,s=0,o=!0){e.pathLength=1;const a=o?y_:w_;e[a.offset]=qe.transform(-s);const c=qe.transform(t),f=qe.transform(i);e[a.array]=`${c} ${f}`}function k0(e,{attrX:t,attrY:i,attrScale:s,pathLength:o,pathSpacing:a=1,pathOffset:c=0,...f},h,v,y){if(Rf(e,f,v),h){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:x,style:k}=e;x.transform&&(k.transform=x.transform,delete x.transform),(k.transform||x.transformOrigin)&&(k.transformOrigin=x.transformOrigin??"50% 50%",delete x.transformOrigin),k.transform&&(k.transformBox=y?.transformBox??"fill-box",delete x.transformBox),t!==void 0&&(x.x=t),i!==void 0&&(x.y=i),s!==void 0&&(x.scale=s),o!==void 0&&b_(x,o,a,c,!1)}const _0=()=>({...Ff(),attrs:{}}),C0=e=>typeof e=="string"&&e.toLowerCase()==="svg";function x_(e,t,i,s){const o=ie.useMemo(()=>{const a=_0();return k0(a,t,C0(s),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};S0(a,e.style,e),o.style={...a,...o.style}}return o}const S_=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Of(e){return typeof e!="string"||e.includes("-")?!1:!!(S_.indexOf(e)>-1||/[A-Z]/u.test(e))}function k_(e,t,i,{latestValues:s},o,a=!1){const f=(Of(e)?x_:v_)(t,s,o,e),h=l_(t,typeof e=="string",a),v=e!==ie.Fragment?{...h,...f,ref:i}:{},{children:y}=t,x=ie.useMemo(()=>gn(y)?y.get():y,[y]);return ie.createElement(e,{...v,children:x})}function Tg(e){const t=[{},{}];return e?.values.forEach((i,s)=>{t[0][s]=i.get(),t[1][s]=i.getVelocity()}),t}function Nf(e,t,i,s){if(typeof t=="function"){const[o,a]=Tg(s);t=t(i!==void 0?i:e.custom,o,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[o,a]=Tg(s);t=t(i!==void 0?i:e.custom,o,a)}return t}function Sl(e){return gn(e)?e.get():e}function __({scrapeMotionValuesFromProps:e,createRenderState:t},i,s,o){return{latestValues:C_(i,s,o,e),renderState:t()}}function C_(e,t,i,s){const o={},a=s(e,{});for(const k in a)o[k]=Sl(a[k]);let{initial:c,animate:f}=e;const h=jl(e),v=b0(e);t&&v&&!h&&e.inherit!==!1&&(c===void 0&&(c=t.initial),f===void 0&&(f=t.animate));let y=i?i.initial===!1:!1;y=y||c===!1;const x=y?f:c;if(x&&typeof x!="boolean"&&!Wl(x)){const k=Array.isArray(x)?x:[x];for(let C=0;C<k.length;C++){const M=Nf(e,k[C]);if(M){const{transitionEnd:E,transition:R,...O}=M;for(const j in O){let z=O[j];if(Array.isArray(z)){const W=y?z.length-1:0;z=z[W]}z!==null&&(o[j]=z)}for(const j in E)o[j]=E[j]}}}return o}const T0=e=>(t,i)=>{const s=ie.useContext(Ul),o=ie.useContext(lf),a=()=>__(e,t,s,o);return i?a():Py(a)};function If(e,t,i){const{style:s}=e,o={};for(const a in s)(gn(s[a])||t.style&&gn(t.style[a])||x0(a,e)||i?.getValue(a)?.liveStyle!==void 0)&&(o[a]=s[a]);return o}const T_=T0({scrapeMotionValuesFromProps:If,createRenderState:Ff});function E0(e,t,i){const s=If(e,t,i);for(const o in e)if(gn(e[o])||gn(t[o])){const a=Gs.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;s[a]=e[o]}return s}const E_=T0({scrapeMotionValuesFromProps:E0,createRenderState:_0}),P_=Symbol.for("motionComponentSymbol");function Rs(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function D_(e,t,i){return ie.useCallback(s=>{s&&e.onMount&&e.onMount(s),t&&(s?t.mount(s):t.unmount()),i&&(typeof i=="function"?i(s):Rs(i)&&(i.current=s))},[t])}const Bf=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),L_="framerAppearId",P0="data-"+Bf(L_),D0=ie.createContext({});function M_(e,t,i,s,o){const{visualElement:a}=ie.useContext(Ul),c=ie.useContext(y0),f=ie.useContext(lf),h=ie.useContext(Lf).reducedMotion,v=ie.useRef(null);s=s||c.renderer,!v.current&&s&&(v.current=s(e,{visualState:t,parent:a,props:i,presenceContext:f,blockInitialAnimation:f?f.initial===!1:!1,reducedMotionConfig:h}));const y=v.current,x=ie.useContext(D0);y&&!y.projection&&o&&(y.type==="html"||y.type==="svg")&&A_(v.current,i,o,x);const k=ie.useRef(!1);ie.useInsertionEffect(()=>{y&&k.current&&y.update(i,f)});const C=i[P0],M=ie.useRef(!!C&&!window.MotionHandoffIsComplete?.(C)&&window.MotionHasOptimisedAnimation?.(C));return ak(()=>{y&&(k.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),y.scheduleRenderMicrotask(),M.current&&y.animationState&&y.animationState.animateChanges())}),ie.useEffect(()=>{y&&(!M.current&&y.animationState&&y.animationState.animateChanges(),M.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(C)}),M.current=!1),y.enteringChildren=void 0)}),y}function A_(e,t,i,s){const{layoutId:o,layout:a,drag:c,dragConstraints:f,layoutScroll:h,layoutRoot:v,layoutCrossfade:y}=t;e.projection=new i(e.latestValues,t["data-framer-portal-id"]?void 0:L0(e.parent)),e.projection.setOptions({layoutId:o,layout:a,alwaysMeasureLayout:!!c||f&&Rs(f),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:s,crossfade:y,layoutScroll:h,layoutRoot:v})}function L0(e){if(e)return e.options.allowProjection!==!1?e.projection:L0(e.parent)}function $u(e,{forwardMotionProps:t=!1}={},i,s){i&&s_(i);const o=Of(e)?E_:T_;function a(f,h){let v;const y={...ie.useContext(Lf),...f,layoutId:R_(f)},{isStatic:x}=y,k=u_(f),C=o(f,x);if(!x&&of){F_();const M=O_(y);v=M.MeasureLayout,k.visualElement=M_(e,C,y,s,M.ProjectionNode)}return we.jsxs(Ul.Provider,{value:k,children:[v&&k.visualElement?we.jsx(v,{visualElement:k.visualElement,...y}):null,k_(e,f,D_(C,k.visualElement,h),C,x,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const c=ie.forwardRef(a);return c[P_]=e,c}function R_({layoutId:e}){const t=ie.useContext(Ey).id;return t&&e!==void 0?t+"-"+e:e}function F_(e,t){ie.useContext(y0).strict}function O_(e){const{drag:t,layout:i}=Ys;if(!t&&!i)return{};const s={...t,...i};return{MeasureLayout:t?.isEnabled(e)||i?.isEnabled(e)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function N_(e,t){if(typeof Proxy>"u")return $u;const i=new Map,s=(a,c)=>$u(a,c,e,t),o=(a,c)=>s(a,c);return new Proxy(o,{get:(a,c)=>c==="create"?s:(i.has(c)||i.set(c,$u(c,void 0,e,t)),i.get(c))})}function M0({top:e,left:t,right:i,bottom:s}){return{x:{min:t,max:i},y:{min:e,max:s}}}function I_({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function B_(e,t){if(!t)return e;const i=t({x:e.left,y:e.top}),s=t({x:e.right,y:e.bottom});return{top:i.y,left:i.x,bottom:s.y,right:s.x}}function Yu(e){return e===void 0||e===1}function Md({scale:e,scaleX:t,scaleY:i}){return!Yu(e)||!Yu(t)||!Yu(i)}function $r(e){return Md(e)||A0(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function A0(e){return Eg(e.x)||Eg(e.y)}function Eg(e){return e&&e!=="0%"}function Nl(e,t,i){const s=e-i,o=t*s;return i+o}function Pg(e,t,i,s,o){return o!==void 0&&(e=Nl(e,o,s)),Nl(e,i,s)+t}function Ad(e,t=0,i=1,s,o){e.min=Pg(e.min,t,i,s,o),e.max=Pg(e.max,t,i,s,o)}function R0(e,{x:t,y:i}){Ad(e.x,t.translate,t.scale,t.originPoint),Ad(e.y,i.translate,i.scale,i.originPoint)}const Dg=.999999999999,Lg=1.0000000000001;function z_(e,t,i,s=!1){const o=i.length;if(!o)return;t.x=t.y=1;let a,c;for(let f=0;f<o;f++){a=i[f],c=a.projectionDelta;const{visualElement:h}=a.options;h&&h.props.style&&h.props.style.display==="contents"||(s&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Os(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),c&&(t.x*=c.x.scale,t.y*=c.y.scale,R0(e,c)),s&&$r(a.latestValues)&&Os(e,a.latestValues))}t.x<Lg&&t.x>Dg&&(t.x=1),t.y<Lg&&t.y>Dg&&(t.y=1)}function Fs(e,t){e.min=e.min+t,e.max=e.max+t}function Mg(e,t,i,s,o=.5){const a=At(e.min,e.max,o);Ad(e,t,i,a,s)}function Os(e,t){Mg(e.x,t.x,t.scaleX,t.scale,t.originX),Mg(e.y,t.y,t.scaleY,t.scale,t.originY)}function F0(e,t){return M0(B_(e.getBoundingClientRect(),t))}function V_(e,t,i){const s=F0(e,i),{scroll:o}=t;return o&&(Fs(s.x,o.offset.x),Fs(s.y,o.offset.y)),s}const Ag=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ns=()=>({x:Ag(),y:Ag()}),Rg=()=>({min:0,max:0}),Qt=()=>({x:Rg(),y:Rg()}),Rd={current:null},O0={current:!1};function U_(){if(O0.current=!0,!!of)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Rd.current=e.matches;e.addEventListener("change",t),t()}else Rd.current=!1}const W_=new WeakMap;function j_(e,t,i){for(const s in t){const o=t[s],a=i[s];if(gn(o))e.addValue(s,o);else if(gn(a))e.addValue(s,is(o,{owner:e}));else if(a!==o)if(e.hasValue(s)){const c=e.getValue(s);c.liveStyle===!0?c.jump(o):c.hasAnimated||c.set(o)}else{const c=e.getStaticValue(s);e.addValue(s,is(c!==void 0?c:o,{owner:e}))}}for(const s in i)t[s]===void 0&&e.removeValue(s);return t}const Fg=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class q_{scrapeMotionValuesFromProps(t,i,s){return{}}constructor({parent:t,props:i,presenceContext:s,reducedMotionConfig:o,blockInitialAnimation:a,visualState:c},f={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Cf,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const k=zn.now();this.renderScheduledAt<k&&(this.renderScheduledAt=k,Et.render(this.render,!1,!0))};const{latestValues:h,renderState:v}=c;this.latestValues=h,this.baseTarget={...h},this.initialValues=i.initial?{...h}:{},this.renderState=v,this.parent=t,this.props=i,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=o,this.options=f,this.blockInitialAnimation=!!a,this.isControllingVariants=jl(i),this.isVariantNode=b0(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:y,...x}=this.scrapeMotionValuesFromProps(i,{},this);for(const k in x){const C=x[k];h[k]!==void 0&&gn(C)&&C.set(h[k])}}mount(t){this.current=t,W_.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,s)=>this.bindToMotionValue(s,i)),O0.current||U_(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Rd.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Tr(this.notifyUpdate),Tr(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const i=this.features[t];i&&(i.unmount(),i.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,i){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=Ks.has(t);s&&this.onBindTransform&&this.onBindTransform();const o=i.on("change",c=>{this.latestValues[t]=c,this.props.onUpdate&&Et.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,i)),this.valueSubscriptions.set(t,()=>{o(),a&&a(),i.owner&&i.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Ys){const i=Ys[t];if(!i)continue;const{isEnabled:s,Feature:o}=i;if(!this.features[t]&&o&&s(this.props)&&(this.features[t]=new o(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Qt()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,i){this.latestValues[t]=i}update(t,i){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let s=0;s<Fg.length;s++){const o=Fg[s];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const a="on"+o,c=t[a];c&&(this.propEventSubscriptions[o]=this.on(o,c))}this.prevMotionValues=j_(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(t),()=>i.variantChildren.delete(t)}addValue(t,i){const s=this.values.get(t);i!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,i),this.values.set(t,i),this.latestValues[t]=i.get())}removeValue(t){this.values.delete(t);const i=this.valueSubscriptions.get(t);i&&(i(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,i){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&i!==void 0&&(s=is(i===null?void 0:i,{owner:this}),this.addValue(t,s)),s}readValue(t,i){let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(Dy(s)||My(s))?s=parseFloat(s):!i_(s)&&Er.test(i)&&(s=f0(t,i)),this.setBaseTarget(t,gn(s)?s.get():s)),gn(s)?s.get():s}setBaseTarget(t,i){this.baseTarget[t]=i}getBaseTarget(t){const{initial:i}=this.props;let s;if(typeof i=="string"||typeof i=="object"){const a=Nf(this.props,i,this.presenceContext?.custom);a&&(s=a[t])}if(i&&s!==void 0)return s;const o=this.getBaseTargetFromProps(this.props,t);return o!==void 0&&!gn(o)?o:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,i){return this.events[t]||(this.events[t]=new pf),this.events[t].add(i)}notify(t,...i){this.events[t]&&this.events[t].notify(...i)}scheduleRenderMicrotask(){Pf.render(this.render)}}class N0 extends q_{constructor(){super(...arguments),this.KeyframeResolver=q2}sortInstanceNodePosition(t,i){return t.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(t,i){return t.style?t.style[i]:void 0}removeValueFromRenderState(t,{vars:i,style:s}){delete i[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;gn(t)&&(this.childSubscription=t.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}}function I0(e,{style:t,vars:i},s,o){const a=e.style;let c;for(c in t)a[c]=t[c];o?.applyProjectionStyles(a,s);for(c in i)a.setProperty(c,i[c])}function H_(e){return window.getComputedStyle(e)}class $_ extends N0{constructor(){super(...arguments),this.type="html",this.renderInstance=I0}readValueFromInstance(t,i){if(Ks.has(i))return this.projection?.isProjecting?_d(i):c2(t,i);{const s=H_(t),o=(gf(i)?s.getPropertyValue(i):s[i])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(t,{transformPagePoint:i}){return F0(t,i)}build(t,i,s){Rf(t,i,s.transformTemplate)}scrapeMotionValuesFromProps(t,i,s){return If(t,i,s)}}const B0=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Y_(e,t,i,s){I0(e,t,void 0,s);for(const o in t.attrs)e.setAttribute(B0.has(o)?o:Bf(o),t.attrs[o])}class X_ extends N0{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Qt}getBaseTargetFromProps(t,i){return t[i]}readValueFromInstance(t,i){if(Ks.has(i)){const s=d0(i);return s&&s.default||0}return i=B0.has(i)?i:Bf(i),t.getAttribute(i)}scrapeMotionValuesFromProps(t,i,s){return E0(t,i,s)}build(t,i,s){k0(t,i,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(t,i,s,o){Y_(t,i,s,o)}mount(t){this.isSVGTag=C0(t.tagName),super.mount(t)}}const G_=(e,t)=>Of(e)?new X_(t):new $_(t,{allowProjection:e!==ie.Fragment});function Vs(e,t,i){const s=e.getProps();return Nf(s,t,i!==void 0?i:s.custom,e)}const Fd=e=>Array.isArray(e);function K_(e,t,i){e.hasValue(t)?e.getValue(t).set(i):e.addValue(t,is(i))}function Q_(e){return Fd(e)?e[e.length-1]||0:e}function Z_(e,t){const i=Vs(e,t);let{transitionEnd:s={},transition:o={},...a}=i||{};a={...a,...s};for(const c in a){const f=Q_(a[c]);K_(e,c,f)}}function J_(e){return!!(gn(e)&&e.add)}function Od(e,t){const i=e.getValue("willChange");if(J_(i))return i.add(t);if(!i&&Qi.WillChange){const s=new Qi.WillChange("auto");e.addValue("willChange",s),s.add(t)}}function z0(e){return e.props[P0]}const eC=e=>e!==null;function tC(e,{repeat:t,repeatType:i="loop"},s){const o=e.filter(eC),a=t&&i!=="loop"&&t%2===1?0:o.length-1;return o[a]}const nC={type:"spring",stiffness:500,damping:25,restSpeed:10},iC=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),rC={type:"keyframes",duration:.8},sC={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},aC=(e,{keyframes:t})=>t.length>2?rC:Ks.has(e)?e.startsWith("scale")?iC(t[1]):nC:sC;function oC({when:e,delay:t,delayChildren:i,staggerChildren:s,staggerDirection:o,repeat:a,repeatType:c,repeatDelay:f,from:h,elapsed:v,...y}){return!!Object.keys(y).length}const zf=(e,t,i,s={},o,a)=>c=>{const f=Tf(s,e)||{},h=f.delay||s.delay||0;let{elapsed:v=0}=s;v=v-Oi(h);const y={keyframes:Array.isArray(i)?i:[null,i],ease:"easeOut",velocity:t.getVelocity(),...f,delay:-v,onUpdate:k=>{t.set(k),f.onUpdate&&f.onUpdate(k)},onComplete:()=>{c(),f.onComplete&&f.onComplete()},name:e,motionValue:t,element:a?void 0:o};oC(f)||Object.assign(y,aC(e,y)),y.duration&&(y.duration=Oi(y.duration)),y.repeatDelay&&(y.repeatDelay=Oi(y.repeatDelay)),y.from!==void 0&&(y.keyframes[0]=y.from);let x=!1;if((y.type===!1||y.duration===0&&!y.repeatDelay)&&(Dd(y),y.delay===0&&(x=!0)),(Qi.instantAnimations||Qi.skipAnimations)&&(x=!0,Dd(y),y.delay=0),y.allowFlatten=!f.type&&!f.ease,x&&!a&&t.get()!==void 0){const k=tC(y.keyframes,f);if(k!==void 0){Et.update(()=>{y.onUpdate(k),y.onComplete()});return}}return f.isSync?new _f(y):new A2(y)};function lC({protectedKeys:e,needsAnimating:t},i){const s=e.hasOwnProperty(i)&&t[i]!==!0;return t[i]=!1,s}function V0(e,t,{delay:i=0,transitionOverride:s,type:o}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:c,...f}=t;s&&(a=s);const h=[],v=o&&e.animationState&&e.animationState.getState()[o];for(const y in f){const x=e.getValue(y,e.latestValues[y]??null),k=f[y];if(k===void 0||v&&lC(v,y))continue;const C={delay:i,...Tf(a||{},y)},M=x.get();if(M!==void 0&&!x.isAnimating&&!Array.isArray(k)&&k===M&&!C.velocity)continue;let E=!1;if(window.MotionHandoffAnimation){const O=z0(e);if(O){const j=window.MotionHandoffAnimation(O,y,Et);j!==null&&(C.startTime=j,E=!0)}}Od(e,y),x.start(zf(y,x,k,e.shouldReduceMotion&&l0.has(y)?{type:!1}:C,e,E));const R=x.animation;R&&h.push(R)}return c&&Promise.all(h).then(()=>{Et.update(()=>{c&&Z_(e,c)})}),h}function U0(e,t,i,s=0,o=1){const a=Array.from(e).sort((v,y)=>v.sortNodePosition(y)).indexOf(t),c=e.size,f=(c-1)*s;return typeof i=="function"?i(a,c):o===1?a*s:f-a*s}function Nd(e,t,i={}){const s=Vs(e,t,i.type==="exit"?e.presenceContext?.custom:void 0);let{transition:o=e.getDefaultTransition()||{}}=s||{};i.transitionOverride&&(o=i.transitionOverride);const a=s?()=>Promise.all(V0(e,s,i)):()=>Promise.resolve(),c=e.variantChildren&&e.variantChildren.size?(h=0)=>{const{delayChildren:v=0,staggerChildren:y,staggerDirection:x}=o;return cC(e,t,h,v,y,x,i)}:()=>Promise.resolve(),{when:f}=o;if(f){const[h,v]=f==="beforeChildren"?[a,c]:[c,a];return h().then(()=>v())}else return Promise.all([a(),c(i.delay)])}function cC(e,t,i=0,s=0,o=0,a=1,c){const f=[];for(const h of e.variantChildren)h.notify("AnimationStart",t),f.push(Nd(h,t,{...c,delay:i+(typeof s=="function"?0:s)+U0(e.variantChildren,h,s,o,a)}).then(()=>h.notify("AnimationComplete",t)));return Promise.all(f)}function uC(e,t,i={}){e.notify("AnimationStart",t);let s;if(Array.isArray(t)){const o=t.map(a=>Nd(e,a,i));s=Promise.all(o)}else if(typeof t=="string")s=Nd(e,t,i);else{const o=typeof t=="function"?Vs(e,t,i.custom):t;s=Promise.all(V0(e,o,i))}return s.then(()=>{e.notify("AnimationComplete",t)})}function W0(e,t){if(!Array.isArray(t))return!1;const i=t.length;if(i!==e.length)return!1;for(let s=0;s<i;s++)if(t[s]!==e[s])return!1;return!0}const dC=Af.length;function j0(e){if(!e)return;if(!e.isControllingVariants){const i=e.parent?j0(e.parent)||{}:{};return e.props.initial!==void 0&&(i.initial=e.props.initial),i}const t={};for(let i=0;i<dC;i++){const s=Af[i],o=e.props[s];(no(o)||o===!1)&&(t[s]=o)}return t}const fC=[...Mf].reverse(),pC=Mf.length;function hC(e){return t=>Promise.all(t.map(({animation:i,options:s})=>uC(e,i,s)))}function mC(e){let t=hC(e),i=Og(),s=!0;const o=h=>(v,y)=>{const x=Vs(e,y,h==="exit"?e.presenceContext?.custom:void 0);if(x){const{transition:k,transitionEnd:C,...M}=x;v={...v,...M,...C}}return v};function a(h){t=h(e)}function c(h){const{props:v}=e,y=j0(e.parent)||{},x=[],k=new Set;let C={},M=1/0;for(let R=0;R<pC;R++){const O=fC[R],j=i[O],z=v[O]!==void 0?v[O]:y[O],W=no(z),V=O===h?j.isActive:null;V===!1&&(M=R);let H=z===y[O]&&z!==v[O]&&W;if(H&&s&&e.manuallyAnimateOnMount&&(H=!1),j.protectedKeys={...C},!j.isActive&&V===null||!z&&!j.prevProp||Wl(z)||typeof z=="boolean")continue;const J=gC(j.prevProp,z);let N=J||O===h&&j.isActive&&!H&&W||R>M&&W,G=!1;const se=Array.isArray(z)?z:[z];let fe=se.reduce(o(O),{});V===!1&&(fe={});const{prevResolvedValues:me={}}=j,be={...me,...fe},ye=ke=>{N=!0,k.has(ke)&&(G=!0,k.delete(ke)),j.needsAnimating[ke]=!0;const oe=e.getValue(ke);oe&&(oe.liveStyle=!1)};for(const ke in be){const oe=fe[ke],_e=me[ke];if(C.hasOwnProperty(ke))continue;let u=!1;Fd(oe)&&Fd(_e)?u=!W0(oe,_e):u=oe!==_e,u?oe!=null?ye(ke):k.add(ke):oe!==void 0&&k.has(ke)?ye(ke):j.protectedKeys[ke]=!0}j.prevProp=z,j.prevResolvedValues=fe,j.isActive&&(C={...C,...fe}),s&&e.blockInitialAnimation&&(N=!1);const We=H&&J;N&&(!We||G)&&x.push(...se.map(ke=>{const oe={type:O};if(typeof ke=="string"&&s&&!We&&e.manuallyAnimateOnMount&&e.parent){const{parent:_e}=e,u=Vs(_e,ke);if(_e.enteringChildren&&u){const{delayChildren:p}=u.transition||{};oe.delay=U0(_e.enteringChildren,e,p)}}return{animation:ke,options:oe}}))}if(k.size){const R={};if(typeof v.initial!="boolean"){const O=Vs(e,Array.isArray(v.initial)?v.initial[0]:v.initial);O&&O.transition&&(R.transition=O.transition)}k.forEach(O=>{const j=e.getBaseTarget(O),z=e.getValue(O);z&&(z.liveStyle=!0),R[O]=j??null}),x.push({animation:R})}let E=!!x.length;return s&&(v.initial===!1||v.initial===v.animate)&&!e.manuallyAnimateOnMount&&(E=!1),s=!1,E?t(x):Promise.resolve()}function f(h,v){if(i[h].isActive===v)return Promise.resolve();e.variantChildren?.forEach(x=>x.animationState?.setActive(h,v)),i[h].isActive=v;const y=c(h);for(const x in i)i[x].protectedKeys={};return y}return{animateChanges:c,setActive:f,setAnimateFunction:a,getState:()=>i,reset:()=>{i=Og()}}}function gC(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!W0(t,e):!1}function qr(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Og(){return{animate:qr(!0),whileInView:qr(),whileHover:qr(),whileTap:qr(),whileDrag:qr(),whileFocus:qr(),exit:qr()}}class Dr{constructor(t){this.isMounted=!1,this.node=t}update(){}}class vC extends Dr{constructor(t){super(t),t.animationState||(t.animationState=mC(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Wl(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:i}=this.node.prevProps||{};t!==i&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let yC=0;class wC extends Dr{constructor(){super(...arguments),this.id=yC++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:i}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const o=this.node.animationState.setActive("exit",!t);i&&!t&&o.then(()=>{i(this.id)})}mount(){const{register:t,onExitComplete:i}=this.node.presenceContext||{};i&&i(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const bC={animation:{Feature:vC},exit:{Feature:wC}};function ro(e,t,i,s={passive:!0}){return e.addEventListener(t,i,s),()=>e.removeEventListener(t,i)}function co(e){return{point:{x:e.pageX,y:e.pageY}}}const xC=e=>t=>Df(t)&&e(t,co(t));function qa(e,t,i,s){return ro(e,t,xC(i),s)}const q0=1e-4,SC=1-q0,kC=1+q0,H0=.01,_C=0-H0,CC=0+H0;function Tn(e){return e.max-e.min}function TC(e,t,i){return Math.abs(e-t)<=i}function Ng(e,t,i,s=.5){e.origin=s,e.originPoint=At(t.min,t.max,e.origin),e.scale=Tn(i)/Tn(t),e.translate=At(i.min,i.max,e.origin)-e.originPoint,(e.scale>=SC&&e.scale<=kC||isNaN(e.scale))&&(e.scale=1),(e.translate>=_C&&e.translate<=CC||isNaN(e.translate))&&(e.translate=0)}function Ha(e,t,i,s){Ng(e.x,t.x,i.x,s?s.originX:void 0),Ng(e.y,t.y,i.y,s?s.originY:void 0)}function Ig(e,t,i){e.min=i.min+t.min,e.max=e.min+Tn(t)}function EC(e,t,i){Ig(e.x,t.x,i.x),Ig(e.y,t.y,i.y)}function Bg(e,t,i){e.min=t.min-i.min,e.max=e.min+Tn(t)}function Il(e,t,i){Bg(e.x,t.x,i.x),Bg(e.y,t.y,i.y)}function fi(e){return[e("x"),e("y")]}const $0=({current:e})=>e?e.ownerDocument.defaultView:null,zg=(e,t)=>Math.abs(e-t);function PC(e,t){const i=zg(e.x,t.x),s=zg(e.y,t.y);return Math.sqrt(i**2+s**2)}class Y0{constructor(t,i,{transformPagePoint:s,contextWindow:o=window,dragSnapToOrigin:a=!1,distanceThreshold:c=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const k=Gu(this.lastMoveEventInfo,this.history),C=this.startEvent!==null,M=PC(k.offset,{x:0,y:0})>=this.distanceThreshold;if(!C&&!M)return;const{point:E}=k,{timestamp:R}=ln;this.history.push({...E,timestamp:R});const{onStart:O,onMove:j}=this.handlers;C||(O&&O(this.lastMoveEvent,k),this.startEvent=this.lastMoveEvent),j&&j(this.lastMoveEvent,k)},this.handlePointerMove=(k,C)=>{this.lastMoveEvent=k,this.lastMoveEventInfo=Xu(C,this.transformPagePoint),Et.update(this.updatePoint,!0)},this.handlePointerUp=(k,C)=>{this.end();const{onEnd:M,onSessionEnd:E,resumeAnimation:R}=this.handlers;if(this.dragSnapToOrigin&&R&&R(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const O=Gu(k.type==="pointercancel"?this.lastMoveEventInfo:Xu(C,this.transformPagePoint),this.history);this.startEvent&&M&&M(k,O),E&&E(k,O)},!Df(t))return;this.dragSnapToOrigin=a,this.handlers=i,this.transformPagePoint=s,this.distanceThreshold=c,this.contextWindow=o||window;const f=co(t),h=Xu(f,this.transformPagePoint),{point:v}=h,{timestamp:y}=ln;this.history=[{...v,timestamp:y}];const{onSessionStart:x}=i;x&&x(t,Gu(h,this.history)),this.removeListeners=ao(qa(this.contextWindow,"pointermove",this.handlePointerMove),qa(this.contextWindow,"pointerup",this.handlePointerUp),qa(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Tr(this.updatePoint)}}function Xu(e,t){return t?{point:t(e.point)}:e}function Vg(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Gu({point:e},t){return{point:e,delta:Vg(e,X0(t)),offset:Vg(e,DC(t)),velocity:LC(t,.1)}}function DC(e){return e[0]}function X0(e){return e[e.length-1]}function LC(e,t){if(e.length<2)return{x:0,y:0};let i=e.length-1,s=null;const o=X0(e);for(;i>=0&&(s=e[i],!(o.timestamp-s.timestamp>Oi(t)));)i--;if(!s)return{x:0,y:0};const a=gi(o.timestamp-s.timestamp);if(a===0)return{x:0,y:0};const c={x:(o.x-s.x)/a,y:(o.y-s.y)/a};return c.x===1/0&&(c.x=0),c.y===1/0&&(c.y=0),c}function MC(e,{min:t,max:i},s){return t!==void 0&&e<t?e=s?At(t,e,s.min):Math.max(e,t):i!==void 0&&e>i&&(e=s?At(i,e,s.max):Math.min(e,i)),e}function Ug(e,t,i){return{min:t!==void 0?e.min+t:void 0,max:i!==void 0?e.max+i-(e.max-e.min):void 0}}function AC(e,{top:t,left:i,bottom:s,right:o}){return{x:Ug(e.x,i,o),y:Ug(e.y,t,s)}}function Wg(e,t){let i=t.min-e.min,s=t.max-e.max;return t.max-t.min<e.max-e.min&&([i,s]=[s,i]),{min:i,max:s}}function RC(e,t){return{x:Wg(e.x,t.x),y:Wg(e.y,t.y)}}function FC(e,t){let i=.5;const s=Tn(e),o=Tn(t);return o>s?i=Ja(t.min,t.max-s,e.min):s>o&&(i=Ja(e.min,e.max-o,t.min)),Ki(0,1,i)}function OC(e,t){const i={};return t.min!==void 0&&(i.min=t.min-e.min),t.max!==void 0&&(i.max=t.max-e.min),i}const Id=.35;function NC(e=Id){return e===!1?e=0:e===!0&&(e=Id),{x:jg(e,"left","right"),y:jg(e,"top","bottom")}}function jg(e,t,i){return{min:qg(e,t),max:qg(e,i)}}function qg(e,t){return typeof e=="number"?e:e[t]||0}const IC=new WeakMap;class BC{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Qt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:i=!1,distanceThreshold:s}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const a=x=>{const{dragSnapToOrigin:k}=this.getProps();k?this.pauseAnimation():this.stopAnimation(),i&&this.snapToCursor(co(x).point)},c=(x,k)=>{const{drag:C,dragPropagation:M,onDragStart:E}=this.getProps();if(C&&!M&&(this.openDragLock&&this.openDragLock(),this.openDragLock=G2(C),!this.openDragLock))return;this.latestPointerEvent=x,this.latestPanInfo=k,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fi(O=>{let j=this.getAxisMotionValue(O).get()||0;if(Ni.test(j)){const{projection:z}=this.visualElement;if(z&&z.layout){const W=z.layout.layoutBox[O];W&&(j=Tn(W)*(parseFloat(j)/100))}}this.originPoint[O]=j}),E&&Et.postRender(()=>E(x,k)),Od(this.visualElement,"transform");const{animationState:R}=this.visualElement;R&&R.setActive("whileDrag",!0)},f=(x,k)=>{this.latestPointerEvent=x,this.latestPanInfo=k;const{dragPropagation:C,dragDirectionLock:M,onDirectionLock:E,onDrag:R}=this.getProps();if(!C&&!this.openDragLock)return;const{offset:O}=k;if(M&&this.currentDirection===null){this.currentDirection=zC(O),this.currentDirection!==null&&E&&E(this.currentDirection);return}this.updateAxis("x",k.point,O),this.updateAxis("y",k.point,O),this.visualElement.render(),R&&R(x,k)},h=(x,k)=>{this.latestPointerEvent=x,this.latestPanInfo=k,this.stop(x,k),this.latestPointerEvent=null,this.latestPanInfo=null},v=()=>fi(x=>this.getAnimationState(x)==="paused"&&this.getAxisMotionValue(x).animation?.play()),{dragSnapToOrigin:y}=this.getProps();this.panSession=new Y0(t,{onSessionStart:a,onStart:c,onMove:f,onSessionEnd:h,resumeAnimation:v},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:y,distanceThreshold:s,contextWindow:$0(this.visualElement)})}stop(t,i){const s=t||this.latestPointerEvent,o=i||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!o||!s)return;const{velocity:c}=o;this.startAnimation(c);const{onDragEnd:f}=this.getProps();f&&Et.postRender(()=>f(s,o))}cancel(){this.isDragging=!1;const{projection:t,animationState:i}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(t,i,s){const{drag:o}=this.getProps();if(!s||!gl(t,o,this.currentDirection))return;const a=this.getAxisMotionValue(t);let c=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(c=MC(c,this.constraints[t],this.elastic[t])),a.set(c)}resolveConstraints(){const{dragConstraints:t,dragElastic:i}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,o=this.constraints;t&&Rs(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&s?this.constraints=AC(s.layoutBox,t):this.constraints=!1,this.elastic=NC(i),o!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&fi(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=OC(s.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:i}=this.getProps();if(!t||!Rs(t))return!1;const s=t.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const a=V_(s,o.root,this.visualElement.getTransformPagePoint());let c=RC(o.layout.layoutBox,a);if(i){const f=i(I_(c));this.hasMutatedConstraints=!!f,f&&(c=M0(f))}return c}startAnimation(t){const{drag:i,dragMomentum:s,dragElastic:o,dragTransition:a,dragSnapToOrigin:c,onDragTransitionEnd:f}=this.getProps(),h=this.constraints||{},v=fi(y=>{if(!gl(y,i,this.currentDirection))return;let x=h&&h[y]||{};c&&(x={min:0,max:0});const k=o?200:1e6,C=o?40:1e7,M={type:"inertia",velocity:s?t[y]:0,bounceStiffness:k,bounceDamping:C,timeConstant:750,restDelta:1,restSpeed:10,...a,...x};return this.startAxisValueAnimation(y,M)});return Promise.all(v).then(f)}startAxisValueAnimation(t,i){const s=this.getAxisMotionValue(t);return Od(this.visualElement,t),s.start(zf(t,s,0,i,this.visualElement,!1))}stopAnimation(){fi(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){fi(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const i=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),o=s[i];return o||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){fi(i=>{const{drag:s}=this.getProps();if(!gl(i,s,this.currentDirection))return;const{projection:o}=this.visualElement,a=this.getAxisMotionValue(i);if(o&&o.layout){const{min:c,max:f}=o.layout.layoutBox[i];a.set(t[i]-At(c,f,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:i}=this.getProps(),{projection:s}=this.visualElement;if(!Rs(i)||!s||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};fi(c=>{const f=this.getAxisMotionValue(c);if(f&&this.constraints!==!1){const h=f.get();o[c]=FC({min:h,max:h},this.constraints[c])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),fi(c=>{if(!gl(c,t,null))return;const f=this.getAxisMotionValue(c),{min:h,max:v}=this.constraints[c];f.set(At(h,v,o[c]))})}addListeners(){if(!this.visualElement.current)return;IC.set(this.visualElement,this);const t=this.visualElement.current,i=qa(t,"pointerdown",h=>{const{drag:v,dragListener:y=!0}=this.getProps();v&&y&&this.start(h)}),s=()=>{const{dragConstraints:h}=this.getProps();Rs(h)&&h.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,a=o.addEventListener("measure",s);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),Et.read(s);const c=ro(window,"resize",()=>this.scalePositionWithinConstraints()),f=o.addEventListener("didUpdate",(({delta:h,hasLayoutChanged:v})=>{this.isDragging&&v&&(fi(y=>{const x=this.getAxisMotionValue(y);x&&(this.originPoint[y]+=h[y].translate,x.set(x.get()+h[y].translate))}),this.visualElement.render())}));return()=>{c(),i(),a(),f&&f()}}getProps(){const t=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:s=!1,dragPropagation:o=!1,dragConstraints:a=!1,dragElastic:c=Id,dragMomentum:f=!0}=t;return{...t,drag:i,dragDirectionLock:s,dragPropagation:o,dragConstraints:a,dragElastic:c,dragMomentum:f}}}function gl(e,t,i){return(t===!0||t===e)&&(i===null||i===e)}function zC(e,t=10){let i=null;return Math.abs(e.y)>t?i="y":Math.abs(e.x)>t&&(i="x"),i}class VC extends Dr{constructor(t){super(t),this.removeGroupControls=vi,this.removeListeners=vi,this.controls=new BC(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||vi}unmount(){this.removeGroupControls(),this.removeListeners()}}const Hg=e=>(t,i)=>{e&&Et.postRender(()=>e(t,i))};class UC extends Dr{constructor(){super(...arguments),this.removePointerDownListener=vi}onPointerDown(t){this.session=new Y0(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:$0(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:i,onPan:s,onPanEnd:o}=this.node.getProps();return{onSessionStart:Hg(t),onStart:Hg(i),onMove:s,onEnd:(a,c)=>{delete this.session,o&&Et.postRender(()=>o(a,c))}}}mount(){this.removePointerDownListener=qa(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const kl={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function $g(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Aa={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(qe.test(e))e=parseFloat(e);else return e;const i=$g(e,t.target.x),s=$g(e,t.target.y);return`${i}% ${s}%`}},WC={correct:(e,{treeScale:t,projectionDelta:i})=>{const s=e,o=Er.parse(e);if(o.length>5)return s;const a=Er.createTransformer(e),c=typeof o[0]!="number"?1:0,f=i.x.scale*t.x,h=i.y.scale*t.y;o[0+c]/=f,o[1+c]/=h;const v=At(f,h,.5);return typeof o[2+c]=="number"&&(o[2+c]/=v),typeof o[3+c]=="number"&&(o[3+c]/=v),a(o)}};let Ku=!1;class jC extends ie.Component{componentDidMount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:s,layoutId:o}=this.props,{projection:a}=t;d_(qC),a&&(i.group&&i.group.add(a),s&&s.register&&o&&s.register(a),Ku&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),kl.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:i,visualElement:s,drag:o,isPresent:a}=this.props,{projection:c}=s;return c&&(c.isPresent=a,Ku=!0,o||t.layoutDependency!==i||i===void 0||t.isPresent!==a?c.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?c.promote():c.relegate()||Et.postRender(()=>{const f=c.getStack();(!f||!f.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Pf.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:s}=this.props,{projection:o}=t;Ku=!0,o&&(o.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(o),s&&s.deregister&&s.deregister(o))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function G0(e){const[t,i]=r_(),s=ie.useContext(Ey);return we.jsx(jC,{...e,layoutGroup:s,switchLayoutGroup:ie.useContext(D0),isPresent:t,safeToRemove:i})}const qC={borderRadius:{...Aa,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Aa,borderTopRightRadius:Aa,borderBottomLeftRadius:Aa,borderBottomRightRadius:Aa,boxShadow:WC};function HC(e,t,i){const s=gn(e)?e:is(e);return s.start(zf("",s,t,i)),s.animation}const $C=(e,t)=>e.depth-t.depth;class YC{constructor(){this.children=[],this.isDirty=!1}add(t){cf(this.children,t),this.isDirty=!0}remove(t){uf(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort($C),this.isDirty=!1,this.children.forEach(t)}}function XC(e,t){const i=zn.now(),s=({timestamp:o})=>{const a=o-i;a>=t&&(Tr(s),e(a-t))};return Et.setup(s,!0),()=>Tr(s)}const K0=["TopLeft","TopRight","BottomLeft","BottomRight"],GC=K0.length,Yg=e=>typeof e=="string"?parseFloat(e):e,Xg=e=>typeof e=="number"||qe.test(e);function KC(e,t,i,s,o,a){o?(e.opacity=At(0,i.opacity??1,QC(s)),e.opacityExit=At(t.opacity??1,0,ZC(s))):a&&(e.opacity=At(t.opacity??1,i.opacity??1,s));for(let c=0;c<GC;c++){const f=`border${K0[c]}Radius`;let h=Gg(t,f),v=Gg(i,f);if(h===void 0&&v===void 0)continue;h||(h=0),v||(v=0),h===0||v===0||Xg(h)===Xg(v)?(e[f]=Math.max(At(Yg(h),Yg(v),s),0),(Ni.test(v)||Ni.test(h))&&(e[f]+="%")):e[f]=v}(t.rotate||i.rotate)&&(e.rotate=At(t.rotate||0,i.rotate||0,s))}function Gg(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const QC=Q0(0,.5,zy),ZC=Q0(.5,.95,vi);function Q0(e,t,i){return s=>s<e?0:s>t?1:i(Ja(e,t,s))}function Kg(e,t){e.min=t.min,e.max=t.max}function _i(e,t){Kg(e.x,t.x),Kg(e.y,t.y)}function Qg(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function Zg(e,t,i,s,o){return e-=t,e=Nl(e,1/i,s),o!==void 0&&(e=Nl(e,1/o,s)),e}function JC(e,t=0,i=1,s=.5,o,a=e,c=e){if(Ni.test(t)&&(t=parseFloat(t),t=At(c.min,c.max,t/100)-c.min),typeof t!="number")return;let f=At(a.min,a.max,s);e===a&&(f-=t),e.min=Zg(e.min,t,i,f,o),e.max=Zg(e.max,t,i,f,o)}function Jg(e,t,[i,s,o],a,c){JC(e,t[i],t[s],t[o],t.scale,a,c)}const eT=["x","scaleX","originX"],tT=["y","scaleY","originY"];function ev(e,t,i,s){Jg(e.x,t,eT,i?i.x:void 0,s?s.x:void 0),Jg(e.y,t,tT,i?i.y:void 0,s?s.y:void 0)}function tv(e){return e.translate===0&&e.scale===1}function Z0(e){return tv(e.x)&&tv(e.y)}function nv(e,t){return e.min===t.min&&e.max===t.max}function nT(e,t){return nv(e.x,t.x)&&nv(e.y,t.y)}function iv(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function J0(e,t){return iv(e.x,t.x)&&iv(e.y,t.y)}function rv(e){return Tn(e.x)/Tn(e.y)}function sv(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class iT{constructor(){this.members=[]}add(t){cf(this.members,t),t.scheduleRender()}remove(t){if(uf(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(t){const i=this.members.findIndex(o=>t===o);if(i===0)return!1;let s;for(let o=i;o>=0;o--){const a=this.members[o];if(a.isPresent!==!1){s=a;break}}return s?(this.promote(s),!0):!1}promote(t,i){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender(),t.resumeFrom=s,i&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:o}=t.options;o===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:i,resumingFrom:s}=t;i.onExitComplete&&i.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function rT(e,t,i){let s="";const o=e.x.translate/t.x,a=e.y.translate/t.y,c=i?.z||0;if((o||a||c)&&(s=`translate3d(${o}px, ${a}px, ${c}px) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),i){const{transformPerspective:v,rotate:y,rotateX:x,rotateY:k,skewX:C,skewY:M}=i;v&&(s=`perspective(${v}px) ${s}`),y&&(s+=`rotate(${y}deg) `),x&&(s+=`rotateX(${x}deg) `),k&&(s+=`rotateY(${k}deg) `),C&&(s+=`skewX(${C}deg) `),M&&(s+=`skewY(${M}deg) `)}const f=e.x.scale*t.x,h=e.y.scale*t.y;return(f!==1||h!==1)&&(s+=`scale(${f}, ${h})`),s||"none"}const Qu=["","X","Y","Z"],sT=1e3;let aT=0;function Zu(e,t,i,s){const{latestValues:o}=t;o[e]&&(i[e]=o[e],t.setStaticValue(e,0),s&&(s[e]=0))}function ew(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const i=z0(t);if(window.MotionHasOptimisedAnimation(i,"transform")){const{layout:o,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(i,"transform",Et,!(o||a))}const{parent:s}=e;s&&!s.hasCheckedOptimisedAppear&&ew(s)}function tw({attachResizeListener:e,defaultParent:t,measureScroll:i,checkIsScrollRoot:s,resetTransform:o}){return class{constructor(c={},f=t?.()){this.id=aT++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(cT),this.nodes.forEach(pT),this.nodes.forEach(hT),this.nodes.forEach(uT)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=c,this.root=f?f.root||f:this,this.path=f?[...f.path,f]:[],this.parent=f,this.depth=f?f.depth+1:0;for(let h=0;h<this.path.length;h++)this.path[h].shouldResetTransform=!0;this.root===this&&(this.nodes=new YC)}addEventListener(c,f){return this.eventHandlers.has(c)||this.eventHandlers.set(c,new pf),this.eventHandlers.get(c).add(f)}notifyListeners(c,...f){const h=this.eventHandlers.get(c);h&&h.notify(...f)}hasListeners(c){return this.eventHandlers.has(c)}mount(c){if(this.instance)return;this.isSVG=v0(c)&&!t_(c),this.instance=c;const{layoutId:f,layout:h,visualElement:v}=this.options;if(v&&!v.current&&v.mount(c),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(h||f)&&(this.isLayoutDirty=!0),e){let y,x=0;const k=()=>this.root.updateBlockedByResize=!1;Et.read(()=>{x=window.innerWidth}),e(c,()=>{const C=window.innerWidth;C!==x&&(x=C,this.root.updateBlockedByResize=!0,y&&y(),y=XC(k,250),kl.hasAnimatedSinceResize&&(kl.hasAnimatedSinceResize=!1,this.nodes.forEach(lv)))})}f&&this.root.registerSharedNode(f,this),this.options.animate!==!1&&v&&(f||h)&&this.addEventListener("didUpdate",({delta:y,hasLayoutChanged:x,hasRelativeLayoutChanged:k,layout:C})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const M=this.options.transition||v.getDefaultTransition()||wT,{onLayoutAnimationStart:E,onLayoutAnimationComplete:R}=v.getProps(),O=!this.targetLayout||!J0(this.targetLayout,C),j=!x&&k;if(this.options.layoutRoot||this.resumeFrom||j||x&&(O||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const z={...Tf(M,"layout"),onPlay:E,onComplete:R};(v.shouldReduceMotion||this.options.layoutRoot)&&(z.delay=0,z.type=!1),this.startAnimation(z),this.setAnimationOrigin(y,j)}else x||lv(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=C})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const c=this.getStack();c&&c.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Tr(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(mT),this.animationId++)}getTransformTemplate(){const{visualElement:c}=this.options;return c&&c.getProps().transformTemplate}willUpdate(c=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&ew(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let y=0;y<this.path.length;y++){const x=this.path[y];x.shouldResetTransform=!0,x.updateScroll("snapshot"),x.options.layoutRoot&&x.willUpdate(!1)}const{layoutId:f,layout:h}=this.options;if(f===void 0&&!h)return;const v=this.getTransformTemplate();this.prevTransformTemplateValue=v?v(this.latestValues,""):void 0,this.updateSnapshot(),c&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(av);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(ov);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(fT),this.nodes.forEach(oT),this.nodes.forEach(lT)):this.nodes.forEach(ov),this.clearAllSnapshots();const f=zn.now();ln.delta=Ki(0,1e3/60,f-ln.timestamp),ln.timestamp=f,ln.isProcessing=!0,Vu.update.process(ln),Vu.preRender.process(ln),Vu.render.process(ln),ln.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Pf.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(dT),this.sharedNodes.forEach(gT)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Et.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Et.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Tn(this.snapshot.measuredBox.x)&&!Tn(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let h=0;h<this.path.length;h++)this.path[h].updateScroll();const c=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Qt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:f}=this.options;f&&f.notify("LayoutMeasure",this.layout.layoutBox,c?c.layoutBox:void 0)}updateScroll(c="measure"){let f=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===c&&(f=!1),f&&this.instance){const h=s(this.instance);this.scroll={animationId:this.root.animationId,phase:c,isRoot:h,offset:i(this.instance),wasRoot:this.scroll?this.scroll.isRoot:h}}}resetTransform(){if(!o)return;const c=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,f=this.projectionDelta&&!Z0(this.projectionDelta),h=this.getTransformTemplate(),v=h?h(this.latestValues,""):void 0,y=v!==this.prevTransformTemplateValue;c&&this.instance&&(f||$r(this.latestValues)||y)&&(o(this.instance,v),this.shouldResetTransform=!1,this.scheduleRender())}measure(c=!0){const f=this.measurePageBox();let h=this.removeElementScroll(f);return c&&(h=this.removeTransform(h)),bT(h),{animationId:this.root.animationId,measuredBox:f,layoutBox:h,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:c}=this.options;if(!c)return Qt();const f=c.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(xT))){const{scroll:v}=this.root;v&&(Fs(f.x,v.offset.x),Fs(f.y,v.offset.y))}return f}removeElementScroll(c){const f=Qt();if(_i(f,c),this.scroll?.wasRoot)return f;for(let h=0;h<this.path.length;h++){const v=this.path[h],{scroll:y,options:x}=v;v!==this.root&&y&&x.layoutScroll&&(y.wasRoot&&_i(f,c),Fs(f.x,y.offset.x),Fs(f.y,y.offset.y))}return f}applyTransform(c,f=!1){const h=Qt();_i(h,c);for(let v=0;v<this.path.length;v++){const y=this.path[v];!f&&y.options.layoutScroll&&y.scroll&&y!==y.root&&Os(h,{x:-y.scroll.offset.x,y:-y.scroll.offset.y}),$r(y.latestValues)&&Os(h,y.latestValues)}return $r(this.latestValues)&&Os(h,this.latestValues),h}removeTransform(c){const f=Qt();_i(f,c);for(let h=0;h<this.path.length;h++){const v=this.path[h];if(!v.instance||!$r(v.latestValues))continue;Md(v.latestValues)&&v.updateSnapshot();const y=Qt(),x=v.measurePageBox();_i(y,x),ev(f,v.latestValues,v.snapshot?v.snapshot.layoutBox:void 0,y)}return $r(this.latestValues)&&ev(f,this.latestValues),f}setTargetDelta(c){this.targetDelta=c,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(c){this.options={...this.options,...c,crossfade:c.crossfade!==void 0?c.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ln.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(c=!1){const f=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=f.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=f.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=f.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==f;if(!(c||h&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:y,layoutId:x}=this.options;if(!this.layout||!(y||x))return;this.resolvedRelativeTargetAt=ln.timestamp;const k=this.getClosestProjectingParent();k&&this.linkedParentVersion!==k.layoutVersion&&!k.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(k&&k.layout?this.createRelativeTarget(k,this.layout.layoutBox,k.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Qt(),this.targetWithTransforms=Qt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),EC(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):_i(this.target,this.layout.layoutBox),R0(this.target,this.targetDelta)):_i(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,k&&!!k.resumingFrom==!!this.resumingFrom&&!k.options.layoutScroll&&k.target&&this.animationProgress!==1?this.createRelativeTarget(k,this.target,k.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||Md(this.parent.latestValues)||A0(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(c,f,h){this.relativeParent=c,this.linkedParentVersion=c.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Qt(),this.relativeTargetOrigin=Qt(),Il(this.relativeTargetOrigin,f,h),_i(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const c=this.getLead(),f=!!this.resumingFrom||this!==c;let h=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(h=!1),f&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===ln.timestamp&&(h=!1),h)return;const{layout:v,layoutId:y}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(v||y))return;_i(this.layoutCorrected,this.layout.layoutBox);const x=this.treeScale.x,k=this.treeScale.y;z_(this.layoutCorrected,this.treeScale,this.path,f),c.layout&&!c.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(c.target=c.layout.layoutBox,c.targetWithTransforms=Qt());const{target:C}=c;if(!C){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Qg(this.prevProjectionDelta.x,this.projectionDelta.x),Qg(this.prevProjectionDelta.y,this.projectionDelta.y)),Ha(this.projectionDelta,this.layoutCorrected,C,this.latestValues),(this.treeScale.x!==x||this.treeScale.y!==k||!sv(this.projectionDelta.x,this.prevProjectionDelta.x)||!sv(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",C))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(c=!0){if(this.options.visualElement?.scheduleRender(),c){const f=this.getStack();f&&f.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ns(),this.projectionDelta=Ns(),this.projectionDeltaWithTransform=Ns()}setAnimationOrigin(c,f=!1){const h=this.snapshot,v=h?h.latestValues:{},y={...this.latestValues},x=Ns();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!f;const k=Qt(),C=h?h.source:void 0,M=this.layout?this.layout.source:void 0,E=C!==M,R=this.getStack(),O=!R||R.members.length<=1,j=!!(E&&!O&&this.options.crossfade===!0&&!this.path.some(yT));this.animationProgress=0;let z;this.mixTargetDelta=W=>{const V=W/1e3;cv(x.x,c.x,V),cv(x.y,c.y,V),this.setTargetDelta(x),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Il(k,this.layout.layoutBox,this.relativeParent.layout.layoutBox),vT(this.relativeTarget,this.relativeTargetOrigin,k,V),z&&nT(this.relativeTarget,z)&&(this.isProjectionDirty=!1),z||(z=Qt()),_i(z,this.relativeTarget)),E&&(this.animationValues=y,KC(y,v,this.latestValues,V,j,O)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=V},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(c){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Tr(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Et.update(()=>{kl.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=is(0)),this.currentAnimation=HC(this.motionValue,[0,1e3],{...c,velocity:0,isSync:!0,onUpdate:f=>{this.mixTargetDelta(f),c.onUpdate&&c.onUpdate(f)},onStop:()=>{},onComplete:()=>{c.onComplete&&c.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const c=this.getStack();c&&c.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(sT),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const c=this.getLead();let{targetWithTransforms:f,target:h,layout:v,latestValues:y}=c;if(!(!f||!h||!v)){if(this!==c&&this.layout&&v&&nw(this.options.animationType,this.layout.layoutBox,v.layoutBox)){h=this.target||Qt();const x=Tn(this.layout.layoutBox.x);h.x.min=c.target.x.min,h.x.max=h.x.min+x;const k=Tn(this.layout.layoutBox.y);h.y.min=c.target.y.min,h.y.max=h.y.min+k}_i(f,h),Os(f,y),Ha(this.projectionDeltaWithTransform,this.layoutCorrected,f,y)}}registerSharedNode(c,f){this.sharedNodes.has(c)||this.sharedNodes.set(c,new iT),this.sharedNodes.get(c).add(f);const v=f.options.initialPromotionConfig;f.promote({transition:v?v.transition:void 0,preserveFollowOpacity:v&&v.shouldPreserveFollowOpacity?v.shouldPreserveFollowOpacity(f):void 0})}isLead(){const c=this.getStack();return c?c.lead===this:!0}getLead(){const{layoutId:c}=this.options;return c?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:c}=this.options;return c?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:c}=this.options;if(c)return this.root.sharedNodes.get(c)}promote({needsReset:c,transition:f,preserveFollowOpacity:h}={}){const v=this.getStack();v&&v.promote(this,h),c&&(this.projectionDelta=void 0,this.needsReset=!0),f&&this.setOptions({transition:f})}relegate(){const c=this.getStack();return c?c.relegate(this):!1}resetSkewAndRotation(){const{visualElement:c}=this.options;if(!c)return;let f=!1;const{latestValues:h}=c;if((h.z||h.rotate||h.rotateX||h.rotateY||h.rotateZ||h.skewX||h.skewY)&&(f=!0),!f)return;const v={};h.z&&Zu("z",c,v,this.animationValues);for(let y=0;y<Qu.length;y++)Zu(`rotate${Qu[y]}`,c,v,this.animationValues),Zu(`skew${Qu[y]}`,c,v,this.animationValues);c.render();for(const y in v)c.setStaticValue(y,v[y]),this.animationValues&&(this.animationValues[y]=v[y]);c.scheduleRender()}applyProjectionStyles(c,f){if(!this.instance||this.isSVG)return;if(!this.isVisible){c.visibility="hidden";return}const h=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,c.visibility="",c.opacity="",c.pointerEvents=Sl(f?.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none";return}const v=this.getLead();if(!this.projectionDelta||!this.layout||!v.target){this.options.layoutId&&(c.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,c.pointerEvents=Sl(f?.pointerEvents)||""),this.hasProjected&&!$r(this.latestValues)&&(c.transform=h?h({},""):"none",this.hasProjected=!1);return}c.visibility="";const y=v.animationValues||v.latestValues;this.applyTransformsToTarget();let x=rT(this.projectionDeltaWithTransform,this.treeScale,y);h&&(x=h(y,x)),c.transform=x;const{x:k,y:C}=this.projectionDelta;c.transformOrigin=`${k.origin*100}% ${C.origin*100}% 0`,v.animationValues?c.opacity=v===this?y.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:c.opacity=v===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const M in io){if(y[M]===void 0)continue;const{correct:E,applyTo:R,isCSSVariable:O}=io[M],j=x==="none"?y[M]:E(y[M],v);if(R){const z=R.length;for(let W=0;W<z;W++)c[R[W]]=j}else O?this.options.visualElement.renderState.vars[M]=j:c[M]=j}this.options.layoutId&&(c.pointerEvents=v===this?Sl(f?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(c=>c.currentAnimation?.stop()),this.root.nodes.forEach(av),this.root.sharedNodes.clear()}}}function oT(e){e.updateLayout()}function lT(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:s}=e.layout,{animationType:o}=e.options,a=t.source!==e.layout.source;o==="size"?fi(y=>{const x=a?t.measuredBox[y]:t.layoutBox[y],k=Tn(x);x.min=i[y].min,x.max=x.min+k}):nw(o,t.layoutBox,i)&&fi(y=>{const x=a?t.measuredBox[y]:t.layoutBox[y],k=Tn(i[y]);x.max=x.min+k,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[y].max=e.relativeTarget[y].min+k)});const c=Ns();Ha(c,i,t.layoutBox);const f=Ns();a?Ha(f,e.applyTransform(s,!0),t.measuredBox):Ha(f,i,t.layoutBox);const h=!Z0(c);let v=!1;if(!e.resumeFrom){const y=e.getClosestProjectingParent();if(y&&!y.resumeFrom){const{snapshot:x,layout:k}=y;if(x&&k){const C=Qt();Il(C,t.layoutBox,x.layoutBox);const M=Qt();Il(M,i,k.layoutBox),J0(C,M)||(v=!0),y.options.layoutRoot&&(e.relativeTarget=M,e.relativeTargetOrigin=C,e.relativeParent=y)}}}e.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:f,layoutDelta:c,hasLayoutChanged:h,hasRelativeLayoutChanged:v})}else if(e.isLead()){const{onExitComplete:i}=e.options;i&&i()}e.options.transition=void 0}function cT(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function uT(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function dT(e){e.clearSnapshot()}function av(e){e.clearMeasurements()}function ov(e){e.isLayoutDirty=!1}function fT(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function lv(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function pT(e){e.resolveTargetDelta()}function hT(e){e.calcProjection()}function mT(e){e.resetSkewAndRotation()}function gT(e){e.removeLeadSnapshot()}function cv(e,t,i){e.translate=At(t.translate,0,i),e.scale=At(t.scale,1,i),e.origin=t.origin,e.originPoint=t.originPoint}function uv(e,t,i,s){e.min=At(t.min,i.min,s),e.max=At(t.max,i.max,s)}function vT(e,t,i,s){uv(e.x,t.x,i.x,s),uv(e.y,t.y,i.y,s)}function yT(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const wT={duration:.45,ease:[.4,0,.1,1]},dv=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),fv=dv("applewebkit/")&&!dv("chrome/")?Math.round:vi;function pv(e){e.min=fv(e.min),e.max=fv(e.max)}function bT(e){pv(e.x),pv(e.y)}function nw(e,t,i){return e==="position"||e==="preserve-aspect"&&!TC(rv(t),rv(i),.2)}function xT(e){return e!==e.root&&e.scroll?.wasRoot}const ST=tw({attachResizeListener:(e,t)=>ro(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ju={current:void 0},iw=tw({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ju.current){const e=new ST({});e.mount(window),e.setOptions({layoutScroll:!0}),Ju.current=e}return Ju.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),kT={pan:{Feature:UC},drag:{Feature:VC,ProjectionNode:iw,MeasureLayout:G0}};function hv(e,t,i){const{props:s}=e;e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",i==="Start");const o="onHover"+i,a=s[o];a&&Et.postRender(()=>a(t,co(t)))}class _T extends Dr{mount(){const{current:t}=this.node;t&&(this.unmount=K2(t,(i,s)=>(hv(this.node,s,"Start"),o=>hv(this.node,o,"End"))))}unmount(){}}class CT extends Dr{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ao(ro(this.node.current,"focus",()=>this.onFocus()),ro(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function mv(e,t,i){const{props:s}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&s.whileTap&&e.animationState.setActive("whileTap",i==="Start");const o="onTap"+(i==="End"?"":i),a=s[o];a&&Et.postRender(()=>a(t,co(t)))}class TT extends Dr{mount(){const{current:t}=this.node;t&&(this.unmount=e_(t,(i,s)=>(mv(this.node,s,"Start"),(o,{success:a})=>mv(this.node,o,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Bd=new WeakMap,ed=new WeakMap,ET=e=>{const t=Bd.get(e.target);t&&t(e)},PT=e=>{e.forEach(ET)};function DT({root:e,...t}){const i=e||document;ed.has(i)||ed.set(i,{});const s=ed.get(i),o=JSON.stringify(t);return s[o]||(s[o]=new IntersectionObserver(PT,{root:e,...t})),s[o]}function LT(e,t,i){const s=DT(t);return Bd.set(e,i),s.observe(e),()=>{Bd.delete(e),s.unobserve(e)}}const MT={some:0,all:1};class AT extends Dr{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:i,margin:s,amount:o="some",once:a}=t,c={root:i?i.current:void 0,rootMargin:s,threshold:typeof o=="number"?o:MT[o]},f=h=>{const{isIntersecting:v}=h;if(this.isInView===v||(this.isInView=v,a&&!v&&this.hasEnteredView))return;v&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",v);const{onViewportEnter:y,onViewportLeave:x}=this.node.getProps(),k=v?y:x;k&&k(h)};return LT(this.node.current,c,f)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:i}=this.node;["amount","margin","root"].some(RT(t,i))&&this.startObserver()}unmount(){}}function RT({viewport:e={}},{viewport:t={}}={}){return i=>e[i]!==t[i]}const FT={inView:{Feature:AT},tap:{Feature:TT},focus:{Feature:CT},hover:{Feature:_T}},OT={layout:{ProjectionNode:iw,MeasureLayout:G0}},NT={...bC,...FT,...kT,...OT},zd=N_(NT,G_);function IT(e){const t=Py(()=>is(e)),{isStatic:i}=ie.useContext(Lf);if(i){const[,s]=ie.useState(e);ie.useEffect(()=>t.on("change",s),[])}return t}const gv=300,BT=e=>{const t=window.innerWidth;return t<=390?Math.min(25,e*.08):t<=540?Math.min(30,e*.1):Math.min(40,e*.12)},vv={type:"spring",mass:.8,stiffness:350,damping:30};function zT({items:e,baseWidth:t=300,autoplay:i=!1,autoplayDelay:s=3e3,pauseOnHover:o=!1,loop:a=!1,round:c=!1}){const h=(()=>{const z=window.innerWidth;return z<=390?16:z<=540?20:30})(),v=24,y=t-h*2,[x,k]=ie.useState(0),C=IT(0),M=ie.useRef(null),[E,R]=ie.useState(!1),O=ie.useMemo(()=>BT(y),[y]);ie.useEffect(()=>{if(!i||o&&E)return;const z=setInterval(()=>{C.get()===0&&k(V=>V===e.length-1?a?0:V:V+1)},s);return()=>clearInterval(z)},[i,s,C,e.length,a,E,o]),ie.useEffect(()=>{if(!o||!M.current)return;const z=M.current,W=()=>R(!0),V=()=>R(!1);return z.addEventListener("mouseenter",W),z.addEventListener("mouseleave",V),()=>{z.removeEventListener("mouseenter",W),z.removeEventListener("mouseleave",V)}},[o]);const j=(z,W)=>{const V=C.get(),H=W.velocity.x,J=V<=-O||H<-gv,N=V>=O||H>gv;J&&x<e.length-1?k(G=>G+1):N&&x>0?k(G=>G-1):a&&(J&&x===e.length-1?k(0):N&&x===0&&k(e.length-1))};return we.jsxs("div",{ref:M,className:`carousel-container ${c?"round":""}`,style:{width:`${t}px`,...c&&{height:`${t}px`,borderRadius:"50%"}},children:[we.jsx(zd.div,{drag:"x",dragConstraints:{left:0,right:0},dragElastic:.2,dragTransition:{bounceStiffness:300,bounceDamping:20},style:{x:C,width:y},animate:{translateX:`-${x*(y+v)}px`},transition:vv,onDragEnd:j,className:"carousel-track",children:e.map((z,W)=>{const V=W===x;return we.jsxs(zd.div,{className:`carousel-item ${c?"round":""}`,style:{width:y,height:c?y:"100%",...c&&{borderRadius:"50%"}},animate:{scale:V?1:.95,borderColor:V?"rgba(255, 255, 255, 0.2)":"rgba(255, 255, 255, 0.1)",backgroundColor:V?"rgba(255, 255, 255, 0.08)":"rgba(255, 255, 255, 0.05)",boxShadow:V?"0 0 0 1px rgba(255, 255, 255, 0.06), 0 0 30px rgba(255, 255, 255, 0.08), 0 0 60px rgba(255, 255, 255, 0.04)":"0 0 0 0px rgba(255, 255, 255, 0), 0 0 0px rgba(255, 255, 255, 0), 0 0 0px rgba(255, 255, 255, 0)"},transition:{...vv,boxShadow:{type:"spring",mass:3,stiffness:200,damping:50}},children:[we.jsx("div",{className:`carousel-item-header ${c?"round":""}`,children:we.jsx("span",{className:"carousel-icon-container",children:z.icon})}),we.jsxs("div",{className:"carousel-item-content",children:[we.jsx("div",{className:"carousel-item-title",children:z.title}),we.jsx("p",{className:"carousel-item-description",children:z.description})]})]},W)})}),we.jsx("div",{className:`carousel-indicators-container ${c?"round":""}`,children:we.jsx("div",{className:"carousel-indicators",children:e.map((z,W)=>we.jsx("button",{onClick:()=>k(W),className:`carousel-indicator ${W===x?"active":"inactive"}`},W))})})]})}const VT=20,UT=1,rw=1.26,WT=[.19,1,.22,1],yv=()=>{const e=window.innerWidth,t=rw;return e>=1024?500:e>=768?e*.65/t:e>=540?e*.75/t:e>=430?e*.85/t:e*.9/t},jT=[{title:"Fixed Scope, No Surprises",description:"Everything defined upfront in a clear SOW. No hidden fees, no unexpected charges.",id:1,icon:we.jsxs("svg",{className:"carousel-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[we.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),we.jsx("polyline",{points:"14 2 14 8 20 8"})]})},{title:"Built on Modern Tech",description:"React, Next.js, Firebaseenterprise-level tools that keep your site fast and reliable.",id:2,icon:we.jsxs("svg",{className:"carousel-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[we.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),we.jsx("path",{d:"M2 17l10 5 10-5M2 12l10 5 10-5"})]})},{title:"Pay as We Build",description:"Milestone-based payments. You only pay for completed workdesign approval, then delivery.",id:3,icon:we.jsxs("svg",{className:"carousel-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[we.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),we.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})},{title:"30-Day Launch Warranty",description:"Your site will work as promised. Guaranteed functionality for 30 days post-deployment.",id:4,icon:we.jsx("svg",{className:"carousel-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:we.jsx("polyline",{points:"20 6 9 17 4 12"})})},{title:"Ongoing Support Available",description:"Launch is just the beginning. Maintenance plans keep your site running smoothly as you grow.",id:5,icon:we.jsx("svg",{className:"carousel-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:we.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}];function qT(){const[e,t]=ie.useState(yv());return ie.useEffect(()=>{const i=()=>{t(yv())};return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),we.jsx(zd.div,{initial:{scale:UT},whileInView:{scale:rw},transition:{duration:VT,ease:WT,delay:.3},viewport:{once:!0,amount:.2},children:we.jsx(zT,{items:jT,baseWidth:e,autoplay:!0,autoplayDelay:4e3,pauseOnHover:!0,loop:!0,round:!1})})}const wv=()=>{const e=document.getElementById("philosophy-carousel-root");e?(kv.createRoot(e).render(we.jsx(qT,{})),console.log(" Philosophy Carousel mounted successfully")):console.error(" Philosophy carousel root element not found")};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",wv):wv();(function(){var e=window.t||function(u){return u},t=window.getCurrentLang||function(){return localStorage.getItem("scarlo-lang")||"en"},i=window.setLang||function(){},s=window.translateStoredFeature||function(u){return u},o=window.translateAddonByKey||function(u,p){return p||u},a=function(u,p){return(p||document).querySelector(u)},c=function(u,p){for(var g=(p||document).querySelectorAll(u),b=[],S=0;S<g.length;S++)b.push(g[S]);return b},f=function(u,p){var g=0;return function(){var b=arguments,S=Date.now();S-g>=p&&(g=S,u.apply(this,b))}},h=function(u,p){var g;return function(){var b=arguments,S=this;clearTimeout(g),g=setTimeout(function(){u.apply(S,b)},p)}},v=null,y=function(){var u=new Image;u.crossOrigin="anonymous",u.onload=function(){try{var p=document.createElement("canvas");p.width=u.width,p.height=u.height;var g=p.getContext("2d");g.drawImage(u,0,0),v=p.toDataURL("image/png"),console.log("Logo cached for PDF generation")}catch(b){console.warn("Could not cache logo:",b)}},u.onerror=function(){console.warn("Could not load logo for caching")},u.src="/images/scarlo-logo.png"},x=function(){return v||"https://scarlo.dev/images/scarlo-logo.png"},k={"+1":{maxDigits:10,format:"US"},"+44":{maxDigits:10,format:"UK"},"+91":{maxDigits:10,format:"IN"},"+61":{maxDigits:9,format:"AU"},"+81":{maxDigits:10,format:"JP"},"+49":{maxDigits:11,format:"DE"},"+33":{maxDigits:9,format:"FR"},"+86":{maxDigits:11,format:"CN"},"+52":{maxDigits:10,format:"MX"},"+55":{maxDigits:11,format:"BR"}},C=function(u,p){if(!u)return"";p=p||"+1";var g=k[p]||k["+1"],b=u.replace(/\D/g,"");b.length>g.maxDigits&&(b=b.substring(0,g.maxDigits));var S="";return g.format==="US"?(b.length>0&&(S="("+b.substring(0,Math.min(3,b.length))),b.length>3&&(S+=") "+b.substring(3,Math.min(6,b.length))),b.length>6&&(S+="-"+b.substring(6,10))):(S=b,b.length>3&&(S=b.substring(0,3)+" "+b.substring(3)),b.length>6&&(S=b.substring(0,3)+" "+b.substring(3,6)+" "+b.substring(6)),b.length>9&&(S=b.substring(0,3)+" "+b.substring(3,6)+" "+b.substring(6,9)+" "+b.substring(9))),S},M=function(u){if(!u)return"";var p=u.replace(/\D/g,"");return p.length===10?"+1"+p:p.length===11&&p.startsWith("1")?"+"+p:u.startsWith("+")?u.replace(/[^\d+]/g,""):p.length>=10?"+1"+p.slice(-10):u},E=function(u){u&&u.addEventListener("input",function(){for(var p=u.selectionStart,g=u.value,b=g.slice(0,p).replace(/\D/g,"").length,S=g.replace(/\D/g,"").slice(0,10),_="",D=0;D<S.length;D++)D===0&&(_+="("),D===3&&(_+=") "),D===6&&(_+="-"),_+=S[D];u.value=_;for(var T=0,L=0,F=0;F<_.length;F++)if(/\d/.test(_[F])&&(L++,L===b)){T=F+1;break}b===0&&(T=_.length>0?1:0),u.setSelectionRange(T,T)})},R={isMobile:function(){return window.innerWidth<=1024||"ontouchstart"in window},isLowEndDevice:function(){var u=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return u?u.effectiveType==="slow-2g"||u.effectiveType==="2g":navigator.hardwareConcurrency&&navigator.hardwareConcurrency<4},isLaptopOrLarger:function(){return window.innerWidth>=1024}},O=function(){if(this.nav=a(".navbar"),!this.nav){console.warn("Navbar not found");return}this.hamburger=a(".hamburger"),this.menu=a(".nav-menu"),this.links=c(".nav-link"),this.sections=null,this.isScrolled=!1,this.scrollTicking=!1,this.activeLinkTicking=!1;var u=this;requestAnimationFrame(function(){u.init()})};O.prototype.init=function(){this.setupSmoothScroll(),this.setupMobileMenu(),this.setupLanguageToggle();var u=this;setTimeout(function(){u.setupScrollEffects(),u.setupActiveLinks()},100)},O.prototype.setupSmoothScroll=function(){for(var u=this,p=c('a[href^="#"]'),g=0;g<p.length;g++)(function(b){b.addEventListener("click",function(S){var _=b.getAttribute("href");if(!(!_||_==="#")){var D=a(_);if(D){S.preventDefault();var T=u.nav?u.nav.offsetHeight:0,L=D.offsetTop-T;window.scrollTo({top:L,behavior:"smooth"}),u.closeMobileMenu()}}})})(p[g])},O.prototype.setupMobileMenu=function(){var u=this;!this.hamburger||!this.menu||(this.hamburger.addEventListener("click",function(){u.toggleMobileMenu()}),document.addEventListener("keydown",function(p){p.key==="Escape"&&u.menu&&u.menu.classList.contains("active")&&u.closeMobileMenu()}),document.addEventListener("click",function(p){u.menu&&u.menu.classList.contains("active")&&!u.menu.contains(p.target)&&u.hamburger&&!u.hamburger.contains(p.target)&&u.closeMobileMenu()}))},O.prototype.toggleMobileMenu=function(){!this.menu||!this.hamburger||(this.menu.classList.toggle("active"),this.hamburger.classList.toggle("active"),document.body.style.overflow=this.menu.classList.contains("active")?"hidden":"")},O.prototype.closeMobileMenu=function(){!this.menu||!this.hamburger||(this.menu.classList.remove("active"),this.hamburger.classList.remove("active"),document.body.style.overflow="")},O.prototype.setupScrollEffects=function(){var u=this;if(this.nav){var p=100,g=20,b=function(){var D=window.pageYOffset||document.documentElement.scrollTop||0;!u.isScrolled&&D>p?(u.isScrolled=!0,u.nav.classList.add("scrolled")):u.isScrolled&&D<p-g&&(u.isScrolled=!1,u.nav.classList.remove("scrolled")),u.scrollTicking=!1},S=function(){u.scrollTicking||(u.scrollTicking=!0,requestAnimationFrame(b))};window.addEventListener("scroll",S,{passive:!0});var _=window.pageYOffset||document.documentElement.scrollTop||0;_>p&&(this.isScrolled=!0,this.nav.classList.add("scrolled"))}},O.prototype.setupActiveLinks=function(){var u=this;if(!(!this.links||this.links.length===0)&&(this.sections=c("section[id]"),!(!this.sections||this.sections.length===0))){var p=function(){var b=window.pageYOffset+window.innerHeight/2,S=document.documentElement.scrollHeight,_=window.innerHeight,D="";if(window.pageYOffset+_>=S-50)D="contact";else for(var T=0;T<u.sections.length;T++){var L=u.sections[T],F=L.offsetTop,U=L.offsetHeight;if(b>=F&&b<F+U){D=L.getAttribute("id");break}}for(var A=0;A<u.links.length;A++){var B=u.links[A];B.classList.remove("active"),B.getAttribute("href")==="#"+D&&B.classList.add("active")}u.activeLinkTicking=!1},g=function(){u.activeLinkTicking||(u.activeLinkTicking=!0,requestAnimationFrame(p))};window.addEventListener("scroll",g,{passive:!0}),setTimeout(p,200)}},O.prototype.setupLanguageToggle=function(){var u=document.getElementById("langToggle");if(u){var p=u.querySelectorAll(".lang-btn"),g=typeof t=="function"?t():"en";p.forEach(function(S){S.classList.toggle("active",S.getAttribute("data-lang")===g)}),this.applyLanguage(g);var b=this;p.forEach(function(S){S.addEventListener("click",function(){var _=this.getAttribute("data-lang");typeof i=="function"&&i(_),p.forEach(function(D){D.classList.remove("active")}),this.classList.add("active"),b.applyLanguage(_),window.rotatingText&&window.rotatingText.switchLanguage&&window.rotatingText.switchLanguage()})})}},O.prototype.applyLanguage=function(u){if(typeof e=="function"){var p=document.querySelectorAll("[data-i18n]");p.forEach(function(D){var T=D.getAttribute("data-i18n"),L=e(T);if(L&&L!==T){if(D.classList.contains("rotating-text"))return;D.textContent=L}});var g=document.querySelectorAll("[data-i18n-html]");g.forEach(function(D){var T=D.getAttribute("data-i18n-html"),L=e(T);L&&L!==T&&(D.innerHTML=L)});var b=document.querySelectorAll("[data-i18n-placeholder]");b.forEach(function(D){var T=D.getAttribute("data-i18n-placeholder"),L=e(T);L&&L!==T&&(D.placeholder=L)});var S=document.getElementById("authActionBtn"),_=document.getElementById("authStatusText");_&&S&&!S.classList.contains("logged-in")&&(_.textContent=e("nav.signIn"))}};var j=function(){if(this.wrapper=a(".rotating-text-wrapper"),!!this.wrapper){this.texts=c(".rotating-text"),this.currentIndex=0;var u=typeof t=="function"?t():"en";if(u!=="en"&&typeof e=="function"){var p=document.querySelector(".hero-title-visual .title-line:first-child");p&&(p.textContent=e("hero.titleLine1")),this.texts.forEach(function(g,b){var S=e("hero.r"+b);S&&(g.textContent=S)})}this.init()}};j.prototype.init=function(){var u=this;this.texts.forEach(function(p){var g=p.textContent,b="";Array.from(g).forEach(function(S){S===" "?b+='<span class="char-space"> </span>':b+='<span class="char">'+S+"</span>"}),p.innerHTML=b}),setTimeout(function(){u.rotate()},3e3)},j.prototype.rotate=function(){var u=this;setInterval(function(){u.texts[u.currentIndex].classList.remove("active"),u.currentIndex=(u.currentIndex+1)%u.texts.length,u.texts[u.currentIndex].classList.add("active")},7e3)},j.prototype.switchLanguage=function(){if(typeof e=="function"){var u=document.querySelector(".hero-title-visual .title-line:first-child");u&&(u.textContent=e("hero.titleLine1")),this.texts.forEach(function(p,g){var b=e("hero.r"+g);if(b){var S="";Array.from(b).forEach(function(_){_===" "?S+='<span class="char-space"> </span>':S+='<span class="char">'+_+"</span>"}),p.innerHTML=S}})}};var z=function(){this.init()};z.prototype.init=function(){var u=new IntersectionObserver(function(p){p.forEach(function(g){g.isIntersecting&&(g.target.classList.add("visible"),u.unobserve(g.target))})},{threshold:.15,rootMargin:"0px 0px -100px 0px"});c(".portfolio-item, .philosophy-card").forEach(function(p){u.observe(p)})};var W=function(){this.thumbnails=c(".portfolio-thumbnail"),this.isMobile=R.isMobile(),console.log("Portfolio Handler - Mobile mode:",this.isMobile),this.init()};W.prototype.init=function(){this.isMobile?(console.log("Mobile: Using thumbnail links only"),this.thumbnails.forEach(function(u){u.addEventListener("click",function(){var p=u.getAttribute("data-url");p&&window.open(p,"_blank")})})):(console.log("Desktop: Enabling iframe loading"),this.setupDesktopIframes())},W.prototype.setupDesktopIframes=function(){var u=this,p=new IntersectionObserver(function(g){g.forEach(function(b){b.isIntersecting&&(u.loadIframe(b.target),p.unobserve(b.target))})},{rootMargin:"500px",threshold:.01});this.thumbnails.forEach(function(g){p.observe(g)})},W.prototype.loadIframe=function(u){var p=u.getAttribute("data-url");if(!p){console.error("No URL found for thumbnail");return}console.log("Loading iframe:",p);var g=document.createElement("iframe");g.src=p,g.style.cssText="width: 100%; height: 100%; border: none; display: block;",g.setAttribute("loading","lazy"),g.setAttribute("allowfullscreen",""),g.addEventListener("load",function(){console.log("Iframe loaded:",p)}),g.addEventListener("error",function(){console.error("Iframe error:",p),u.innerHTML='<div class="thumbnail-overlay"><span>Failed to load preview</span></div>'});var b=u.parentElement;b.innerHTML="",b.appendChild(g)};var V=function(){this.form=a(".contact-form"),this.fields=c(".form-field input, .form-field textarea"),this.form&&this.init()};V.prototype.init=function(){var u=this;this.fields.forEach(function(p){p.setAttribute("placeholder"," ")}),this.form.addEventListener("submit",function(p){p.preventDefault();var g=a(".btn-submit"),b=a(".btn-text",g),S=b.textContent;g.disabled=!0,b.textContent=e("contact.btn.sending"),setTimeout(function(){b.textContent=e("contact.btn.sent"),g.style.background="linear-gradient(135deg, #10b981 0%, #059669 100%)",u.form.reset(),setTimeout(function(){b.textContent=S,g.style.background="",g.disabled=!1},3e3)},1500)})};var H=function(){if(this.authModal=a("#authModal"),this.contractModal=a("#contractModal"),this.currentUser=null,this.recaptchaVerifier=null,this.confirmationResult=null,this.currentPhoneNumber="",this.lastLoginError=null,!this.authModal||!this.contractModal){console.error("Auth or Contract modal not found");return}this.init()};H.prototype.init=function(){var u=this;typeof firebase<"u"&&firebase.auth?firebase.auth().onAuthStateChanged(function(A){u.handleAuthStateChange(A)}):console.error("Firebase is not loaded.");var p=a("#authActionBtn");p&&p.addEventListener("click",function(A){A.preventDefault(),u.currentUser?confirm(e("auth.confirm.signOut"))&&u.handleLogout():u.showAuthModal()}),c(".view-contract-trigger").forEach(function(A){A.addEventListener("click",function(B){B.preventDefault(),u.checkAuthAndShowContract()})});var g=a("#downloadTemplateBtn");g&&g.addEventListener("click",function(A){A.preventDefault(),u.checkAuthAndShowContract()});var b=a("#closeAuthBtn");b&&b.addEventListener("click",function(){u.closeAuthModal()});var S=a("#closeModalBtn");S&&S.addEventListener("click",function(){u.closeContractModal()});var _=a("#loginForm");_&&_.addEventListener("submit",function(A){A.preventDefault(),u.handleLogin()});var D=a(".auth-overlay",this.authModal);D&&D.addEventListener("click",function(){u.closeAuthModal()});var T=a(".modal-overlay",this.contractModal);T&&T.addEventListener("click",function(){u.closeContractModal()});var L=a("#loginContactDevBtn");L&&L.addEventListener("click",function(){u.openHelpModalWithContext()});var F=a("#phoneContactDevBtn");F&&F.addEventListener("click",function(){u.openHelpModalWithContext()});var U=a("#verifyContactDevBtn");U&&U.addEventListener("click",function(){u.openHelpModalWithContext()}),this.setupTabs(),this.initPhoneAuth()},H.prototype.checkAuthAndShowContract=function(){this.currentUser?this.showContractModal():this.showAuthModal()},H.prototype.handleAuthStateChange=function(u){var p=this;this.currentUser=u;var g=a("#authActionBtn"),b=a("#authStatusText");if(u){g&&g.classList.add("logged-in"),b&&(u.email?b.textContent=u.email.split("@")[0]:u.phoneNumber&&(b.textContent="***"+u.phoneNumber.slice(-4))),this.saveUserToFirestore(u);var S=(window.VITE_DEVELOPER_EMAIL||"").trim().toLowerCase(),_=u.email?u.email.trim().toLowerCase():"";if(_&&_===S){var D=new URLSearchParams(window.location.search),T=D.has("business")||D.has("phone")||D.has("email")||D.has("package");T&&setTimeout(function(){p.showContractModal()},300)}}else console.log("User signed out"),g&&g.classList.remove("logged-in"),b&&(b.textContent=e("auth.btn.signIn")),this.closeContractModal()},H.prototype.saveUserToFirestore=function(u){if(!u||!u.uid){console.log(" No user or uid, skipping save");return}var p=window.VITE_DEVELOPER_EMAIL||"";if(u.email&&u.email.toLowerCase()===p.toLowerCase()){console.log(" Developer email, skipping save");return}var g={uid:u.uid,email:u.email||null,phoneNumber:u.phoneNumber||null,displayName:u.displayName||null,lastLogin:firebase.firestore.FieldValue.serverTimestamp()};console.log(" Saving user data to Firestore:",g);var b=firebase.firestore().collection("users");b.doc(u.uid).set(g,{merge:!0}).then(function(){console.log(" User info saved to Firestore successfully")}).catch(function(S){console.error(" Error saving user to Firestore:",S)})},H.prototype.showAuthModal=function(){this.authModal&&(this.authModal.classList.add("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open"))},H.prototype.closeAuthModal=function(){this.authModal&&(this.authModal.classList.remove("show"),document.body.style.overflow="",document.body.classList.remove("modal-open"),this.resetPhoneAuthToStep1())},H.prototype.showContractModal=function(){this.contractModal&&(this.contractModal.classList.add("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open"),setTimeout(function(){window.dispatchEvent(new CustomEvent("contractModalOpened"))},150))},H.prototype.closeContractModal=function(){window.unsubscribeFromUsers&&window.unsubscribeFromUsers(),this.contractModal&&(this.contractModal.classList.remove("show"),document.body.style.overflow="",document.body.classList.remove("modal-open"))},H.prototype.resetContractModalState=function(){var u=document.getElementById("developerDashboard");u&&u.remove();var p=document.getElementById("dualSigningCompleted");p&&p.remove();var g=document.getElementById("closeModalBtn");g&&(g.style.display="",g.style.position="",g.style.top="",g.style.alignSelf="",g.style.marginRight="",g.style.marginTop="",g.style.marginBottom="",g.style.flexShrink="");var b=document.querySelector(".modal-header");b&&(b.style.display="");var S=document.getElementById("contractForm");S&&(S.style.display="",S.reset());var _=document.getElementById("clientSignatureBlock"),D=document.getElementById("developerSignatureBlock");_&&(_.style.display=""),D&&(D.style.display="");var T=document.getElementById("clientSignaturePad"),L=document.getElementById("devSignaturePad");if(T){var F=T.getContext("2d");F&&F.clearRect(0,0,T.width,T.height)}if(L){var F=L.getContext("2d");F&&F.clearRect(0,0,L.width,L.height)}},H.prototype.handleLogin=function(){var u=a("#loginEmail").value.trim(),p=a("#loginPassword").value,g=a("#loginError"),b=a("#loginHelpLink"),S=a('#loginForm button[type="submit"]');if(b&&(b.style.display="none"),!u||!p){this.showError(g,e("auth.err.fillFields"));return}S.disabled=!0,S.textContent=e("auth.btn.signingIn");var _=this;firebase.auth().signInWithEmailAndPassword(u,p).then(function(D){console.log("Login successful"),_.closeAuthModal(),a("#loginForm").reset(),setTimeout(function(){_.showContractModal()},300)}).catch(function(D){console.error("Login error:",D),_.showErrorWithHelpLink(g,b,_.getErrorMessage(D.code),{email:u,errorType:"account_access"})}).finally(function(){S.disabled=!1,S.textContent=e("auth.btn.signIn")})},H.prototype.handleLogout=function(){var u=this;firebase.auth().signOut().then(function(){console.log("Logged out successfully"),u.resetContractModalState(),u.closeContractModal()}).catch(function(p){console.error("Logout error:",p),alert(e("auth.err.signOut"))})},H.prototype.showError=function(u,p){u&&(u.textContent=p,u.classList.add("show"),setTimeout(function(){u.classList.remove("show")},5e3))},H.prototype.getErrorMessage=function(u){var p={"auth/configuration-not-found":e("auth.err.configNotFound"),"auth/invalid-email":e("auth.err.invalidEmail"),"auth/user-not-found":e("auth.err.userNotFound"),"auth/wrong-password":e("auth.err.wrongPassword"),"auth/too-many-requests":e("auth.err.tooManyRequests"),"auth/network-request-failed":e("auth.err.networkFailed"),"auth/user-disabled":e("auth.err.userDisabled"),"auth/invalid-credential":e("auth.err.invalidCredential"),"auth/invalid-phone-number":e("auth.err.invalidPhone"),"auth/missing-phone-number":e("auth.err.missingPhone"),"auth/quota-exceeded":e("auth.err.quotaExceeded"),"auth/captcha-check-failed":e("auth.err.captchaFailed"),"auth/invalid-verification-code":e("auth.err.invalidCode"),"auth/code-expired":e("auth.err.codeExpired"),"auth/missing-verification-code":e("auth.err.missingCode"),"auth/invalid-verification-id":e("auth.err.invalidVerificationId"),"auth/session-expired":e("auth.err.sessionExpired"),"auth/credential-already-in-use":e("auth.err.credentialInUse"),"auth/operation-not-allowed":e("auth.err.operationNotAllowed"),"auth/billing-not-enabled":e("auth.err.billingNotEnabled")};return p[u]||e("auth.err.default")},H.prototype.showErrorWithHelpLink=function(u,p,g,b){this.lastLoginError={message:g,email:b.email||"",phone:b.phone||"",errorType:b.errorType||"account_access"},p&&(p.style.display="none"),u&&(u.textContent=g,u.classList.add("show"),setTimeout(function(){u.classList.remove("show"),p&&(p.style.display="flex")},5e3))},H.prototype.openHelpModalWithContext=function(){var u=a("#helpModal"),p=a("#helpContact"),g=a("#helpContactLabel"),b=a("#helpIssue"),S=a("#helpDetails"),_=a("#contactTabs"),D=a("#helpSuccessMessage"),T=document.querySelectorAll("#helpRequestForm .form-group"),L=document.querySelector(".help-form-footer");!u||!this.lastLoginError||(u.classList.add("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open"),D&&D.classList.remove("show"),T.forEach(function(F){F.style.display="block"}),L&&(L.style.display="flex"),p&&(this.lastLoginError.email?(p.value=this.lastLoginError.email,p.type="email",p.placeholder="your@email.com",g&&(g.textContent=e("help.label.email")),_&&(_.style.display="none")):this.lastLoginError.phone&&(p.value=this.lastLoginError.phone,p.type="tel",p.placeholder="(555) 123-4567",g&&(g.textContent=e("help.label.phone")),_&&(_.style.display="none")),p.removeAttribute("readonly"),p.style.opacity="1"),b&&(b.value=this.lastLoginError.errorType),S&&(S.value=""))},H.prototype.setupTabs=function(){var u=this,p=c(".auth-tab",this.authModal),g=c(".auth-panel",this.authModal);p.forEach(function(b){b.addEventListener("click",function(){var S=this.getAttribute("data-tab");p.forEach(function(T){T.classList.remove("active")}),this.classList.add("active"),g.forEach(function(T){T.classList.remove("active")});var _=a("#"+S+"Panel",u.authModal);_&&_.classList.add("active");var D=c(".auth-help-link",u.authModal);D.forEach(function(T){T.style.display="none"}),S==="phone"&&u.resetPhoneAuthToStep1()})})},H.prototype.initPhoneAuth=function(){var u=this,p=a("#phoneForm"),g=a("#verifyCodeForm"),b=a("#backToPhoneBtn");p&&p.addEventListener("submit",function(D){D.preventDefault(),u.handlePhoneSubmit()}),g&&g.addEventListener("submit",function(D){D.preventDefault(),u.handleCodeVerification()}),b&&b.addEventListener("click",function(){u.resetPhoneAuthToStep1()});var S=a("#phoneNumber");S&&E(S);var _=a("#verificationCode");_&&_.addEventListener("input",function(D){D.target.value=D.target.value.replace(/\D/g,"").slice(0,6)})},H.prototype.initRecaptcha=function(){this.recaptchaVerifier||(this.recaptchaVerifier=new firebase.auth.RecaptchaVerifier("recaptcha-container",{size:"invisible"}))},H.prototype.handlePhoneSubmit=function(){var u=this,p=a("#countryCode"),g=a("#phoneNumber"),b=p?p.value:"+1",S=g?g.value.replace(/\D/g,""):"",_=a("#phoneError"),D=a("#phoneHelpLink"),T=a("#sendCodeBtn");if(_&&(_.classList.remove("show"),_.textContent=""),D&&(D.style.display="none"),!S||S.length<10){this.showError(_,e("auth.err.validPhone"));return}var L=b+S;this.currentPhoneNumber=L,this.isTestPhone=!1,this.setPhoneLoadingState(T,!0);var F=firebase.functions().httpsCallable("checkTestPhoneNumber");F({phoneNumber:L}).then(function(U){if(U.data.isTestPhone)console.log("Test phone number detected, skipping SMS"),u.isTestPhone=!0,u.confirmationResult=null,u.showVerificationStep(),u.setPhoneLoadingState(T,!1);else{var A=a("#phoneHelpLink");u.showErrorWithHelpLink(_,A,e("auth.err.phoneNotRegistered"),{phone:L,errorType:"account_access"}),u.setPhoneLoadingState(T,!1)}}).catch(function(U){console.error("Error checking test phone:",U);var A=a("#phoneHelpLink");u.showErrorWithHelpLink(_,A,e("auth.err.phoneVerifyFailed"),{phone:L,errorType:"account_access"}),u.setPhoneLoadingState(T,!1)})},H.prototype.proceedWithRealPhoneAuth=function(u,p,g){var b=this;this.initRecaptcha(),firebase.auth().signInWithPhoneNumber(u,this.recaptchaVerifier).then(function(S){console.log("SMS sent successfully"),b.confirmationResult=S,b.showVerificationStep()}).catch(function(S){console.error("SMS send error:",S),b.showError(p,b.getErrorMessage(S.code)),b.recaptchaVerifier=null}).finally(function(){b.setPhoneLoadingState(g,!1)})},H.prototype.handleCodeVerification=function(){var u=this,p=a("#verificationCode"),g=p?p.value.trim():"",b=a("#verifyError"),S=a("#verifyHelpLink"),_=a("#verifyCodeBtn");b&&(b.classList.remove("show"),b.textContent=""),S&&(S.style.display="none");var D=this.isTestPhone?4:6,T=6;if(!g||g.length<D||g.length>T){var L=this.isTestPhone?e("auth.err.codeDigits46"):e("auth.err.codeDigits6");this.showError(b,L);return}if(this.setPhoneLoadingState(_,!0),this.isTestPhone)this.verifyTestPhone(g,b,_);else{if(!this.confirmationResult){this.showErrorWithHelpLink(b,S,e("auth.err.invalidVerificationId"),{phone:this.currentPhoneNumber,errorType:"verification_code"}),this.setPhoneLoadingState(_,!1);return}this.confirmationResult.confirm(g).then(function(F){console.log("Phone auth successful:",F.user),u.closeAuthModal(),u.resetPhoneAuthState(),setTimeout(function(){u.showContractModal()},300)}).catch(function(F){console.error("Code verification error:",F);var U=a("#verifyHelpLink");u.showErrorWithHelpLink(b,U,u.getErrorMessage(F.code),{phone:u.currentPhoneNumber,errorType:"verification_code"})}).finally(function(){u.setPhoneLoadingState(_,!1)})}},H.prototype.verifyTestPhone=function(u,p,g){var b=this;console.log("Verifying test phone:",this.currentPhoneNumber);var S=firebase.functions().httpsCallable("verifyTestPhoneNumber");S({phoneNumber:this.currentPhoneNumber,verificationCode:u}).then(function(_){if(_.data.success&&_.data.customToken)return console.log("Test phone verification successful, signing in with custom token"),firebase.auth().signInWithCustomToken(_.data.customToken);throw new Error("Verification failed")}).then(function(_){console.log("Signed in with custom token:",_.user),b.closeAuthModal(),b.resetPhoneAuthState(),setTimeout(function(){b.showContractModal()},300)}).catch(function(_){console.error("Test phone verification error:",_);var D=_.message||e("auth.err.invalidCodeGeneric");_.code==="functions/invalid-argument"?D=e("auth.err.invalidPhoneOrCode"):_.code==="functions/internal"&&(D=e("auth.err.serverError"));var T=a("#verifyHelpLink");b.showErrorWithHelpLink(p,T,D,{phone:b.currentPhoneNumber,errorType:"verification_code"})}).finally(function(){b.setPhoneLoadingState(g,!1)})},H.prototype.showVerificationStep=function(){var u=a("#phoneForm"),p=a("#verifyCodeForm");u&&(u.style.display="none"),p&&(p.style.display="block");var g=a("#verificationCode");g&&setTimeout(function(){g.focus()},100)},H.prototype.resetPhoneAuthToStep1=function(){var u=a("#phoneForm"),p=a("#verifyCodeForm");u&&(u.style.display="block"),p&&(p.style.display="none");var g=a("#verificationCode");g&&(g.value="");var b=a("#phoneError"),S=a("#verifyError");b&&b.classList.remove("show"),S&&S.classList.remove("show");var _=a("#sendCodeBtn"),D=a("#verifyCodeBtn");this.setPhoneLoadingState(_,!1),this.setPhoneLoadingState(D,!1),this.recaptchaVerifier=null},H.prototype.resetPhoneAuthState=function(){this.confirmationResult=null,this.currentPhoneNumber="",this.isTestPhone=!1,this.resetPhoneAuthToStep1();var u=a("#phoneForm");u&&u.reset()},H.prototype.setPhoneLoadingState=function(u,p){u&&(p?(u.classList.add("loading"),u.disabled=!0):(u.classList.remove("loading"),u.disabled=!1))},H.prototype.formatPhoneDisplay=function(u){if(u.startsWith("+1")&&u.length===12){var p=u.slice(2);return"+1 ("+p.slice(0,3)+") "+p.slice(3,6)+"-"+p.slice(6)}return u};function J(u){if(!u)return null;var p=u.getContext("2d"),g=!1,b=!1,S=0,_=0;function D(){var B=u.getBoundingClientRect(),$=window.devicePixelRatio||1;if(B.width<=0||B.height<=0){console.log("Signature canvas not visible yet, will retry...",B.width,"x",B.height),setTimeout(function(){var K=u.getBoundingClientRect();K.width>0&&K.height>0&&D()},100);return}u.width=B.width*$,u.height=B.height*$,p.scale($,$),p.strokeStyle="#ffffff",p.fillStyle="#ffffff",p.lineWidth=2.5,p.lineCap="round",p.lineJoin="round",console.log("Signature canvas sized:",B.width,"x",B.height)}function T(B){var $=u.getBoundingClientRect(),K,Y;B.touches&&B.touches.length>0?(K=B.touches[0].clientX,Y=B.touches[0].clientY):(K=B.clientX,Y=B.clientY);var Q=K-$.left,te=Y-$.top,ce=u.width/$.width,pe=u.height/$.height;return{x:Q*(ce/(window.devicePixelRatio||1)),y:te*(pe/(window.devicePixelRatio||1))}}function L(B){B.preventDefault(),B.stopPropagation(),g=!0,b=!0;var $=T(B);S=$.x,_=$.y,p.beginPath(),p.arc($.x,$.y,p.lineWidth/2,0,Math.PI*2),p.fill(),console.log("Sig start:",$.x.toFixed(0),$.y.toFixed(0))}function F(B){if(g){B.preventDefault(),B.stopPropagation();var $=T(B);p.beginPath(),p.moveTo(S,_),p.lineTo($.x,$.y),p.stroke(),S=$.x,_=$.y}}function U(B){B&&(B.preventDefault(),B.stopPropagation()),g=!1}function A(){var B=u.getBoundingClientRect();p.clearRect(0,0,B.width,B.height),b=!1,console.log("Signature cleared")}return u.addEventListener("mousedown",L),u.addEventListener("mousemove",F),u.addEventListener("mouseup",U),u.addEventListener("mouseleave",U),u.addEventListener("touchstart",L,{passive:!1}),u.addEventListener("touchmove",F,{passive:!1}),u.addEventListener("touchend",U,{passive:!1}),u.addEventListener("touchcancel",U,{passive:!1}),u.style.touchAction="none",D(),console.log("Signature pad created for:",u.id),{clear:A,isEmpty:function(){return!b},toDataURL:function(){return u.toDataURL("image/png")},resize:D}}var N=function(){if(this.form=a("#contractForm"),!this.form){console.log("Contract form not found");return}N.prototype.fetchHelpRequests=function(u){firebase.firestore().collection("help_requests").where("status","==","open").orderBy("timestamp","desc").get().then(function(p){var g=[];p.forEach(function(b){var S=b.data();S.id=b.id,g.push(S)}),u&&u(g)}).catch(function(p){console.error("Error fetching help requests:",p),u&&u([])})},N.prototype.getIssueTypeLabel=function(u){var p={contract_not_showing:"Contract Not Showing",problems_submitting:"Problems Submitting",signature_issues:"Signature Issues",account_access:"Account Access",other:"Other Issues"};return p[u]||u},N.prototype.resolveHelpRequest=function(u){var p=this;confirm(e("dash.help.confirmResolve"))&&firebase.firestore().collection("help_requests").doc(u).update({status:"resolved",resolved:!0,resolvedTimestamp:firebase.firestore.FieldValue.serverTimestamp()}).then(function(){console.log("Help request marked as resolved"),p.showDeveloperDashboard()}).catch(function(g){console.error("Error resolving help request:",g),alert(e("dash.help.err.resolve")+g.message)})},N.prototype.resolveAllHelpRequests=function(u){var p=this;if(u.length!==0&&confirm(e("dash.help.confirmResolvePrefix")+u.length+e("dash.help.confirmResolveSuffix"))){var g=firebase.firestore().batch(),b=firebase.firestore.FieldValue.serverTimestamp();u.forEach(function(S){var _=firebase.firestore().collection("help_requests").doc(S.id);g.update(_,{status:"resolved",resolved:!0,resolvedTimestamp:b})}),g.commit().then(function(){console.log("All help requests marked as resolved"),p.showDeveloperDashboard()}).catch(function(S){console.error("Error resolving all help requests:",S),alert(e("dash.help.err.resolveAll")+S.message)})}},this.devSignaturePad=null,this.clientSignaturePad=null,this.isDeveloper=!1,this.currentContract=null,this.currentUserEmail=null,this.DEVELOPER_EMAIL=(window.VITE_DEVELOPER_EMAIL||"").trim().toLowerCase(),this.signaturePadsInitialized=!1,this.formSetup=!1,console.log("ContractFormHandler created"),this.init()},G=function(){if(this.helpModal=a("#helpModal"),this.helpForm=a("#helpRequestForm"),this.currentUser=null,!this.helpModal||!this.helpForm){console.log("Help modal elements not found");return}this.init()};G.prototype.init=function(){var u=this;typeof firebase<"u"&&firebase.auth&&firebase.auth().onAuthStateChanged(function(_){if(u.currentUser=_,_){var D=a("#helpContact");D&&u.helpModal.classList.contains("show")&&(D.value=_.email||C(_.phoneNumber)||"")}});var p=a("#requestHelpBtn");p&&p.addEventListener("click",function(_){_.preventDefault(),u.showHelpModal()});var g=a("#closeHelpBtn");g&&g.addEventListener("click",function(){u.closeHelpModal()});var b=a("#cancelHelpBtn");b&&b.addEventListener("click",function(){u.closeHelpModal()});var S=a(".modal-overlay",this.helpModal);S&&S.addEventListener("click",function(){u.closeHelpModal()}),this.helpForm&&this.helpForm.addEventListener("submit",function(_){_.preventDefault(),u.submitHelpRequest()})},G.prototype.showHelpModal=function(){if(this.helpModal){this.helpModal.classList.add("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open");var u=a("#helpSuccessMessage");u&&u.classList.remove("show");var p=a(".help-form");p&&(p.style.display="block"),this.helpForm&&this.helpForm.reset();var g=a("#helpContact"),b=a("#helpContactLabel"),S=a("#helpContactHint"),_=a("#contactTabs");if(g&&this.currentUser){_&&(_.style.display="none");var D=this.currentUser.email,T=this.currentUser.phoneNumber;D?(g.value=this.currentUser.email,g.type="email",g.placeholder="your@email.com",b&&(b.textContent=e("help.label.email")),S&&(S.textContent=e("help.label.contactHint"))):T&&(g.value=C(this.currentUser.phoneNumber),g.type="tel",g.placeholder="(555) 123-4567",b&&(b.textContent=e("help.label.phone")),S&&(S.textContent=e("help.label.contactHint"))),g.setAttribute("readonly","readonly"),g.style.opacity="0.7"}else if(g){_&&(_.style.display="flex",this.setupContactTabs(g,b,S,_)),g.removeAttribute("readonly"),g.style.opacity="1",g.type="email",g.value="",g.placeholder="your@email.com",b&&(b.textContent=e("help.label.email"));var L=c(".contact-tab",_);L.forEach(function(F){F.classList.toggle("active",F.dataset.type==="email")})}}},G.prototype.setupContactTabs=function(u,p,g,b){var S=this,_=c(".contact-tab",b);_.forEach(function(D){var T=D.cloneNode(!0);D.parentNode.replaceChild(T,D)}),_=c(".contact-tab",b),_.forEach(function(D){D.addEventListener("click",function(){var T=this.dataset.type;_.forEach(function(L){L.classList.remove("active")}),this.classList.add("active"),u.value="",T==="email"?(u.type="email",u.placeholder="your@email.com",p&&(p.textContent=e("help.label.email")),g&&(g.textContent=e("help.label.contactHint")),S.removePhoneFormatting(u)):(u.type="tel",u.placeholder="(555) 123-4567",p&&(p.textContent=e("help.label.phone")),g&&(g.textContent=e("help.label.contactHint")),E(u)),u.focus()})})},G.prototype.removePhoneFormatting=function(u){var p=u.cloneNode(!0);u.parentNode.replaceChild(p,u)},G.prototype.closeHelpModal=function(){this.helpModal&&(this.helpModal.classList.remove("show"),document.body.style.overflow="",document.body.classList.remove("modal-open"))},G.prototype.submitHelpRequest=function(){var u=this,p=this.helpForm.querySelector('button[type="submit"]'),g=a("#helpSubmitText"),b=g?g.textContent:e("help.submitBtn");p&&(p.disabled=!0),g&&(g.textContent=e("help.btn.sending"));var S=a("#helpContact").value.trim(),_=a("#helpIssue").value,D=a("#helpDetails").value.trim();if(!S||!_||!D){alert(e("help.val.fillRequired")),p&&(p.disabled=!1),g&&(g.textContent=b);return}var T=this.currentUser&&this.currentUser.phoneNumber&&!this.currentUser.email,L=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,F=/^\+?[1-9]\d{6,14}$/;if(!T&&!L.test(S)){alert(e("help.val.validEmail")),p&&(p.disabled=!1),g&&(g.textContent=b);return}if(T&&!F.test(S.replace(/[\s\-\(\)]/g,""))){alert(e("help.val.validPhone")),p&&(p.disabled=!1),g&&(g.textContent=b);return}var U={userContact:T?M(S):S,contactType:T?"phone":"email",userEmail:T?"":S,userPhone:T?M(S):"",issueType:_,issueDetails:D,timestamp:firebase.firestore.FieldValue.serverTimestamp(),status:"open",resolved:!1,isAuthenticated:!!this.currentUser};this.currentUser&&(U.userId=this.currentUser.uid),console.log("Submitting help request:",U),firebase.firestore().collection("help_requests").add(U).then(function(A){console.log("Help request submitted with ID:",A.id),u.showSuccessMessage(),setTimeout(function(){u.closeHelpModal()},3e3)}).catch(function(A){console.error("Error submitting help request:",A),alert(e("help.err.submitPrefix")+A.message+e("help.err.submitSuffix")),p&&(p.disabled=!1),g&&(g.textContent=b)})},G.prototype.showSuccessMessage=function(){var u=c(".form-group");u.forEach(function(b){b.style.display="none"});var p=a(".help-form-footer");p&&(p.style.display="none");var g=a("#helpSuccessMessage");g&&(g.classList.add("show"),g.scrollIntoView({behavior:"smooth",block:"center"}))},N.prototype.init=function(){var u=this;console.log("Initializing contract form handler"),window.addEventListener("contractModalOpened",function(){console.log("Contract modal opened");var p=firebase.auth().currentUser;p&&(u.currentUserEmail=p.email?p.email.trim().toLowerCase():"",u.isDeveloper=u.currentUserEmail&&u.currentUserEmail===u.DEVELOPER_EMAIL,u.isDeveloper?u.setupDeveloperView():u.setupClientView()),setTimeout(function(){u.initializeSignaturePads()},100),u.initEntityTypeToggle()}),typeof firebase<"u"&&firebase.auth&&firebase.auth().onAuthStateChanged(function(p){p?(u.currentUserEmail=p.email?p.email.trim().toLowerCase():"",u.isDeveloper=u.currentUserEmail&&u.currentUserEmail===u.DEVELOPER_EMAIL,console.log("isDeveloper:",u.isDeveloper),u.setupForm()):(u.currentUserEmail=null,u.isDeveloper=!1)})},N.prototype.initializeSignaturePads=function(){var u=this;console.log("Initializing signature pads, isDeveloper:",this.isDeveloper);var p=document.getElementById("devSignaturePad"),g=document.getElementById("clientSignaturePad");this.isDeveloper?p&&(this.devSignaturePad=J(p),console.log("Dev signature pad created")):g&&(this.clientSignaturePad=J(g),console.log("Client signature pad created")),this.signaturePadsInitialized||(c(".clear-btn").forEach(function(b){b.addEventListener("click",function(S){S.preventDefault(),S.stopPropagation();var _=this.getAttribute("data-canvas");console.log("Clear clicked:",_),_==="devSignaturePad"&&u.devSignaturePad?u.devSignaturePad.clear():_==="clientSignaturePad"&&u.clientSignaturePad&&u.clientSignaturePad.clear()})}),this.signaturePadsInitialized=!0),console.log("Signature pads initialized")},N.prototype.initEntityTypeToggle=function(){console.log("Contract form initialized - client info will be populated from SOW")},N.prototype.populateClientInfoFromSOW=function(u){if(!u){console.log("No SOW data provided");return}console.log("Populating client info from SOW:",u.clientName);var p=a("#sowRequiredNotice"),g=a("#clientInfoPopulated"),b=a("#businessEntityInfo");p&&(p.style.display="none"),g&&(g.style.display="block");var S=a("#contractClientName"),_=a("#contractEntityType"),D=a("#contractStateOfFormation"),T=a("#contractRepName"),L=a("#contractRepTitle"),F=a("#contractClientContact");S&&(S.textContent=u.isBusinessEntity?u.businessName:u.clientName),u.isBusinessEntity&&b?(b.style.display="block",_&&(_.textContent=u.entityType||""),D&&(D.textContent=u.stateOfFormation||""),T&&(T.textContent=u.representativeName||""),L&&(L.textContent=u.representativeTitle||"")):b&&(b.style.display="none"),F&&(F.textContent=u.clientEmail||u.clientPhone||"");var U=a("#clientName"),A=a("#isBusinessEntity"),B=a("#businessName"),$=a("#entityType"),K=a("#stateOfFormation"),Y=a("#repName"),Q=a("#repTitle");U&&(U.value=u.isBusinessEntity?u.businessName:u.clientName),A&&(A.value=u.isBusinessEntity?"true":"false"),B&&(B.value=u.businessName||""),$&&($.value=u.entityType||""),K&&(K.value=u.stateOfFormation||""),Y&&(Y.value=u.representativeName||""),Q&&(Q.value=u.representativeTitle||"")},N.prototype.setupForm=function(){var u=this;if(this.formSetup){console.log("Form already setup, updating view only"),this.isDeveloper?this.setupDeveloperView():this.setupClientView();return}this.isDeveloper?this.setupDeveloperView():this.setupClientView();var p=new Date().toISOString().split("T")[0],g=a("#devDate"),b=a("#clientDate");g&&(g.value=p),b&&(b.value=p);var S=a("#clientName"),_=a("#clientNameDisplay");S&&_&&S.addEventListener("input",function(){_.textContent=this.value||"Client Name"}),this.form.addEventListener("submit",function(L){return L.preventDefault(),L.stopPropagation(),console.log("Form submit prevented"),!1});var D=a("#submitBtn");D&&D.addEventListener("click",function(L){L.preventDefault(),L.stopPropagation(),console.log("Submit button clicked, isDeveloper:",u.isDeveloper),u.isDeveloper?u.handleDeveloperSubmit():u.handleClientSubmit()});var T=a("#downloadBtn");T&&T.addEventListener("click",function(L){L.preventDefault(),u.generatePDF()}),this.formSetup=!0},N.prototype.setupDeveloperView=function(){console.log("Setting up developer view");var u=a("#contractForm");u&&(u.style.display="none"),this.showDeveloperDashboard();var p=a("#devSignatureBlock");p&&(p.style.display="none");var g=a("#clientSignatureBlock");g&&(g.style.display="none");var b=a("#devPendingBlock");b&&(b.style.display="none");var S=a("#clientName");S&&(S.disabled=!0,S.removeAttribute("required"),S.setAttribute("readonly","readonly"));var _=a("#clientSignerName");_&&(_.disabled=!0,_.removeAttribute("required"));var D=a("#clientDate");D&&(D.disabled=!0,D.removeAttribute("required"));var T=a("#acknowledgment");T&&(T.disabled=!0,T.removeAttribute("required"),T.checked=!0);var L=a(".acknowledgment");L&&(L.style.display="none");var F=a("#submitBtn");F&&(F.style.display="none");var U=a("#downloadBtn");U&&(U.style.display="none")},N.prototype.showDeveloperDashboard=function(){console.log("Loading developer dashboard...");var u=a("#contractForm");u&&(u.style.display="none");var p=a(".modal-header");p&&(p.style.display="none");var g=a(".modal-close");g&&(g.style.display="none");var b=a("#developerDashboard");if(!b){b=document.createElement("div"),b.id="developerDashboard",b.className="developer-dashboard";var S=a(".modal-content");S&&S.insertBefore(b,S.firstChild)}b.innerHTML='<div class="dashboard-loading"><p>Loading contracts...</p></div>',b.style.display="block",this.fetchAllContracts()},N.prototype.renderHelpRequestsSection=function(u){var p=this,g=a("#helpTabContent"),b=a("#helpCountBadge");if(g){b&&(b.textContent=u.length);var S='<div class="help-tab-header"><h3> '+e("helpDash.title")+'</h3><div style="display: flex; align-items: center; gap: 10px;">';if(u.length>0&&(S+='<button class="btn-resolve-all" style="padding: 6px 12px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: 600;"> '+e("helpDash.btn.resolveAll")+"</button>"),S+="</div></div>",u.length>0){var _={};u.forEach(function(L){var F=L.issueType||"other";_[F]=(_[F]||0)+1});var D={contract_not_showing:"#6366f1",problems_submitting:"#f59e0b",signature_issues:"#ef4444",account_access:"#10b981",other:"#8b5cf6"};S+='<div class="help-chips">',Object.keys(_).forEach(function(L){var F=D[L]||"#6b7280";S+='<span class="help-chip" style="border-color: '+F+"40; color: "+F+';">'+p.getIssueTypeLabel(L)+'<span class="chip-count">'+_[L]+"</span></span>"}),S+="</div>"}if(u.length===0)S+='<div class="empty-state"><img src="/images/scarlo-logo.png" alt="Scarlo" class="empty-icon"><p>'+e("helpDash.empty")+"</p></div>";else{var D={contract_not_showing:"#6366f1",problems_submitting:"#f59e0b",signature_issues:"#ef4444",account_access:"#10b981",other:"#8b5cf6"};S+='<div class="help-list">',u.forEach(function(F){var U=F.timestamp?F.timestamp.toDate?F.timestamp.toDate().toLocaleDateString():new Date(F.timestamp).toLocaleDateString():"N/A",A=F.isAuthenticated?'<span class="auth-badge verified"> '+e("helpDash.badge.verified")+"</span>":'<span class="auth-badge anonymous"> '+e("helpDash.badge.anonymous")+"</span>",B=D[F.issueType]||"#f59e0b";S+='<div class="help-item" data-request-id="'+F.id+'" style="border-left-color: '+B+';"><div class="help-icon"></div><div class="help-details"><div class="help-header"><h4>'+(F.userEmail||F.userPhone||e("helpDash.fallback.user"))+"</h4>"+A+'<span class="help-badge">'+p.getIssueTypeLabel(F.issueType)+'</span></div><p class="help-message">'+(F.issueDetails||e("helpDash.fallback.message"))+'</p><div class="help-meta"><span class="meta-item"> '+U+'</span></div></div><div class="help-actions"><button class="btn-resolve-help" data-request-id="'+F.id+'" title="Mark as resolved"> '+e("helpDash.btn.resolve")+"</button></div></div>"}),S+="</div>"}S+="</div>",g.innerHTML=S,c(".btn-resolve-help").forEach(function(L){L.addEventListener("click",function(F){F.preventDefault();var U=this.getAttribute("data-request-id");p.resolveHelpRequest(U)})});var T=a(".btn-resolve-all");T&&T.addEventListener("click",function(L){L.preventDefault(),p.resolveAllHelpRequests(u)})}},N.prototype.fetchAllContracts=function(){var u=this,p=firebase.firestore().collection("contracts").where("status","==","pending_developer").get(),g=firebase.firestore().collection("contracts").where("status","==","completed").get(),b=new Promise(function(D){u.fetchHelpRequests(function(T){D(T)})}),S=firebase.firestore().collection("sow_documents").orderBy("createdAt","desc").get(),_=firebase.firestore().collection("coupons").orderBy("createdAt","desc").get();Promise.all([p,g,b,S,_]).then(function(D){var T=D[0],L=D[1],F=D[2],U=D[3],A=D[4],B=[];T.forEach(function(pe){var ge=pe.data();ge.id=pe.id,ge.daysSinceSubmission=u.calculateDaysSince(ge.timestamp),B.push(ge)}),B.sort(function(pe,ge){return ge.daysSinceSubmission-pe.daysSinceSubmission});var $=[];L.forEach(function(pe){var ge=pe.data();ge.id=pe.id,ge.daysSinceSubmission=u.calculateDaysSince(ge.timestamp),$.push(ge)}),$.sort(function(pe,ge){var Se=pe.finalizedTimestamp?pe.finalizedTimestamp.toDate().getTime():0,Ee=ge.finalizedTimestamp?ge.finalizedTimestamp.toDate().getTime():0;return Ee-Se});var K=[],Y=[];U.forEach(function(pe){var ge=pe.data();ge.id=pe.id,K.push(ge),ge.changeRequestId&&Y.push(ge.changeRequestId)});var Q=[];A.forEach(function(pe){var ge=pe.data();ge.id=pe.id,Q.push(ge)}),u.coupons=Q,u.renderDeveloperDashboard(B,$,K,Q,F),u.renderHelpRequestsSection(F);var te=document.getElementById("couponsTabContent");if(te){var ce=document.getElementById("couponCountBadge");ce&&(ce.textContent=Q.length),te.innerHTML=u.renderCouponsTab(Q),u.attachCouponEventListeners()}u.fetchClientLastLogins(K).then(function(){Y.length>0?u.fetchChangeRequestsUnreadStatus(Y,K):u.renderSOWTab(K)})}).catch(function(D){console.error("Error fetching contracts:",D);var T=a("#developerDashboard");T&&(T.innerHTML='<div class="dashboard-error"><p>Error loading contracts: '+D.message+"</p></div>")})},N.prototype.calculateDaysSince=function(u){if(!u)return 0;var p;u.toDate?p=u.toDate():u instanceof Date?p=u:p=new Date(u);var g=new Date,b=Math.abs(g-p),S=Math.floor(b/(1e3*60*60*24));return S},N.prototype.getUrgencyLevel=function(u){return u>=7?{level:"critical",label:"URGENT",color:"#ef4444",icon:""}:u>=3?{level:"high",label:"ACTION NEEDED",color:"#f59e0b",icon:""}:u>=1?{level:"medium",label:"NEW",color:"#3b82f6",icon:""}:{level:"low",label:"JUST IN",color:"#10b981",icon:""}},N.prototype.formatCurrency=function(u){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(u||0)},N.prototype.timeAgo=function(u){var p=Math.floor((new Date-u)/1e3);if(p<60)return"just now";var g=Math.floor(p/60);if(g<60)return g+"m ago";var b=Math.floor(g/60);if(b<24)return b+"h ago";var S=Math.floor(b/24);if(S<7)return S+"d ago";var _=Math.floor(S/7);return _<4?_+"w ago":u.toLocaleDateString("en-US",{month:"short",day:"numeric"})},N.prototype.computeDashboardMetrics=function(u,p,g,b,S){var _=this,D=new Date,T=D.getMonth(),L=D.getFullYear(),F=0,U=0,A={},B=0;g.forEach(function(re){re.payment&&re.payment.total&&(F+=re.payment.total);var xe=_.calculatePaymentStatus(re);U+=xe.paidAmount;var $e=re.packageType||"unknown";A[$e]=(A[$e]||0)+1,re.status!=="approved"&&B++});var $=u.length+p.length,K=$>0?Math.round(p.length/$*100):0,Y=0;if(p.length>0){var Q=0;p.forEach(function(re){Q+=re.daysSinceSubmission||0}),Y=Math.round(Q/p.length)}var te=u.filter(function(re){return re.daysSinceSubmission>=7}).length,ce=p.filter(function(re){if(!re.finalizedTimestamp)return!1;var xe=re.finalizedTimestamp.toDate?re.finalizedTimestamp.toDate():new Date(re.finalizedTimestamp);return xe.getMonth()===T&&xe.getFullYear()===L}).length,pe=b.filter(function(re){return re.active!==!1}).length,ge=0;b.forEach(function(re){ge+=re.usageCount||0});var Se={};S.forEach(function(re){var xe=re.issueType||"other";Se[xe]=(Se[xe]||0)+1});var Ee=[];return p.forEach(function(re){if(re.finalizedTimestamp){var xe=re.finalizedTimestamp.toDate?re.finalizedTimestamp.toDate():new Date(re.finalizedTimestamp);Ee.push({type:"contract_signed",label:"Contract signed  "+(re.clientName||"Unknown"),date:xe,color:"#10b981"})}}),u.forEach(function(re){if(re.timestamp){var xe=re.timestamp.toDate?re.timestamp.toDate():new Date(re.timestamp);Ee.push({type:"contract_received",label:"Contract received  "+(re.clientName||"Unknown"),date:xe,color:"#6366f1"})}}),g.forEach(function(re){if(re.createdAt){var xe=re.createdAt.toDate?re.createdAt.toDate():new Date(re.createdAt);Ee.push({type:"sow_created",label:"SOW created  "+(re.clientName||"Unknown"),date:xe,color:"#f59e0b"})}}),S.forEach(function(re){if(re.timestamp){var xe=re.timestamp.toDate?re.timestamp.toDate():new Date(re.timestamp);Ee.push({type:"help_request",label:"Help request  "+(re.userEmail||re.userPhone||"Anonymous"),date:xe,color:"#ef4444"})}}),Ee.sort(function(re,xe){return xe.date-re.date}),Ee=Ee.slice(0,5),{totalRevenue:F,paidRevenue:U,completionRate:K,avgResponseDays:Y,activeProjects:B,totalContracts:$,urgentCount:te,thisMonthCompleted:ce,activeCoupons:pe,totalCouponUsage:ge,helpByType:Se,sowsByPackage:A,events:Ee,pending:u.length,completed:p.length,sowCount:g.length,helpCount:S.length,couponCount:b.length}},N.prototype.renderDeveloperDashboard=function(u,p,g,b,S){var _=this,D=a("#developerDashboard");if(D){g=g||[],b=b||[],S=S||[];var T=_.computeDashboardMetrics(u,p,g,b,S),L=T.urgentCount,F="";F+=`<button class="dashboard-close" onclick="document.querySelector('.contract-modal').classList.remove('show'); document.body.classList.remove('modal-open'); document.body.style.overflow = '';"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>`;for(var U="",A=0;A<20;A++){var B=A<10?"0"+A:""+A;U+='<img id="dashLogo'+A+'"'+(A===0?' class="visible"':"")+' src="/images/morph-logo'+B+'.png"'+(A===0?' alt="Scarlo Logo"':' alt=""')+">"}F+='<div class="dashboard-header"><div class="header-content"><div class="dash-logo-animated"><div class="dash-logo-ambient"></div><div class="dash-logo-stack">'+U+'</div></div></div><div class="header-date"><span class="current-date">'+new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})+"</span></div></div>",L>0?F+='<div class="alert-banner urgent"><div class="alert-icon"></div><div class="alert-content"><strong>'+L+e(L!==1?"dash.alert.contractPlural":"dash.alert.contractSingular")+e(L===1?"dash.alert.needSingular":"dash.alert.needPlural")+" immediate attention!</strong><p>"+e(L!==1?"dash.alert.clientPlural":"dash.alert.clientSingular")+e(L!==1?"dash.alert.havePlural":"dash.alert.hasSingular")+e("dash.alert.waiting7days")+"</p></div></div>":u.length===0&&p.length>0&&(F+='<div class="alert-banner success"><div class="alert-icon"></div><div class="alert-content"><strong>'+e("dash.alert.allCaughtUp")+"</strong><p>"+e("dash.alert.noPending")+"</p></div></div>"),F+='<div class="analytics-grid">',F+='<div class="analytics-card revenue-card"><div class="analytics-card-row"><span class="analytics-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></span><div class="analytics-value">'+_.formatCurrency(T.totalRevenue)+'</div><span class="analytics-trend">'+_.formatCurrency(T.paidRevenue)+" "+e("sowTab.stats.collected").toLowerCase()+'</span></div><div class="analytics-bottom"><span class="analytics-label">'+e("dash.analytics.totalRevenue")+'</span><div class="analytics-bar-track"><div class="analytics-bar-fill revenue-fill" style="width: '+(T.totalRevenue>0?Math.round(T.paidRevenue/T.totalRevenue*100):0)+'%;"></div></div></div></div>';var $=(2*Math.PI*20).toFixed(1),K=((1-T.completionRate/100)*2*Math.PI*20).toFixed(1);F+='<div class="analytics-card completion-card"><div class="analytics-card-row"><svg class="progress-ring" width="40" height="40" viewBox="0 0 44 44"><circle cx="22" cy="22" r="20" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="3"/><circle class="progress-ring-fill" cx="22" cy="22" r="20" fill="none" stroke="#10b981" stroke-width="3" stroke-dasharray="'+$+'" stroke-dashoffset="'+K+'" stroke-linecap="round" transform="rotate(-90 22 22)"/></svg><div class="analytics-value">'+T.completionRate+'<span class="analytics-unit">%</span></div><span class="analytics-trend">'+T.completed+" "+e("dash.analytics.of")+T.totalContracts+'</span></div><div class="analytics-bottom"><span class="analytics-label">'+e("dash.analytics.completionRate")+"</span></div></div>",F+='<div class="analytics-card response-card"><div class="analytics-card-row"><span class="analytics-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg></span><div class="analytics-value">'+T.avgResponseDays+'<span class="analytics-unit">'+e("dash.analytics.days")+'</span></div><span class="analytics-trend'+(T.urgentCount>0?" trend-warning":"")+'">'+(T.urgentCount>0?T.urgentCount+" "+e("dash.analytics.urgent"):e("dash.analytics.onTrack"))+'</span></div><div class="analytics-bottom"><span class="analytics-label">'+e("dash.analytics.avgResponse")+'</span><div class="analytics-bar-track"><div class="analytics-bar-fill response-fill" style="width: '+Math.min(100,Math.round(T.avgResponseDays/14*100))+'%;"></div></div></div></div>',F+='<div class="analytics-card projects-card"><div class="analytics-card-row"><span class="analytics-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg></span><div class="analytics-value">'+T.activeProjects+'</div><span class="analytics-trend">+'+T.thisMonthCompleted+" "+e("dash.analytics.thisMonth")+'</span></div><div class="analytics-bottom"><span class="analytics-label">'+e("dash.analytics.activeProjects")+'</span><div class="analytics-bar-track"><div class="analytics-bar-fill projects-fill" style="width: '+(T.sowCount>0?Math.round(T.activeProjects/T.sowCount*100):0)+'%;"></div></div></div></div>',F+="</div>",T.events.length>0&&(F+='<div class="activity-feed"><div class="activity-feed-header"><h3>'+e("dash.analytics.recentActivity")+'</h3></div><div class="activity-feed-list">',T.events.forEach(function(Y,Q){F+='<div class="activity-item" style="animation-delay: '+Q*.06+'s;"><div class="activity-dot" style="background: '+Y.color+"; box-shadow: 0 0 8px "+Y.color+'40;"></div><div class="activity-info"><span class="activity-text">'+Y.label+'</span><span class="activity-time">'+_.timeAgo(Y.date)+"</span></div></div>"}),F+="</div></div>"),F+='<div class="dashboard-tabs"><div class="tab-buttons"><button class="tab-btn active" data-tab="contracts"><span class="tab-icon"></span><span class="tab-label">'+e("dash.tab.contracts")+'</span><span class="tab-badge">'+(u.length+p.length)+'</span></button><button class="tab-btn" data-tab="sow"><span class="tab-icon"></span><span class="tab-label">'+e("dash.tab.sowDocuments")+'</span><span class="tab-badge" id="sowCountBadge">0</span></button><button class="tab-btn" data-tab="coupons"><span class="tab-icon"></span><span class="tab-label">'+e("dash.tab.coupons")+'</span><span class="tab-badge" id="couponCountBadge">0</span></button><button class="tab-btn" data-tab="help"><span class="tab-icon"></span><span class="tab-label">'+e("dash.tab.helpRequests")+'</span><span class="tab-badge" id="helpCountBadge">0</span></button></div><div class="tab-content"><div class="tab-pane active" data-tab="contracts">'+_.renderContractsTab(u,p)+'</div><div class="tab-pane" data-tab="sow"><div id="sowTabContent"><div class="loading-state"><div class="spinner"></div><p>'+e("dash.loading.sow")+'</p></div></div></div><div class="tab-pane" data-tab="coupons"><div id="couponsTabContent"><div class="loading-state"><div class="spinner"></div><p>'+e("dash.loading.coupons")+'</p></div></div></div><div class="tab-pane" data-tab="help"><div id="helpTabContent"><div class="loading-state"><div class="spinner"></div><p>'+e("dash.loading.help")+"</p></div></div></div></div></div>",F+=`<div class="dashboard-footer"><button class="btn-close-dashboard" onclick="document.querySelector('.contract-modal').classList.remove('show'); document.body.classList.remove('modal-open');">`+e("dash.btn.closeDashboard")+"</button></div>",D.innerHTML=F,(function(){for(var Y=20,Q=120,te=[],ce=0;ce<Y;ce++){var pe=document.getElementById("dashLogo"+ce);pe&&te.push(pe)}if(te.length===0)return;var ge=te[0].closest(".dash-logo-animated");ge&&(ge.style.visibility="hidden");var Se=0,Ee=1,re=performance.now(),xe=null;function $e(je){je-re>=Q&&(te[Se].classList.remove("visible"),Se+=Ee,Se>=te.length-1?(Se=te.length-1,Ee=-1):Se<=0&&(Se=0,Ee=1),te[Se].classList.add("visible"),re=je),xe=requestAnimationFrame($e)}Promise.all(te.map(function(je){var nt=je.complete?Promise.resolve():new Promise(function(Qe){je.onload=Qe,je.onerror=Qe});return nt.then(function(){return je.decode?je.decode().catch(function(){}):Promise.resolve()})})).then(function(){ge&&(ge.style.visibility=""),re=performance.now(),xe=requestAnimationFrame($e)});var it=new MutationObserver(function(){document.getElementById("dashLogo0")||(cancelAnimationFrame(xe),it.disconnect())});it.observe(document.body,{childList:!0,subtree:!0})})(),c(".btn-sign-contract").forEach(function(Y){Y.addEventListener("click",function(Q){Q.preventDefault();var te=this.getAttribute("data-contract-id");_.selectContractToSign(te,u)})}),c(".btn-download").forEach(function(Y){Y.addEventListener("click",function(Q){Q.preventDefault();var te=this.getAttribute("data-contract-id");_.viewCompletedContract(te,p)})}),c(".tab-btn").forEach(function(Y){Y.addEventListener("click",function(){var Q=this.getAttribute("data-tab");_.switchTab(Q)})})}},N.prototype.renderContractsTab=function(u,p){var g=this,b="",S=p.length,_=u.length,D=S+_;return b+='<div class="pipeline-strip"><div class="pipeline-stage"><span class="pipeline-count">'+_+'</span><span class="pipeline-label">'+e("contracts.stage.pending")+'</span></div><div class="pipeline-arrow"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg></div><div class="pipeline-stage"><span class="pipeline-count">'+S+'</span><span class="pipeline-label">'+e("contracts.stage.completed")+'</span></div><div class="pipeline-bar-track"><div class="pipeline-bar-fill" style="width: '+(D>0?Math.round(S/D*100):0)+'%;"></div></div></div>',b+='<div class="dashboard-section action-section"><div class="section-header"><h3>'+e("contracts.section.actionRequired")+'</h3><span class="section-badge">'+u.length+e("contracts.badge.pending")+"</span></div>",u.length===0?b+='<div class="empty-state success-state"><img src="/images/scarlo-logo.png" alt="Scarlo" class="empty-icon"><p>'+e("contracts.empty.noPending")+"</p></div>":(b+='<div class="action-list">',u.forEach(function(T){var L=g.getUrgencyLevel(T.daysSinceSubmission),F=T.timestamp?T.timestamp.toDate?T.timestamp.toDate().toLocaleDateString():new Date(T.timestamp).toLocaleDateString():"N/A";b+='<div class="action-item" data-contract-id="'+T.id+'"><div class="client-avatar" style="border-color: '+L.color+';"><span>'+(T.clientName||"U").charAt(0).toUpperCase()+'</span></div><div class="action-priority-bar" style="background: '+L.color+';"></div><div class="action-details"><div class="action-client"><h4>'+(T.clientName||"Unknown Client")+'</h4><span class="urgency-tag" style="background: '+L.color+"22; color: "+L.color+';">'+L.icon+" "+L.label+'</span></div><div class="action-meta-grid"><div class="meta-cell"><span class="meta-key">'+e("contracts.meta.email")+'</span><span class="meta-val">'+(T.clientEmail||"N/A")+'</span></div><div class="meta-cell"><span class="meta-key">'+e("contracts.meta.received")+'</span><span class="meta-val">'+F+'</span></div><div class="meta-cell"><span class="meta-key">'+e("contracts.meta.waiting")+'</span><span class="meta-val '+(T.daysSinceSubmission>=7?"meta-urgent":"")+'">'+T.daysSinceSubmission+" "+(T.daysSinceSubmission!==1?e("contracts.meta.dayPlural"):e("contracts.meta.daySingular"))+'</span></div><div class="meta-cell"><span class="meta-key">'+e("contracts.meta.phone")+'</span><span class="meta-val">'+(T.clientPhone?C(T.clientPhone):"N/A")+'</span></div></div></div><div class="action-cta"><button class="btn-sign-contract" data-contract-id="'+T.id+'"><span class="btn-icon"></span><span class="btn-text">'+e("contracts.btn.sign")+"</span></button></div></div>"}),b+="</div>"),b+="</div>",b+='<div class="dashboard-section history-section"><div class="section-header"><h3>'+e("contracts.section.completed")+'</h3><span class="section-badge success">'+p.length+e("contracts.badge.total")+"</span></div>",p.length===0?b+='<div class="empty-state"><img src="/images/scarlo-logo.png" alt="Scarlo" class="empty-icon"><p>'+e("contracts.empty.noCompleted")+"</p></div>":(b+='<div class="history-table">',p.forEach(function(T){var L=T.finalizedTimestamp?T.finalizedTimestamp.toDate?T.finalizedTimestamp.toDate().toLocaleDateString():new Date(T.finalizedTimestamp).toLocaleDateString():"N/A";b+='<div class="history-row" data-contract-id="'+T.id+'"><div class="history-status"><span class="status-check">&#10003;</span></div><div class="history-name">'+(T.clientName||"Unknown Client")+'</div><div class="history-date">'+L+'</div><div class="history-action"><button class="btn-download" data-contract-id="'+T.id+'" title="Download PDF"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> '+e("contracts.btn.pdf")+"</button></div></div>"}),b+="</div>"),b+="</div>",b},N.prototype.switchTab=function(u){c(".tab-btn").forEach(function(p){p.classList.remove("active"),p.getAttribute("data-tab")===u&&p.classList.add("active")}),c(".tab-pane").forEach(function(p){p.classList.remove("active"),p.getAttribute("data-tab")===u&&p.classList.add("active")})},N.prototype.loadCoupons=function(){var u=this,p=document.getElementById("couponsTabContent");p&&firebase.firestore().collection("coupons").orderBy("createdAt","desc").get().then(function(g){var b=[];g.forEach(function(_){var D=_.data();D.id=_.id,b.push(D)});var S=document.getElementById("couponCountBadge");S&&(S.textContent=b.length),u.coupons=b,p.innerHTML=u.renderCouponsTab(b),u.attachCouponEventListeners()}).catch(function(g){console.error("Error loading coupons:",g),p.innerHTML='<div class="error-state"><p>Error loading coupons: '+g.message+"</p></div>"})},N.prototype.createWelcomeCoupon=function(){var u={code:"WELCOME10",description:"Welcome discount for new clients - 10% off your first project",discountType:"percentage",discountValue:10,minPurchase:0,usageLimit:0,usageCount:0,expirationDate:null,tierRestrictions:[],oneTimeUse:!1,active:!0,createdAt:firebase.firestore.FieldValue.serverTimestamp()};return firebase.firestore().collection("coupons").add(u).then(function(p){console.log("WELCOME10 coupon created with ID:",p.id)}).catch(function(p){console.error("Error creating WELCOME10 coupon:",p)})},N.prototype.renderCouponsTab=function(u){var p=this,g="";if(g+='<div class="coupons-header"><div class="coupons-title"></div><button class="btn-create-coupon" id="btnCreateCoupon"><span class="btn-icon">+</span><span class="btn-text">'+e("couponTab.btn.create")+"</span></button></div>",g+='<div id="couponCreatorForm" class="coupon-creator-form" style="display: none;"><div class="coupon-form-header"><h4 id="couponFormTitle">'+e("couponTab.form.title")+'</h4><button class="btn-close-form" id="btnCloseCouponForm"></button></div><div class="coupon-form-body"><div class="form-row"><div class="form-group"><label>'+e("couponTab.form.codeLabel")+'</label><input type="text" id="couponCode" placeholder="'+e("couponTab.form.codePlaceholder")+'" class="coupon-input" style="text-transform: uppercase;"><small>'+e("couponTab.form.codeHelper")+'</small></div><div class="form-group"><label>'+e("couponTab.form.typeLabel")+'</label><select id="couponType" class="coupon-select"><option value="percentage">'+e("couponTab.form.typePercent")+'</option><option value="fixed">'+e("couponTab.form.typeFixed")+'</option></select></div></div><div class="form-row"><div class="form-group"><label>'+e("couponTab.form.valueLabel")+'</label><input type="number" id="couponValue" placeholder="'+e("couponTab.form.valuePlaceholder")+'" class="coupon-input" min="0" step="0.01"><small id="couponValueHint">'+e("couponTab.form.valueHelper")+'</small></div><div class="form-group"><label>'+e("couponTab.form.usageLabel")+'</label><input type="number" id="couponUsageLimit" placeholder="'+e("couponTab.form.usagePlaceholder")+'" class="coupon-input" min="0"><small>'+e("couponTab.form.usageHelper")+'</small></div></div><div class="form-row"><div class="form-group"><label>'+e("couponTab.form.minPurchaseLabel")+'</label><input type="number" id="couponMinPurchase" placeholder="0" class="coupon-input" min="0" step="0.01"><small>'+e("couponTab.form.minPurchaseHelper")+'</small></div><div class="form-group"><label>'+e("couponTab.form.expirationLabel")+'</label><input type="date" id="couponExpiration" class="coupon-input"><small>'+e("couponTab.form.expirationHelper")+'</small></div></div><div class="form-row"><div class="form-group full-width"><label>'+e("couponTab.form.tierLabel")+'</label><div class="tier-checkboxes"><label class="tier-checkbox"><input type="checkbox" value="essential" checked> '+e("couponTab.form.tierEssential")+'</label><label class="tier-checkbox"><input type="checkbox" value="starter" checked> '+e("couponTab.form.tierStarter")+'</label><label class="tier-checkbox"><input type="checkbox" value="growth" checked> '+e("couponTab.form.tierGrowth")+'</label><label class="tier-checkbox"><input type="checkbox" value="professional" checked> '+e("couponTab.form.tierProfessional")+'</label><label class="tier-checkbox"><input type="checkbox" value="enterprise" checked> '+e("couponTab.form.tierEnterprise")+'</label><label class="tier-checkbox"><input type="checkbox" value="custom" checked> '+e("couponTab.form.tierCustom")+"</label></div><small>"+e("couponTab.form.tierHelper")+'</small></div></div><div class="form-row"><div class="form-group full-width"><label>'+e("couponTab.form.descLabel")+'</label><input type="text" id="couponDescription" placeholder="'+e("couponTab.form.descPlaceholder")+'" class="coupon-input"></div></div><div class="form-row"><div class="form-group"><label class="checkbox-label"><input type="checkbox" id="couponActive" checked><span>'+e("couponTab.form.activeLabel")+'</span></label></div></div><input type="hidden" id="couponEditId" value=""><div class="form-actions"><button class="btn-cancel" id="btnCancelCoupon">'+e("couponTab.form.cancelBtn")+'</button><button class="btn-save-coupon" id="btnSaveCoupon">'+e("couponTab.form.saveBtn")+"</button></div></div></div>",u.length===0)g+='<div class="empty-state"><div class="empty-icon"></div><h4>'+e("couponTab.empty.title")+"</h4><p>"+e("couponTab.empty.text")+"</p></div>";else{g+='<div class="coupons-list">';var b=u.filter(function(_){return _.active!==!1}),S=u.filter(function(_){return _.active===!1});b.length>0&&(g+='<div class="coupons-section"><h4 class="section-label">'+e("couponTab.section.active")+" ("+b.length+")</h4>",b.forEach(function(_){g+=p.renderCouponCard(_)}),g+="</div>"),S.length>0&&(g+='<div class="coupons-section inactive-section"><h4 class="section-label">'+e("couponTab.section.inactive")+" ("+S.length+")</h4>",S.forEach(function(_){g+=p.renderCouponCard(_)}),g+="</div>"),g+="</div>"}return g},N.prototype.renderCouponCard=function(u){var p=u.expirationDate&&new Date(u.expirationDate)<new Date,g=u.usageLimit&&u.usageCount>=u.usageLimit,b=!u.active||p||g?"coupon-inactive":"coupon-active",S=u.discountType==="percentage"?u.discountValue+"% OFF":"$"+parseFloat(u.discountValue||0).toFixed(0)+" OFF",_="";u.active?p?_='<span class="status-badge expired">Expired</span>':g?_='<span class="status-badge used-up">Limit Reached</span>':_='<span class="status-badge active">Active</span>':_='<span class="status-badge inactive">Disabled</span>';var D='<div class="coupon-card '+b+'" data-coupon-id="'+u.id+'"><div class="coupon-card-header"><div class="coupon-code-display"><span class="coupon-code">'+u.code+'</span><button class="btn-copy-code" data-code="'+u.code+'" title="Copy code"></button></div>'+_+'</div><div class="coupon-card-body"><div class="coupon-discount">'+S+'</div><div class="coupon-details">';if(u.description&&(D+='<div class="detail-row"><span class="detail-label">Description:</span> '+u.description+"</div>"),u.minPurchase&&u.minPurchase>0&&(D+='<div class="detail-row"><span class="detail-label">Min. Purchase:</span> $'+parseFloat(u.minPurchase).toFixed(0)+"</div>"),u.usageLimit?D+='<div class="detail-row"><span class="detail-label">Usage:</span> '+(u.usageCount||0)+" / "+u.usageLimit+"</div>":D+='<div class="detail-row"><span class="detail-label">Usage:</span> '+(u.usageCount||0)+" (unlimited)</div>",u.expirationDate){var T=new Date(u.expirationDate).toLocaleDateString();D+='<div class="detail-row"><span class="detail-label">Expires:</span> '+T+"</div>"}return u.allowedTiers&&u.allowedTiers.length<5&&(D+='<div class="detail-row"><span class="detail-label">Tiers:</span> '+u.allowedTiers.join(", ")+"</div>"),D+='</div></div><div class="coupon-card-footer"><button class="btn-edit-coupon" data-coupon-id="'+u.id+'">Edit</button><button class="btn-delete-coupon" data-coupon-id="'+u.id+'">Delete</button></div></div>',D},N.prototype.attachCouponEventListeners=function(){var u=this,p=document.getElementById("btnCreateCoupon");p&&p.addEventListener("click",function(){u.showCouponForm()});var g=document.getElementById("btnCloseCouponForm");g&&g.addEventListener("click",function(){u.hideCouponForm()});var b=document.getElementById("btnCancelCoupon");b&&b.addEventListener("click",function(){u.hideCouponForm()});var S=document.getElementById("btnSaveCoupon");S&&S.addEventListener("click",function(){u.saveCoupon()});var _=document.getElementById("couponType");_&&_.addEventListener("change",function(){var T=document.getElementById("couponValueHint");this.value==="percentage"?T.textContent=e("coupon.hint.percentage"):T.textContent=e("coupon.hint.dollar")});var D=document.getElementById("couponCode");D&&D.addEventListener("input",function(){this.value=this.value.toUpperCase().replace(/[^A-Z0-9]/g,"")}),c(".btn-edit-coupon").forEach(function(T){T.addEventListener("click",function(){var L=this.getAttribute("data-coupon-id");u.editCoupon(L)})}),c(".btn-delete-coupon").forEach(function(T){T.addEventListener("click",function(){var L=this.getAttribute("data-coupon-id");u.deleteCoupon(L)})}),c(".btn-copy-code").forEach(function(T){T.addEventListener("click",function(){var L=this.getAttribute("data-code");navigator.clipboard.writeText(L).then(function(){alert("Coupon code copied: "+L)})})})},N.prototype.showCouponForm=function(u){var p=document.getElementById("couponCreatorForm"),g=document.getElementById("couponFormTitle");p&&(document.getElementById("couponCode").value="",document.getElementById("couponType").value="percentage",document.getElementById("couponValue").value="",document.getElementById("couponUsageLimit").value="",document.getElementById("couponMinPurchase").value="",document.getElementById("couponExpiration").value="",document.getElementById("couponDescription").value="",document.getElementById("couponActive").checked=!0,document.getElementById("couponEditId").value="",c('.tier-checkboxes input[type="checkbox"]').forEach(function(b){b.checked=!0}),u?(g.textContent=e("coupon.title.edit"),document.getElementById("couponCode").value=u.code||"",document.getElementById("couponType").value=u.discountType||"percentage",document.getElementById("couponValue").value=u.discountValue||"",document.getElementById("couponUsageLimit").value=u.usageLimit||"",document.getElementById("couponMinPurchase").value=u.minPurchase||"",document.getElementById("couponExpiration").value=u.expirationDate||"",document.getElementById("couponDescription").value=u.description||"",document.getElementById("couponActive").checked=u.active!==!1,document.getElementById("couponEditId").value=u.id,u.allowedTiers&&c('.tier-checkboxes input[type="checkbox"]').forEach(function(b){b.checked=u.allowedTiers.indexOf(b.value)!==-1})):g.textContent=e("coupon.title.create"),p.style.display="block",document.getElementById("couponCode").focus())},N.prototype.hideCouponForm=function(){var u=document.getElementById("couponCreatorForm");u&&(u.style.display="none")},N.prototype.saveCoupon=function(){var u=this,p=document.getElementById("couponEditId").value,g=document.getElementById("couponCode").value.trim().toUpperCase(),b=document.getElementById("couponType").value,S=parseFloat(document.getElementById("couponValue").value),_=document.getElementById("couponUsageLimit").value?parseInt(document.getElementById("couponUsageLimit").value):null,D=parseFloat(document.getElementById("couponMinPurchase").value)||0,T=document.getElementById("couponExpiration").value||null,L=document.getElementById("couponDescription").value.trim(),F=document.getElementById("couponActive").checked,U=[];if(c('.tier-checkboxes input[type="checkbox"]:checked').forEach(function($){U.push($.value)}),!g){alert(e("coupon.val.enterCode"));return}if(isNaN(S)||S<=0){alert(e("coupon.val.validDiscount"));return}if(b==="percentage"&&S>100){alert(e("coupon.val.percentMax"));return}if(U.length===0){alert(e("coupon.val.selectTier"));return}var A={code:g,discountType:b,discountValue:S,usageLimit:_,minPurchase:D,expirationDate:T,description:L,active:F,allowedTiers:U,updatedAt:firebase.firestore.FieldValue.serverTimestamp()},B;p?B=firebase.firestore().collection("coupons").doc(p).update(A):(A.createdAt=firebase.firestore.FieldValue.serverTimestamp(),A.usageCount=0,B=firebase.firestore().collection("coupons").where("code","==",g).get().then(function($){if(!$.empty)throw new Error("A coupon with this code already exists");return firebase.firestore().collection("coupons").add(A)})),B.then(function(){alert(e("coupon.msg.saveSuccess")),u.hideCouponForm(),u.loadCoupons()}).catch(function($){console.error("Error saving coupon:",$),alert(e("coupon.err.save")+$.message)})},N.prototype.editCoupon=function(u){var p=this.coupons.find(function(g){return g.id===u});p&&this.showCouponForm(p)},N.prototype.deleteCoupon=function(u){var p=this,g=this.coupons.find(function(b){return b.id===u});g&&confirm(e("coupon.confirm.deletePrefix")+g.code+e("coupon.confirm.deleteSuffix"))&&firebase.firestore().collection("coupons").doc(u).delete().then(function(){alert(e("coupon.msg.deleteSuccess")),p.loadCoupons()}).catch(function(b){console.error("Error deleting coupon:",b),alert(e("coupon.err.delete")+b.message)})},N.prototype.validateCoupon=function(u,p,g){var b=this.coupons?this.coupons.find(function(_){return _.code===u.toUpperCase()&&_.active!==!1}):null;if(!b)return{valid:!1,error:e("coupon.val.invalidCode")};if(b.expirationDate&&new Date(b.expirationDate)<new Date)return{valid:!1,error:e("coupon.val.expired")};if(b.usageLimit&&b.usageCount>=b.usageLimit)return{valid:!1,error:e("coupon.val.usageLimit")};if(b.minPurchase&&g<b.minPurchase)return{valid:!1,error:e("coupon.val.minPurchasePrefix")+b.minPurchase.toFixed(0)+e("coupon.val.minPurchaseSuffix")};if(b.allowedTiers&&b.allowedTiers.length>0&&p&&b.allowedTiers.indexOf(p)===-1)return{valid:!1,error:e("coupon.val.tierInvalidPrefix")+p+e("coupon.val.tierInvalidSuffix")};var S=0;return b.discountType==="percentage"?S=g*(b.discountValue/100):S=Math.min(b.discountValue,g),{valid:!0,coupon:b,discount:S,discountDisplay:b.discountType==="percentage"?b.discountValue+"%":"$"+b.discountValue.toFixed(0)}},N.prototype.fetchClientLastLogins=function(u){if(!u||u.length===0)return Promise.resolve();var p={};u.forEach(function(T){T.clientEmail&&(p[T.clientEmail.toLowerCase()]=T.clientEmail)});var g=Object.values(p);if(g.length===0)return Promise.resolve();for(var b=[],S=0;S<g.length;S+=10)b.push(g.slice(S,S+10));var _={},D=b.map(function(T){return firebase.firestore().collection("users").where("email","in",T).get().then(function(L){console.log(" Found",L.size,"users for lastLogin lookup"),L.forEach(function(F){var U=F.data();U.email&&(_[U.email.toLowerCase()]=U.lastLogin)})})});return Promise.all(D).then(function(){u.forEach(function(T){T.clientEmail&&(T.clientLastLogin=_[T.clientEmail.toLowerCase()]||null)})})},N.prototype.loadSOWDocuments=function(){var u=this;firebase.firestore().collection("sow_documents").orderBy("createdAt","desc").get().then(function(p){var g=[],b=[];return p.forEach(function(S){var _=S.data();_.id=S.id,g.push(_),_.changeRequestId&&b.push(_.changeRequestId)}),u.fetchClientLastLogins(g).then(function(){b.length>0?u.fetchChangeRequestsUnreadStatus(b,g):u.renderSOWTab(g)})}).catch(function(p){console.error("Error loading SOWs:",p);var g=a("#sowTabContent");g&&(g.innerHTML='<div class="error-state"><p>Error loading SOW documents</p><button class="btn-create-sow" onclick="location.reload()">Retry</button></div>')})},N.prototype.fetchChangeRequestsUnreadStatus=function(u,p){for(var g=this,b=g.isDeveloper?"developer":"client",S=g.isDeveloper?"developerLastViewed":"clientLastViewed",_=[],D=0;D<u.length;D+=10)_.push(u.slice(D,D+10));var T={},L=_.map(function(F){return firebase.firestore().collection("change_requests").where(firebase.firestore.FieldPath.documentId(),"in",F).get().then(function(U){U.forEach(function(A){var B=A.data();B.id=A.id;var $=!1;if(B.lastMessageBy&&B.lastMessageBy!==b&&B.lastMessageAt){var K=B[S];(!K||B.lastMessageAt.toMillis()>K.toMillis())&&($=!0)}B.hasUnreadMessages=$,T[A.id]=B})})});Promise.all(L).then(function(){p.forEach(function(F){F.changeRequestId&&T[F.changeRequestId]&&(F.changeRequestData=T[F.changeRequestId])}),g.renderSOWTab(p)}).catch(function(F){console.error("Error fetching change requests:",F),g.renderSOWTab(p)})},N.prototype.renderSOWTab=function(u){var p=this,g=a("#sowTabContent"),b=a("#sowCountBadge");if(g){b&&(b.textContent=u.length);var S='<div class="sow-tab-header"><button class="btn-create-sow" onclick="window.contractFormHandler.showSOWCreator()"><span class="btn-icon">+</span> '+e("sowTab.btn.createSow")+"</button></div>";if(u.length===0)S+='<div class="empty-state"><img src="/images/scarlo-logo.png" alt="Scarlo" class="empty-icon"><h4>'+e("sowTab.empty.title")+"</h4><p>"+e("sowTab.empty.text")+'</p><button class="btn-create-sow" onclick="window.contractFormHandler.showSOWCreator()" style="margin-top: 20px;"><span class="btn-icon">+</span> '+e("sowTab.btn.createSow")+"</button></div>";else{var _=0,D=0,T={};u.forEach(function(A){A.payment&&A.payment.total&&(_+=A.payment.total);var B=p.calculatePaymentStatus(A);D+=B.paidAmount;var $=A.packageType||"unknown";T[$]=(T[$]||0)+1});var L=u.length>0?_/u.length:0;S+='<div class="sow-revenue-bar"><div class="sow-revenue-stat"><span class="revenue-val">'+p.formatCurrency(_)+'</span><span class="revenue-label">'+e("sowTab.stats.totalRevenue")+'</span></div><div class="sow-revenue-stat"><span class="revenue-val">'+p.formatCurrency(L)+'</span><span class="revenue-label">'+e("sowTab.stats.avgProject")+'</span></div><div class="sow-revenue-stat"><span class="revenue-val">'+p.formatCurrency(D)+'</span><span class="revenue-label">'+e("sowTab.stats.collected")+"</span></div></div>";var F={essential:"#6366f1",starter:"#8b5cf6",growth:"#10b981",professional:"#f59e0b",enterprise:"#ef4444",custom:"#ec4899"};S+='<div class="package-distribution"><div class="package-bar">';var U=Object.keys(T);U.forEach(function(A){var B=(T[A]/u.length*100).toFixed(1);S+='<div class="package-segment" style="width: '+B+"%; background: "+(F[A]||"#6b7280")+';" title="'+A+": "+T[A]+'"></div>'}),S+='</div><div class="package-legend">',U.forEach(function(A){S+='<span class="legend-item"><span class="legend-dot" style="background: '+(F[A]||"#6b7280")+';"></span>'+A.charAt(0).toUpperCase()+A.slice(1)+" ("+T[A]+")</span>"}),S+="</div></div>",S+='<div class="sow-list">',u.forEach(function(A){var B=A.createdAt?A.createdAt.toDate?A.createdAt.toDate().toLocaleDateString():new Date(A.createdAt).toLocaleDateString():"N/A",$={essential:e("sowTab.pkg.essential"),starter:e("sowTab.pkg.tier1"),growth:e("sowTab.pkg.tier2"),professional:e("sowTab.pkg.tier3"),enterprise:e("sowTab.pkg.tier4"),custom:e("sowTab.pkg.custom")},K={draft:{bg:"#374151",color:"#9ca3af",icon:""},sent:{bg:"#1e40af",color:"#60a5fa",icon:""},approved:{bg:"#065f46",color:"#34d399",icon:""}},Y=A.status||"draft",Q=K[Y]||K.draft,te=Y.toUpperCase();Y==="pending_developer"||Y==="sent"?A.clientSignature&&!A.devSignature?te=" "+e("sowTab.status.awaitingDev"):A.clientSignature||(te=" "+e("sowTab.status.awaitingClient")):Y==="approved"&&A.clientSignature&&A.devSignature&&(te=" "+e("sowTab.status.fullySigned"));var ce="sowData_"+A.id.replace(/[^a-zA-Z0-9]/g,"_");window[ce]=A;var pe="";if(A.hasChangeRequest&&A.changeRequestStatus){var ge={pending:{bg:"rgba(251, 191, 36, 0.2)",color:"#fbbf24",text:" "+e("sowTab.cr.requested")},approved:{bg:"rgba(16, 185, 129, 0.2)",color:"#10b981",text:" "+e("sowTab.cr.approved")},rejected:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444",text:" "+e("sowTab.cr.rejected")},change_order:{bg:"rgba(99, 102, 241, 0.2)",color:"#6366f1",text:" "+e("sowTab.cr.order")}},Se=ge[A.changeRequestStatus]||ge.pending,Ee="";A.changeRequestData&&A.changeRequestData.hasUnreadMessages&&(Ee='<span class="unread-badge">'+e("sowTab.badge.new")+"</span>"),pe='<div style="font-size: 0.75rem; color: '+Se.color+"; background: "+Se.bg+`; padding: 4px 8px; border-radius: 4px; white-space: nowrap; cursor: pointer; display: flex; align-items: center;" onclick="window.contractFormHandler.viewChangeRequest('`+A.changeRequestId+`')">`+Se.text+Ee+"</div>"}S+='<div class="sow-item" data-sow-id="'+A.id+'"><div class="sow-item-header"><div class="sow-client-info"><h4>'+(A.clientName||"Unknown Client")+'</h4><p class="sow-package">'+($[A.packageType]||A.packageType)+'</p><p style="margin: 0.25rem 0 0; font-size: 0.7rem; color: #6b7280; opacity: 0.8;">Last sign in: '+(A.clientLastLogin?A.clientLastLogin.toDate?A.clientLastLogin.toDate().toLocaleString([],{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):new Date(A.clientLastLogin).toLocaleString([],{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):"Never")+'</p></div><div style="display: flex; flex-direction: column; align-items: flex-end; gap: 8px;"><span class="sow-status" style="background: '+Q.bg+"; color: "+Q.color+';">'+Q.icon+" "+te+"</span>"+(A.linkedContract?'<div style="font-size: 0.75rem; color: #10b981; background: rgba(16, 185, 129, 0.15); padding: 4px 8px; border-radius: 4px; white-space: nowrap;"> '+e("sowTab.badge.linkedContract")+"</div>":"")+pe+'<div class="sow-signatures"><span class="sig-icon '+(A.devSignature?"signed":"pending")+'">'+(A.devSignature?"&#10003;":"&#9202;")+" "+e("sowTab.sig.dev")+'</span><span class="sig-icon '+(A.clientSignature?"signed":"pending")+'">'+(A.clientSignature?"&#10003;":"&#9202;")+" "+e("sowTab.sig.client")+'</span></div></div></div><div class="sow-item-details"><div class="sow-detail-grid"><div class="sow-detail-row"><span class="detail-label">'+(A.clientEmail?" "+e("sowTab.detail.email"):" "+e("sowTab.detail.phone"))+'</span><span class="detail-value">'+(A.clientEmail||(A.clientPhone?C(A.clientPhone):"N/A"))+'</span></div><div class="sow-detail-row"><span class="detail-label"> '+e("sowTab.detail.total")+'</span><span class="detail-value">'+p.formatCurrency(A.payment&&A.payment.total?A.payment.total:0)+'</span></div><div class="sow-detail-row"><span class="detail-label"> '+e("sowTab.detail.timeline")+'</span><span class="detail-value">'+(A.estimatedWeeks||"TBD")+" "+(A.devDurationUnit||e("sowTab.detail.weeks"))+'</span></div><div class="sow-detail-row"><span class="detail-label"> '+e("sowTab.detail.created")+'</span><span class="detail-value">'+B+"</span></div></div></div>"+(A.hasChangeRequest&&A.changeRequestStatus==="pending"?'<div class="change-request-card" style="background: rgba(251, 191, 36, 0.1); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 8px; padding: 0.75rem; margin-bottom: 0.75rem;"><div><p style="margin: 0; font-weight: 600; color: #fbbf24; font-size: 0.9rem; display: flex; align-items: center;"> '+e("sowTab.cr.clientRequested")+(A.changeRequestData&&A.changeRequestData.hasUnreadMessages?'<span class="unread-badge">'+e("sowTab.badge.new")+"</span>":"")+'</p><p style="margin: 0.25rem 0 0; font-size: 0.8rem; opacity: 0.8;">'+e("sowTab.cr.reviewText")+"</p></div></div>":"")+'<div class="sow-item-actions">'+(!A.clientSignature||!A.devSignature?`<button class="sow-action-icon" onclick="window.contractFormHandler.showSOWSigningModal('`+A.id+`')" title="`+e("sowTab.btn.signSow")+'"></button>':"")+(A.hasChangeRequest&&A.changeRequestId?`<button class="sow-action-icon has-badge" onclick="window.contractFormHandler.viewChangeRequest('`+A.changeRequestId+`')" title="`+e("sowTab.btn.viewChangeRequest")+'">'+(A.changeRequestData&&A.changeRequestData.hasUnreadMessages?'<span class="action-badge"></span>':"")+"</button>":"")+`<button class="sow-action-icon" onclick="window.contractFormHandler.showPaymentManager('`+A.id+`')" title="`+e("sowTab.btn.managePayments")+'"></button><button class="sow-action-icon" onclick="window.contractFormHandler.editSOW(window.'+ce+')" title="'+e("sowTab.btn.editSow")+'"></button><button class="sow-action-icon" onclick="window.contractFormHandler.generateSOWPDF(window.'+ce+')" title="'+e("sowTab.btn.downloadPdf")+`"></button><button class="sow-action-icon delete" onclick="window.contractFormHandler.deleteSOW('`+A.id+`')" title="`+e("sowTab.btn.deleteSow")+'"></button></div></div>'}),S+="</div>"}S+='<div id="sowCreatorContainer" style="display: none;"></div>',g.innerHTML=S,console.log(" SOW tab rendered with",u.length,"items"),fe()}},N.prototype.viewSOWDetails=function(u){alert("SOW Details for: "+u.clientName+`

Package: `+u.packageType+`
Total: $`+(u.payment?u.payment.total.toFixed(0):"0")+`
Timeline: `+(u.estimatedWeeks||"TBD")+` weeks
Features: `+(u.features?u.features.length:0)+" selected")},N.prototype.generateSOWPDFFromData=function(u){var p=a("#sowClientName"),g=a("#sowClientEmail"),b=a("#sowPackage"),S=a("#sowWeeks"),_=a("#sowNotes"),D=a("#sowMaintenance");p&&(p.value=u.clientName||""),g&&(g.value=u.clientEmail||""),b&&(b.value=u.packageType||""),S&&(S.value=u.estimatedWeeks||""),_&&(_.value=u.notes||""),D&&(D.value=u.maintenancePlan||"none"),this.generateSOWPDF()},N.prototype.deleteSOW=function(u){if(confirm(e("sow.confirm.delete"))){var p=this;firebase.firestore().collection("sow_documents").doc(u).delete().then(function(){console.log("SOW deleted successfully"),alert(e("sow.msg.deleteSuccess")),p.loadSOWDocuments()}).catch(function(g){console.error("Error deleting SOW:",g),alert(e("sow.err.delete")+g.message)})}},N.prototype.showPaymentManager=function(u){var p=this;firebase.firestore().collection("sow_documents").doc(u).get().then(function(g){if(!g.exists){alert(e("sow.err.notFound"));return}var b=g.data();b.id=g.id,p.renderPaymentManagerModal(b)}).catch(function(g){console.error("Error loading SOW:",g),alert(e("sow.err.load")+g.message)})},N.prototype.renderPaymentManagerModal=function(u){var p=this,g=document.getElementById("paymentManagerModal");g&&g.remove();var b=p.calculatePaymentStatus(u),S="";b.payments.forEach(function(F,U){var A=F.paid?"paid":"pending",B=F.paid?"checked":"";S+='<div class="admin-payment-row '+A+'" data-index="'+U+'"><div class="payment-row-checkbox"><input type="checkbox" id="payment_'+U+'" '+B+' class="payment-checkbox" data-index="'+U+'"><label for="payment_'+U+'"></label></div><div class="payment-row-info"><span class="payment-row-name">'+F.name+'</span><span class="payment-row-amount">$'+F.amount.toFixed(2)+'</span></div><div class="payment-row-meta">',F.dueDate&&(S+='<span class="payment-row-due">'+e("payMgr.label.due")+F.dueDate+"</span>"),S+='<span class="payment-row-status '+A+'">'+(F.paid?" "+e("payMgr.status.paid")+(F.paidDate?e("payMgr.status.paidOn")+F.paidDate:""):" "+e("payMgr.status.pending"))+"</span></div></div>"});var _=b.totalCount>0?Math.round(b.paidCount/b.totalCount*100):0,D='<div id="paymentManagerModal" class="payment-manager-modal"><div class="payment-manager-overlay" onclick="window.contractFormHandler.closePaymentManager()"></div><div class="payment-manager-content"><div class="payment-manager-header"><h2> '+e("payMgr.title")+'</h2><button class="payment-manager-close" onclick="window.contractFormHandler.closePaymentManager()">&times;</button></div><div class="payment-manager-client"><h3>'+(u.clientName||e("payMgr.fallback.client"))+"</h3><p>"+(u.packageType||"N/A")+"  "+e("payMgr.label.total")+" $"+(u.payment?u.payment.total.toFixed(2):"0")+'</p></div><div class="payment-manager-summary"><div class="summary-progress"><div class="summary-progress-bar"><div class="summary-progress-fill" style="width: '+_+'%;"></div></div><span class="summary-progress-text">'+b.paidCount+e("payMgr.summary.of")+b.totalCount+e("payMgr.summary.completed")+'</span></div><div class="summary-amounts"><div class="summary-amount paid"><span class="amount-label">'+e("payMgr.summary.paid")+'</span><span class="amount-value">$'+b.paidAmount.toFixed(2)+'</span></div><div class="summary-amount owed"><span class="amount-label">'+e("payMgr.summary.owed")+'</span><span class="amount-value">$'+b.owedAmount.toFixed(2)+'</span></div></div></div><div class="payment-manager-list"><h4>'+e("payMgr.section.schedule")+'</h4><p class="payment-manager-hint">'+e("payMgr.helper.checkBox")+'</p><div class="payment-grid">'+S+'</div></div><div class="payment-manager-actions"><button class="btn btn-secondary" onclick="window.contractFormHandler.closePaymentManager()">'+e("payMgr.btn.cancel")+`</button><button class="btn btn-primary" onclick="window.contractFormHandler.savePaymentStatus('`+u.id+`')">`+e("payMgr.btn.save")+"</button></div></div></div>";document.body.insertAdjacentHTML("beforeend",D),p.currentPaymentSOW=u;var T=document.querySelectorAll(".admin-payment-row");T.forEach(function(F){F.style.cursor="pointer",F.addEventListener("click",function(U){if(U.target.type!=="checkbox"){var A=F.querySelector(".payment-checkbox");A&&(A.checked=!A.checked,A.dispatchEvent(new Event("change",{bubbles:!0})))}})});var L=document.querySelectorAll(".payment-checkbox");L.forEach(function(F){F.addEventListener("change",function(){var U=F.closest(".admin-payment-row");parseInt(F.dataset.index),F.checked?(U.classList.add("paid"),U.classList.remove("pending")):(U.classList.remove("paid"),U.classList.add("pending"));var A=0,B=0,$=0,K=b.payments.length;b.payments.forEach(function(Se,Ee){var re=document.querySelector('.payment-checkbox[data-index="'+Ee+'"]');$+=Se.amount,re&&re.checked&&(A+=Se.amount,B++)});var Y=$-A,Q=K>0?Math.round(B/K*100):0,te=document.querySelector(".summary-amount.paid .amount-value"),ce=document.querySelector(".summary-amount.owed .amount-value"),pe=document.querySelector(".summary-progress-fill"),ge=document.querySelector(".summary-progress-text");te&&(te.textContent="$"+A.toFixed(2)),ce&&(ce.textContent="$"+Y.toFixed(2)),pe&&(pe.style.width=Q+"%"),ge&&(ge.textContent=B+e("dash.payment.of")+K+e("dash.payment.completed"))})})},N.prototype.closePaymentManager=function(){var u=document.getElementById("paymentManagerModal");u&&u.remove(),this.currentPaymentSOW=null},N.prototype.savePaymentStatus=function(u){var p=this,g=p.currentPaymentSOW;if(!g||!g.payment){alert(e("sow.err.dataNotFound"));return}var b=g.payment,S=b.tracking||{},_=b.deferred&&b.deferred.enabled,D=document.querySelectorAll("#paymentManagerModal .payment-checkbox"),T=new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});if(_&&b.deferred.customSchedule&&b.deferred.customSchedule.length>0){var L=S.deferredPayments||[];D.forEach(function(U,A){var B=U.checked,$=L[A]||{};L[A]={paid:B,paidDate:B?$.paidDate||T:null}}),S.deferredPayments=L}else{var F=["deposit","milestone1","final"];D.forEach(function(U,A){var B=F[A];if(B){var $=U.checked,K=S[B+"PaidDate"];S[B+"Paid"]=$,S[B+"PaidDate"]=$?K||T:null}})}firebase.firestore().collection("sow_documents").doc(u).update({"payment.tracking":S,updatedAt:firebase.firestore.FieldValue.serverTimestamp()}).then(function(){console.log("Payment status updated successfully"),alert(e("dash.payment.msg.saveSuccess")),p.closePaymentManager(),p.loadSOWDocuments()}).catch(function(U){console.error("Error saving payment status:",U),alert(e("dash.payment.err.save")+U.message)})},N.prototype.showChangeRequestModal=function(u){this.currentChangeRequestSOW=u;var p=[{id:"package",label:e("changeModal.section.packageTier"),desc:e("changeModal.section.packageTierDesc")},{id:"features",label:e("changeModal.section.features"),desc:e("changeModal.section.featuresDesc")},{id:"timeline",label:e("changeModal.section.timeline"),desc:e("changeModal.section.timelineDesc")},{id:"payment",label:e("changeModal.section.payment"),desc:e("changeModal.section.paymentDesc")},{id:"maintenance",label:e("changeModal.section.maintenance"),desc:e("changeModal.section.maintenanceDesc")},{id:"other",label:e("changeModal.section.other"),desc:e("changeModal.section.otherDesc")}],g=p.map(function(_){return'<label class="change-section-option"><input type="checkbox" name="changeSections" value="'+_.id+'" /><div class="section-option-content"><span class="section-option-label">'+_.label+'</span><span class="section-option-desc">'+_.desc+"</span></div></label>"}).join(""),b='<div id="changeRequestModal" class="modal-overlay" style="display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); z-index: 10000; justify-content: center; align-items: center; padding: 1rem;"><div class="modal-content change-request-modal-content" style="max-width: 720px; width: 100%; padding: 0; background: linear-gradient(165deg, rgba(30, 30, 30, 0.95) 0%, rgba(18, 18, 18, 0.98) 100%); border: 1px solid rgba(228, 216, 196, 0.15); border-radius: 20px; box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6), 0 0 40px rgba(228, 216, 196, 0.03), inset 0 1px 0 rgba(255, 255, 255, 0.05); overflow: hidden;"><div class="modal-header" style="position: relative; padding: 1rem 1.5rem; border-bottom: 1px solid rgba(228, 216, 196, 0.1); background: linear-gradient(180deg, rgba(228, 216, 196, 0.03) 0%, transparent 100%);"><h2 style="margin: 0; font-size: 1.25rem; color: #fff; font-weight: 600; letter-spacing: -0.02em;">'+e("changeModal.title")+'</h2><button type="button" class="modal-close" onclick="window.contractFormHandler.closeChangeRequestModal()" style="position: absolute; top: 0.75rem; right: 1rem; background: rgba(255, 255, 255, 0.06); border: 1px solid rgba(255, 255, 255, 0.08); width: 32px; height: 32px; border-radius: 50%; color: rgba(255,255,255,0.7); font-size: 1.25rem; cursor: pointer; display: flex; align-items: center; justify-content: center; line-height: 1; transition: all 0.2s ease;"></button></div><div class="modal-body" style="color: #fff; padding: 1.25rem 1.5rem; max-height: 65vh; overflow-y: auto;"><div class="change-request-info" style="background: linear-gradient(135deg, rgba(228, 216, 196, 0.08) 0%, rgba(228, 216, 196, 0.03) 100%); border: 1px solid rgba(228, 216, 196, 0.15); border-radius: 10px; padding: 0.75rem 1rem; margin-bottom: 1rem; display: flex; gap: 2rem; align-items: center;"><p style="margin: 0; font-size: 0.85rem; color: rgba(255,255,255,0.9);"><span style="color: rgba(228, 216, 196, 0.7); font-weight: 500;">'+e("changeModal.label.sow")+'</span> <strong style="color: #E4D8C4; margin-left: 0.5rem;">'+(u.packageType||"N/A")+' Package</strong></p><p style="margin: 0; font-size: 0.85rem; color: rgba(255,255,255,0.9);"><span style="color: rgba(228, 216, 196, 0.7); font-weight: 500;">'+e("changeModal.label.currentTotal")+'</span> <strong style="color: #E4D8C4; margin-left: 0.5rem;">$'+(u.payment?u.payment.total.toFixed(0):"0")+'</strong></p></div><div class="form-group" style="margin: 0;"><label class="form-label" style="display: block; margin-bottom: 0.6rem; font-weight: 500; font-size: 0.9rem; color: rgba(255,255,255,0.9);">'+e("changeModal.label.whichSections")+'</label><div class="change-sections-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem;">'+g+'</div></div><div class="form-group" style="margin: 1rem 0 0;"><label class="form-label" style="display: block; margin-bottom: 0.4rem; font-weight: 500; font-size: 0.9rem; color: rgba(255,255,255,0.9);">'+e("changeModal.label.describeChanges")+'</label><textarea id="changeRequestDescription" class="form-input" rows="3" placeholder="'+e("changeModal.placeholder.describe")+'" style="width: 100%; resize: vertical; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; padding: 0.75rem; color: #fff; font-size: 0.9rem; transition: all 0.2s ease; outline: none;"></textarea></div><div class="form-group" style="margin: 0.75rem 0 0;"><label class="form-label" style="display: block; margin-bottom: 0.4rem; font-weight: 500; font-size: 0.9rem; color: rgba(255,255,255,0.9);">'+e("changeModal.label.priority")+'</label><select id="changeRequestPriority" class="form-input" style="width: 100%; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; padding: 0.75rem; color: #fff; font-size: 0.9rem; cursor: pointer; transition: all 0.2s ease; outline: none;"><option value="normal" style="background: #1a1a1a; color: #fff;">'+e("changeModal.priority.normal")+'</option><option value="high" style="background: #1a1a1a; color: #fff;">'+e("changeModal.priority.high")+'</option><option value="urgent" style="background: #1a1a1a; color: #fff;">'+e("changeModal.priority.urgent")+'</option></select></div></div><div class="modal-footer" style="display: flex; gap: 0.75rem; justify-content: flex-end; padding: 1rem 1.5rem; background: rgba(0,0,0,0.2); border-top: 1px solid rgba(255,255,255,0.05);"><button type="button" class="btn btn-secondary" onclick="window.contractFormHandler.closeChangeRequestModal()" style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); padding: 0.6rem 1.25rem; border-radius: 10px; cursor: pointer; font-weight: 500; font-size: 0.85rem; transition: all 0.2s ease;">'+e("changeModal.btn.cancel")+'</button><button type="button" class="btn btn-primary" onclick="window.contractFormHandler.submitChangeRequest()" style="background: linear-gradient(135deg, rgba(228, 216, 196, 0.9) 0%, rgba(228, 216, 196, 0.7) 100%); border: none; color: #121212; padding: 0.6rem 1.25rem; border-radius: 10px; cursor: pointer; font-weight: 600; font-size: 0.85rem; transition: all 0.2s ease;">'+e("changeModal.btn.submit")+"</button></div></div></div>";if(!document.getElementById("changeRequestStyles")){var S=document.createElement("style");S.id="changeRequestStyles",S.textContent='#changeRequestModal .modal-content { height: auto; max-height: 90vh; }#changeRequestModal .modal-footer { margin-top: 0; }.change-section-option { display: flex; align-items: flex-start; gap: 0.6rem; padding: 0.6rem 0.75rem; background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.06); border-radius: 10px; cursor: pointer; transition: all 0.25s ease; position: relative; overflow: hidden; }.change-section-option::before { content: ""; position: absolute; inset: 0; background: linear-gradient(135deg, rgba(228, 216, 196, 0.06) 0%, transparent 100%); opacity: 0; transition: opacity 0.25s ease; border-radius: 12px; pointer-events: none; }.change-section-option:hover { background: rgba(228, 216, 196, 0.05); border-color: rgba(228, 216, 196, 0.2); }.change-section-option:hover::before { opacity: 1; }.change-section-option input[type="checkbox"] { margin-top: 2px; accent-color: #E4D8C4; width: 16px; height: 16px; flex-shrink: 0; }.change-section-option input[type="checkbox"]:checked + .section-option-content .section-option-label { color: #E4D8C4; }.change-section-option:has(input:checked) { border-color: rgba(228, 216, 196, 0.3); background: rgba(228, 216, 196, 0.06); }.section-option-content { display: flex; flex-direction: column; gap: 2px; }.section-option-label { font-weight: 600; font-size: 0.85rem; color: rgba(255,255,255,0.95); transition: color 0.2s ease; }.section-option-desc { font-size: 0.75rem; color: rgba(255,255,255,0.4); line-height: 1.3; }.change-request-modal-content .modal-body::-webkit-scrollbar { width: 4px; }.change-request-modal-content .modal-body::-webkit-scrollbar-track { background: transparent; }.change-request-modal-content .modal-body::-webkit-scrollbar-thumb { background: rgba(228, 216, 196, 0.15); border-radius: 4px; }.change-request-modal-content .modal-body::-webkit-scrollbar-thumb:hover { background: rgba(228, 216, 196, 0.3); }.change-request-modal-content textarea:focus, .change-request-modal-content select:focus { border-color: rgba(228, 216, 196, 0.3); box-shadow: 0 0 0 3px rgba(228, 216, 196, 0.05); }.change-request-modal-content .btn-secondary:hover { background: rgba(255,255,255,0.1) !important; border-color: rgba(255,255,255,0.2) !important; }.change-request-modal-content .btn-primary:hover { opacity: 0.9; transform: translateY(-1px); box-shadow: 0 4px 16px rgba(228, 216, 196, 0.2); }@media (max-width: 600px) { .change-sections-grid { grid-template-columns: 1fr !important; } .change-request-info { flex-direction: column; gap: 0.5rem !important; } }.change-request-badge { display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }.change-request-badge.pending { background: rgba(251, 191, 36, 0.2); color: #fbbf24; }.change-request-badge.approved { background: rgba(16, 185, 129, 0.2); color: #10b981; }.change-request-badge.rejected { background: rgba(239, 68, 68, 0.2); color: #ef4444; }.change-request-badge.change-order { background: rgba(99, 102, 241, 0.2); color: #6366f1; }.change-request-badge.completed { background: rgba(16, 185, 129, 0.2); color: #10b981; }.change-request-card { background: rgba(251, 191, 36, 0.1); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 12px; padding: 1rem; margin-top: 1rem; }.change-request-card.approved { background: rgba(16, 185, 129, 0.1); border-color: rgba(16, 185, 129, 0.3); }.change-request-card.rejected { background: rgba(239, 68, 68, 0.1); border-color: rgba(239, 68, 68, 0.3); }.btn-change-request { cursor: pointer !important; pointer-events: auto !important; }.btn-change-request:hover { background: linear-gradient(135deg, rgba(228, 216, 196, 0.3) 0%, rgba(228, 216, 196, 0.15) 100%) !important; border-color: rgba(228, 216, 196, 0.5) !important; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(228, 216, 196, 0.15); }',document.head.appendChild(S)}document.body.insertAdjacentHTML("beforeend",b)},N.prototype.closeChangeRequestModal=function(){var u=document.getElementById("changeRequestModal");u&&u.remove(),this.currentChangeRequestSOW=null},N.prototype.showPricingComparisonModal=function(){var u=document.getElementById("pricingComparisonModal");u&&u.remove();var p=document.createElement("div");p.id="pricingComparisonModal",p.className="pricing-comparison-modal-overlay",p.innerHTML='<div class="pricing-comparison-modal"><div class="pricing-comparison-modal-header"><h3>2025 Web Development Pricing Guide</h3><button class="pricing-comparison-modal-close" id="closePricingModal">&times;</button></div><div class="pricing-comparison-modal-body"><iframe src="/pricing/index.html" title="Industry Pricing Comparison"></iframe></div></div>',document.body.appendChild(p),requestAnimationFrame(function(){p.classList.add("active")});var g=document.getElementById("closePricingModal");g&&g.addEventListener("click",function(){p.classList.remove("active"),setTimeout(function(){p.remove()},300)}),p.addEventListener("click",function(S){S.target===p&&(p.classList.remove("active"),setTimeout(function(){p.remove()},300))});var b=function(S){S.key==="Escape"&&(p.classList.remove("active"),setTimeout(function(){p.remove()},300),document.removeEventListener("keydown",b))};document.addEventListener("keydown",b)},N.prototype.submitChangeRequest=function(){var u=this,p=this.currentChangeRequestSOW;if(!p){alert(e("sow.err.dataNotFound"));return}var g=[];if(document.querySelectorAll('input[name="changeSections"]:checked').forEach(function(T){g.push(T.value)}),g.length===0){alert(e("change.val.selectSection"));return}var b=document.getElementById("changeRequestDescription").value.trim();if(!b){alert(e("change.val.describeChanges"));return}var S=document.getElementById("changeRequestPriority").value,_={sowId:p.id,sowData:{clientName:p.clientName,clientEmail:p.clientEmail,clientPhone:p.clientPhone,packageType:p.packageType,payment:p.payment,estimatedWeeks:p.estimatedWeeks},sections:g,description:b,priority:S,status:"pending",clientEmail:p.clientEmail,clientPhone:p.clientPhone||"",clientName:p.clientName,createdAt:firebase.firestore.FieldValue.serverTimestamp(),updatedAt:firebase.firestore.FieldValue.serverTimestamp()},D=null;firebase.firestore().collection("change_requests").add(_).then(function(T){return console.log("Change request submitted:",T.id),D=T.id,firebase.firestore().collection("sow_documents").doc(p.id).update({hasChangeRequest:!0,changeRequestId:T.id,changeRequestStatus:"pending"})}).then(function(){var T=document.getElementById("changeRequestBtn-"+p.id);T&&(T.className="sow-action-btn",T.style.background="linear-gradient(135deg, #f59e0b, #d97706)",T.style.color="white",T.style.border="none",T.innerHTML=e("change.btn.viewRequest"),T.onclick=function(){window.contractFormHandler.viewChangeRequest(D)});var L="sowData_"+p.id.replace(/[^a-zA-Z0-9]/g,"_");window[L]&&(window[L].hasChangeRequest=!0,window[L].changeRequestId=D,window[L].changeRequestStatus="pending"),u.closeChangeRequestModal(),alert(e("change.msg.submitSuccess"))}).catch(function(T){console.error("Error submitting change request:",T),alert(e("change.err.submit")+T.message)})},N.prototype.viewChangeRequest=function(u){var p=this;firebase.firestore().collection("change_requests").doc(u).get().then(function(g){if(!g.exists){alert(e("change.err.notFound"));return}var b=g.data();return b.id=g.id,firebase.firestore().collection("sow_documents").doc(b.sowId).get().then(function(S){S.exists&&(b.sowData=S.data(),b.sowData.id=S.id),p.showChangeRequestDetailModal(b)})}).catch(function(g){console.error("Error loading change request:",g),alert(e("change.err.load")+g.message)})},N.prototype.showChangeRequestDetailModal=function(u){var p=this;this.currentChangeRequest=u;var g={package:e("changeOrder.section.package"),features:e("changeOrder.section.features"),timeline:e("changeOrder.section.timeline"),payment:e("changeOrder.section.payment"),maintenance:e("changeOrder.section.maintenance"),other:e("changeOrder.section.other")},b={normal:{bg:"rgba(107, 114, 128, 0.2)",color:"#9ca3af",label:e("changeOrder.priority.normal")},high:{bg:"rgba(251, 191, 36, 0.2)",color:"#fbbf24",label:e("changeOrder.priority.high")},urgent:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444",label:e("changeOrder.priority.urgent")}},S={pending:{bg:"rgba(251, 191, 36, 0.2)",color:"#fbbf24",label:e("changeOrder.status.pending")},approved:{bg:"rgba(16, 185, 129, 0.2)",color:"#10b981",label:e("changeOrder.status.approved")},rejected:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444",label:e("changeOrder.status.rejected")},change_order:{bg:"rgba(99, 102, 241, 0.2)",color:"#6366f1",label:e("changeOrder.status.change_order")},completed:{bg:"rgba(16, 185, 129, 0.2)",color:"#10b981",label:e("changeOrder.status.completed")}},_=u.sections.map(function(K){return'<span style="background: rgba(99, 102, 241, 0.15); color: #a5b4fc; padding: 4px 10px; border-radius: 4px; font-size: 0.85rem;">'+(g[K]||K)+"</span>"}).join(" "),D=b[u.priority]||b.normal,T=S[u.status]||S.pending,L=u.createdAt?new Date(u.createdAt.toDate()).toLocaleString():"N/A",F=p.renderConversationThread(u.messages||[]),U="";p.isDeveloper&&u.status==="pending"?U=`<div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;"><button class="btn btn-primary" style="padding: 0.5rem 1rem; font-size: 0.85rem;" onclick="window.contractFormHandler.approveChangeRequest('`+u.id+`')"> Approve</button><button class="btn" style="padding: 0.5rem 1rem; font-size: 0.85rem; background: rgba(239, 68, 68, 0.2); color: #ef4444;" onclick="window.contractFormHandler.rejectChangeRequest('`+u.id+`')"> Reject</button><button class="btn" style="padding: 0.5rem 1rem; font-size: 0.85rem; background: rgba(99, 102, 241, 0.2); color: #6366f1;" onclick="window.contractFormHandler.createChangeOrderFromRequest('`+u.id+`')"> Change Order</button></div>`:p.isDeveloper&&(u.status==="approved"||u.status==="change_order")&&(U=`<div style="display: flex; gap: 0.5rem; justify-content: center;"><button class="btn btn-primary" style="padding: 0.5rem 1rem; font-size: 0.85rem;" onclick="window.contractFormHandler.editSOWFromChangeRequest('`+u.sowId+`')"> Edit SOW</button></div>`);var A=`<div id="changeRequestDetailModal" class="modal-overlay-fixed"><div class="modal-content" style="max-width: 700px;"><div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1);"><h2 style="margin: 0; font-size: 1.25rem; display: flex; align-items: center; gap: 0.5rem;"><img src="/images/morph-logo14.png" alt="Logo" style="height: 2rem; width: auto;"> Change Request Details</h2><button style="background: rgba(255,255,255,0.1); border: none; color: #fff; width: 36px; height: 36px; border-radius: 50%; font-size: 1.5rem; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.2)'" onmouseout="this.style.background='rgba(255,255,255,0.1)'" onclick="window.contractFormHandler.closeChangeRequestDetailModal()">&times;</button></div><div class="modal-body" style="max-height: 70vh; overflow-y: auto; padding: .8rem;"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;"><div><h3 style="margin: 0;">`+u.clientName+'</h3><p style="margin: 0.25rem 0 0; opacity: 0.7; font-size: 0.9rem;">'+u.clientEmail+'</p></div><span style="background: '+T.bg+"; color: "+T.color+'; padding: 6px 12px; border-radius: 20px; font-weight: 600; font-size: 0.85rem;">'+T.label+'</span></div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;"><div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px;"><p style="margin: 0; font-size: 0.8rem; opacity: 0.7;">PACKAGE</p><p style="margin: 0.25rem 0 0; font-weight: 600;">'+(u.sowData.packageType||"N/A")+'</p></div><div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px;"><p style="margin: 0; font-size: 0.8rem; opacity: 0.7;">CURRENT TOTAL</p><p style="margin: 0.25rem 0 0; font-weight: 600;">$'+(u.sowData.payment?u.sowData.payment.total.toFixed(0):"0")+'</p></div></div><div style="margin-bottom: 1.5rem;"><p style="margin: 0 0 0.5rem; font-weight: 600;">Sections to Modify:</p><div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">'+_+'</div></div><div style="margin-bottom: 1.5rem;"><p style="margin: 0 0 0.5rem; font-weight: 600;">Description:</p><div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; white-space: pre-wrap;">'+u.description+'</div></div><div style="display: flex; gap: 2rem; margin-bottom: 1.5rem;"><div><p style="margin: 0; font-size: 0.8rem; opacity: 0.7;">PRIORITY</p><span style="background: '+D.bg+"; color: "+D.color+'; padding: 4px 10px; border-radius: 4px; font-size: 0.85rem;">'+D.label+'</span></div><div><p style="margin: 0; font-size: 0.8rem; opacity: 0.7;">SUBMITTED</p><p style="margin: 0.25rem 0 0;">'+L+'</p></div></div><div class="conversation-section"><h4> Conversation</h4><div id="conversationThread" class="conversation-thread">'+F+`</div><div class="conversation-input-wrapper"><textarea id="conversationInput" class="conversation-input" placeholder="Type your message..." rows="1"></textarea><button class="conversation-send-btn" onclick="window.contractFormHandler.sendChangeRequestMessage('`+u.id+`')">Send</button></div></div></div><div class="modal-footer" style="padding: 0rem; border-top: 0px solid rgba(255, 255, 255, 0);">`+U+"</div></div></div>";document.body.insertAdjacentHTML("beforeend",A);var B=document.getElementById("conversationThread");B&&(B.scrollTop=B.scrollHeight);var $=document.getElementById("conversationInput");$&&$.addEventListener("input",function(){this.style.height="auto",this.style.overflowY="hidden",this.scrollHeight>150?(this.style.height="150px",this.style.overflowY="auto"):this.style.height=this.scrollHeight+"px"}),p.updateChangeRequestLastViewed(u.id),p.conversationUnsubscribe=firebase.firestore().collection("change_requests").doc(u.id).onSnapshot(function(K){if(K.exists){var Y=K.data(),Q=Y.messages||[],te=document.getElementById("conversationThread");te&&(te.innerHTML=p.renderConversationThread(Q),te.scrollTop=te.scrollHeight),p.currentChangeRequest.messages=Q}},function(K){console.error("Error listening to conversation:",K)})},N.prototype.closeChangeRequestDetailModal=function(){this.conversationUnsubscribe&&(this.conversationUnsubscribe(),this.conversationUnsubscribe=null),this.currentChangeRequest=null;var u=document.getElementById("changeRequestDetailModal");u&&u.remove()},N.prototype.renderConversationThread=function(u){var p=this;return!u||u.length===0?'<div class="conversation-empty">No messages yet. Start the conversation!</div>':u.map(function(g){var b="";g.timestamp&&(g.timestamp.toDate?b=new Date(g.timestamp.toDate()).toLocaleString():b=new Date(g.timestamp).toLocaleString());var S=p.isDeveloper&&g.sender==="developer"||!p.isDeveloper&&g.sender==="client",_=S?"self":"other";return'<div class="conversation-message '+_+'"><div class="message-sender">'+(g.senderName||g.sender)+'</div><div class="message-text">'+g.text+'</div><div class="message-time">'+b+"</div></div>"}).join("")},N.prototype.sendChangeRequestMessage=function(u){var p=this,g=document.getElementById("conversationInput"),b=g.value.trim();if(b){var S=p.isDeveloper?"developer":"client",_=p.isDeveloper?"Carlos (Developer)":p.currentChangeRequest.clientName||"Client",D={sender:S,senderName:_,text:b,timestamp:new Date().toISOString()},T=document.querySelector(".conversation-send-btn");T&&(T.disabled=!0,T.textContent=e("change.btn.sending")),firebase.firestore().collection("change_requests").doc(u).update({messages:firebase.firestore.FieldValue.arrayUnion(D),lastMessageAt:firebase.firestore.FieldValue.serverTimestamp(),lastMessageBy:S}).then(function(){g.value="";var L=document.getElementById("conversationThread");if(L){var F=L.querySelector(".conversation-empty");F&&F.remove();var U='<div class="conversation-message self"><div class="message-sender">'+_+'</div><div class="message-text">'+b+'</div><div class="message-time">'+e("change.time.justNow")+"</div></div>";L.insertAdjacentHTML("beforeend",U),L.scrollTop=L.scrollHeight}T&&(T.disabled=!1,T.textContent=e("change.btn.send"))}).catch(function(L){console.error("Error sending message:",L),alert(e("change.err.sendFailed")),T&&(T.disabled=!1,T.textContent=e("change.btn.send"))})}},N.prototype.updateChangeRequestLastViewed=function(u){var p=this,g=p.isDeveloper?"developerLastViewed":"clientLastViewed";firebase.firestore().collection("change_requests").doc(u).update({[g]:firebase.firestore.FieldValue.serverTimestamp()}).catch(function(b){console.error("Error updating last viewed:",b)})},N.prototype.approveChangeRequest=function(u){var p=this;if(confirm(e("change.confirm.approve"))){var g={sender:"developer",senderName:"Carlos (Developer)",text:e("change.msg.approveSystem"),timestamp:new Date().toISOString()};firebase.firestore().collection("change_requests").doc(u).update({status:"approved",updatedAt:firebase.firestore.FieldValue.serverTimestamp(),messages:firebase.firestore.FieldValue.arrayUnion(g),lastMessageAt:firebase.firestore.FieldValue.serverTimestamp(),lastMessageBy:"developer"}).then(function(){return firebase.firestore().collection("change_requests").doc(u).get()}).then(function(b){var S=b.data();return firebase.firestore().collection("sow_documents").doc(S.sowId).update({changeRequestStatus:"approved"})}).then(function(){p.closeChangeRequestDetailModal(),alert(e("change.msg.approved")),p.loadSOWDocuments()}).catch(function(b){console.error("Error approving change request:",b),alert(e("contract.err.prefix")+b.message)})}},N.prototype.rejectChangeRequest=function(u){var p=this;if(confirm(e("change.confirm.reject"))){var g={sender:"developer",senderName:"Carlos (Developer)",text:e("change.msg.rejectSystem"),timestamp:new Date().toISOString()};firebase.firestore().collection("change_requests").doc(u).update({status:"rejected",updatedAt:firebase.firestore.FieldValue.serverTimestamp(),messages:firebase.firestore.FieldValue.arrayUnion(g),lastMessageAt:firebase.firestore.FieldValue.serverTimestamp(),lastMessageBy:"developer"}).then(function(){return firebase.firestore().collection("change_requests").doc(u).get()}).then(function(b){var S=b.data();return firebase.firestore().collection("sow_documents").doc(S.sowId).update({changeRequestStatus:"rejected",hasChangeRequest:!1})}).then(function(){p.closeChangeRequestDetailModal(),alert(e("change.msg.rejected")),p.loadSOWDocuments()}).catch(function(b){console.error("Error rejecting change request:",b),alert(e("contract.err.prefix")+b.message)})}},N.prototype.createChangeOrderFromRequest=function(u){var p=this;firebase.firestore().collection("change_requests").doc(u).get().then(function(g){if(!g.exists){alert(e("change.err.notFound"));return}var b=g.data();b.id=g.id;var S=document.getElementById("changeRequestDetailModal");return S&&S.remove(),firebase.firestore().collection("change_requests").doc(u).update({status:"change_order",updatedAt:firebase.firestore.FieldValue.serverTimestamp()}).then(function(){return firebase.firestore().collection("sow_documents").doc(b.sowId).update({changeRequestStatus:"change_order",hasChangeOrder:!0})}).then(function(){return firebase.firestore().collection("sow_documents").doc(b.sowId).get()}).then(function(_){if(_.exists){var D=_.data();D.id=_.id,D.editingFromChangeRequest={id:u,description:b.description,sections:b.sections,clientName:b.clientName},p.editSOW(D)}else alert(e("sow.err.notFound"))})}).catch(function(g){console.error("Error creating change order:",g),alert(e("contract.err.prefix")+g.message)})},N.prototype.showChangeOrderModal=function(u){var p={package:e("changeOrder.section.package"),features:e("changeOrder.section.features"),timeline:e("changeOrder.section.timeline"),payment:e("changeOrder.section.payment"),maintenance:e("changeOrder.section.maintenance"),other:e("changeOrder.section.other")},g=u.sections.map(function(S){return p[S]||S}).join(", "),b='<div id="changeOrderModal" class="modal-overlay-fixed"><div class="modal-content" style="max-width: 600px;"><div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1);"><h2 style="margin: 0; font-size: 1.25rem;">'+e("changeOrder.createTitle")+`</h2><button style="background: rgba(255,255,255,0.1); border: none; color: #fff; width: 36px; height: 36px; border-radius: 50%; font-size: 1.5rem; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.2)'" onmouseout="this.style.background='rgba(255,255,255,0.1)'" onclick="document.getElementById('changeOrderModal').remove()">&times;</button></div><div class="modal-body" style="padding: 1.5rem;"><div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;"><p style="margin: 0; font-size: 0.9rem;"><strong>`+e("changeOrder.label.client")+"</strong> "+u.clientName+'</p><p style="margin: 0.5rem 0 0; font-size: 0.9rem;"><strong>'+e("changeOrder.label.sections")+"</strong> "+g+'</p><p style="margin: 0.5rem 0 0; font-size: 0.9rem;"><strong>'+e("changeOrder.label.request")+"</strong> "+u.description.substring(0,100)+(u.description.length>100?"...":"")+'</p></div><div class="form-group"><label class="form-label">'+e("changeOrder.label.description")+'</label><textarea id="changeOrderDescription" class="form-input" rows="4" placeholder="'+e("changeOrder.descPlaceholder")+'" style="width: 100%; resize: vertical;">'+u.description+`</textarea></div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;"><div class="form-group"><label class="form-label">Price Adjustment ($):</label><input type="number" id="changeOrderPrice" class="form-input" value="0" step="50" style="width: 100%;" /><p style="font-size: 0.8rem; opacity: 0.7; margin-top: 0.25rem;">Use negative for discounts</p></div><div class="form-group"><label class="form-label">Timeline Adjustment (weeks):</label><input type="number" id="changeOrderTimeline" class="form-input" value="0" step="1" style="width: 100%;" /><p style="font-size: 0.8rem; opacity: 0.7; margin-top: 0.25rem;">Use negative to reduce</p></div></div><div class="form-group" style="margin-top: 1rem;"><label class="form-label">Notes for Client:</label><textarea id="changeOrderNotes" class="form-input" rows="2" placeholder="Any additional notes..." style="width: 100%; resize: vertical;"></textarea></div></div><div class="modal-footer" style="display: flex; gap: 1rem; justify-content: flex-end; padding: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1);"><button class="btn btn-secondary" onclick="document.getElementById('changeOrderModal').remove()">`+e("changeOrder.btn.cancel")+`</button><button class="btn btn-primary" onclick="window.contractFormHandler.saveChangeOrder('`+u.id+"', '"+u.sowId+`')">`+e("changeOrder.btn.create")+"</button></div></div></div>";document.body.insertAdjacentHTML("beforeend",b)},N.prototype.saveChangeOrder=function(u,p){var g=this,b=document.getElementById("changeOrderDescription").value.trim(),S=parseFloat(document.getElementById("changeOrderPrice").value)||0,_=parseInt(document.getElementById("changeOrderTimeline").value)||0,D=document.getElementById("changeOrderNotes").value.trim();if(!b){alert(e("changeOrder.val.description"));return}firebase.firestore().collection("sow_documents").doc(p).get().then(function(T){if(!T.exists)throw new Error("SOW not found");var L=T.data(),F=L.payment?L.payment.total:0,U=L.estimatedWeeks||0,A={sowId:p,changeRequestId:u,clientName:L.clientName,clientEmail:L.clientEmail,description:b,priceAdjustment:S,timelineAdjustment:_,notes:D,previousTotal:F,newTotal:F+S,previousTimeline:U,newTimeline:U+_,status:"pending_approval",createdAt:firebase.firestore.FieldValue.serverTimestamp(),createdBy:firebase.auth().currentUser.email};return firebase.firestore().collection("change_orders").add(A)}).then(function(T){return firebase.firestore().collection("change_requests").doc(u).update({status:"change_order",changeOrderId:T.id,updatedAt:firebase.firestore.FieldValue.serverTimestamp()})}).then(function(){return firebase.firestore().collection("sow_documents").doc(p).update({changeRequestStatus:"change_order",hasChangeOrder:!0})}).then(function(){document.getElementById("changeOrderModal").remove(),alert(e("changeOrder.msg.success")),g.loadSOWDocuments()}).catch(function(T){console.error("Error creating change order:",T),alert(e("contract.err.prefix")+T.message)})},N.prototype.editSOWFromChangeRequest=function(u){var p=this,g=document.getElementById("changeRequestDetailModal");g&&g.remove(),firebase.firestore().collection("sow_documents").doc(u).get().then(function(b){if(b.exists){var S=b.data();S.id=b.id,p.editSOW(S)}}).catch(function(b){console.error("Error loading SOW:",b),alert(e("sow.err.load")+b.message)})},N.prototype.showSOWCreator=function(){var u=a("#sowCreatorContainer");if(u){var p='<div class="sow-creator-form"><div class="sow-form-header"><h4 style="display: flex; align-items: center; gap: 0.5rem;"><img src="/images/morph-logo14.png" alt="Logo" style="height: 2rem; width: auto;"> '+e("sowCreator.title")+'</h4><button class="btn-close-sow"></button></div><div class="sow-form-section client-info-section"><h5><span class="section-icon"></span> '+e("sowCreator.section.clientInfo")+'</h5><div class="sow-user-search-container"><label class="sow-search-label">'+e("sowCreator.quickSelect")+'</label><div class="sow-search-wrapper"><input type="text" id="sowUserSearch" placeholder="'+e("sowCreator.searchPlaceholder")+'" class="sow-input sow-search-input" autocomplete="off" /><div class="sow-search-icon"></div><div id="sowUserDropdown" class="sow-user-dropdown" style="display: none;"></div></div><div class="sow-search-actions"><p class="sow-search-hint">'+e("sowCreator.manualEntry")+'</p><button type="button" id="btnAddUser" class="btn-add-user">'+e("sowCreator.btn.addUser")+'</button></div><div id="addUserForm" class="add-user-form" style="display: none;"><div class="add-user-form-inner"><input type="text" id="addUserName" placeholder="'+e("sowCreator.label.displayName")+'" class="sow-input" /><div class="add-user-auth-section"><div class="add-user-auth-row"><input type="email" id="addUserEmail" placeholder="'+e("sowCreator.label.email")+'" class="sow-input" oninput="window.toggleAuthFields()" /><input type="password" id="addUserPassword" placeholder="'+e("sowCreator.label.password")+'" class="sow-input" style="display: none;" /></div><div class="add-user-auth-divider"><span>'+e("sowCreator.label.or")+'</span></div><div class="add-user-auth-row"><div class="phone-input-wrapper sow-phone-wrapper"><select id="addUserPhoneCountryCode" class="country-code-select sow-country-code"><option value="+1" selected>US +1</option><option value="+1">CA +1</option><option value="+44">UK +44</option><option value="+91">IN +91</option><option value="+61">AU +61</option><option value="+81">JP +81</option><option value="+49">DE +49</option><option value="+33">FR +33</option><option value="+86">CN +86</option><option value="+52">MX +52</option><option value="+55">BR +55</option></select><input type="tel" id="addUserPhone" placeholder="'+e("sowCreator.label.phone")+'" class="sow-input" oninput="window.toggleAuthFields()" /></div><input type="text" id="addUserCode" placeholder="'+e("sowCreator.label.verificationCode")+'" class="sow-input" style="display: none;" maxlength="6" /></div></div><div class="add-user-buttons"><button type="button" id="btnSaveUser" class="btn-save-user">'+e("sowCreator.btn.saveUser")+'</button><button type="button" id="btnCancelAddUser" class="btn-cancel-add-user">'+e("sowCreator.btn.cancel")+'</button></div></div></div></div><div class="toggles-row"><div class="client-id-toggle"><span class="toggle-label" id="emailToggleLabel">'+e("sowCreator.toggle.email")+'</span><label class="toggle-switch"><input type="checkbox" id="clientIdTypeToggle" /><span class="toggle-slider"></span></label><span class="toggle-label" id="phoneToggleLabel">'+e("sowCreator.toggle.phone")+'</span></div><div class="entity-type-toggle"><span class="toggle-label active" id="sowIndividualLabel">'+e("sowCreator.toggle.individual")+'</span><label class="toggle-switch"><input type="checkbox" id="sowEntityTypeToggle" /><span class="toggle-slider"></span></label><span class="toggle-label" id="sowBusinessLabel">'+e("sowCreator.toggle.business")+'</span></div></div><div id="sowIndividualFields"><div class="sow-input-group client-inputs-row"><input type="text" id="sowClientName" placeholder="'+e("sowCreator.label.clientName")+'" class="sow-input" required /><div id="sowClientEmailWrapper" class="sow-input-wrapper-single"><input type="email" id="sowClientEmail" placeholder="'+e("sowCreator.label.clientEmail")+'" class="sow-input" /></div><div id="sowClientPhoneWrapper" class="phone-input-wrapper sow-phone-wrapper" style="display: none;"><select id="sowClientPhoneCountryCode" class="country-code-select sow-country-code"><option value="+1" selected>US +1</option><option value="+1">CA +1</option><option value="+44">UK +44</option><option value="+91">IN +91</option><option value="+61">AU +61</option><option value="+81">JP +81</option><option value="+49">DE +49</option><option value="+33">FR +33</option><option value="+86">CN +86</option><option value="+52">MX +52</option><option value="+55">BR +55</option></select><input type="tel" id="sowClientPhone" placeholder="'+e("sowCreator.label.clientPhone")+'" class="sow-input" /></div></div></div><div id="sowBusinessFields" style="display: none;"><div class="sow-input-group"><input type="text" id="sowBusinessName" placeholder="'+e("sowCreator.label.businessName")+'" class="sow-input" /><select id="sowEntityType" class="sow-select" style="flex: 1;"><option value="">'+e("sowCreator.label.entityType")+'</option><option value="LLC">'+e("sowCreator.entity.llc")+'</option><option value="Corporation">'+e("sowCreator.entity.corp")+'</option><option value="Partnership">'+e("sowCreator.entity.partnership")+'</option><option value="Sole Proprietorship">'+e("sowCreator.entity.sole")+'</option></select></div><div class="sow-input-group"><input type="text" id="sowStateOfFormation" placeholder="'+e("sowCreator.label.stateFormation")+'" class="sow-input" /><div id="sowBusinessEmailWrapper" class="sow-input-wrapper-single"><input type="email" id="sowBusinessEmail" placeholder="'+e("sowCreator.label.businessEmail")+'" class="sow-input" /></div><div id="sowBusinessPhoneWrapper" class="phone-input-wrapper sow-phone-wrapper" style="display: none;"><select id="sowBusinessPhoneCountryCode" class="country-code-select sow-country-code"><option value="+1" selected>US +1</option><option value="+1">CA +1</option><option value="+44">UK +44</option><option value="+91">IN +91</option><option value="+61">AU +61</option><option value="+81">JP +81</option><option value="+49">DE +49</option><option value="+33">FR +33</option><option value="+86">CN +86</option><option value="+52">MX +52</option><option value="+55">BR +55</option></select><input type="tel" id="sowBusinessPhone" placeholder="'+e("sowCreator.label.businessPhone")+'" class="sow-input" /></div></div><div class="sow-input-group"><input type="text" id="sowRepName" placeholder="'+e("sowCreator.label.repName")+'" class="sow-input" /><input type="text" id="sowRepTitle" placeholder="'+e("sowCreator.label.repTitle")+'" class="sow-input" /></div></div></div><div class="sow-form-section"><h5><span class="section-icon"></span> '+e("sowCreator.section.package")+'</h5><select id="sowPackage" class="sow-select" onchange="setTimeout(syncDeferredWithTotal, 50)"><option value="">'+e("sowCreator.pkg.select")+'</option><option value="essential">'+e("sowCreator.pkg.essential")+'</option><option value="starter">'+e("sowCreator.pkg.tier1")+'</option><option value="growth">'+e("sowCreator.pkg.tier2")+'</option><option value="professional">'+e("sowCreator.pkg.tier3")+'</option><option value="enterprise">'+e("sowCreator.pkg.tier4")+'</option><option value="custom">'+e("sowCreator.pkg.custom")+'</option></select><div id="customPricingSection" style="display: none; margin-top: 15px;"><input type="number" id="sowCustomPrice" placeholder="Enter custom total price" class="sow-input" step="0.01" min="0" oninput="setTimeout(syncDeferredWithTotal, 50)" /></div></div><div class="sow-form-section"><h5><span class="section-icon"></span> '+e("sowCreator.section.timeline")+'</h5><label class="sow-checkbox retroactive-toggle" style="margin-bottom: 10px; padding: 8px 12px; background: rgba(245, 158, 11, 0.1); border-radius: 6px; border: 1px solid rgba(245, 158, 11, 0.3);"><input type="checkbox" id="sowRetroactive" onchange="toggleRetroactiveFields()" /><span style="color: #f59e0b; font-weight: 500;">'+e("sowCreator.timeline.retroactive")+'</span><span style="font-size: 0.8em; color: #888; margin-left: 8px;">'+e("sowCreator.timeline.retroactiveDesc")+'</span></label><div class="sow-input-group"><input type="number" id="sowWeeks" placeholder="'+e("sowCreator.timeline.estWeeks")+'" class="sow-input" min="1" max="52" required /><input type="date" id="sowStartDate" class="sow-input" title="'+e("sowCreator.timeline.targetDate")+'" /></div><div id="retroactiveDurationFields" style="display: none; margin-top: 10px; padding: 10px; background: rgba(245, 158, 11, 0.05); border-radius: 6px; border: 1px dashed rgba(245, 158, 11, 0.3);"><label style="font-size: 0.85em; color: #f59e0b; margin-bottom: 5px; display: block;">'+e("sowCreator.timeline.devDuration")+'</label><div class="sow-input-group"><input type="number" id="sowDevDuration" placeholder="'+e("sowCreator.timeline.duration")+'" class="sow-input" min="1" max="52" style="flex: 1;" /><select id="sowDevDurationUnit" class="sow-input" style="flex: 1;"><option value="weeks">'+e("sowCreator.timeline.weeks")+'</option><option value="months">'+e("sowCreator.timeline.months")+'</option></select></div><label style="font-size: 0.85em; color: #f59e0b; margin-bottom: 5px; margin-top: 10px; display: block;">'+e("sowCreator.timeline.estFinalRevision")+'</label><input type="date" id="sowRetroactiveEndDate" class="sow-input" title="'+e("sowCreator.timeline.estFinalRevisionDate")+'" /></div></div><div class="sow-form-section"><h5><span class="section-icon"></span> '+e("sowCreator.section.features")+'</h5><div class="sow-checkboxes"><div class="feature-group"><p class="feature-group-title">'+e("sowCreator.features.standard")+'</p><label class="sow-checkbox"><input type="checkbox" value="responsive_design" /> '+e("sowCreator.features.crossDevice")+'</label><label class="sow-checkbox"><input type="checkbox" value="custom_ui" /> '+e("sowCreator.features.brandDesign")+'</label><label class="sow-checkbox"><input type="checkbox" value="animations" /> '+e("sowCreator.features.scrollInteractions")+'</label><label class="sow-checkbox"><input type="checkbox" value="seo_optimization" /> '+e("sowCreator.features.seoSetup")+'</label><label class="sow-checkbox"><input type="checkbox" value="analytics" /> '+e("sowCreator.features.ga4")+'</label><label class="sow-checkbox"><input type="checkbox" value="contact_forms" /> '+e("sowCreator.features.contactForms")+'</label></div><div class="feature-group"><p class="feature-group-title">'+e("sowCreator.features.premium")+'</p><label class="sow-checkbox"><input type="checkbox" value="firebase_auth" /> '+e("sowCreator.features.authSystem")+' <span class="third-party-note">'+e("sowCreator.features.firebaseCosts")+'</span></label><label class="sow-checkbox"><input type="checkbox" value="firebase_db" /> '+e("sowCreator.features.database")+' <span class="third-party-note">'+e("sowCreator.features.firebaseCosts")+'</span></label><label class="sow-checkbox"><input type="checkbox" value="user_profiles" /> '+e("sowCreator.features.clientPortal")+'</label><label class="sow-checkbox"><input type="checkbox" value="file_storage" /> '+e("sowCreator.features.mediaUpload")+' <span class="third-party-note">'+e("sowCreator.features.firebaseCosts")+'</span></label><label class="sow-checkbox"><input type="checkbox" value="api_integration" /> '+e("sowCreator.features.thirdParty")+'</label><label class="sow-checkbox"><input type="checkbox" value="email_integration" /> '+e("sowCreator.features.emailNotif")+' <span class="third-party-note">'+e("sowCreator.features.sendgridCosts")+'</span></label><label class="sow-checkbox"><input type="checkbox" value="music_media" /> '+e("sowCreator.features.audioVideo")+'</label><label class="sow-checkbox"><input type="checkbox" value="booking_basic" /> '+e("sowCreator.features.scheduling")+'</label><label class="sow-checkbox"><input type="checkbox" value="newsletter" /> '+e("sowCreator.features.newsletter")+'</label><label class="sow-checkbox"><input type="checkbox" value="social_feed" /> '+e("sowCreator.features.socialMedia")+'</label></div><div class="feature-group"><p class="feature-group-title">'+e("sowCreator.features.enterprise")+'</p><label class="sow-checkbox"><input type="checkbox" value="user_roles" /> '+e("sowCreator.features.rbac")+'</label><label class="sow-checkbox"><input type="checkbox" value="cms_integration" /> '+e("sowCreator.features.cms")+'</label><label class="sow-checkbox"><input type="checkbox" value="booking_system" /> '+e("sowCreator.features.advBooking")+'</label><label class="sow-checkbox"><input type="checkbox" value="blog" /> '+e("sowCreator.features.blog")+'</label><label class="sow-checkbox"><input type="checkbox" value="gallery" /> '+e("sowCreator.features.gallery")+'</label><label class="sow-checkbox"><input type="checkbox" value="notifications" /> '+e("sowCreator.features.inAppNotif")+'</label></div><div class="feature-group"><p class="feature-group-title">'+e("sowCreator.features.ecommerce")+'</p><div class="ecommerce-radio-group"><label class="sow-radio"><input type="radio" name="ecommerce_option" value="none" checked /> '+e("sowCreator.features.noEcommerce")+'</label><label class="sow-radio"><input type="radio" name="ecommerce_option" value="basic_cart" /> '+e("sowCreator.features.basicEcommerce")+' <span class="third-party-note">'+e("sowCreator.features.stripeCosts")+'</span></label><label class="sow-radio"><input type="radio" name="ecommerce_option" value="full_store" /> '+e("sowCreator.features.fullEcommerce")+' <span class="third-party-note">'+e("sowCreator.features.stripeCosts")+'</span></label></div></div></div></div><div class="sow-form-section"><h5><span class="section-icon"></span> '+e("sowCreator.section.additionalReqs")+'</h5><textarea id="sowNotes" placeholder="'+e("sowCreator.additionalReqs.placeholder")+'" class="sow-textarea" rows="4"></textarea></div><div class="sow-form-section"><h5><span class="section-icon"></span> '+e("sowCreator.section.maintenance")+'</h5><select id="sowMaintenance" class="sow-select" required><option value="">'+e("sowCreator.maint.select")+'</option><option value="none">'+e("sowCreator.maint.none")+'</option><option value="basic" selected>'+e("sowCreator.maint.basic")+'</option><option value="professional">'+e("sowCreator.maint.professional")+'</option><option value="premium">'+e("sowCreator.maint.premium")+'</option></select></div><div class="sow-form-section" id="deferredPaymentSection"><h5><span class="section-icon"></span> '+e("sowCreator.section.deferred")+'</h5><label class="sow-checkbox deferred-toggle" style="margin-bottom: 10px; padding: 8px 12px; background: rgba(99, 102, 241, 0.1); border-radius: 6px; border: 1px solid rgba(99, 102, 241, 0.3);"><input type="checkbox" id="sowDeferredPayment" onchange="toggleDeferredPaymentFields()" /><span style="color: #6366f1; font-weight: 500;">'+e("sowCreator.deferred.enable")+'</span><span style="font-size: 0.8em; color: #888; margin-left: 8px;">'+e("sowCreator.deferred.enableDesc")+'</span></label><div id="deferredPaymentFields" style="display: none; margin-top: 10px; padding: 15px; background: rgba(99, 102, 241, 0.05); border-radius: 8px; border: 1px dashed rgba(99, 102, 241, 0.3);"><div class="deferred-split-type"><label style="font-size: 0.9em; color: #94a3b8; margin-bottom: 8px; display: block;">'+e("sowCreator.deferred.paymentType")+'</label><div class="deferred-radio-group" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;"><label class="sow-radio deferred-type-card" style="display: flex; flex-direction: column; align-items: center; gap: 6px; padding: 12px 8px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;"><input type="radio" name="deferred_split" value="lump_sum" checked onchange="toggleDeferredSplitType()" style="display: none;" /><span style="font-size: 1.5em;"></span><span style="font-weight: 500; font-size: 0.85em;">'+e("sowCreator.deferred.lumpSum")+'</span><span style="font-size: 0.7em; color: #94a3b8; text-align: center;">'+e("sowCreator.deferred.lumpSumDesc")+'</span></label><label class="sow-radio deferred-type-card" style="display: flex; flex-direction: column; align-items: center; gap: 6px; padding: 12px 8px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;"><input type="radio" name="deferred_split" value="recurring" onchange="toggleDeferredSplitType()" style="display: none;" /><span style="font-size: 1.5em;"></span><span style="font-weight: 500; font-size: 0.85em;">'+e("sowCreator.deferred.paymentPlan")+'</span><span style="font-size: 0.7em; color: #94a3b8; text-align: center;">'+e("sowCreator.deferred.paymentPlanDesc")+'</span></label><label class="sow-radio deferred-type-card" style="display: flex; flex-direction: column; align-items: center; gap: 6px; padding: 12px 8px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;"><input type="radio" name="deferred_split" value="custom" onchange="toggleDeferredSplitType()" style="display: none;" /><span style="font-size: 1.5em;"></span><span style="font-weight: 500; font-size: 0.85em;">'+e("sowCreator.deferred.custom")+'</span><span style="font-size: 0.7em; color: #94a3b8; text-align: center;">'+e("sowCreator.deferred.customDesc")+'</span></label></div></div><div id="lumpSumFields" style="margin-top: 15px;"><div class="sow-input-group" style="display: flex; gap: 10px;"><div style="flex: 1;"><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+e("sowCreator.deferred.amountToDefer")+'</label><input type="number" id="sowDeferredAmount" placeholder="'+e("sowCreator.deferred.amountLabel")+'" class="sow-input" min="0" step="0.01" onchange="calculateLateFee()" oninput="calculateLateFee()" /></div><div style="flex: 1;"><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+e("sowCreator.deferred.dueDate")+'</label><input type="date" id="sowDeferredDueDate" class="sow-input" /></div></div></div><div id="recurringFields" style="display: none; margin-top: 15px;"><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;"><div><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+e("sowCreator.deferred.totalAmount")+'</label><input type="number" id="sowRecurringTotalAmount" placeholder="'+e("sowCreator.deferred.totalLabel")+'" class="sow-input" min="0" step="0.01" onchange="updateRecurringSchedule()" oninput="updateRecurringSchedule()" /></div><div><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+e("sowCreator.deferred.firstPayment")+'</label><input type="date" id="sowRecurringStartDate" class="sow-input" onchange="updateRecurringSchedule()" /></div></div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;"><div><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+e("sowCreator.deferred.frequency")+'</label><select id="sowRecurringFrequency" class="sow-select" onchange="updateRecurringSchedule()" style="width: 100%; padding: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: #fff;"><option value="weekly">'+e("sowCreator.deferred.weekly")+'</option><option value="biweekly" selected>'+e("sowCreator.deferred.biweekly")+'</option><option value="semimonthly">'+e("sowCreator.deferred.semimonthly")+'</option><option value="monthly">'+e("sowCreator.deferred.monthly")+'</option><option value="bimonthly">'+e("sowCreator.deferred.bimonthly")+'</option></select></div><div><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+e("sowCreator.deferred.calculateBy")+'</label><select id="sowRecurringCalcMode" class="sow-select" onchange="toggleRecurringCalcMode(); updateRecurringSchedule();" style="width: 100%; padding: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: #fff;"><option value="amount">'+e("sowCreator.deferred.fixedAmount")+'</option><option value="count">'+e("sowCreator.deferred.numPayments")+'</option></select></div></div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 15px;"><div id="recurringAmountField"><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+e("sowCreator.deferred.amountPerPayment")+'</label><input type="number" id="sowRecurringPaymentAmount" placeholder="'+e("sowCreator.deferred.amountPerPaymentPlaceholder")+'" class="sow-input" min="1" step="0.01" onchange="updateRecurringSchedule()" oninput="updateRecurringSchedule()" /></div><div id="recurringCountField" style="display: none;"><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+e("sowCreator.deferred.numPayments")+'</label><input type="number" id="sowRecurringPaymentCount" placeholder="'+e("sowCreator.deferred.numPaymentsPlaceholder")+'" class="sow-input" min="2" max="52" onchange="updateRecurringSchedule()" oninput="updateRecurringSchedule()" /></div><div id="recurringCalcResult" style="display: flex; align-items: flex-end;"><div style="padding: 10px 14px; background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 6px; width: 100%;"><span style="font-size: 0.75em; color: #10b981; display: block;">'+e("sowCreator.deferred.calculated")+'</span><span id="recurringCalcDisplay" style="font-size: 1.1em; font-weight: 600; color: #10b981;">--</span></div></div></div><div id="recurringSchedulePreview" style="display: none; background: rgba(99, 102, 241, 0.05); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 8px; padding: 12px; max-height: 200px; overflow-y: auto;"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;"><span style="font-size: 0.85em; font-weight: 500; color: #6366f1;">'+e("sowCreator.deferred.schedulePreview")+'</span><span id="recurringScheduleSummary" style="font-size: 0.75em; color: #94a3b8;"></span></div><div id="recurringScheduleList" style="display: grid; gap: 6px;"></div></div></div><div id="customSplitFields" style="display: none; margin-top: 15px;"><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+e("sowCreator.deferred.customSchedule")+'</label><div id="customPaymentsList" class="custom-payments-list"></div><button type="button" class="btn-add-payment" onclick="addCustomPaymentRow()" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 8px 16px; background: rgba(99, 102, 241, 0.15); border: 1px dashed rgba(99, 102, 241, 0.4); border-radius: 6px; color: #818cf8; cursor: pointer; font-size: 0.9em;"><span>'+e("sowCreator.deferred.addPayment")+'</span></button></div><div class="late-fee-section" style="margin-top: 15px; padding: 12px; background: rgba(245, 158, 11, 0.08); border-radius: 6px; border: 1px solid rgba(245, 158, 11, 0.2);"><div style="display: flex; justify-content: space-between; align-items: center;"><div><span style="color: #f59e0b; font-weight: 500;">'+e("sowCreator.deferred.lateFee")+'</span><span id="lateFeeDisplay" style="color: #fff; margin-left: 8px;">$0</span><span style="font-size: 0.75em; color: #94a3b8; margin-left: 6px;">'+e("sowCreator.deferred.lateFeeDesc")+'</span></div><label class="sow-checkbox" style="margin: 0; display: flex; align-items: center; gap: 6px;"><input type="checkbox" id="sowWaiveLateFee" onchange="calculateLateFee()" /><span style="font-size: 0.85em; color: #f59e0b;">'+e("sowCreator.deferred.waiveLateFee")+'</span></label></div><div style="margin-top: 8px;"><span style="color: #94a3b8; font-size: 0.85em;">'+e("sowCreator.deferred.totalDeferred")+'</span><span id="totalDeferredDisplay" style="color: #10b981; font-weight: 600; margin-left: 8px;">$0</span></div></div><div class="deferred-options" style="margin-top: 15px;"><label class="sow-checkbox" style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;"><input type="checkbox" id="sowAllowPartialPayments" checked /><span>'+e("sowCreator.deferred.allowPartial")+'</span></label><label class="sow-checkbox" style="display: flex; align-items: center; gap: 8px;"><input type="checkbox" id="sowMaintenanceDuringDeferral" checked /><span>'+e("sowCreator.deferred.maintDuringDeferral")+'</span></label></div></div></div><div class="sow-form-section coupon-section"><h5><span class="section-icon"></span> '+e("sowCreator.section.discount")+'</h5><div class="coupon-input-group"><select id="sowCouponSelect" class="sow-select coupon-select" onchange="setTimeout(syncDeferredWithTotal, 50)"><option value="">'+e("sowCreator.discount.noDiscount")+'</option></select><div id="couponValidationMessage" class="coupon-validation-message"></div></div></div><div class="sow-form-section pricing-summary"><h5><span class="section-icon"></span> '+e("sowCreator.section.pricing")+'</h5><div class="pricing-itemized-container"><div id="pricingItemizedList" class="pricing-itemized-list"></div></div><div class="pricing-breakdown"><div class="pricing-divider"></div><div class="pricing-row total-row"><span><strong>'+e("sowCreator.pricing.projectTotal")+'</strong></span><span id="sowTotalPrice" class="price-value total-value">$0.00</span></div><div class="pricing-row deposit-row"><span>'+e("sowCreator.pricing.deposit")+'</span><span id="sowDepositCalc" class="price-value">$0.00</span></div><div class="pricing-row"><span>'+e("sowCreator.pricing.milestone")+'</span><span id="sowMilestone1Calc" class="price-value">$0.00</span></div><div class="pricing-row"><span>'+e("sowCreator.pricing.finalPayment")+'</span><span id="sowFinalCalc" class="price-value">$0.00</span></div><div class="pricing-divider"></div><div class="pricing-row maintenance-row" id="maintenanceRow"><span>'+e("sowCreator.pricing.monthlyMaint")+'</span><span id="sowMaintenanceCalc" class="price-value">$167/month</span></div></div></div><div class="sow-form-actions"><button class="btn-cancel-sow btn-secondary">'+e("sowCreator.btn.cancelSow")+'</button><button class="btn-save-sow btn-primary"><span class="btn-icon"></span> '+e("sowCreator.btn.saveSow")+'</button><button class="btn-generate-sow-pdf btn-primary"><span class="btn-icon"></span> '+e("sowCreator.btn.generatePdf")+"</button></div></div>";u.innerHTML=p,u.style.display="block";var g=this,b={essential:{min:1e3,max:3e3,default:2e3},starter:{min:3e3,max:6e3,default:4500},growth:{min:6e3,max:12e3,default:9e3},professional:{min:12e3,max:25e3,default:18500},enterprise:{min:25e3,max:5e4,default:37500}},S={none:0,basic:167,professional:335,premium:670},_={responsive_design:{default:200,thirdParty:!1},custom_ui:{default:450,thirdParty:!1},animations:{default:275,thirdParty:!1},seo_optimization:{default:200,thirdParty:!1},analytics:{default:175,thirdParty:!1},contact_forms:{default:250,thirdParty:!1},firebase_auth:{default:350,thirdParty:!0,note:"Firebase costs"},firebase_db:{default:425,thirdParty:!0,note:"Firebase costs"},user_profiles:{default:550,thirdParty:!1},file_storage:{default:300,thirdParty:!0,note:"Firebase costs"},api_integration:{default:450,thirdParty:!1},email_integration:{default:325,thirdParty:!0,note:"SendGrid costs"},newsletter:{default:200,thirdParty:!1,addon:!0},user_roles:{default:450,thirdParty:!1},notifications:{default:400,thirdParty:!1},booking_basic:{default:450,thirdParty:!1,addon:!0},booking_system:{default:1100,thirdParty:!1,addon:!0},blog:{default:400,thirdParty:!1,addon:!0},cms_integration:{default:600,thirdParty:!1,addon:!0},gallery:{default:325,thirdParty:!1,addon:!0},music_media:{default:275,thirdParty:!1,addon:!0},social_feed:{default:250,thirdParty:!1,addon:!0}},D={none:{price:0,label:e("ecommerce.none")},basic_cart:{price:5500,label:e("ecommerce.basicCart"),thirdParty:!0,note:"Stripe fees"},full_store:{price:14e3,label:e("ecommerce.fullStore"),thirdParty:!0,note:"Stripe fees"}},T={essential:["responsive_design","contact_forms"],starter:["responsive_design","custom_ui","animations","seo_optimization","analytics","contact_forms"],growth:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","contact_forms"],professional:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","firebase_db","user_profiles","file_storage","api_integration","contact_forms","email_integration","newsletter"],enterprise:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","firebase_db","user_profiles","user_roles","file_storage","api_integration","contact_forms","email_integration","notifications","newsletter"],custom:[]},L=function(){g.updateSOWPricing(b,S,_,D,T)},F=a("#sowPackage"),U=a("#customPricingSection"),A=a("#sowCustomPrice");F&&F.addEventListener("change",function(){this.value==="custom"?(U.style.display="block",g.autoCheckPackageFeatures("custom",T)):(U.style.display="none",g.autoCheckPackageFeatures(this.value,T)),L()}),A&&A.addEventListener("input",function(){L()});var B=a("#sowMaintenance");B&&B.addEventListener("change",function(){L()});var $=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]');$.forEach(function(le){le.addEventListener("change",function(){L()})});var K=document.querySelectorAll('input[name="ecommerce_option"]');K.forEach(function(le){le.addEventListener("change",function(){L()})}),window.toggleRetroactiveFields=function(){var le=a("#sowRetroactive"),ae=a("#retroactiveDurationFields"),Ie=a("#sowWeeks"),Fe=Ie?Ie.parentElement:null;le&&le.checked?(ae&&(ae.style.display="block"),Fe&&(Fe.style.display="none")):(ae&&(ae.style.display="none"),Fe&&(Fe.style.display="flex"));var Te=document.querySelector(".deposit-row"),Le=a("#sowMilestone1Calc"),Be=a("#sowFinalCalc");le&&le.checked?(Te&&(Te.style.display="none"),Le&&Le.parentElement&&(Le.parentElement.style.display="none"),Be&&Be.parentElement&&(Be.parentElement.style.display="none")):(Te&&(Te.style.display="flex"),Le&&Le.parentElement&&(Le.parentElement.style.display="flex"),Be&&Be.parentElement&&(Be.parentElement.style.display="flex"))},window.toggleDeferredPaymentFields=function(){var le=a("#sowDeferredPayment"),ae=a("#deferredPaymentFields");if(le&&le.checked){ae&&(ae.style.display="block");var Ie=a("#sowTotalPrice");if(Ie){var Fe=parseFloat(Ie.textContent.replace(/[^0-9.-]/g,""))||0,Te=a("#sowDeferredAmount"),Le=a("#sowRecurringTotalAmount");Te&&!Te.value&&(Te.value=Fe),Le&&!Le.value&&(Le.value=Fe)}var Be=document.querySelectorAll(".deferred-type-card");Be.forEach(function(lt){var tt=lt.querySelector('input[type="radio"]');tt&&tt.checked?(lt.style.borderColor="#6366f1",lt.style.background="rgba(99, 102, 241, 0.15)"):(lt.style.borderColor="transparent",lt.style.background="rgba(255, 255, 255, 0.03)")}),calculateLateFee()}else ae&&(ae.style.display="none")},window.toggleDeferredSplitType=function(){var le=document.querySelector('input[name="deferred_split"]:checked'),ae=a("#lumpSumFields"),Ie=a("#recurringFields"),Fe=a("#customSplitFields"),Te=document.querySelectorAll(".deferred-type-card");if(Te.forEach(function(Xe){var $n=Xe.querySelector('input[type="radio"]');$n&&$n.checked?(Xe.style.borderColor="#6366f1",Xe.style.background="rgba(99, 102, 241, 0.15)"):(Xe.style.borderColor="transparent",Xe.style.background="rgba(255, 255, 255, 0.03)")}),ae&&(ae.style.display="none"),Ie&&(Ie.style.display="none"),Fe&&(Fe.style.display="none"),le){if(le.value==="lump_sum")ae&&(ae.style.display="block");else if(le.value==="recurring"){Ie&&(Ie.style.display="block");var Le=a("#sowTotalPrice"),Be=a("#sowRecurringTotalAmount");if(Le&&Be&&!Be.value){var lt=parseFloat(Le.textContent.replace(/[^0-9.-]/g,""))||0;Be.value=lt}updateRecurringSchedule()}else if(le.value==="custom"){Fe&&(Fe.style.display="block");var tt=a("#customPaymentsList");tt&&tt.children.length===0&&addCustomPaymentRow()}}calculateLateFee()},window.toggleRecurringCalcMode=function(){var le=a("#sowRecurringCalcMode"),ae=a("#recurringAmountField"),Ie=a("#recurringCountField");le&&le.value==="count"?(ae&&(ae.style.display="none"),Ie&&(Ie.style.display="block")):(ae&&(ae.style.display="block"),Ie&&(Ie.style.display="none"))},window.generateRecurringSchedule=function(le,ae,Ie,Fe,Te){var Le=[];if(!le||le<=0||!ae)return Le;var Be=new Date(ae),lt=le,tt,Xe;if(Fe==="amount"){if(tt=parseFloat(Te)||0,tt<=0)return Le;Xe=Math.ceil(le/tt)}else{if(Xe=parseInt(Te)||0,Xe<=0)return Le;tt=Math.ceil(le/Xe)}Xe>52&&(Xe=52);for(var $n=0;$n<Xe;$n++){var zt=Math.min(tt,lt);if(zt<=0)break;switch(Le.push({amount:zt,dueDate:Be.toISOString().split("T")[0]}),lt-=zt,Ie){case"weekly":Be.setDate(Be.getDate()+7);break;case"biweekly":Be.setDate(Be.getDate()+14);break;case"semimonthly":Be.getDate()<15?Be.setDate(15):(Be.setMonth(Be.getMonth()+1),Be.setDate(1));break;case"monthly":Be.setMonth(Be.getMonth()+1);break;case"bimonthly":Be.setMonth(Be.getMonth()+2);break;default:Be.setDate(Be.getDate()+14)}}return Le},window.updateRecurringSchedule=function(){var le=parseFloat(a("#sowRecurringTotalAmount")?a("#sowRecurringTotalAmount").value:0)||0,ae=a("#sowRecurringStartDate")?a("#sowRecurringStartDate").value:null,Ie=a("#sowRecurringFrequency")?a("#sowRecurringFrequency").value:"biweekly",Fe=a("#sowRecurringCalcMode")?a("#sowRecurringCalcMode").value:"amount",Te=Fe==="amount"?a("#sowRecurringPaymentAmount")?a("#sowRecurringPaymentAmount").value:0:a("#sowRecurringPaymentCount")?a("#sowRecurringPaymentCount").value:0,Le=a("#recurringCalcDisplay"),Be=a("#recurringSchedulePreview"),lt=a("#recurringScheduleList"),tt=a("#recurringScheduleSummary");if(!le||!ae||!Te){Le&&(Le.textContent="--"),Be&&(Be.style.display="none"),calculateLateFee();return}var Xe=generateRecurringSchedule(le,ae,Ie,Fe,Te);if(Xe.length===0){Le&&(Le.textContent="--"),Be&&(Be.style.display="none"),calculateLateFee();return}if(Fe==="amount")Le&&(Le.textContent=Xe.length+" payments");else{var $n=Xe.length>0?Xe[0].amount:0;Le&&(Le.textContent="$"+$n.toLocaleString()+"/payment")}var zt={weekly:"Weekly",biweekly:"Bi-Weekly",semimonthly:"Semi-Monthly",monthly:"Monthly",bimonthly:"Bi-Monthly"};if(tt){var ss=Xe[Xe.length-1].dueDate;tt.textContent=zt[Ie]+"  Final payment: "+new Date(ss).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}if(Be&&(Be.style.display="block"),lt){var Ke="";Xe.forEach(function(un,Ei){var as=new Date(un.dueDate).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"});Ke+='<div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 10px; background: rgba(255,255,255,0.03); border-radius: 4px;"><span style="font-size: 0.8em; color: #94a3b8;">#'+(Ei+1)+'</span><span style="font-size: 0.85em; color: #e2e8f0;">'+as+'</span><span style="font-size: 0.9em; font-weight: 600; color: #10b981;">$'+un.amount.toLocaleString()+"</span></div>"}),lt.innerHTML=Ke}calculateLateFee()},window.syncDeferredWithTotal=function(){var le=a("#sowDeferredPayment"),ae=a("#deferredPaymentFields"),Ie=le&&le.checked||ae&&ae.style.display==="block";if(Ie){var Fe=document.querySelector('input[name="deferred_split"]:checked');if(!(Fe&&Fe.value==="custom")){var Te=a("#sowTotalPrice");if(Te){var Le=parseFloat(Te.textContent.replace(/[^0-9.-]/g,""))||0;if(Fe&&Fe.value==="recurring"){var Be=a("#sowRecurringTotalAmount");Be&&Le>0&&(Be.value=Le,updateRecurringSchedule())}else{var lt=a("#sowDeferredAmount");lt&&Le>0&&(lt.value=Le,calculateLateFee())}}}}};var Y=function(){var le=a("#sowTotalPrice");if(le){var ae=new MutationObserver(function(Ie){Ie.forEach(function(Fe){(Fe.type==="childList"||Fe.type==="characterData")&&syncDeferredWithTotal()})});ae.observe(le,{childList:!0,characterData:!0,subtree:!0})}};setTimeout(Y,500),window.calculateLateFee=function(){var le=document.querySelector('input[name="deferred_split"]:checked'),ae=a("#sowWaiveLateFee"),Ie=ae&&ae.checked,Fe=0;if(le&&le.value==="custom"){var Te=document.querySelectorAll(".custom-payment-amount");Te.forEach(function($n){Fe+=parseFloat($n.value)||0})}else if(le&&le.value==="recurring"){var Le=a("#sowRecurringTotalAmount");Fe=parseFloat(Le?Le.value:0)||0}else{var Be=a("#sowDeferredAmount");Fe=parseFloat(Be?Be.value:0)||0}var lt=Ie?0:Fe*.1,tt=a("#lateFeeDisplay"),Xe=a("#totalDeferredDisplay");tt&&(tt.textContent="$"+lt.toFixed(0),tt.style.textDecoration=Ie?"line-through":"none"),Xe&&(Xe.textContent="$"+Fe.toFixed(0))},window.addCustomPaymentRow=function(){var le=a("#customPaymentsList");if(le){var ae=document.createElement("div");ae.className="custom-payment-row",ae.style.cssText="display: flex; gap: 10px; margin-bottom: 10px; align-items: center;",ae.innerHTML='<input type="number" class="sow-input custom-payment-amount" placeholder="Amount $" style="flex: 1;" onchange="calculateLateFee()" oninput="calculateLateFee()" /><input type="date" class="sow-input custom-payment-date" style="flex: 1;" /><button type="button" onclick="removeCustomPaymentRow(this)" style="padding: 8px 12px; background: rgba(239, 68, 68, 0.2); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 6px; color: #ef4444; cursor: pointer; font-size: 1em;"></button>',le.appendChild(ae)}},window.removeCustomPaymentRow=function(le){var ae=le.parentElement;ae.remove(),calculateLateFee()};var Q=a("#sowCouponSelect");if(Q&&g.coupons){var te=g.coupons.filter(function(le){var ae=le.expirationDate&&new Date(le.expirationDate)<new Date,Ie=le.usageLimit&&le.usageCount>=le.usageLimit;return le.active!==!1&&!ae&&!Ie});te.forEach(function(le){var ae=le.discountType==="percentage"?le.discountValue+"% off":"$"+(le.discountValue||0).toFixed(0)+" off",Ie=document.createElement("option");Ie.value=le.code,Ie.textContent=le.code+"  "+ae,le.description&&(Ie.textContent+=" ("+le.description+")"),Q.appendChild(Ie)}),Q.addEventListener("change",function(){L()})}var ce=a("#sowWeeks"),pe=a("#sowStartDate");ce&&ce.addEventListener("input",function(){var le=parseInt(this.value);if(le&&le>0&&pe){var ae=new Date;ae.setDate(ae.getDate()+le*7),pe.value=ae.toISOString().split("T")[0]}}),pe&&pe.addEventListener("change",function(){var le=new Date(this.value),ae=new Date;if(ae.setHours(0,0,0,0),le&&le>ae&&ce){var Ie=le-ae,Fe=Ie/(1e3*60*60*24),Te=Math.round(Fe/7);ce.value=Math.max(1,Math.min(52,Te))}});var ge=a(".btn-close-sow");ge&&ge.addEventListener("click",function(){u.style.display="none"});var Se=a(".btn-cancel-sow");Se&&Se.addEventListener("click",function(){u.style.display="none"});var Ee=a("#clientIdTypeToggle"),re=a("#sowClientEmail"),xe=a("#sowClientPhone"),$e=a("#sowClientEmailWrapper"),it=a("#sowClientPhoneWrapper"),je=a("#emailToggleLabel"),nt=a("#phoneToggleLabel");Ee&&(Ee.addEventListener("change",function(){this.checked?($e&&($e.style.display="none"),re&&(re.value=""),it&&(it.style.display="flex"),je.classList.remove("active"),nt.classList.add("active")):(it&&(it.style.display="none"),xe&&(xe.value=""),$e&&($e.style.display="block"),nt.classList.remove("active"),je.classList.add("active"))}),je.classList.add("active"));var Qe=a("#sowEntityTypeToggle"),at=a("#sowIndividualFields"),Ye=a("#sowBusinessFields"),pt=a("#sowIndividualLabel"),Xt=a("#sowBusinessLabel"),Wt=a("#sowBusinessEmail"),Oe=a("#sowBusinessPhone"),De=a("#sowBusinessEmailWrapper"),xt=a("#sowBusinessPhoneWrapper");Qe&&(Qe.addEventListener("change",function(){this.checked?(at&&(at.style.display="none"),Ye&&(Ye.style.display="block"),pt&&pt.classList.remove("active"),Xt&&Xt.classList.add("active"),Ee&&Ee.checked?(De&&(De.style.display="none"),xt&&(xt.style.display="flex")):(De&&(De.style.display="block"),xt&&(xt.style.display="none"))):(Ye&&(Ye.style.display="none"),at&&(at.style.display="block"),Xt&&Xt.classList.remove("active"),pt&&pt.classList.add("active"))}),pt&&pt.classList.add("active")),Ee&&Ee.addEventListener("change",function(){Qe&&Qe.checked&&(this.checked?(De&&(De.style.display="none"),Wt&&(Wt.value=""),xt&&(xt.style.display="flex")):(xt&&(xt.style.display="none"),Oe&&(Oe.value=""),De&&(De.style.display="block")))}),Oe&&(Oe.setAttribute("maxlength","17"),Oe.addEventListener("input",function(){var le=C(this.value);le!==this.value&&(this.value=le)})),xe&&(xe.setAttribute("maxlength","17"),xe.addEventListener("input",function(){var le=C(this.value);le!==this.value&&(this.value=le)}));var Ge=a("#sowUserSearch"),vt=a("#sowUserDropdown"),Nt=[],St=null,Ze=null,st=null,ht=null,Zt=function(){console.log(" Starting realtime subscription for users without SOW..."),Ge&&(Ge.placeholder=e("dash.search.loading"),Ge.disabled=!0);var le=function(){if(!(!st||!ht)){var ae=new Set,Ie=new Set;ht.forEach(function(Fe){var Te=Fe.data();Te.clientEmail&&ae.add(Te.clientEmail.toLowerCase().trim()),Te.clientPhone&&Ie.add(M(Te.clientPhone))}),Nt=[],st.forEach(function(Fe){var Te=Fe.data(),Le=Te.email?Te.email.toLowerCase().trim():null,Be=Te.phoneNumber?M(Te.phoneNumber):null,lt=Le&&ae.has(Le),tt=Be&&Ie.has(Be);!lt&&!tt&&Nt.push({uid:Te.uid,email:Te.email||null,phoneNumber:Te.phoneNumber||null,displayName:Te.displayName||null})}),Ge&&(Ge.placeholder=e("dash.search.placeholder"),Ge.disabled=!1),console.log("Realtime: Loaded "+Nt.length+" users without SOW"),vt&&vt.style.display==="block"&&yt(Ge?Ge.value:"")}};console.log(" Subscribing to users collection..."),St=firebase.firestore().collection("users").onSnapshot(function(ae){console.log(" Users snapshot received:",ae.size,"users"),st=ae,le()},function(ae){console.error(" Error listening to users:",ae),Ge&&(Ge.placeholder=e("dash.search.unavailable"),Ge.disabled=!1)}),console.log(" Subscribing to sow_documents collection..."),Ze=firebase.firestore().collection("sow_documents").onSnapshot(function(ae){console.log(" SOW documents snapshot received:",ae.size,"documents"),ht=ae,le()},function(ae){console.error(" Error listening to SOWs:",ae)})},En=function(){St&&(St(),St=null),Ze&&(Ze(),Ze=null),st=null,ht=null},rn=function(){var le=a("#addUserEmail"),ae=a("#addUserPassword"),Ie=a("#addUserPhone"),Fe=a("#addUserCode"),Te=a("#addUserPhoneCountryCode");if(le&&ae){var Le=le.value&&le.value.trim().length>0;ae.style.display=Le?"block":"none",Le?ae.required=!0:(ae.required=!1,ae.value="")}if(Ie&&Fe){var Be=Te?Te.value:"+1",lt=k[Be]||k["+1"],tt=Ie.value.replace(/\D/g,"").length,Xe=Ie.value&&tt>=lt.maxDigits;Fe.style.display=Xe?"block":"none",Xe?Fe.required=!0:(Fe.required=!1,Fe.value="")}};window.toggleAuthFields=rn;var Pn=function(le,ae,Ie,Fe,Te){var Le=ae&&ae.trim(),Be=Fe&&Fe.trim();if(!Le&&!Be)return alert(e("dash.user.val.emailOrPhone")),Promise.reject("No email or phone provided");if(Le&&(!Ie||Ie.length<6))return alert(e("dash.user.val.passwordLength")),Promise.reject("Password too short");if(Be&&(!Te||!/^\d{4,6}$/.test(Te)))return alert(e("dash.user.val.codeFormat")),Promise.reject("Invalid verification code");console.log("Adding user via Cloud Function...");var lt=firebase.functions().httpsCallable("addAuthUser");return lt({displayName:le?le.trim():null,email:Le?ae.trim():null,password:Le?Ie:null,phoneNumber:Be?Fe.trim():null,verificationCode:Be?Te:null}).then(function(tt){return console.log("User added successfully:",tt.data),tt.data}).catch(function(tt){throw console.error("Error adding user:",tt),tt})};window.unsubscribeFromUsers=En;var yt=function(le){var ae;if(!le||le.length===0)ae=Nt;else{var Ie=le.toLowerCase();ae=Nt.filter(function(Te){var Le=Te.displayName&&Te.displayName.toLowerCase().includes(Ie),Be=Te.email&&Te.email.toLowerCase().includes(Ie),lt=Te.phoneNumber&&Te.phoneNumber.includes(Ie);return Le||Be||lt})}if(ae.length===0){vt.innerHTML='<div class="sow-dropdown-empty">'+e("sowCreator.noUsersFound")+"</div>",vt.style.display="block";return}var Fe=ae.slice(0,10).map(function(Te){var Le=Te.displayName||"Unknown",Be=Te.email||(Te.phoneNumber?C(Te.phoneNumber):"")||"",lt=!!Te.email,tt=!!Te.phoneNumber;return'<div class="sow-dropdown-item" data-email="'+(Te.email||"")+'" data-phone="'+(Te.phoneNumber||"")+'" data-name="'+(Te.displayName||"")+'"><span class="sow-dropdown-name">'+Le+'</span><span class="sow-dropdown-contact">'+Be+'</span><span class="sow-dropdown-badges">'+(lt?'<span class="badge-email">'+e("sowCreator.badge.email")+"</span>":"")+(tt?'<span class="badge-phone">'+e("sowCreator.badge.phone")+"</span>":"")+"</span></div>"}).join("");vt.innerHTML=Fe,vt.style.display="block"},ii=function(le){var ae=le.getAttribute("data-email"),Ie=le.getAttribute("data-phone"),Fe=le.getAttribute("data-name"),Te=a("#sowClientName");if(Te&&Fe&&(Te.value=Fe),ae)Ee.checked=!1,$e&&($e.style.display="block"),it&&(it.style.display="none"),re&&(re.value=ae),xe&&(xe.value=""),je.classList.add("active"),nt.classList.remove("active");else if(Ie){if(Ee.checked=!0,it&&(it.style.display="flex"),$e&&($e.style.display="none"),xe){var Le=a("#sowClientPhoneCountryCode")?a("#sowClientPhoneCountryCode").value:"+1";xe.value=C(Ie,Le)}re&&(re.value=""),nt.classList.add("active"),je.classList.remove("active")}Ge.value="",vt.style.display="none"};Ge&&(Ge.addEventListener("input",function(){yt(this.value)}),Ge.addEventListener("focus",function(){yt(this.value)})),vt&&vt.addEventListener("click",function(le){var ae=le.target.closest(".sow-dropdown-item");ae&&ii(ae)}),document.addEventListener("click",function(le){vt&&!le.target.closest(".sow-search-wrapper")&&(vt.style.display="none")}),Zt();var Dn=a("#btnAddUser"),Ln=a("#addUserForm"),yn=a("#btnSaveUser"),wt=a("#btnCancelAddUser"),wn=a("#addUserName"),jt=a("#addUserEmail"),bn=a("#addUserPassword"),xn=a("#addUserPhone"),Hn=a("#addUserCode");Dn&&Dn.addEventListener("click",function(){Ln.style.display="block",Dn.style.display="none",jt.focus()}),wt&&wt.addEventListener("click",function(){Ln.style.display="none",Dn.style.display="inline-block",wn.value="",jt.value="",bn.value="",xn.value="",Hn.value="",bn.style.display="none",Hn.style.display="none"}),yn&&yn.addEventListener("click",function(){var le=wn.value.trim(),ae=jt.value.trim(),Ie=bn.value,Fe=xn.value.trim(),Te=Hn.value.trim();yn.disabled=!0,yn.textContent=e("dash.user.btn.saving"),Pn(le,ae,Ie,Fe,Te).then(function(Le){wn.value="",jt.value="",bn.value="",xn.value="",Hn.value="",bn.style.display="none",Hn.style.display="none",Ln.style.display="none",Dn.style.display="inline-block",yn.disabled=!1,yn.textContent=e("dash.user.btn.save"),alert(e("dash.user.msg.success"))}).catch(function(Le){yn.disabled=!1,yn.textContent=e("dash.user.btn.save"),Le!=="No email or phone provided"&&Le!=="Password too short"&&Le!=="Invalid verification code"&&alert(e("dash.user.err.add")+(Le.message||Le))})});var Sn=a("#addUserPhoneCountryCode");if(xn){var sn=function(){var le=Sn?Sn.value:"+1",ae=C(xn.value,le);ae!==xn.value&&(xn.value=ae)};xn.addEventListener("input",sn),Sn&&Sn.addEventListener("change",sn)}var Mn=a("#sowClientPhone"),Ce=a("#sowClientPhoneCountryCode");if(Mn){var It=function(){var le=Ce?Ce.value:"+1",ae=C(Mn.value,le);ae!==Mn.value&&(Mn.value=ae)};Mn.addEventListener("input",It),Ce&&Ce.addEventListener("change",It)}var ot=a("#sowBusinessPhone"),Bt=a("#sowBusinessPhoneCountryCode");if(ot){var An=function(){var le=Bt?Bt.value:"+1",ae=C(ot.value,le);ae!==ot.value&&(ot.value=ae)};ot.addEventListener("input",An),Bt&&Bt.addEventListener("change",An)}var Zi=a(".btn-save-sow");Zi&&Zi.addEventListener("click",function(){g.saveSOW()});var et=a(".btn-generate-sow-pdf");et&&et.addEventListener("click",function(){g.generateSOWPDF()}),se()}};function se(){var u=new URLSearchParams(window.location.search),p=u.get("business"),g=u.get("phone"),b=u.get("email"),S=u.get("package"),_=u.get("features"),D=u.get("ecommerce"),T=u.get("maintenance"),L=["essential","starter","growth","professional","enterprise","custom"],F=["responsive_design","custom_ui","animations","seo_optimization","analytics","contact_forms","firebase_auth","firebase_db","user_profiles","file_storage","api_integration","email_integration","music_media","booking_basic","newsletter","social_feed","user_roles","cms_integration","booking_system","blog","gallery","notifications"],U=["none","basic_cart","full_store"],A=["none","basic","professional","premium"];if(p){var B=document.getElementById("sowBusinessName"),$=document.getElementById("sowClientName");B&&(B.value=p),$&&($.value=p)}if(g){var K=document.getElementById("sowClientPhone"),Y=document.getElementById("sowBusinessPhone"),Q=document.getElementById("addUserPhone");K&&(K.value=g),Y&&(Y.value=g),Q&&(Q.value=g)}if(b){var te=document.getElementById("sowClientEmail"),ce=document.getElementById("sowBusinessEmail"),pe=document.getElementById("addUserEmail");te&&(te.value=b),ce&&(ce.value=b),pe&&(pe.value=b)}if(b||g){var ge=document.getElementById("addUserForm");ge&&(ge.style.display="block");var Se=document.getElementById("clientIdTypeToggle"),Ee=document.getElementById("sowClientEmailWrapper"),re=document.getElementById("sowClientPhoneWrapper"),xe=document.getElementById("emailToggleLabel"),$e=document.getElementById("phoneToggleLabel");g&&!b?(Se&&(Se.checked=!0),Ee&&(Ee.style.display="none"),re&&(re.style.display="flex"),xe&&xe.classList.remove("active"),$e&&$e.classList.add("active")):b&&(Se&&(Se.checked=!1),re&&(re.style.display="none"),Ee&&(Ee.style.display="block"),$e&&$e.classList.remove("active"),xe&&xe.classList.add("active"))}if(S&&L.indexOf(S)!==-1){var it=document.getElementById("sowPackage");if(it){it.value=S;var je=new Event("change",{bubbles:!0});it.dispatchEvent(je)}}if(_){var nt=_.split(",").map(function(Ye){return Ye.trim().toLowerCase()});nt.forEach(function(Ye){if(F.indexOf(Ye)!==-1){var pt=document.querySelector('.sow-checkboxes input[type="checkbox"][value="'+Ye+'"]');if(pt){pt.checked=!0;var Xt=new Event("change",{bubbles:!0});pt.dispatchEvent(Xt)}}})}if(D&&U.indexOf(D)!==-1){var Qe=document.querySelector('input[name="ecommerce_option"][value="'+D+'"]');if(Qe){Qe.checked=!0;var je=new Event("change",{bubbles:!0});Qe.dispatchEvent(je)}}if(T&&A.indexOf(T)!==-1){var at=document.getElementById("sowMaintenance");if(at){at.value=T;var je=new Event("change",{bubbles:!0});at.dispatchEvent(je)}}}function fe(){var u=new URLSearchParams(window.location.search),p=u.has("business")||u.has("phone")||u.has("email")||u.has("package");p&&window.contractFormHandler&&typeof window.contractFormHandler.showSOWCreator=="function"&&(typeof window.contractFormHandler.switchTab=="function"&&window.contractFormHandler.switchTab("sow"),setTimeout(function(){window.contractFormHandler.showSOWCreator()},100))}N.prototype.calculateFeatureBasedPricing=function(u,p,g,b){var S=a("#sowPackage"),_=a("#sowCustomPrice"),D=S?S.value:"",T={basePrice:0,packageType:D,addOns:[],discounts:[],ecommerceOption:"none",ecommercePrice:0,total:0};if(!D)return T;D==="custom"?T.basePrice=parseFloat(_.value)||0:u[D]&&(T.basePrice=u[D].default);var L=b[D]||[],F=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]');F.forEach(function($){var K=$.value,Y=$.checked,Q=L.indexOf(K)!==-1,te=p[K];if(te){var ce=$.parentElement.textContent.trim(),pe=$.parentElement.querySelector(".third-party-note");pe&&(ce=ce.replace(pe.textContent,"").trim()),Y&&!Q?T.addOns.push({key:K,label:ce,price:D==="custom"?0:te.default,thirdParty:te.thirdParty,note:te.note||""}):!Y&&Q&&D!=="custom"&&T.discounts.push({key:K,label:ce,price:Math.round(te.default*.5)})}});var U=document.querySelector('input[name="ecommerce_option"]:checked');U&&(T.ecommerceOption=U.value,g[T.ecommerceOption]&&(T.ecommercePrice=g[T.ecommerceOption].price,T.ecommercePrice>0&&T.addOns.push({key:"ecommerce_"+T.ecommerceOption,label:g[T.ecommerceOption].label,price:D==="custom"?0:T.ecommercePrice,thirdParty:g[T.ecommerceOption].thirdParty,note:g[T.ecommerceOption].note||""})));var A=T.addOns.reduce(function($,K){return $+K.price},0),B=T.discounts.reduce(function($,K){return $+K.price},0);return T.total=Math.max(0,T.basePrice+A-B),T},N.prototype.renderItemizedPricing=function(u,p,g){var b=document.getElementById("pricingItemizedList");if(!b){console.warn("pricingItemizedList container not found");return}var S={responsive_design:e("feature.responsive_design"),custom_ui:e("feature.custom_ui"),animations:e("feature.animations"),seo_optimization:e("feature.seo_optimization"),analytics:e("feature.analytics"),contact_forms:e("feature.contact_forms"),firebase_auth:e("feature.firebase_auth"),firebase_db:e("feature.firebase_db"),user_profiles:e("feature.user_profiles"),file_storage:e("feature.file_storage"),api_integration:e("feature.api_integration"),email_integration:e("feature.email_integration"),newsletter:e("feature.newsletter"),user_roles:e("feature.user_roles"),notifications:e("feature.notifications"),booking_basic:e("feature.booking_basic"),booking_system:e("feature.booking_system"),blog:e("feature.blog"),cms_integration:e("feature.cms_integration"),gallery:e("feature.gallery"),music_media:e("feature.music_media"),social_feed:e("feature.social_feed")},_={essential:e("pkg.essential"),starter:e("pkg.starter"),growth:e("pkg.growth"),professional:e("pkg.professional"),enterprise:e("pkg.enterprise"),custom:e("pkg.custom")},D="",T=u.packageType;if(!T){D='<div class="pricing-empty-state">'+e("pricing.selectPackage")+"</div>",b.innerHTML=D;return}var L=_[T]||T.charAt(0).toUpperCase()+T.slice(1)+" Package";D+='<div class="pricing-package-header"><span class="package-name">'+L+'</span><span class="package-price">$'+u.basePrice.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</span></div>";var F=g?g[T]||[]:[];F.length>0&&T!=="custom"&&(D+='<div class="pricing-section-header">'+e("pricing.includedInPackage")+"</div>",D+='<div class="pricing-included-features">',F.forEach(function(Y){var Q=S[Y]||Y.replace(/_/g," ").replace(/\b\w/g,function(te){return te.toUpperCase()});D+='<div class="pricing-feature-item included"><span class="feature-check"></span><span class="feature-name">'+Q+"</span></div>"}),D+="</div>");var U=u.addOns.filter(function(Y){return Y.key.indexOf("ecommerce_")!==0}),A=u.addOns.find(function(Y){return Y.key.indexOf("ecommerce_")===0});if(U.length>0&&(D+='<div class="pricing-section-header">'+e(T==="custom"?"pricing.includedFeatures":"pricing.addOns")+"</div>",U.forEach(function(Y){var Q=S[Y.key]||Y.label,te=Y.price===0?'<span class="included-badge">'+e("pricing.included")+"</span>":"+$"+Y.price.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});D+='<div class="pricing-line-item add-on"><span class="item-label">'+Q+(Y.thirdParty?' <span class="third-party-note">+ '+Y.note+"</span>":"")+'</span><span class="item-price">'+te+"</span></div>"})),A){U.length===0&&(D+='<div class="pricing-section-header">'+e(T==="custom"?"pricing.includedFeatures":"pricing.addOns")+"</div>");var B=A.price===0?'<span class="included-badge">'+e("pricing.included")+"</span>":"+$"+A.price.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});D+='<div class="pricing-line-item add-on ecommerce-item"><span class="item-label">'+A.label+(A.thirdParty?' <span class="third-party-note">+ '+A.note+"</span>":"")+'</span><span class="item-price">'+B+"</span></div>"}if(u.discounts.length>0&&(D+='<div class="pricing-section-header">'+e("pricing.removedFeatures")+"</div>",u.discounts.forEach(function(Y){var Q=S[Y.key]||Y.label;D+='<div class="pricing-line-item discount"><span class="item-label">'+Q+'</span><span class="item-price discount-value">-$'+Y.price.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</span></div>"})),u.coupon&&u.couponDiscount>0){var $=u.coupon,K=$.code;$.discountType==="percentage"?K+=" ("+$.discountValue+e("pricing.percentOff")+")":K+=" ($"+$.discountValue.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+e("pricing.dollarOff")+")",D+='<div class="pricing-section-header coupon-header">'+e("pricing.discountApplied")+"</div>",D+='<div class="pricing-line-item coupon-discount"><span class="item-label"><span class="coupon-icon"></span> '+K+'</span><span class="item-price coupon-value">-$'+u.couponDiscount.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</span></div>"}b.innerHTML=D},N.prototype.autoCheckPackageFeatures=function(u,p){var g=p[u]||[],b=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]');b.forEach(function(_){var D=_.value,T=g.indexOf(D)!==-1;_.checked=T;var L=_.parentElement;T?L.classList.add("feature-included"):L.classList.remove("feature-included")});var S=document.querySelector('input[name="ecommerce_option"][value="none"]');S&&(S.checked=!0)},N.prototype.updateSOWPricing=function(u,p,g,b,S){var _=a("#sowMaintenance"),D=a("#sowCouponSelect"),T=a("#couponValidationMessage"),L=this.calculateFeatureBasedPricing(u,g,b,S),F=D?D.value:"";L.coupon=null,L.couponDiscount=0;var U=L.basePrice;if(F&&this.coupons){var A=L.packageType==="custom"?L.basePrice:L.total,B=this.validateCoupon(F,L.packageType,A);B.valid?(L.coupon=B.coupon,L.couponDiscount=B.discount,L.total=Math.max(0,L.total-B.discount),L.basePrice=U,T&&(T.className="coupon-validation-message success",T.innerHTML=e("coupon.msg.discountAppliedPrefix")+B.discountDisplay+e("coupon.msg.discountAppliedSuffix"))):T&&(T.className="coupon-validation-message error",T.innerHTML=" "+B.error)}else T&&(T.className="coupon-validation-message",T.innerHTML="");this.renderItemizedPricing(L,u,S);var $=L.total,K=$*.5,Y=$*.25,Q=$*.25,te=p[_.value]||0,ce=a("#sowTotalPrice"),pe=a("#sowDepositCalc"),ge=a("#sowMilestone1Calc"),Se=a("#sowFinalCalc"),Ee=a("#sowMaintenanceCalc"),re=a("#maintenanceRow");ce&&(ce.textContent="$"+$.toFixed(0)),pe&&(pe.textContent="$"+K.toFixed(0)),ge&&(ge.textContent="$"+Y.toFixed(0)),Se&&(Se.textContent="$"+Q.toFixed(0)),re&&(re.style.display="flex"),_.value&&_.value!==""?Ee&&(Ee.textContent="$"+te+"/month"):Ee&&(Ee.textContent="Select plan");var xe=a("#sowDeferredPayment"),$e=a("#deferredPaymentFields"),it=xe&&xe.checked||$e&&$e.style.display==="block";if(it){var je=document.querySelector('input[name="deferred_split"]:checked');if(!je||je.value!=="custom"){var nt=a("#sowDeferredAmount");nt&&(nt.value=$)}calculateLateFee()}this.currentPricingData=L},N.prototype.saveSOW=function(){var u=a("#sowEntityTypeToggle")&&a("#sowEntityTypeToggle").checked,p=a("#sowClientName").value.trim(),g=a("#sowClientEmail").value.trim(),b=a("#sowClientPhone").value.trim(),S=a("#sowBusinessName")?a("#sowBusinessName").value.trim():"",_=a("#sowEntityType")?a("#sowEntityType").value:"",D=a("#sowStateOfFormation")?a("#sowStateOfFormation").value.trim():"",T=a("#sowRepName")?a("#sowRepName").value.trim():"",L=a("#sowRepTitle")?a("#sowRepTitle").value.trim():"",F=a("#sowBusinessEmail")?a("#sowBusinessEmail").value.trim():"",U=a("#sowBusinessPhone")?a("#sowBusinessPhone").value.trim():"",A=a("#sowPackage").value,B=a("#sowWeeks").value,$=a("#sowStartDate").value,K=a("#sowNotes").value.trim(),Y=a("#sowMaintenance").value,Q=a("#sowRetroactive")&&a("#sowRetroactive").checked,te=a("#sowDevDuration")?a("#sowDevDuration").value:"",ce=a("#sowRetroactiveEndDate")?a("#sowRetroactiveEndDate").value:"",pe="";if(b){var ge=b.replace(/\D/g,"");ge.length===10?pe="+1"+ge:ge.length===11&&ge.startsWith("1")?pe="+"+ge:pe=b}var Se="";if(U){var Ee=U.replace(/\D/g,"");Ee.length===10?Se="+1"+Ee:Ee.length===11&&Ee.startsWith("1")?Se="+"+Ee:Se=U}var re=[];if(u){if(S||re.push("Business Legal Name"),_||re.push("Entity Type"),T||re.push("Representative Name"),L||re.push("Representative Title"),A||re.push("Package Tier"),Q?te||re.push("Development Duration"):B||re.push("Estimated Weeks"),re.length>0){alert(e("sow.val.fillRequired")+re.join(`
- `));return}if(!F&&!Se){alert(e("sow.val.businessEmailOrPhone"));return}}else{if(p||re.push("Client Name"),A||re.push("Package Tier"),Q?te||re.push("Development Duration"):B||re.push("Estimated Weeks"),re.length>0){alert(e("sow.val.fillRequired")+re.join(`
- `));return}if(!g&&!pe){alert(e("sow.val.clientEmailOrPhone"));return}}var xe=[],$e=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]:checked');$e.forEach(function(Ze){var st=Ze.parentElement.textContent.trim(),ht=Ze.parentElement.querySelector(".third-party-note");ht&&(st=st.replace(ht.textContent,"").trim()),xe.push(st)});var it=document.querySelector('input[name="ecommerce_option"]:checked'),je=it?it.value:"none",nt=this.currentPricingData||{basePrice:0,addOns:[],discounts:[],ecommerceOption:je,ecommercePrice:0,total:0},Qe=nt.total,at=a("#sowCouponSelect"),Ye=at?at.value:"",pt=a("#sowDevDurationUnit")?a("#sowDevDurationUnit").value:"weeks",Xt=te&&parseInt(te)||null,Wt=a("#sowDeferredPayment")&&a("#sowDeferredPayment").checked,Oe={enabled:Wt,splitType:"lump_sum",dueDate:null,deferredAmount:0,lateFee:0,lateFeeWaived:!1,allowPartialPayments:!0,maintenanceDuringDeferral:!0,customSchedule:[],frequency:null,startDate:null,calculationMode:null,amountPerPayment:null,numberOfPayments:null,acknowledgmentSigned:!1,acknowledgmentDate:null};if(Wt){var De=document.querySelector('input[name="deferred_split"]:checked');if(Oe.splitType=De?De.value:"lump_sum",Oe.lateFeeWaived=a("#sowWaiveLateFee")&&a("#sowWaiveLateFee").checked,Oe.allowPartialPayments=a("#sowAllowPartialPayments")?a("#sowAllowPartialPayments").checked:!0,Oe.maintenanceDuringDeferral=a("#sowMaintenanceDuringDeferral")?a("#sowMaintenanceDuringDeferral").checked:!0,Oe.splitType==="custom"){var xt=[],Ge=document.querySelectorAll(".custom-payment-row");Ge.forEach(function(Ze){var st=Ze.querySelector(".custom-payment-amount"),ht=Ze.querySelector(".custom-payment-date"),Zt=parseFloat(st?st.value:0)||0,En=ht?ht.value:null;Zt>0&&xt.push({amount:Zt,dueDate:En})}),Oe.customSchedule=xt,Oe.deferredAmount=xt.reduce(function(Ze,st){return Ze+st.amount},0)}else if(Oe.splitType==="recurring"){Oe.deferredAmount=parseFloat(a("#sowRecurringTotalAmount")?a("#sowRecurringTotalAmount").value:0)||0,Oe.startDate=a("#sowRecurringStartDate")?a("#sowRecurringStartDate").value:null,Oe.frequency=a("#sowRecurringFrequency")?a("#sowRecurringFrequency").value:"biweekly",Oe.calculationMode=a("#sowRecurringCalcMode")?a("#sowRecurringCalcMode").value:"amount",Oe.calculationMode==="amount"?Oe.amountPerPayment=parseFloat(a("#sowRecurringPaymentAmount")?a("#sowRecurringPaymentAmount").value:0)||0:Oe.numberOfPayments=parseInt(a("#sowRecurringPaymentCount")?a("#sowRecurringPaymentCount").value:0)||0;var vt=Oe.calculationMode==="amount"?Oe.amountPerPayment:Oe.numberOfPayments;Oe.customSchedule=generateRecurringSchedule(Oe.deferredAmount,Oe.startDate,Oe.frequency,Oe.calculationMode,vt)}else Oe.deferredAmount=parseFloat(a("#sowDeferredAmount")?a("#sowDeferredAmount").value:0)||0,Oe.dueDate=a("#sowDeferredDueDate")?a("#sowDeferredDueDate").value:null;if(Oe.lateFee=Oe.lateFeeWaived?0:Oe.deferredAmount*.1,Oe.deferredAmount<=0){alert(e("sow.val.deferredAmount"));return}if(Oe.splitType==="lump_sum"&&!Oe.dueDate){alert(e("sow.val.deferredDueDate"));return}if(Oe.splitType==="custom"&&Oe.customSchedule.length===0){alert(e("sow.val.customSchedule"));return}if(Oe.splitType==="recurring"){if(!Oe.startDate){alert(e("sow.val.firstPaymentDate"));return}if(Oe.calculationMode==="amount"&&(!Oe.amountPerPayment||Oe.amountPerPayment<=0)){alert(e("sow.val.paymentAmount"));return}if(Oe.calculationMode==="count"&&(!Oe.numberOfPayments||Oe.numberOfPayments<2)){alert(e("sow.val.paymentCount"));return}if(Oe.customSchedule.length===0){alert(e("sow.val.scheduleError"));return}}if(Oe.deferredAmount>Qe){alert(e("sow.val.deferredExceedsTotal"));return}}var Nt={clientName:u?S:p,clientEmail:u?F||"":g||"",clientPhone:u?M(Se)||"":M(pe)||"",packageType:A,estimatedWeeks:Q?Xt||null:parseInt(B),startDate:Q?ce||null:$||null,features:xe,notes:K,maintenancePlan:Y,isRetroactive:Q,devDuration:Xt,devDurationUnit:pt,retroactiveEndDate:Q&&ce||null,couponCode:Ye||null,isBusinessEntity:u,businessName:u?S:"",entityType:u?_:"",stateOfFormation:u?D:"",representativeName:u?T:"",representativeTitle:u?L:"",payment:{total:Qe,deposit:Qe*.5,milestone1:Qe*.25,final:Qe*.25,breakdown:{basePrice:nt.basePrice,addOns:nt.addOns,discounts:nt.discounts,ecommerceOption:nt.ecommerceOption,ecommercePrice:nt.ecommercePrice,couponCode:Ye||null,couponDiscount:nt.couponDiscount||0},deferred:Oe,tracking:{depositPaid:!1,depositPaidDate:null,milestone1Paid:!1,milestone1PaidDate:null,finalPaid:!1,finalPaidDate:null,deferredPayments:[]}},createdBy:firebase.auth().currentUser.email,createdAt:firebase.firestore.FieldValue.serverTimestamp(),status:"draft"},St=this;firebase.firestore().collection("sow_documents").add(Nt).then(function(Ze){console.log("SOW saved with ID:",Ze.id),alert(e("sow.msg.saveSuccess")),a("#sowCreatorContainer").style.display="none",St.loadSOWDocuments()}).catch(function(Ze){console.error("Error saving SOW:",Ze),alert(e("sow.err.save")+Ze.message)})},N.prototype.showSOWSigningModal=function(u){var p=this;console.log("Opening SOW for signing:",u),firebase.firestore().collection("sow_documents").doc(u).get().then(function(g){if(!g.exists){alert(e("sow.err.notFound"));return}var b=g.data();if(b.id=g.id,b.clientSignature&&b.devSignature){alert(e("sow.msg.alreadySigned")),p.generateSOWPDF(b);return}p.renderSOWSigningModal(b)}).catch(function(g){console.error("Error loading SOW:",g),alert(e("sow.err.load")+g.message)})},N.prototype.renderSOWSigningModal=function(u){var p=this,g=firebase.auth().currentUser,b=g.email?g.email.toLowerCase():"",S=g.phoneNumber||"",_=b===this.DEVELOPER_EMAIL,D=b&&u.clientEmail&&b===u.clientEmail.toLowerCase()||S&&u.clientPhone&&S===u.clientPhone;if(!_&&!D){alert(e("sow.msg.noPermission"));return}var T=document.createElement("div");T.id="sowSigningModal",T.className="contract-modal show";var L='<div class="modal-overlay"></div><div class="modal-content"><button class="modal-close" id="closeSOWSigningModal"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button><div class="modal-header"><h1> '+e("sowSign.title")+'</h1><p class="modal-subtitle">'+u.clientName+" | "+u.packageType.toUpperCase()+'</p></div><div class="contract-form" "><div class="contract-section-inner"><h2>'+e("sowSign.summary")+"</h2><p><strong>"+e("sowSign.label.client")+"</strong> "+u.clientName+"</p><p><strong>"+e("sowSign.label.package")+"</strong> "+u.packageType+"</p><p><strong>"+e("sowSign.label.totalCost")+"</strong> $"+(u.payment?u.payment.total.toFixed(0):"0")+"</p><p><strong>"+e("sowSign.label.timeline")+"</strong> "+(u.estimatedWeeks||"TBD")+" "+e("sowTab.detail.weeks")+"</p><p><strong>"+e("sowSign.label.features")+"</strong> "+(u.features?u.features.length:0)+" "+e("sowSign.label.selected")+'</p></div><div class="signatures"><div class="signature-grid">';L+='<div class="signature-block" id="sowClientSignatureBlock"><h3>'+e("sowSign.clientSig")+u.clientName+"</h3>",u.clientSignature?L+='<div class="pending-notice"><p><strong> '+e("sowSign.clientSigned")+"</strong></p><p>"+e("sowSign.signedOn")+(u.clientSignedDate||"N/A")+'</p></div><div class="signature-pad-container"><canvas id="sowClientSigPad" class="signature-pad"></canvas></div>':D?L+='<div class="form-row"><div class="form-group"><label>'+e("sowSign.nameLabel")+'</label><input type="text" id="sowClientSignerName" value="'+u.clientName+'" required /></div><div class="form-group"><label>'+e("sowSign.dateLabel")+'</label><input type="date" id="sowClientSignDate" required /></div></div><div class="form-group"><label>'+e("sowSign.signatureLabel")+'</label><div class="signature-pad-container"><canvas id="sowClientSigPad" class="signature-pad"></canvas><button class="clear-btn" data-canvas="sowClientSigPad">'+e("sowSign.btn.clear")+"</button></div></div>":L+='<div class="pending-notice"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg><p><strong>'+e("sowSign.awaitingClient")+"</strong></p><p>"+e("sowSign.awaitingClientText")+"</p></div>",L+="</div>",L+='<div class="signature-block" id="sowDevSignatureBlock"><h3>'+e("sowSign.devSig")+"</h3>",u.devSignature?L+='<div class="pending-notice"><p><strong> '+e("sowSign.devSigned")+"</strong></p><p>"+e("sowSign.signedOn")+(u.devSignedDate||"N/A")+'</p></div><div class="signature-pad-container"><canvas id="sowDevSigPad" class="signature-pad"></canvas></div>':_?L+='<div class="form-row"><div class="form-group"><label>'+e("sowSign.devNameLabel")+'</label><input type="text" id="sowDevSignerName" value="Carlos Martin" required /></div><div class="form-group"><label>'+e("sowSign.devDateLabel")+'</label><input type="date" id="sowDevSignDate" required /></div></div><div class="form-group"><label>'+e("sowSign.devSignatureLabel")+'</label><div class="signature-pad-container"><canvas id="sowDevSigPad" class="signature-pad"></canvas><button class="clear-btn" data-canvas="sowDevSigPad">'+e("sowSign.btn.clear")+"</button></div></div>":L+='<div class="pending-notice"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg><p><strong>'+e("sowSign.awaitingDev")+"</strong></p><p>"+e("sowSign.awaitingDevText")+"</p></div>",L+="</div>",L+="</div></div>",L+='<div class="action-buttons">',u.clientSignature&&u.devSignature?L+='<button class="btn btn-primary" id="downloadSOWBtn"><span> '+e("sowSign.btn.downloadSigned")+"</span></button>":D&&!u.clientSignature?L+='<button class="btn btn-primary" id="submitSOWClientSig"><span> '+e("sowSign.btn.submitSignature")+"</span></button>":_&&!u.devSignature&&u.clientSignature&&(L+='<button class="btn btn-primary" id="submitSOWDevSig"><span> '+e("sowSign.btn.signSow")+"</span></button>"),L+="</div></div></div>",T.innerHTML=L,document.body.appendChild(T),document.body.classList.add("modal-open"),setTimeout(function(){p.initSOWSignaturePads(u,_,D)},100)},N.prototype.initSOWSignaturePads=function(u,p,g){var b=this,S=document.getElementById("sowClientSigPad"),_=document.getElementById("sowDevSigPad"),D=null,T=null;if(S){if(u.clientSignature)this.drawSignatureOnCanvas(S,u.clientSignature);else if(g){D=J(S);var L=document.getElementById("sowClientSignDate");L&&(L.value=new Date().toISOString().split("T")[0])}}if(_){if(u.devSignature)this.drawSignatureOnCanvas(_,u.devSignature);else if(p){T=J(_);var F=document.getElementById("sowDevSignDate");F&&(F.value=new Date().toISOString().split("T")[0])}}var U=document.querySelectorAll(".clear-btn");U.forEach(function(Y){Y.addEventListener("click",function(Q){Q.preventDefault();var te=this.getAttribute("data-canvas");te==="sowClientSigPad"&&D?D.clear():te==="sowDevSigPad"&&T&&T.clear()})});var A=document.getElementById("closeSOWSigningModal");A&&A.addEventListener("click",function(){var Y=document.getElementById("sowSigningModal");Y&&Y.remove(),document.body.classList.remove("modal-open")});var B=document.getElementById("submitSOWClientSig");B&&B.addEventListener("click",function(Y){Y.preventDefault(),b.submitSOWClientSignature(u.id,D)});var $=document.getElementById("submitSOWDevSig");$&&$.addEventListener("click",function(Y){Y.preventDefault(),b.submitSOWDeveloperSignature(u.id,T)});var K=document.getElementById("downloadSOWBtn");K&&K.addEventListener("click",function(Y){Y.preventDefault(),b.generateSOWPDF(u)})},N.prototype.submitSOWClientSignature=function(u,p){if(!p||p.isEmpty()){alert(e("sow.val.signature"));return}var g=document.getElementById("sowClientSignerName").value.trim(),b=document.getElementById("sowClientSignDate").value;if(!g||!b){alert(e("sow.val.fillAllFields"));return}var S=document.getElementById("submitSOWClientSig");S&&(S.disabled=!0,S.innerHTML="<span>"+e("sow.btn.submitting")+"</span>");var _={clientSignature:p.toDataURL(),clientSignerName:g,clientSignedDate:b,clientSignedTimestamp:firebase.firestore.FieldValue.serverTimestamp(),status:"pending_developer"};firebase.firestore().collection("sow_documents").doc(u).update(_).then(function(){console.log(" Client signed SOW"),alert(e("sow.msg.clientSignSuccess"));var D=document.getElementById("sowSigningModal");D&&D.remove(),document.body.classList.remove("modal-open")}).catch(function(D){console.error("Error signing SOW:",D),alert(e("sow.err.sign")+D.message),S&&(S.disabled=!1,S.innerHTML="<span>"+e("sow.btn.submitSignature")+"</span>")})},N.prototype.submitSOWDeveloperSignature=function(u,p){var g=this;if(!p||p.isEmpty()){alert(e("sow.val.signature"));return}var b=document.getElementById("sowDevSignerName").value.trim(),S=document.getElementById("sowDevSignDate").value;if(!b||!S){alert(e("sow.val.fillAllFields"));return}var _=document.getElementById("submitSOWDevSig");_&&(_.disabled=!0,_.innerHTML="<span>"+e("sow.btn.signing")+"</span>");var D={devSignature:p.toDataURL(),devSignerName:b,devSignedDate:S,devSignedTimestamp:firebase.firestore.FieldValue.serverTimestamp(),status:"approved"};firebase.firestore().collection("sow_documents").doc(u).update(D).then(function(){console.log(" Developer signed SOW"),alert(e("sow.msg.fullySigned"));var T=document.getElementById("sowSigningModal");T&&T.remove(),document.body.classList.remove("modal-open"),g.isDeveloper&&g.showDeveloperDashboard()}).catch(function(T){console.error("Error signing SOW:",T),alert(e("sow.err.sign")+T.message),_&&(_.disabled=!1,_.innerHTML="<span>"+e("sow.btn.signSow")+"</span>")})},N.prototype.generateSOWPDF=function(u){var p,g,b,S,_,D,T,L,F,U,A,B,$,K,Y;if(u)p=u.clientName||"Client Name",g=u.clientEmail||u.clientPhone||"N/A",b=u.packageType||"professional",S=u.estimatedWeeks||"TBD",_=u.startDate||null,D=u.notes||"",T=u.maintenancePlan||"none",L=u.features||[],F=u.id||"DRAFT",U=u.clientSignature||"",A=u.clientSignerName||p,B=u.clientSignedDate||"",$=u.devSignature||"",K=u.devSignerName||"Carlos Martin",Y=u.devSignedDate||"";else{var Q=a("#sowEntityTypeToggle"),te=Q&&Q.checked,ce=a("#sowClientName"),pe=a("#sowClientEmail"),ge=a("#sowClientPhone"),Se=a("#sowBusinessName"),Ee=a("#sowBusinessEmail"),re=a("#sowBusinessPhone"),xe=a("#sowPackage"),$e=a("#sowWeeks"),it=a("#sowStartDate"),je=a("#sowNotes"),nt=a("#sowMaintenance");if(!xe){alert(e("sow.val.selectPackage"));return}if(te){p=Se?Se.value.trim():"";var Qe=Ee?Ee.value.trim():"",at=re?re.value.trim():"";g=Qe||at||"N/A"}else{p=ce?ce.value.trim():"";var Ye=pe?pe.value.trim():"",pt=ge?ge.value.trim():"";g=Ye||pt||"N/A"}if(!p){alert(e(te?"sow.val.fillBusinessName":"sow.val.fillClientName"));return}b=xe.value||"professional",S=$e?$e.value:"TBD",_=it?it.value:null,D=je?je.value.trim():"",T=nt?nt.value:"none",F="DRAFT",U="",A=te&&a("#sowRepName")?a("#sowRepName").value.trim():p,B="",$="",K="Carlos Martin",Y="",L=[],c('.sow-checkboxes input[type="checkbox"]:checked').forEach(function(Ke){var un=Ke.parentElement.textContent.trim();L.push(un)})}var Xt=g,Wt=!1,Oe=null,De="weeks";if(u&&u.isRetroactive!==void 0)Wt=u.isRetroactive,Oe=u.devDuration||null,De=u.devDurationUnit||"weeks";else{var xt=a("#sowRetroactive");Wt=xt&&xt.checked,Oe=a("#sowDevDuration")&&parseInt(a("#sowDevDuration").value)||null,De=a("#sowDevDurationUnit")?a("#sowDevDurationUnit").value:"weeks"}var Ge=!1,vt="",Nt="",St="",Ze="",st="";if(u)Ge=u.isBusinessEntity||!1,vt=u.businessName||"",Nt=u.entityType||"",St=u.stateOfFormation||"",Ze=u.representativeName||"",st=u.representativeTitle||"";else{var ht=a("#sowEntityTypeToggle");Ge=ht&&ht.checked,Ge&&(vt=a("#sowBusinessName")?a("#sowBusinessName").value.trim():"",Nt=a("#sowEntityType")?a("#sowEntityType").value:"",St=a("#sowStateOfFormation")?a("#sowStateOfFormation").value.trim():"",Ze=a("#sowRepName")?a("#sowRepName").value.trim():"",st=a("#sowRepTitle")?a("#sowRepTitle").value.trim():"")}if(!p||!b){alert((Ge?"Business Name":"Client Name")+" and Package Tier are required to generate PDF");return}var Zt={essential:{name:e("pkgDef.essential.name"),priceRange:e("pkgDef.essential.priceRange"),defaultPrice:2e3,timeline:e("pkgDef.essential.timeline"),description:e("pkgDef.essential.desc"),includes:[e("pkgDef.essential.i1"),e("pkgDef.essential.i2"),e("pkgDef.essential.i3"),e("pkgDef.essential.i4"),e("pkgDef.essential.i5"),e("pkgDef.essential.i6"),e("pkgDef.essential.i7")],notIncluded:[e("pkgDef.essential.ni1"),e("pkgDef.essential.ni2"),e("pkgDef.essential.ni3"),e("pkgDef.essential.ni4"),e("pkgDef.essential.ni5")]},starter:{name:e("pkgDef.starter.name"),priceRange:e("pkgDef.starter.priceRange"),defaultPrice:4500,timeline:e("pkgDef.starter.timeline"),description:e("pkgDef.starter.desc"),includes:[e("pkgDef.starter.i1"),e("pkgDef.starter.i2"),e("pkgDef.starter.i3"),e("pkgDef.starter.i4"),e("pkgDef.starter.i5"),e("pkgDef.starter.i6"),e("pkgDef.starter.i7"),e("pkgDef.starter.i8"),e("pkgDef.starter.i9"),e("pkgDef.starter.i10")],notIncluded:[e("pkgDef.starter.ni1"),e("pkgDef.starter.ni2"),e("pkgDef.starter.ni3"),e("pkgDef.starter.ni4")]},growth:{name:e("pkgDef.growth.name"),priceRange:e("pkgDef.growth.priceRange"),defaultPrice:9e3,timeline:e("pkgDef.growth.timeline"),description:e("pkgDef.growth.desc"),includes:[e("pkgDef.growth.i1"),e("pkgDef.growth.i2"),e("pkgDef.growth.i3"),e("pkgDef.growth.i4"),e("pkgDef.growth.i5"),e("pkgDef.growth.i6"),e("pkgDef.growth.i7"),e("pkgDef.growth.i8")],notIncluded:[e("pkgDef.growth.ni1"),e("pkgDef.growth.ni2"),e("pkgDef.growth.ni3"),e("pkgDef.growth.ni4")]},professional:{name:e("pkgDef.professional.name"),priceRange:e("pkgDef.professional.priceRange"),defaultPrice:18500,timeline:e("pkgDef.professional.timeline"),description:e("pkgDef.professional.desc"),includes:[e("pkgDef.professional.i1"),e("pkgDef.professional.i2"),e("pkgDef.professional.i3"),e("pkgDef.professional.i4"),e("pkgDef.professional.i5"),e("pkgDef.professional.i6"),e("pkgDef.professional.i7"),e("pkgDef.professional.i8"),e("pkgDef.professional.i9"),e("pkgDef.professional.i10"),e("pkgDef.professional.i11")],notIncluded:[e("pkgDef.professional.ni1"),e("pkgDef.professional.ni2"),e("pkgDef.professional.ni3"),e("pkgDef.professional.ni4")]},enterprise:{name:e("pkgDef.enterprise.name"),priceRange:e("pkgDef.enterprise.priceRange"),defaultPrice:37500,timeline:e("pkgDef.enterprise.timeline"),description:e("pkgDef.enterprise.desc"),includes:[e("pkgDef.enterprise.i1"),e("pkgDef.enterprise.i2"),e("pkgDef.enterprise.i3"),e("pkgDef.enterprise.i4"),e("pkgDef.enterprise.i5"),e("pkgDef.enterprise.i6"),e("pkgDef.enterprise.i7"),e("pkgDef.enterprise.i8"),e("pkgDef.enterprise.i9"),e("pkgDef.enterprise.i10"),e("pkgDef.enterprise.i11"),e("pkgDef.enterprise.i12"),e("pkgDef.enterprise.i13")],notIncluded:[e("pkgDef.enterprise.ni1"),e("pkgDef.enterprise.ni2"),e("pkgDef.enterprise.ni3")]},custom:{name:e("pkgDef.custom.name"),priceRange:e("pkgDef.custom.priceRange"),defaultPrice:0,timeline:e("pkgDef.custom.timeline"),description:e("pkgDef.custom.desc"),includes:[e("pkgDef.custom.i1")],notIncluded:[]}},En={none:{name:e("maint.none.name"),price:"$0/month",description:e("maint.none.desc"),includes:[]},basic:{name:e("maint.basic.name"),price:e("maint.basic.price"),description:e("maint.basic.desc"),includes:[e("maint.basic.i1"),e("maint.basic.i2"),e("maint.basic.i3"),e("maint.basic.i4"),e("maint.basic.i5"),e("maint.basic.i6")]},professional:{name:e("maint.professional.name"),price:e("maint.professional.price"),description:e("maint.professional.desc"),includes:[e("maint.professional.i1"),e("maint.professional.i2"),e("maint.professional.i3"),e("maint.professional.i4"),e("maint.professional.i5"),e("maint.professional.i6"),e("maint.professional.i7"),e("maint.professional.i8")]},premium:{name:e("maint.premium.name"),price:e("maint.premium.price"),description:e("maint.premium.desc"),includes:[e("maint.premium.i1"),e("maint.premium.i2"),e("maint.premium.i3"),e("maint.premium.i4"),e("maint.premium.i5"),e("maint.premium.i6"),e("maint.premium.i7"),e("maint.premium.i8"),e("maint.premium.i9"),e("maint.premium.i10")]}},rn=Zt[b]||Zt.custom,Pn=En[T]||En.none,yt=0;if(u&&u.payment&&u.payment.total)yt=u.payment.total;else if(b==="custom"&&u&&u.customPrice)yt=parseFloat(u.customPrice)||0;else if(b==="custom"){var ii=a("#sowCustomPrice");yt=ii&&parseFloat(ii.value)||0}else yt=rn.defaultPrice;var Dn=yt*.5,Ln=yt*.25,yn=yt*.25,wt=u&&u.payment&&u.payment.breakdown?u.payment.breakdown:null,wn=wt?wt.basePrice:yt,jt=wt?wt.addOns:[],bn=wt?wt.discounts:[];wt&&wt.ecommerceOption,wt&&wt.ecommercePrice;var xn=wt?wt.couponCode:null,Hn=wt?wt.couponDiscount:0,Sn=typeof t=="function"&&t()==="es"?"es-MX":"en-US",sn=new Date().toLocaleDateString(Sn,{year:"numeric",month:"long",day:"numeric"}),Mn=_?new Date(_).toLocaleDateString(Sn,{year:"numeric",month:"long",day:"numeric"}):e("pdf.sow.toBeDeterm"),Ce='<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=1024"><title>Statement of Work - '+p+'</title><link rel="icon" type="image/png" href="https://scarlo.dev/favicons/favicon-96x96.png"><style>* { margin: 0; padding: 0; box-sizing: border-box; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; text-size-adjust: 100%; }body { font-family: "Times New Roman", Times, serif; font-size: 10pt; line-height: 1.35; color: #000; background: #fff; padding: 0.5in 0.75in; }.sow-container { max-width: 900px; margin: 0 auto; }h1 { font-size: 18pt; text-align: center; margin-bottom: 8px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }h2 { font-size: 10pt; margin-top: 12px; margin-bottom: 6px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #000; padding-bottom: 2px; }h3 { font-size: 10pt; margin-top: 8px; margin-bottom: 4px; font-weight: bold; }p { margin-bottom: 6px; text-align: justify; }ul, ol { margin-left: 20px; margin-bottom: 6px; }li { margin-bottom: 2px; }.header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #000; }.subtitle { font-size: 11pt; margin-top: 6px; font-style: italic; }.meta-date { font-size: 9pt; margin-top: 6px; font-style: italic; }.info-box { padding: 8px 12px; border: 1px solid #000; border-left: 3px solid #000; margin: 8px 0; page-break-inside: avoid; break-inside: avoid; }.info-box h3 { margin-top: 0; }.info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 4px 20px; margin-top: 6px; }.info-item { font-size: 9pt; word-wrap: break-word; overflow-wrap: break-word; }.section { margin-bottom: 10px; page-break-inside: avoid; break-inside: avoid; }.deferred-terms { page-break-inside: avoid; break-inside: avoid; }.section-compact { page-break-inside: avoid; break-inside: avoid; }.package-box { border: 1px solid #000; padding: 8px 12px; margin: 8px 0; page-break-inside: avoid; break-inside: avoid; }.package-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; padding-bottom: 6px; border-bottom: 1px solid #000; }.package-name { font-size: 11pt; font-weight: bold; }.package-price { font-size: 10pt; font-weight: bold; }.feature-list { columns: 2; column-gap: 20px; font-size: 9pt; }.feature-list li { break-inside: avoid; margin-bottom: 1px; }.not-included { border-left: 3px solid #000; }.not-included h3 { font-style: italic; }.payment-table { width: 100%; border-collapse: collapse; margin: 8px 0; font-size: 9pt; page-break-inside: avoid; break-inside: avoid; }.payment-table th, .payment-table td { border: 1px solid #000; padding: 5px 8px; text-align: left; }.payment-table th { font-weight: bold; background: #f5f5f5; }.payment-table .total-row { font-weight: bold; font-size: 10pt; border-top: 2px solid #000; }.timeline-box { border: 1px solid #000; padding: 8px 12px; margin: 8px 0; page-break-inside: avoid; break-inside: avoid; }.timeline-header { font-weight: bold; margin-bottom: 8px; font-size: 10pt; border-bottom: 1px solid #000; padding-bottom: 4px; }.milestone { margin-bottom: 6px; padding-left: 8px; border-left: 2px solid #000; }.milestone:last-child { margin-bottom: 0; }.milestone-title { font-weight: bold; font-size: 9pt; }.milestone-desc { font-size: 9pt; }.assumptions-box { border: 1px solid #000; border-left: 3px solid #000; padding: 8px 12px; margin: 8px 0; page-break-inside: avoid; break-inside: avoid; }.assumptions-box h3 { margin-top: 0; font-size: 9pt; }.assumptions-box li { font-size: 9pt; }.legal-notice { border: 1px solid #000; padding: 8px 12px; margin: 10px 0; font-size: 9pt; }.signature-section { margin-top: 20px; page-break-before: always; }.signature-grid { display: flex; justify-content: space-between; gap: 30px; margin-top: 15px; }.signature-block { flex: 1; }.signature-block h3 { font-size: 9pt; margin-bottom: 6px; }.signature-line { border-bottom: 1px solid #000; height: 50px; margin: 6px 0; display: flex; align-items: flex-end; justify-content: center; }.signature-line img { max-height: 45px; max-width: 100%; filter: invert(1) grayscale(1); }.signature-label { font-size: 8pt; font-style: italic; margin-top: 3px; }.signature-name { font-weight: bold; margin-top: 6px; font-size: 9pt; }.signature-date { font-size: 9pt; margin-top: 3px; }.footer { margin-top: 20px; text-align: center; font-size: 8pt; border-top: 1px solid #000; padding-top: 10px; }.sow-id { font-size: 7pt; margin-top: 4px; font-style: italic; }.highlight { font-weight: bold; }.maintenance-box { border: 1px solid #000; padding: 8px 12px; margin: 8px 0; page-break-inside: avoid; break-inside: avoid; }.maintenance-header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 6px; border-bottom: 1px solid #000; margin-bottom: 6px; }.maintenance-name { font-weight: bold; font-size: 10pt; }.maintenance-price { font-weight: bold; }.logo { max-width: 180px; max-height: 60px; margin-bottom: 15px; }@media print { body { padding: 0; margin: 0; orphans: 3; widows: 3; } .sow-container { max-width: 100%; } .info-box, .package-box, .timeline-box, .maintenance-box, .legal-notice, .deferred-terms, .assumptions-box, .section-compact { page-break-inside: avoid !important; break-inside: avoid !important; } }@page { margin: 0.5in 0.6in; size: letter; }</style></head><body><div class="sow-container"><div class="header"><img src="'+x()+'" alt="Scarlo Logo" class="logo" /><h1>'+e("pdf.sow.title")+'</h1><div class="subtitle">'+e("pdf.sow.subtitle")+'</div><div class="meta-date">'+e("pdf.sow.generated")+" "+sn+'</div></div><div class="legal-notice"><strong>'+e("pdf.sow.incorporation")+"</strong> "+e("pdf.sow.incorporationText")+" "+p+e("pdf.sow.incorporationText2")+'</div><div class="section"><h2>'+e("pdf.sow.clientInfo")+'</h2><div class="info-box"><div class="info-grid">'+(Ge?'<div class="info-item"><strong>'+e("pdf.sow.businessName")+"</strong> "+vt+'</div><div class="info-item"><strong>'+e("pdf.sow.entityType")+"</strong> "+Nt+(St?" ("+St+")":"")+'</div><div class="info-item"><strong>'+e("pdf.sow.representative")+"</strong> "+Ze+", "+st+"</div>":'<div class="info-item"><strong>'+e("pdf.sow.clientName")+"</strong> "+p+"</div>")+'<div class="info-item"><strong>'+e("pdf.sow.contact")+"</strong> "+Xt+'</div><div class="info-item"><strong>'+e("pdf.sow.packageSelected")+"</strong> "+rn.name+"</div>"+(Wt?'<div class="info-item"><strong>'+e("pdf.sow.devDuration")+"</strong> "+(Oe||S)+" "+De+"</div>":'<div class="info-item"><strong>'+e("pdf.sow.estimatedTimeline")+"</strong> "+S+" "+e("sow.weeks")+"</div>")+'<div class="info-item"><strong>'+e("pdf.sow.estimatedFinalRevision")+"</strong> "+Mn+'</div><div class="info-item"><strong>'+e("pdf.sow.sowReference")+"</strong> "+F+'</div></div></div></div><div class="section"><h2>'+e("pdf.sow.projectOverview")+'</h2><div class="package-box"><div class="package-header"><span class="package-name">'+rn.name+'</span><span class="package-price">'+rn.priceRange+'</span></div><p style="font-size: 9pt; margin-bottom: 10px;">'+rn.description+'</p><h3 style="font-size: 9pt; margin-top: 10px;">'+e("pdf.sow.includedInPackage")+'</h3><ul class="feature-list">';b==="custom"&&jt&&jt.length>0?jt.forEach(function(Ke){var un=Ke.key?o(Ke.key,Ke.label):s(Ke.label);Ce+="<li>"+un+"</li>"}):rn.includes.forEach(function(Ke){Ce+="<li>"+Ke+"</li>"}),Ce+="</ul></div></div>";var It=jt&&b!=="custom"?jt.filter(function(Ke){return Ke.price>0}):[];It.length>0&&(Ce+='<div class="section"><h2>3. '+e("pdf.sow.additionalFeatures").replace(/^\d+\.\s*/,"")+'</h2><div class="info-box"><ul class="feature-list">',It.forEach(function(Ke){var un=Ke.key?o(Ke.key,Ke.label):s(Ke.label);Ce+="<li>"+un+"</li>"}),Ce+="</ul></div></div>"),D&&D.trim()&&(Ce+='<div class="section"><h2>'+(It.length>0?"4":"3")+". "+e("pdf.sow.specialRequirements")+'</h2><div class="info-box"><p style="font-size: 9pt; margin-bottom: 0;">'+D+"</p></div></div>");var ot=3+(It.length>0?1:0)+(D&&D.trim()?1:0);Wt||(Ce+='<div class="section"><h2>'+ot+". "+e("pdf.sow.projectTimeline")+'</h2><div class="timeline-box"><div class="timeline-header">'+e("pdf.sow.estimatedDuration")+" "+S+" "+e("pdf.sow.weeks")+'</div><div class="milestone"><div class="milestone-title">'+e("pdf.sow.phase1Title")+'</div><div class="milestone-desc">'+e("pdf.sow.phase1Desc")+'</div></div><div class="milestone"><div class="milestone-title">'+e("pdf.sow.phase2Title")+'</div><div class="milestone-desc">'+e("pdf.sow.phase2Desc")+" <strong>"+e("pdf.sow.phase2Payment")+'</strong></div></div><div class="milestone"><div class="milestone-title">'+e("pdf.sow.phase3Title")+Math.max(4,parseInt(S)-2||4)+')</div><div class="milestone-desc">'+e("pdf.sow.phase3Desc")+'</div></div><div class="milestone"><div class="milestone-title">'+e("pdf.sow.phase4Title")+'</div><div class="milestone-desc">'+e("pdf.sow.phase4Desc")+" <strong>"+e("pdf.sow.phase4Payment")+'</strong></div></div></div><p style="font-size: 9pt; font-style: italic; margin-top: 6px;">'+e("pdf.sow.timelineNote")+"</p></div>",ot++),Ce+='<div class="section"><h2>'+ot+". "+e("pdf.sow.pricingSummary")+'</h2><table class="payment-table" style="width: 100%;"><tbody>',Ce+='<tr><td style="width: 70%;"><strong>'+rn.name+'</strong></td><td style="width: 30%; text-align: right;"><strong>$'+wn.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr>",jt&&jt.length>0&&jt.forEach(function(Ke){var un=Ke.key?o(Ke.key,Ke.label):s(Ke.label),Ei=Ke.price===0?'<span style="color: #2e7d32; font-style: italic;">'+e("pdf.sow.included")+"</span>":'<span style="color: #2e7d32;">+$'+Ke.price.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</span>";Ce+="<tr><td>"+un+'</td><td style="text-align: right;">'+Ei+"</td></tr>"}),bn&&bn.length>0&&bn.forEach(function(Ke){var un=Ke.key?o(Ke.key,Ke.label):s(Ke.label);Ce+="<tr><td>"+un+' <span style="font-size: 8pt; color: #666;">'+e("pdf.sow.removed")+'</span></td><td style="text-align: right; color: #c62828;">-$'+Ke.price.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</td></tr>"}),xn&&Hn>0&&(Ce+="<tr><td>"+e("pdf.sow.coupon")+" "+xn+'</td><td style="text-align: right; color: #c62828;">-$'+Hn.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</td></tr>"),Ce+='<tr style="border-top: 2px solid #333;"><td><strong>'+e("pdf.sow.total")+'</strong></td><td style="text-align: right;"><strong>$'+yt.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr></tbody></table></div>",ot++;var Bt={essential:{local:"$1,500 - $4,000",localHigh:4e3},starter:{local:"$4,000 - $8,000",localHigh:8e3},growth:{local:"$8,000 - $15,000",localHigh:15e3},professional:{local:"$15,000 - $35,000",localHigh:35e3},enterprise:{local:"$35,000 - $80,000",localHigh:8e4}},An;b==="custom"?yt<=3e3?An=Bt.essential:yt<=6e3?An=Bt.starter:yt<=12e3?An=Bt.growth:yt<=25e3?An=Bt.professional:An=Bt.enterprise:An=Bt[b]||Bt.starter;var Zi=Math.max(0,An.localHigh-yt);if(Ce+='<div class="section" style="page-break-inside: avoid;"><h2>'+ot+". "+e("pdf.sow.valueSummary")+'</h2><div style="border: 2px solid #000; padding: 12px 15px; margin: 8px 0;"><div style="display: flex; justify-content: space-between; align-items: center; padding-bottom: 10px; border-bottom: 1px solid #ccc; margin-bottom: 10px;"><div style="font-size: 9pt;"><div style="color: #666; margin-bottom: 2px;">'+e("pdf.sow.marketRatesIntro")+'</div><div style="font-size: 11pt; font-weight: bold;">'+An.local+'</div></div><div style="text-align: right;"><div style="color: #666; font-size: 9pt; margin-bottom: 2px;">'+e("pdf.sow.yourQuote")+'</div><div style="font-size: 14pt; font-weight: bold;">$'+yt.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</div></div></div>"+(Zi>500?'<div style="background: #f0f7f0; padding: 8px 12px; margin-bottom: 10px; text-align: center; border-left: 3px solid #2e7d32;"><span style="font-size: 9pt; color: #666;">'+e("pdf.sow.potentialSavings")+' </span><strong style="font-size: 11pt; color: #2e7d32;">'+e("pdf.sow.upTo")+" $"+Zi.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></div>":"")+'<div style="font-size: 9pt;"><div style="margin-bottom: 4px;"><strong style="color: #2e7d32;"></strong> <strong>'+e("pdf.sow.valueProp1")+"</strong> "+e("pdf.sow.valueProp1Desc")+'</div><div style="margin-bottom: 4px;"><strong style="color: #2e7d32;"></strong> <strong>'+e("pdf.sow.valueProp2")+"</strong> "+e("pdf.sow.valueProp2Desc")+'</div><div><strong style="color: #2e7d32;"></strong> <strong>'+e("pdf.sow.valueProp3")+"</strong> "+e("pdf.sow.valueProp3Desc")+'</div></div></div><p style="font-size: 7pt; color: #888; margin-top: 4px; margin-bottom: 0;">'+e("pdf.sow.marketNote")+' <a href="https://scarlo.dev/pricing" target="_blank" style="color: #2e7d32; text-decoration: underline;">scarlo.dev/pricing</a></p></div>',ot++,Wt?Ce+='<div class="section"><h2>'+ot+". "+e("pdf.sow.paymentSummary")+'</h2><div class="info-box" style="text-align: center; padding: 15px;"><div style="font-size: 10pt; color: #666; margin-bottom: 5px;">'+e("pdf.sow.totalProjectCost")+'</div><div style="font-size: 16pt; font-weight: bold;">$'+yt.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+'</div></div><p style="font-size: 9pt; font-style: italic;">'+e("pdf.sow.paymentTermsNote")+"</p></div>":Ce+='<div class="section"><h2>'+ot+". "+e("pdf.sow.paymentStructure")+'</h2><table class="payment-table"><thead><tr><th style="width: 25%;">'+e("pdf.sow.payment")+'</th><th style="width: 45%;">'+e("pdf.sow.description")+'</th><th style="width: 15%;">'+e("pdf.sow.percentage")+'</th><th style="width: 15%;">'+e("pdf.sow.amount")+"</th></tr></thead><tbody><tr><td><strong>"+e("pdf.sow.deposit")+"</strong></td><td>"+e("pdf.sow.beforeWorkBegins")+"</td><td>50%</td><td><strong>$"+Dn.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr><tr><td><strong>"+e("pdf.sow.milestone")+"</strong></td><td>"+e("pdf.sow.uponDesignApproval")+"</td><td>25%</td><td><strong>$"+Ln.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr><tr><td><strong>"+e("pdf.sow.final")+"</strong></td><td>"+e("pdf.sow.priorToDeployment")+"</td><td>25%</td><td><strong>$"+yn.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+'</strong></td></tr><tr class="total-row"><td colspan="2"><strong>'+e("pdf.sow.totalProjectCostLabel")+"</strong></td><td><strong>100%</strong></td><td><strong>$"+yt.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+'</strong></td></tr></tbody></table><p style="font-size: 9pt; font-style: italic;">'+e("pdf.sow.latePaymentsNote")+"</p></div>",ot++,u.payment&&u.payment.deferred&&u.payment.deferred.enabled){var et=u.payment.deferred;Ce+='<div class="section" style="page-break-inside: auto; break-inside: auto;"><div style="page-break-inside: avoid; break-inside: avoid;"><h2>'+ot+". "+e("pdf.sow.deferredPaymentAgreement")+'</h2><div style="background: #fff8e6; border: 2px solid #f59e0b; padding: 10px; margin-bottom: 10px;"><p style="font-size: 9pt; margin: 0 0 5px; color: #92400e; font-weight: bold;">'+e("pdf.sow.deferredPaymentTerms")+'</p><p style="font-size: 8pt; margin: 0; color: #78350f;">'+e("pdf.sow.deferredPaymentIntro")+'</p></div></div><table class="payment-table"><thead><tr><th style="width: 50%;">'+e("pdf.sow.description")+'</th><th style="width: 25%;">'+e("pdf.sow.dueDate")+'</th><th style="width: 25%;">'+e("pdf.sow.amount")+"</th></tr></thead><tbody>";var le={weekly:e("freq.weekly"),biweekly:e("freq.biweekly"),semimonthly:e("freq.semimonthly"),monthly:e("freq.monthly"),bimonthly:e("freq.bimonthly")};if((et.splitType==="custom"||et.splitType==="recurring")&&et.customSchedule&&et.customSchedule.length>0){if(et.splitType==="recurring"&&et.frequency){var ae=le[et.frequency]||et.frequency;Ce+='<tr style="background: #e0f2fe;"><td colspan="3" style="font-size: 8pt; color: #0369a1; padding: 6px 8px;"><strong>'+e("pdf.sow.paymentPlan")+"</strong> "+et.customSchedule.length+" "+ae.toLowerCase()+" "+e("pdf.sow.paymentsOf")+" $"+(et.customSchedule[0].amount||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</td></tr>"}et.customSchedule.forEach(function(Ke,un){var Ei=Ke.dueDate?new Date(Ke.dueDate).toLocaleDateString(Sn,{year:"numeric",month:"long",day:"numeric"}):e("common.tbd");Ce+="<tr><td>"+e("pdf.sow.paymentNum")+" "+(un+1)+"</td><td>"+Ei+"</td><td><strong>$"+(Ke.amount||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr>"})}else{var Ie=et.dueDate?new Date(et.dueDate).toLocaleDateString(Sn,{year:"numeric",month:"long",day:"numeric"}):e("common.tbd");Ce+="<tr><td>"+e("pdf.sow.deferredLumpSum")+"</td><td>"+Ie+"</td><td><strong>$"+(et.deferredAmount||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr>"}Ce+='<tr class="total-row"><td colspan="2"><strong>'+e("pdf.sow.totalDeferredAmount")+"</strong></td><td><strong>$"+(et.deferredAmount||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr>";var Fe=et.lateFeeWaived||et.feeWaived,Te=et.deferredAmount*.1;Ce+='<tr style="background: #fef3c7;"><td>'+e("pdf.sow.lateFee10")+(Fe?' <em style="color:#666;">('+e("pdf.sow.waived")+")</em>":"")+'</td><td style="font-size: 8pt; color: #92400e;">'+e("pdf.sow.ifPaymentLate")+"</td><td>"+(Fe?"<s>$"+Te.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</s> $0":"<strong>$"+Te.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong>")+"</td></tr></tbody></table>";var Le=et.splitType==="recurring"||et.splitType==="custom"&&et.customSchedule&&et.customSchedule.length>1,Be=Fe?e("pdf.sow.term.lateFeeWaived"):Le?e("pdf.sow.term.lateFeeRecurring"):e("pdf.sow.term.lateFeeLump1")+"$"+Te.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+e("pdf.sow.term.lateFeeLump2");Ce+='<div class="deferred-terms"><h3 style="font-size: 9pt; margin-top: 10px; margin-bottom: 5px;">'+e("pdf.sow.termsAndConditions")+'</h3><ol style="font-size: 8pt; margin: 5px 0; padding-left: 18px; line-height: 1.3;"><li><strong>'+e("pdf.sow.term.dueDateTitle")+"</strong> "+e("pdf.sow.term.dueDateText")+"</li><li><strong>"+e("pdf.sow.term.lateFeeTitle")+"</strong> "+Be+"</li><li><strong>"+e("pdf.sow.term.interestTitle")+"</strong> "+e("pdf.sow.term.interestText")+"</li><li><strong>"+e("pdf.sow.term.suspensionTitle")+"</strong> "+e("pdf.sow.term.suspensionText")+"</li><li><strong>"+e("pdf.sow.term.collectionTitle")+"</strong> "+e("pdf.sow.term.collectionText")+"</li><li><strong>"+e("pdf.sow.term.ipRightsTitle")+"</strong> "+e("pdf.sow.term.ipRightsText")+"</li><li><strong>"+e("pdf.sow.term.defaultTitle")+"</strong> "+e("pdf.sow.term.defaultText")+"</li>",et.allowPartialPayments&&(Ce+="<li><strong>"+e("pdf.sow.term.partialTitle")+"</strong> "+e("pdf.sow.term.partialText")+"</li>"),et.maintenanceDuringDeferral?Ce+="<li><strong>"+e("pdf.sow.term.maintTitle")+"</strong> "+e("pdf.sow.term.maintDuringText")+"</li>":Ce+="<li><strong>"+e("pdf.sow.term.maintTitle")+"</strong> "+e("pdf.sow.term.maintDeferredText")+"</li>",Ce+="<li><strong>"+e("pdf.sow.term.noticeTitle")+"</strong> "+e("pdf.sow.term.noticeText")+"</li></ol></div></div>",ot++}if(Ce+='<div class="section"><h2>'+ot+". "+e("pdf.sow.ongoingMaintenance")+'</h2><div class="maintenance-box"><div class="maintenance-header"><span class="maintenance-name">'+Pn.name+'</span><span class="maintenance-price">'+Pn.price+'</span></div><p style="font-size: 9pt; margin: 10px 0;">'+Pn.description+"</p>",T==="none"&&(Ce+='<div style="background: #fff3cd; border: 2px solid #856404; padding: 12px; margin: 10px 0; border-radius: 4px;"><p style="font-size: 9pt; margin: 0; color: #856404; font-weight: bold;">'+e("pdf.sow.importantNotice")+'</p><p style="font-size: 9pt; margin: 5px 0 0; color: #856404;">'+e("pdf.sow.noMaintenanceWarning")+"</p></div>"),Pn.includes&&Pn.includes.length>0&&(Ce+='<h3 style="font-size: 9pt; margin-top: 10px;">'+e("pdf.sow.maintenanceIncludes")+"</h3><ul>",Pn.includes.forEach(function(Ke){Ce+="<li>"+Ke+"</li>"}),Ce+="</ul>"),Ce+="</div>",T==="none"?Ce+='<p style="font-size: 8pt; font-style: italic;">'+e("pdf.sow.maintFooterNone")+"</p>":Ce+='<p style="font-size: 8pt; font-style: italic;">'+e("pdf.sow.maintFooterActive")+"</p>",Ce+="</div>",ot++,Ce+='<div class="section"><h2>'+ot+". "+e("pdf.sow.assumptionsDeps")+'</h2><div class="assumptions-box"><ul><li><strong>'+e("pdf.sow.assume.contentTitle")+"</strong> "+e("pdf.sow.assume.contentText")+"</li><li><strong>"+e("pdf.sow.assume.feedbackTitle")+"</strong> "+e("pdf.sow.assume.feedbackText")+"</li><li><strong>"+e("pdf.sow.assume.contactTitle")+"</strong> "+e("pdf.sow.assume.contactText")+"</li><li><strong>"+e("pdf.sow.assume.thirdPartyTitle")+"</strong> "+e("pdf.sow.assume.thirdPartyText")+"</li><li><strong>"+e("pdf.sow.assume.domainTitle")+"</strong> "+e("pdf.sow.assume.domainText")+"</li><li><strong>"+e("pdf.sow.assume.rightsTitle")+"</strong> "+e("pdf.sow.assume.rightsText")+"</li><li><strong>"+e("pdf.sow.assume.scopeTitle")+"</strong> "+e("pdf.sow.assume.scopeText")+'</li></ul><p style="font-size: 8pt; margin-bottom: 0; margin-top: 6px;">'+e("pdf.sow.assume.footer")+"</p></div></div>",ot++,Ce+='<div class="section"><h2>'+ot+". "+e("pdf.sow.acceptanceCriteria")+'</h2><div class="info-box"><p style="font-size: 9pt; margin-bottom: 4px;"><strong>'+e("pdf.sow.accept.processTitle")+"</strong> "+e("pdf.sow.accept.processText")+'</p><p style="font-size: 9pt; margin-bottom: 0;"><strong>'+e("pdf.sow.accept.criteriaTitle")+"</strong> "+e("pdf.sow.accept.criteriaText")+"</p></div></div>",ot++,Ce+='<div class="section"><h2>'+ot+". "+e("pdf.sow.scopeChanges")+'</h2><div class="info-box"><p style="font-size: 9pt; margin-bottom: 4px;">'+e("pdf.sow.scopeChangesIntro")+'</p><p style="font-size: 9pt; margin-bottom: 0;"><strong>'+e("pdf.sow.scopeChangesProcessTitle")+"</strong> "+e("pdf.sow.scopeChangesProcessText")+"</p></div></div>",Ce+='<div class="signature-section"><h2>'+e("pdf.sow.signatures")+'</h2><p style="font-size: 9pt;">'+e("pdf.sow.signaturesIntro")+'</p><div class="signature-grid"><div class="signature-block"><h3>'+e("pdf.sow.developerLabel")+" Scarlo</h3>"+(Ge?'<p style="font-size: 9pt; margin-bottom: 8px;">&nbsp;</p>':"")+'<div class="signature-line">'+($?'<img src="'+$+'" alt="Developer Signature" />':'<span style="font-style: italic;">'+e("pdf.sow.awaitingSignature")+"</span>")+'</div><div class="signature-label">'+e("pdf.sow.authorizedSignature")+'</div><div class="signature-name">'+K+'</div><div class="signature-date">'+e("common.date")+" "+(Y||"_______________")+'</div></div><div class="signature-block"><h3>'+e("pdf.sow.clientLabel")+" "+(Ge?vt:p)+"</h3>"+(Ge?'<p style="font-size: 9pt; margin-bottom: 8px;">'+Nt+(St?", "+St:"")+"</p>":"")+'<div class="signature-line">'+(U?'<img src="'+U+'" alt="Client Signature" />':'<span style="font-style: italic;">'+e("pdf.sow.awaitingSignature")+"</span>")+'</div><div class="signature-label">'+e("pdf.sow.authorizedSignature")+'</div><div class="signature-name">'+(Ge?e("common.by")+" "+Ze+", "+st:A)+'</div><div class="signature-date">'+e("common.date")+" "+(B||"_______________")+"</div></div></div></div>",u.payment&&u.payment.deferred&&u.payment.deferred.enabled){var et=u.payment.deferred,lt=et.lateFeeWaived||et.feeWaived,tt=et.deferredAmount*.1,Xe=et.deferredAmount*.015;Ce+='<div class="signature-section" style="margin-top: 15px; border-top: 2px solid #f59e0b; padding-top: 10px;"><h2 style="color: #92400e; font-size: 11pt; margin-bottom: 8px;">'+e("pdf.sow.deferredAckTitle")+'</h2><div style="background: #fff8e6; padding: 10px; margin-bottom: 10px; border: 1px solid #f59e0b;"><p style="font-size: 8pt; margin: 0 0 5px; font-weight: bold;">'+e("pdf.sow.ack.bySigningBelow")+'</p><ul style="font-size: 8pt; margin: 0; padding-left: 18px; line-height: 1.4;"><li><strong>'+e("pdf.sow.ack.deferredLabel")+"</strong> $"+(et.deferredAmount||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+" "+e("pdf.sow.ack.perSchedule")+"</li><li><strong>"+e("pdf.sow.ack.lateFeeLabel")+"</strong> "+(lt?e("pdf.sow.waived"):"10% ($"+tt.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+") "+e("pdf.sow.ack.if5DaysLate"))+"</li><li><strong>"+e("pdf.sow.ack.interestLabel")+"</strong> 1.5%/"+e("pdf.sow.ack.month")+" (~$"+Xe.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"/"+e("pdf.sow.ack.mo")+") "+e("pdf.sow.ack.after30Days")+"</li><li><strong>"+e("pdf.sow.ack.suspensionLabel")+"</strong> "+e("pdf.sow.ack.suspensionText")+"</li><li><strong>"+e("pdf.sow.ack.collectionLabel")+"</strong> "+e("pdf.sow.ack.collectionText")+"</li><li><strong>"+e("pdf.sow.ack.ipRightsLabel")+"</strong> "+e("pdf.sow.ack.ipRightsText")+'</li></ul></div><div class="signature-grid"><div class="signature-block"><h3>'+e("pdf.sow.clientAcknowledgment")+'</h3><div class="signature-line">'+(et.acknowledgmentSigned&&U?'<img src="'+U+'" alt="Client Acknowledgment" />':'<span style="font-style: italic;">'+e("pdf.sow.awaitingAcknowledgment")+"</span>")+'</div><div class="signature-label">'+e("pdf.sow.clientSignatureLabel")+'</div><div class="signature-name">'+(Ge?e("common.by")+" "+Ze:A)+'</div><div class="signature-date">'+e("common.date")+" "+(et.acknowledgmentDate||"_______________")+"</div></div></div></div>"}Ce+='<div class="footer"><p><strong> '+new Date().getFullYear()+" Scarlo</strong>  "+e("pdf.sow.footerTagline")+'</p><p class="sow-id">SOW: '+F+" | "+e("pdf.sow.footerGenerated")+" "+new Date().toLocaleString(Sn)+'</p><p style="font-size: 7pt; font-style: italic;">'+e("pdf.sow.footerValid")+"</p></div></div><script>window.onload = function() {  var images = document.images;  var loaded = 0;  var total = images.length;  if (total === 0) { setTimeout(function() { window.print(); }, 300); return; }  for (var i = 0; i < total; i++) {    if (images[i].complete) { loaded++; }    else { images[i].onload = images[i].onerror = function() { loaded++; if (loaded >= total) setTimeout(function() { window.print(); }, 300); }; }  }  if (loaded >= total) setTimeout(function() { window.print(); }, 300);};<\/script></body></html>";var $n=new Blob([Ce],{type:"text/html;charset=utf-8"}),zt=URL.createObjectURL($n),ss=window.open(zt,"_blank");if(!ss){URL.revokeObjectURL(zt),alert(e("alert.allowPopups"));return}ss.onload=function(){URL.revokeObjectURL(zt)}},N.prototype.generateSOWPDFFromData=function(u){console.log("Generating PDF from saved SOW data:",u.clientName),this.generateSOWPDF(u)},N.prototype.editSOW=function(u){var p=this;console.log(" Opening editor for SOW:",u.id,"-",u.clientName),this.showSOWCreator(),setTimeout(function(){console.log("Populating form fields...");var g={clientName:a("#sowClientName"),clientEmail:a("#sowClientEmail"),clientPhone:a("#sowClientPhone"),clientIdToggle:a("#clientIdTypeToggle"),emailLabel:a("#emailToggleLabel"),phoneLabel:a("#phoneToggleLabel"),package:a("#sowPackage"),weeks:a("#sowWeeks"),startDate:a("#sowStartDate"),notes:a("#sowNotes"),maintenance:a("#sowMaintenance"),customPrice:a("#sowCustomPrice"),customSection:a("#customPricingSection")};if(g.clientName&&(g.clientName.value=u.clientName||""),u.clientPhone&&!u.clientEmail?(g.clientIdToggle&&(g.clientIdToggle.checked=!0),g.clientEmail&&(g.clientEmail.style.display="none"),g.clientPhone&&(g.clientPhone.style.display="block",g.clientPhone.value=C(u.clientPhone)),g.emailLabel&&g.emailLabel.classList.remove("active"),g.phoneLabel&&g.phoneLabel.classList.add("active")):(g.clientIdToggle&&(g.clientIdToggle.checked=!1),g.clientPhone&&(g.clientPhone.style.display="none"),g.clientEmail&&(g.clientEmail.style.display="block",g.clientEmail.value=u.clientEmail||""),g.phoneLabel&&g.phoneLabel.classList.remove("active"),g.emailLabel&&g.emailLabel.classList.add("active")),g.weeks&&(g.weeks.value=u.estimatedWeeks||""),g.startDate&&(g.startDate.value=u.startDate||""),g.notes&&(g.notes.value=u.notes||""),g.package&&(g.package.value=u.packageType||"",u.packageType==="custom"&&(g.customSection&&(g.customSection.style.display="block"),g.customPrice&&u.payment))){var b=u.payment.breakdown&&u.payment.breakdown.basePrice?u.payment.breakdown.basePrice:u.payment.total;g.customPrice.value=b||""}g.maintenance&&(g.maintenance.value=u.maintenancePlan||"none");var S=a("#sowRetroactive"),_=a("#sowDevDuration"),D=a("#sowDevDurationUnit"),T=a("#retroactiveDurationFields"),L=a("#sowRetroactiveEndDate"),F=a("#sowWeeks"),U=F?F.parentElement:null;S&&u.isRetroactive&&(S.checked=!0,T&&(T.style.display="block"),U&&(U.style.display="none"),_&&u.devDuration&&(_.value=u.devDuration),D&&u.devDurationUnit&&(D.value=u.devDurationUnit),L&&(u.retroactiveEndDate||u.startDate)&&(L.value=u.retroactiveEndDate||u.startDate),typeof toggleRetroactiveFields=="function"&&toggleRetroactiveFields());var A=a("#sowEntityTypeToggle"),B=a("#sowIndividualFields"),$=a("#sowBusinessFields"),K=a("#sowIndividualLabel"),Y=a("#sowBusinessLabel"),Q=a("#sowBusinessName"),te=a("#sowEntityType"),ce=a("#sowStateOfFormation"),pe=a("#sowRepName"),ge=a("#sowRepTitle"),Se=a("#sowBusinessEmail"),Ee=a("#sowBusinessPhone");if(u.isBusinessEntity&&A?(A.checked=!0,B&&(B.style.display="none"),$&&($.style.display="block"),K&&K.classList.remove("active"),Y&&Y.classList.add("active"),Q&&(Q.value=u.businessName||""),te&&(te.value=u.entityType||""),ce&&(ce.value=u.stateOfFormation||""),pe&&(pe.value=u.representativeName||""),ge&&(ge.value=u.representativeTitle||""),u.clientPhone&&!u.clientEmail?(Se&&(Se.style.display="none"),Ee&&(Ee.style.display="block",Ee.value=C(u.clientPhone))):(Ee&&(Ee.style.display="none"),Se&&(Se.style.display="block",Se.value=u.clientEmail||""))):A&&(A.checked=!1,$&&($.style.display="none"),B&&(B.style.display="block"),Y&&Y.classList.remove("active"),K&&K.classList.add("active")),u.payment&&u.payment.deferred&&u.payment.deferred.enabled){var re=u.payment.deferred,xe=a("#sowDeferredPayment"),$e=a("#deferredPaymentFields");if(xe){xe.checked=!0,$e&&($e.style.display="block");var it=document.querySelector('input[name="deferred_split"][value="'+re.splitType+'"]');it&&(it.checked=!0);var je=a("#lumpSumFields"),nt=a("#recurringFields"),Qe=a("#customSplitFields");if(je&&(je.style.display="none"),nt&&(nt.style.display="none"),Qe&&(Qe.style.display="none"),re.splitType==="custom"){Qe&&(Qe.style.display="block");var at=a("#customPaymentsList");at&&re.customSchedule&&re.customSchedule.length>0&&(at.innerHTML="",re.customSchedule.forEach(function(Ce){if(typeof addCustomPaymentRow=="function"){addCustomPaymentRow();var It=at.lastElementChild;if(It){var ot=It.querySelector(".custom-payment-amount"),Bt=It.querySelector(".custom-payment-date");ot&&(ot.value=Ce.amount||""),Bt&&(Bt.value=Ce.dueDate||"")}}}))}else if(re.splitType==="recurring"){nt&&(nt.style.display="block");var Ye=a("#sowRecurringTotalAmount"),pt=a("#sowRecurringStartDate"),Xt=a("#sowRecurringFrequency"),Wt=a("#sowRecurringCalcMode"),Oe=a("#sowRecurringPaymentAmount"),De=a("#sowRecurringPaymentCount");Ye&&(Ye.value=re.deferredAmount||""),pt&&(pt.value=re.startDate||""),Xt&&(Xt.value=re.frequency||"biweekly"),Wt&&(Wt.value=re.calculationMode||"amount"),typeof toggleRecurringCalcMode=="function"&&toggleRecurringCalcMode(),re.calculationMode==="amount"?Oe&&(Oe.value=re.amountPerPayment||""):De&&(De.value=re.numberOfPayments||""),typeof updateRecurringSchedule=="function"&&updateRecurringSchedule()}else{je&&(je.style.display="block");var xt=a("#sowDeferredAmount"),Ge=a("#sowDeferredDueDate");xt&&(xt.value=re.deferredAmount||""),Ge&&(Ge.value=re.dueDate||"")}var vt=document.querySelectorAll(".deferred-type-card");vt.forEach(function(Ce){var It=Ce.querySelector('input[type="radio"]');It&&It.checked?(Ce.style.borderColor="#6366f1",Ce.style.background="rgba(99, 102, 241, 0.15)"):(Ce.style.borderColor="transparent",Ce.style.background="rgba(255, 255, 255, 0.03)")});var Nt=a("#sowWaiveLateFee"),St=a("#sowAllowPartialPayments"),Ze=a("#sowMaintenanceDuringDeferral");Nt&&(Nt.checked=re.lateFeeWaived||re.feeWaived||!1),St&&(St.checked=re.allowPartialPayments!==!1),Ze&&(Ze.checked=re.maintenanceDuringDeferral!==!1),typeof calculateLateFee=="function"&&calculateLateFee()}}var st={essential:{min:1e3,max:3e3,default:2e3},starter:{min:3e3,max:6e3,default:4500},growth:{min:6e3,max:12e3,default:9e3},professional:{min:12e3,max:25e3,default:18500},enterprise:{min:25e3,max:5e4,default:37500}},ht={none:0,basic:167,professional:335,premium:670},Zt={responsive_design:{default:200,thirdParty:!1},custom_ui:{default:450,thirdParty:!1},animations:{default:275,thirdParty:!1},seo_optimization:{default:200,thirdParty:!1},analytics:{default:175,thirdParty:!1},contact_forms:{default:250,thirdParty:!1},firebase_auth:{default:350,thirdParty:!0,note:"Firebase costs"},firebase_db:{default:425,thirdParty:!0,note:"Firebase costs"},user_profiles:{default:550,thirdParty:!1},file_storage:{default:300,thirdParty:!0,note:"Firebase costs"},api_integration:{default:450,thirdParty:!1},email_integration:{default:325,thirdParty:!0,note:"SendGrid costs"},newsletter:{default:200,thirdParty:!1,addon:!0},user_roles:{default:450,thirdParty:!1},notifications:{default:400,thirdParty:!1},booking_basic:{default:450,thirdParty:!1,addon:!0},booking_system:{default:1100,thirdParty:!1,addon:!0},blog:{default:400,thirdParty:!1,addon:!0},cms_integration:{default:600,thirdParty:!1,addon:!0},gallery:{default:325,thirdParty:!1,addon:!0},music_media:{default:275,thirdParty:!1,addon:!0},social_feed:{default:250,thirdParty:!1,addon:!0}},En={none:{price:0,label:e("ecommerce.none")},basic_cart:{price:5500,label:e("ecommerce.basicCart"),thirdParty:!0,note:"Stripe fees"},full_store:{price:14e3,label:e("ecommerce.fullStore"),thirdParty:!0,note:"Stripe fees"}},rn={essential:["responsive_design","contact_forms"],starter:["responsive_design","custom_ui","animations","seo_optimization","analytics","contact_forms"],growth:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","contact_forms"],professional:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","firebase_db","user_profiles","file_storage","api_integration","contact_forms","email_integration","newsletter"],enterprise:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","firebase_db","user_profiles","user_roles","file_storage","api_integration","contact_forms","email_integration","notifications","newsletter"],custom:[]},Pn=u.packageType||"",yt=rn[Pn]||[];if(u.features&&u.features.length>0){console.log("Checking",u.features.length,"features");var ii=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]');ii.forEach(function(Ce){Ce.checked=!1,Ce.parentElement.classList.remove("feature-included");var It=Ce.parentElement.textContent.trim(),ot=Ce.parentElement.querySelector(".third-party-note");ot&&(It=It.replace(ot.textContent,"").trim()),u.features.some(function(Bt){return Bt.indexOf(It)!==-1||It.indexOf(Bt)!==-1})&&(Ce.checked=!0),yt.indexOf(Ce.value)!==-1&&Ce.parentElement.classList.add("feature-included")})}var Dn="none";u.payment&&u.payment.breakdown&&u.payment.breakdown.ecommerceOption&&(Dn=u.payment.breakdown.ecommerceOption);var Ln=document.querySelector('input[name="ecommerce_option"][value="'+Dn+'"]');Ln&&(Ln.checked=!0);var yn=a("#sowCouponSelect");yn&&u.couponCode&&(yn.value=u.couponCode),setTimeout(function(){p.updateSOWPricing(st,ht,Zt,En,rn)},100);var wt=a(".sow-form-header h4");if(wt&&(wt.innerHTML=" Edit Statement of Work"),u.editingFromChangeRequest){var wn=u.editingFromChangeRequest,jt={package:e("changeOrder.section.package"),features:e("changeOrder.section.features"),timeline:e("changeOrder.section.timeline"),payment:e("changeOrder.section.payment"),maintenance:e("changeOrder.section.maintenance"),other:e("changeOrder.section.other")},bn=wn.sections.map(function(Ce){return'<span style="background: rgba(251, 191, 36, 0.2); color: #fbbf24; padding: 3px 8px; border-radius: 4px; font-size: 0.75rem; margin-right: 4px;">'+(jt[Ce]||Ce)+"</span>"}).join(""),xn='<div id="changeRequestBanner" style="background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(245, 158, 11, 0.1) 100%); border: 1px solid rgba(251, 191, 36, 0.4); border-radius: 12px; padding: 1rem; margin-bottom: 1.25rem;"><div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.75rem;"><h5 style="margin: 0; color: #fbbf24; font-size: 0.95rem; display: flex; align-items: center; gap: 6px;"> Change Request from '+wn.clientName+`</h5><button onclick="document.getElementById('changeRequestBanner').remove()" style="background: none; border: none; color: rgba(255,255,255,0.5); cursor: pointer; font-size: 1.25rem; line-height: 1; padding: 0;">&times;</button></div><div style="margin-bottom: 0.75rem;">`+bn+'</div><div style="background: rgba(0,0,0,0.2); border-radius: 8px; padding: 0.75rem; max-height: 120px; overflow-y: auto;"><p style="margin: 0; font-size: 0.85rem; color: rgba(255,255,255,0.9); white-space: pre-wrap; line-height: 1.5;">'+wn.description+"</p></div></div>",Hn=document.querySelector(".sow-creator-form");if(Hn){var Sn=Hn.querySelector(".sow-form-section");Sn&&Sn.insertAdjacentHTML("beforebegin",xn)}p.currentEditChangeRequestId=wn.id}var sn=a(".btn-save-sow");if(sn){var Mn=sn.cloneNode(!0);sn.parentNode.replaceChild(Mn,sn),Mn.innerHTML='<span class="btn-icon"></span> Update SOW',Mn.onclick=function(Ce){Ce.preventDefault(),p.updateSOW(u.id)}}console.log(" Form populated for editing")},250)},N.prototype.updateSOW=function(u){var p=a("#sowEntityTypeToggle")&&a("#sowEntityTypeToggle").checked,g=a("#sowClientName").value.trim(),b=a("#sowClientEmail").value.trim(),S=a("#sowClientPhone").value.trim(),_=a("#sowBusinessName")?a("#sowBusinessName").value.trim():"",D=a("#sowEntityType")?a("#sowEntityType").value:"",T=a("#sowStateOfFormation")?a("#sowStateOfFormation").value.trim():"",L=a("#sowRepName")?a("#sowRepName").value.trim():"",F=a("#sowRepTitle")?a("#sowRepTitle").value.trim():"",U=a("#sowBusinessEmail")?a("#sowBusinessEmail").value.trim():"",A=a("#sowBusinessPhone")?a("#sowBusinessPhone").value.trim():"",B=a("#sowPackage").value,$=a("#sowWeeks").value,K=a("#sowStartDate").value,Y=a("#sowNotes").value.trim(),Q=a("#sowMaintenance").value,te=a("#sowRetroactive")&&a("#sowRetroactive").checked,ce=a("#sowDevDuration")?a("#sowDevDuration").value:"",pe=a("#sowRetroactiveEndDate")?a("#sowRetroactiveEndDate").value:"",ge="";if(S){var Se=S.replace(/\D/g,"");Se.length===10?ge="+1"+Se:Se.length===11&&Se.startsWith("1")?ge="+"+Se:ge=S}var Ee="";if(A){var re=A.replace(/\D/g,"");re.length===10?Ee="+1"+re:re.length===11&&re.startsWith("1")?Ee="+"+re:Ee=A}var xe=[];if(p){if(_||xe.push("Business Legal Name"),D||xe.push("Entity Type"),L||xe.push("Representative Name"),F||xe.push("Representative Title"),B||xe.push("Package Tier"),te?ce||xe.push("Development Duration"):$||xe.push("Estimated Weeks"),xe.length>0){alert(e("sow.val.fillRequired")+xe.join(`
- `));return}if(!U&&!Ee){alert(e("sow.val.businessEmailOrPhone"));return}}else{if(g||xe.push("Client Name"),B||xe.push("Package Tier"),te?ce||xe.push("Development Duration"):$||xe.push("Estimated Weeks"),xe.length>0){alert(e("sow.val.fillRequired")+xe.join(`
- `));return}if(!b&&!ge){alert(e("sow.val.clientEmailOrPhone"));return}}var $e=[],it=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]:checked');it.forEach(function(st){var ht=st.parentElement.textContent.trim(),Zt=st.parentElement.querySelector(".third-party-note");Zt&&(ht=ht.replace(Zt.textContent,"").trim()),$e.push(ht)});var je=document.querySelector('input[name="ecommerce_option"]:checked'),nt=je?je.value:"none",Qe=this.currentPricingData||{basePrice:0,addOns:[],discounts:[],ecommerceOption:nt,ecommercePrice:0,total:0},at=Qe.total,Ye=a("#sowCouponSelect"),pt=Ye?Ye.value:"",Xt=a("#sowDevDurationUnit")?a("#sowDevDurationUnit").value:"weeks",Wt=ce&&parseInt(ce)||null,Oe=a("#sowDeferredPayment")&&a("#sowDeferredPayment").checked,De={enabled:Oe,splitType:"lump_sum",dueDate:null,deferredAmount:0,lateFee:0,lateFeeWaived:!1,allowPartialPayments:!0,maintenanceDuringDeferral:!0,customSchedule:[],frequency:null,startDate:null,calculationMode:null,amountPerPayment:null,numberOfPayments:null,acknowledgmentSigned:!1,acknowledgmentDate:null};if(Oe){var xt=document.querySelector('input[name="deferred_split"]:checked');if(De.splitType=xt?xt.value:"lump_sum",De.lateFeeWaived=a("#sowWaiveLateFee")&&a("#sowWaiveLateFee").checked,De.allowPartialPayments=a("#sowAllowPartialPayments")?a("#sowAllowPartialPayments").checked:!0,De.maintenanceDuringDeferral=a("#sowMaintenanceDuringDeferral")?a("#sowMaintenanceDuringDeferral").checked:!0,De.splitType==="custom"){var Ge=[],vt=document.querySelectorAll(".custom-payment-row");vt.forEach(function(st){var ht=st.querySelector(".custom-payment-amount"),Zt=st.querySelector(".custom-payment-date"),En=parseFloat(ht?ht.value:0)||0,rn=Zt?Zt.value:null;En>0&&Ge.push({amount:En,dueDate:rn})}),De.customSchedule=Ge,De.deferredAmount=Ge.reduce(function(st,ht){return st+ht.amount},0)}else if(De.splitType==="recurring"){De.deferredAmount=parseFloat(a("#sowRecurringTotalAmount")?a("#sowRecurringTotalAmount").value:0)||0,De.startDate=a("#sowRecurringStartDate")?a("#sowRecurringStartDate").value:null,De.frequency=a("#sowRecurringFrequency")?a("#sowRecurringFrequency").value:"biweekly",De.calculationMode=a("#sowRecurringCalcMode")?a("#sowRecurringCalcMode").value:"amount",De.calculationMode==="amount"?De.amountPerPayment=parseFloat(a("#sowRecurringPaymentAmount")?a("#sowRecurringPaymentAmount").value:0)||0:De.numberOfPayments=parseInt(a("#sowRecurringPaymentCount")?a("#sowRecurringPaymentCount").value:0)||0;var Nt=De.calculationMode==="amount"?De.amountPerPayment:De.numberOfPayments;De.customSchedule=generateRecurringSchedule(De.deferredAmount,De.startDate,De.frequency,De.calculationMode,Nt)}else De.deferredAmount=parseFloat(a("#sowDeferredAmount")?a("#sowDeferredAmount").value:0)||0,De.dueDate=a("#sowDeferredDueDate")?a("#sowDeferredDueDate").value:null;if(De.lateFee=De.lateFeeWaived?0:De.deferredAmount*.1,De.deferredAmount<=0){alert(e("sow.val.deferredAmount"));return}if(De.splitType==="lump_sum"&&!De.dueDate){alert(e("sow.val.deferredDueDate"));return}if(De.splitType==="custom"&&De.customSchedule.length===0){alert(e("sow.val.customSchedule"));return}if(De.splitType==="recurring"){if(!De.startDate){alert(e("sow.val.firstPaymentDate"));return}if(De.calculationMode==="amount"&&(!De.amountPerPayment||De.amountPerPayment<=0)){alert(e("sow.val.paymentAmount"));return}if(De.calculationMode==="count"&&(!De.numberOfPayments||De.numberOfPayments<2)){alert(e("sow.val.paymentCount"));return}if(De.customSchedule.length===0){alert(e("sow.val.scheduleError"));return}}if(De.deferredAmount>at){alert(e("sow.val.deferredExceedsTotal"));return}}var St={clientName:p?_:g,clientEmail:p?U||"":b||"",clientPhone:p?M(Ee)||"":M(ge)||"",packageType:B,estimatedWeeks:te?Wt||null:parseInt($),startDate:te?pe||null:K||null,features:$e,notes:Y,maintenancePlan:Q,isRetroactive:te,devDuration:Wt,devDurationUnit:Xt,retroactiveEndDate:te&&pe||null,couponCode:pt||null,isBusinessEntity:p,businessName:p?_:"",entityType:p?D:"",stateOfFormation:p?T:"",representativeName:p?L:"",representativeTitle:p?F:"",payment:{total:at,deposit:at*.5,milestone1:at*.25,final:at*.25,breakdown:{basePrice:Qe.basePrice,addOns:Qe.addOns,discounts:Qe.discounts,ecommerceOption:Qe.ecommerceOption,ecommercePrice:Qe.ecommercePrice,couponCode:pt||null,couponDiscount:Qe.couponDiscount||0},deferred:De},updatedAt:firebase.firestore.FieldValue.serverTimestamp()},Ze=this;firebase.firestore().collection("sow_documents").doc(u).update(St).then(function(){if(console.log("SOW updated successfully"),Ze.currentEditChangeRequestId)return firebase.firestore().collection("change_requests").doc(Ze.currentEditChangeRequestId).update({status:"completed",completedAt:firebase.firestore.FieldValue.serverTimestamp(),updatedAt:firebase.firestore.FieldValue.serverTimestamp()}).then(function(){return firebase.firestore().collection("sow_documents").doc(u).update({changeRequestStatus:"completed",lastChangeOrderApplied:firebase.firestore.FieldValue.serverTimestamp()})}).then(function(){Ze.currentEditChangeRequestId=null,alert(e("sow.msg.updateChangeSuccess"))});alert(e("sow.msg.updateSuccess"))}).then(function(){a("#sowCreatorContainer").style.display="none",Ze.loadSOWDocuments()}).catch(function(st){console.error("Error updating SOW:",st),alert(e("sow.err.update")+st.message)})},N.prototype.selectContractToSign=function(u,p){var g=p.find(function(_){return _.id===u});if(!g){alert(e("contract.err.notFound"));return}console.log("Selected contract to sign:",u),this.currentContract={id:u,data:g};var b=a("#developerDashboard");b&&(b.style.display="none");var S=a("#contractForm");S&&(S.style.display="block"),this.showContractSigningForm(g)},N.prototype.showContractSigningForm=function(u){var p=this,g=a("#contractForm");g&&(g.style.display="block");var b=a(".modal-header");b&&(b.style.display="block");var S=a(".modal-close");S&&(S.style.display="flex",S.style.position="",S.style.top="",S.style.alignSelf="",S.style.marginRight="",S.style.marginTop="",S.style.marginBottom="",S.style.flexShrink="");var _=a("#devSignatureBlock");if(_){_.style.display="block";var D=_.querySelectorAll("input");D.forEach(function(K){K.disabled=!1});var T=_.querySelector("h3");T&&(T.innerHTML=e("contract.label.devSig")+' <span style="font-size: 12px; color: #f59e0b;">'+e("contract.label.signBelow")+"</span>")}var L=new Date().toISOString().split("T")[0],F=a("#devDate");F&&(F.value=L),this.populateFormWithContract(u);var U=a("#submitBtn");U&&(U.style.display="inline-flex",U.disabled=!1,U.innerHTML='<span id="submitBtnText">'+e("contract.btn.uploadFinalize")+"</span>",U.style.background="");var A=a("#backToDashboard");A&&A.remove();var B=document.createElement("button");B.id="backToDashboard",B.className="btn btn-secondary",B.innerHTML=e("contract.btn.backDashboard"),B.style.marginRight="10px",B.onclick=function(K){K.preventDefault(),p.showDeveloperDashboard(),p.devSignaturePad&&p.devSignaturePad.clear()};var $=a(".action-buttons");$&&$.insertBefore(B,$.firstChild),setTimeout(function(){var K=document.getElementById("devSignaturePad");K&&(p.devSignaturePad=J(K),console.log("Dev signature pad initialized for signing"))},200)},N.prototype.viewCompletedContract=function(u,p){var g=p.find(function(b){return b.id===u});if(!g){alert(e("contract.err.notFound"));return}console.log("Viewing completed contract:",u),this.currentContract={id:u,data:g},this.generatePDF()},N.prototype.setupClientView=function(){console.log("Setting up client view - dual signing mode");var u=this,p=firebase.auth().currentUser,g=a(".modal-close");g&&(g.style.display="flex");var b=p.email,S=p.phoneNumber,_;if(b)console.log("Checking existing contracts by email:",b),_=firebase.firestore().collection("contracts").where("clientEmail","==",b).where("status","in",["pending_developer","completed"]).orderBy("timestamp","desc").limit(1);else if(S){var D=S.replace(/\D/g,""),T=D.length===11&&D.startsWith("1")?D.slice(1):D,L=[S,D,T,"("+T.slice(0,3)+") "+T.slice(3,6)+"-"+T.slice(6)];console.log("Checking existing contracts by phone formats:",L);var F=function(U){if(U>=L.length){console.log("No existing contract found for phone user"),u.proceedWithClientSetup();return}firebase.firestore().collection("contracts").where("clientPhone","==",L[U]).where("status","in",["pending_developer","completed"]).orderBy("timestamp","desc").limit(1).get().then(function(A){if(A.empty)F(U+1);else{var B=A.docs[0],$=B.data();$.id=B.id,console.log("Found existing contract with format:",L[U]);var K=document.getElementById("dualSigningCompleted");K?K.style.display="block":u.showExistingCompletion($)}}).catch(function(){F(U+1)})};F(0);return}else return console.log("No email or phone - proceeding to setup"),u.proceedWithClientSetup();_.get().then(function(U){if(!U.empty){var A=U.docs[0],B=A.data();B.id=A.id,console.log("Found existing contract with status:",B.status);var $=document.getElementById("dualSigningCompleted");$?($.style.display="block",console.log("Showing existing completion view")):u.showExistingCompletion(B);return}return u.proceedWithClientSetup()}).catch(function(U){console.error("Error checking existing contracts:",U),u.proceedWithClientSetup()})},N.prototype.proceedWithClientSetup=function(){var u=this,p=a("#clientSignatureBlock");p&&(p.style.display="block",p.style.pointerEvents="auto",p.classList.remove("signature-locked"));var g=a("#devSignatureBlock");if(g){g.style.display="none";var b=g.querySelectorAll("input");b.forEach(function(K){K.disabled=!0,K.removeAttribute("required")})}var S=a("#devPendingBlock");S&&(S.style.display="block");var _=a("#downloadBtn");_&&(_.style.display="none");var D=firebase.auth().currentUser,T=D.email,L=D.phoneNumber,F;if(T)console.log("Querying SOW by email:",T),F=firebase.firestore().collection("sow_documents").where("clientEmail","==",T).orderBy("createdAt","desc").limit(1);else if(L){var U=L.replace(/\D/g,""),A=U.length===11&&U.startsWith("1")?U.slice(1):U,B=[L,U,A,"("+A.slice(0,3)+") "+A.slice(3,6)+"-"+A.slice(6)];console.log("Querying SOW by phone formats:",B);var $=function(K){if(K>=B.length){console.log(" No SOW found for client (tried all phone formats)"),u.showNoSOWNotification();return}firebase.firestore().collection("sow_documents").where("clientPhone","==",B[K]).orderBy("createdAt","desc").limit(1).get().then(function(Y){if(Y.empty)$(K+1);else{var Q=Y.docs[0],te=Q.data();te.id=Q.id,console.log(" SOW found with format:",B[K],"ID:",te.id),u.showDualSigningInterface(te)}}).catch(function(Y){console.error("Error querying SOW format",B[K],Y),$(K+1)})};$(0);return}else{console.log("No email or phone found"),u.showNoSOWNotification();return}F.get().then(function(K){if(K.empty)console.log(" No SOW found for client"),u.showNoSOWNotification();else{var Y=K.docs[0],Q=Y.data();Q.id=Y.id,u.showDualSigningInterface(Q)}}).catch(function(K){console.error("Error fetching SOW:",K),u.showNoSOWNotification(K.message)})},N.prototype.showNoSOWNotification=function(u){console.log("Showing no-SOW notification");var p=a("#clientSignatureBlock");p&&(p.style.display="none");var g=a("#submitBtn");g&&(g.style.display="none",g.disabled=!0);var b='<div class="sow-missing-notification"><div class="notification-icon"></div><div class="notification-content"><h4>'+e("signing.sowRequired")+"</h4><p>"+e("signing.sowRequiredMsg")+'</p><p class="notification-action">'+e("signing.sowRequiredAction")+' <a href="#" class="request-help-link" style="color: #6366f1; text-decoration: underline; cursor: pointer; font-weight: 700;">'+e("signing.requestHelp")+"</a> "+e("signing.sowRequiredAction2")+"</p></div></div>",S=a("#contractForm");if(S){var _=a(".sow-missing-notification");_&&_.remove(),S.insertAdjacentHTML("afterbegin",b);var D=a(".request-help-link");D&&D.addEventListener("click",function(L){L.preventDefault();var F=a("#helpModal");if(F){F.classList.add("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open");var U=firebase.auth().currentUser;if(U){var A=a("#helpContact"),B=a("#helpContactLabel");A&&(U.email?(A.value=U.email,A.type="email",A.placeholder="your@email.com",B&&(B.textContent=e("help.label.email"))):U.phoneNumber&&(A.value=C(U.phoneNumber),A.type="tel",A.placeholder="(555) 123-4567",B&&(B.textContent=e("help.label.phone"))),A.setAttribute("readonly","readonly"),A.style.opacity="0.7")}}})}var T=a("#requestHelpBtn");T&&(T.style.animation="pulse 6s infinite",T.style.boxShadow="0 0 20px rgba(255, 255, 255, 0.18)")},N.prototype.showDualSigningInterface=function(u){var p=this;console.log("Showing dual signing interface for:",u.clientName),this.currentSOW=u,this.populateClientInfoFromSOW(u);var g=a("#contractForm");g&&(g.style.display="none");var b=a("#submitBtn");b&&(b.style.display="none");var S=a(".modal-content");if(S){var _=a("#clientSigningTabs");_&&(console.log("Removing existing tabs to prevent duplicates"),_.remove());var D=a("#closeModalBtn");D&&(D.style.position="sticky",D.style.top="1rem",D.style.alignSelf="flex-end",D.style.marginRight="1.5rem",D.style.marginTop="1rem",D.style.marginBottom="-2.5rem",D.style.flexShrink="0");var T=document.createElement("div");T.id="clientSigningTabs",T.className="client-signing-tabs",T.innerHTML='<div class="signing-tabs-header"><button class="signing-tab active" data-tab="contract"><span class="tab-icon"></span><span class="tab-title">'+e("signing.contractAgreement")+'</span><span class="tab-status" id="contractStatus">'+e("signing.pending")+'</span></button><button class="signing-tab" data-tab="sow"><span class="tab-icon"></span><span class="tab-title">'+e("signing.statementOfWork")+'</span><span class="tab-status" id="sowStatus">'+e("signing.pending")+'</span></button></div><div class="signing-tabs-content"><div class="signing-tab-pane active" data-tab="contract"><div id="contractSigningContent"></div></div><div class="signing-tab-pane" data-tab="sow"><div id="sowSigningContent"></div></div></div><div class="signing-footer"><div class="signing-progress"><div class="progress-indicator"><span class="progress-dot" id="contractDot"></span><span class="progress-line"></span><span class="progress-dot" id="sowDot"></span></div><p class="progress-text">'+e("signing.completeBoth")+'</p></div><button class="btn btn-primary" id="dualSignBtn"><span id="dualSignBtnText">'+e("signing.nextSignSOW")+"</span></button></div>",D&&D.nextSibling?S.insertBefore(T,D.nextSibling):S.appendChild(T);var L=a("#contractSigningContent");if(L){var F=document.createElement("div");F.className="modal-header",F.innerHTML="<h2>"+e("signing.contract")+'</h2><p class="modal-subtitle">Scarlo - Carlos Martin</p>',L.appendChild(F),L.appendChild(g),g.style.display="block";var U=document.getElementById("clientSignerName");U&&(U.disabled=!1,U.required=!0,U.style.pointerEvents="auto");var A=document.getElementById("clientDate");A&&(A.disabled=!1,A.required=!0,A.style.pointerEvents="auto",A.value||(A.value=new Date().toISOString().split("T")[0]));var B=document.querySelector(".acknowledgment");B&&(B.style.display="block");var $=document.getElementById("acknowledgment");$&&($.disabled=!1,$.required=!0)}if(this.renderSOWForClientSigning(u),typeof t=="function"&&t()!=="en"){var K=window.navigation||window.navInstance;K&&K.applyLanguage?K.applyLanguage(t()):(document.querySelectorAll("[data-i18n]").forEach(function(Q){var te=Q.getAttribute("data-i18n"),ce=e(te);ce&&ce!==te&&(Q.textContent=ce)}),document.querySelectorAll("[data-i18n-html]").forEach(function(Q){var te=Q.getAttribute("data-i18n-html"),ce=e(te);ce&&ce!==te&&(Q.innerHTML=ce)}),document.querySelectorAll("[data-i18n-placeholder]").forEach(function(Q){var te=Q.getAttribute("data-i18n-placeholder"),ce=e(te);ce&&ce!==te&&(Q.placeholder=ce)}))}c(".signing-tab").forEach(function(Q){Q.addEventListener("click",function(){var te=this.getAttribute("data-tab");p.switchSigningTab(te)})});var Y=a("#dualSignBtn");Y&&Y.addEventListener("click",function(Q){Q.preventDefault();var te=a(".signing-tab.active"),ce=te?te.getAttribute("data-tab"):"contract";if(ce==="contract"){var pe=p.validateContractTab();if(pe.length>0){alert(e("signing.pleaseComplete")+`

`+pe.join(`
`));return}p.updateSignatureStatus("contract",!0),p.switchSigningTab("sow")}else p.submitBothSignatures()}),setTimeout(function(){console.log(" Initializing dual signature pads...");var Q=document.getElementById("clientSignaturePad");if(Q){console.log("Found contract canvas, initializing..."),Q.style.pointerEvents="auto",Q.style.touchAction="none",Q.style.cursor="crosshair";var te=Q.closest(".signature-block");te&&(te.classList.remove("signature-locked"),te.style.pointerEvents="auto"),p.clientSignaturePad=J(Q),console.log(" Contract signature pad initialized");var ce=a('.clear-btn[data-canvas="clientSignaturePad"]');ce&&ce.addEventListener("click",function(xe){xe.preventDefault(),p.clientSignaturePad&&(p.clientSignaturePad.clear(),p.updateSignatureStatus("contract",!1))})}else console.error(" Contract signature canvas not found!");var pe=a('.clear-btn[data-canvas="sowClientSignaturePad"]');pe&&pe.addEventListener("click",function(xe){xe.preventDefault(),window.sowClientPad&&(window.sowClientPad.clear(),p.updateSignatureStatus("sow",!1))}),console.log(" SOW signature pad will be initialized when SOW tab is opened");var ge=document.getElementById("clientSignerName");ge&&(ge.disabled=!1);var Se=document.getElementById("clientDate");Se&&(Se.disabled=!1,Se.value||(Se.value=new Date().toISOString().split("T")[0]));var Ee=document.querySelector(".acknowledgment");Ee&&(Ee.style.display="block");var re=document.getElementById("acknowledgment");re&&(re.disabled=!1),p.checkExistingSignatures()},400)}},N.prototype.renderSOWForClientSigning=function(u){var p=a("#sowSigningContent");if(p){var g={essential:e("pkg.essential"),starter:e("pkg.starter"),growth:e("pkg.growth"),professional:e("pkg.professional"),enterprise:e("pkg.enterprise"),custom:e("pkg.custom")},b={essential:{includes:[e("pkg.essential.i1"),e("pkg.essential.i2"),e("pkg.essential.i3"),e("pkg.essential.i4"),e("pkg.essential.i5"),e("pkg.essential.i6")]},starter:{includes:[e("pkg.starter.i1"),e("pkg.starter.i2"),e("pkg.starter.i3"),e("pkg.starter.i4"),e("pkg.starter.i5"),e("pkg.starter.i6"),e("pkg.starter.i7")]},growth:{includes:[e("pkg.growth.i1"),e("pkg.growth.i2"),e("pkg.growth.i3"),e("pkg.growth.i4"),e("pkg.growth.i5"),e("pkg.growth.i6"),e("pkg.growth.i7")]},professional:{includes:[e("pkg.professional.i1"),e("pkg.professional.i2"),e("pkg.professional.i3"),e("pkg.professional.i4"),e("pkg.professional.i5"),e("pkg.professional.i6"),e("pkg.professional.i7"),e("pkg.professional.i8")]},enterprise:{includes:[e("pkg.enterprise.i1"),e("pkg.enterprise.i2"),e("pkg.enterprise.i3"),e("pkg.enterprise.i4"),e("pkg.enterprise.i5"),e("pkg.enterprise.i6"),e("pkg.enterprise.i7"),e("pkg.enterprise.i8")]}},S=b[u.packageType]||{includes:[]},_=u.payment?u.payment.total:0,D=_*.5,T=_*.25,L=_*.25,F=u.payment&&u.payment.breakdown?u.payment.breakdown:null,U=F?F.basePrice:_,A=F?F.addOns:[],B=F?F.discounts:[],$=F?F.couponCode:null,K=F?F.couponDiscount:0,Y='<div class="modal-header"><h2>'+e("sow.title")+'</h2><p class="modal-subtitle">Scarlo - Carlos Martin</p></div><section class="contract-section-inner"><h3>'+e("sow.clientInfo")+'</h3><div class="sow-info-grid"><div class="sow-info-item"><strong>'+e("sow.clientName")+"</strong> "+u.clientName+'</div><div class="sow-info-item"><strong>'+e("sow.contact")+"</strong> "+(u.clientEmail||u.clientPhone||e("common.na"))+'</div><div class="sow-info-item"><strong>'+e("sow.package")+"</strong> "+(g[u.packageType]||u.packageType)+'</div><div class="sow-info-item"><strong>'+e("sow.timeline")+"</strong> "+(u.estimatedWeeks||e("common.tbd"))+" "+e("sow.weeks")+'</div></div></section><section class="contract-section-inner"><h3>'+e("sow.packageIncludes")+'</h3><ul class="sow-list">';u.packageType==="custom"?u.features&&u.features.length>0&&u.features.forEach(function(te){Y+="<li>"+s(te)+"</li>"}):S.includes&&S.includes.length>0&&S.includes.forEach(function(te){Y+="<li>"+te+"</li>"}),Y+="</ul></section>",u.packageType!=="custom"&&u.features&&u.features.length>0&&(Y+='<section class="contract-section-inner"><h3>'+e("sow.additionalFeatures")+'</h3><ul class="sow-list">',u.features.forEach(function(te){Y+="<li>"+s(te)+"</li>"}),Y+="</ul></section>"),u.notes&&(Y+='<section class="contract-section-inner"><h3>'+e("sow.specialRequirements")+"</h3><p>"+u.notes+"</p></section>"),Y+='<section class="contract-section-inner"><h3>'+e("sow.pricingBreakdown")+'</h3><table class="sow-payment-table pricing-breakdown-table"><thead><tr><th>'+e("sow.item")+"</th><th>"+e("sow.description")+"</th><th>"+e("sow.amount")+'</th></tr></thead><tbody><tr class="base-package-row"><td><strong>'+(g[u.packageType]||e("common.package"))+"</strong></td><td>"+e("sow.basePackagePrice")+"</td><td><strong>$"+U.toFixed(0)+"</strong></td></tr>",A&&A.length>0&&A.forEach(function(te){var ce=te.thirdParty?' <span class="third-party-indicator">*</span>':"",pe=te.key?o(te.key,te.label):s(te.label);Y+='<tr class="addon-row"><td>'+pe+ce+"</td><td>"+e("sow.additionalFeature")+'</td><td class="addon-price">+$'+te.price.toFixed(0)+"</td></tr>"}),B&&B.length>0&&B.forEach(function(te){var ce=te.key?o(te.key,te.label):s(te.label);Y+='<tr class="discount-row"><td>'+ce+"</td><td>"+e("sow.featureRemoved")+'</td><td class="discount-price">-$'+te.price.toFixed(0)+"</td></tr>"}),$&&K>0&&(Y+='<tr class="coupon-row"><td>'+$+"</td><td>"+e("sow.couponDiscount")+'</td><td class="discount-price">-$'+K.toFixed(0)+"</td></tr>"),Y+='<tr class="sow-total-row"><td colspan="2"><strong>'+e("sow.totalProjectCost")+"</strong></td><td><strong>$"+_.toFixed(0)+"</strong></td></tr></tbody></table>",A&&A.some(function(te){return te.thirdParty})&&(Y+='<p class="third-party-note-text"><span class="third-party-indicator">*</span> '+e("sow.thirdPartyNote")+"</p>"),Y+='<button type="button" class="view-industry-pricing-btn" onclick="window.contractFormHandler.showPricingComparisonModal()"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>'+e("sow.viewIndustryPricing")+"</button>",Y+="</section>",Y+='<section class="contract-section-inner"><h3>'+e("sow.paymentSchedule")+'</h3><table class="sow-payment-table"><thead><tr><th>'+e("sow.paymentMilestone")+"</th><th>"+e("sow.description")+"</th><th>"+e("sow.amount")+"</th></tr></thead><tbody><tr><td><strong>"+e("sow.initialDeposit")+"</strong></td><td>"+e("sow.dueBeforeWork")+"</td><td><strong>$"+D.toFixed(0)+"</strong></td></tr><tr><td><strong>"+e("sow.milestone1")+"</strong></td><td>"+e("sow.designApproval")+"</td><td><strong>$"+T.toFixed(0)+"</strong></td></tr><tr><td><strong>"+e("sow.finalPayment")+"</strong></td><td>"+e("sow.priorToDeployment")+"</td><td><strong>$"+L.toFixed(0)+"</strong></td></tr></tbody></table></section>",Y+='<section class="contract-section-inner"><h3>'+e("sow.termsConditions")+"</h3><p>"+e("sow.termsText1")+" <strong>"+u.clientName+"</strong>"+e("sow.termsText2")+"</p><p>"+e("sow.termsText3")+'</p></section><section class="contract-section-inner signatures"><h3>'+e("sow.clientSignatureRequired")+"</h3><p>"+e("sow.signatureInstructions")+'</p><div class="signature-block"><h3>'+e("sow.clientSignature")+" "+u.clientName+'</h3><div class="form-row"><div class="form-group"><label>'+e("sow.fullName")+'</label><input type="text" id="sowClientName" value="'+u.clientName+'" required /></div><div class="form-group"><label>'+e("sow.date")+'</label><input type="date" id="sowClientDate" required /></div></div><div class="signature-pad-container"><canvas id="sowClientSignaturePad" class="signature-pad"></canvas><button class="clear-btn" data-canvas="sowClientSignaturePad">'+e("sow.clear")+"</button></div></div></section>",p.innerHTML=Y;var Q=a("#sowClientDate");Q&&(Q.value=new Date().toISOString().split("T")[0]),console.log(" SOW content rendered, signature pad will be initialized by parent function")}},N.prototype.switchSigningTab=function(u){var p=this;c(".signing-tab").forEach(function(_){_.classList.remove("active"),_.getAttribute("data-tab")===u&&_.classList.add("active")}),c(".signing-tab-pane").forEach(function(_){_.classList.remove("active"),_.getAttribute("data-tab")===u&&_.classList.add("active")}),u==="sow"&&setTimeout(function(){var _=document.getElementById("sowClientSignaturePad");if(_){console.log(" SOW tab opened - initializing signature pad"),_.style.pointerEvents="auto",_.style.touchAction="none",_.style.cursor="crosshair";var D=_.closest(".signature-block");D&&(D.classList.remove("signature-locked"),D.style.pointerEvents="auto"),_.style.display="block",_.style.width="100%",_.style.height="270px",requestAnimationFrame(function(){requestAnimationFrame(function(){!window.sowClientPad||typeof window.sowClientPad.resize!="function"?(window.sowClientPad=J(_),console.log(" SOW signature pad created")):(window.sowClientPad.resize(),console.log(" SOW signature pad resized"));var U=_.getBoundingClientRect();console.log("SOW canvas rect:",U.width,"x",U.height,"left:",U.left,"top:",U.top)})});var T=function(){var U=a("#dualSignBtn");if(U){var A=window.sowClientPad&&!window.sowClientPad.isEmpty();U.disabled=!A,U.style.opacity=A?"1":"0.5",console.log("SOW signature state:",A?"Signed ":"Empty ")}};_.addEventListener("mouseup",T),_.addEventListener("touchend",T);var L=a('.clear-btn[data-canvas="sowClientSignaturePad"]');if(L){var F=L.cloneNode(!0);L.parentNode.replaceChild(F,L),F.addEventListener("click",function(U){U.preventDefault(),window.sowClientPad&&(window.sowClientPad.clear(),p.updateSignatureStatus("sow",!1),T())})}T()}else console.error(" SOW signature canvas not found when switching to tab")},100);var g=a("#dualSignBtn"),b=a("#dualSignBtnText");if(u==="contract")b&&(b.textContent=e("signing.nextSignSOW")),g&&(g.disabled=!1,g.style.display="inline-flex");else if(u==="sow"){b&&(b.textContent=e("signing.submitForDev"));var S=window.sowClientPad&&!window.sowClientPad.isEmpty();g&&(g.disabled=!S,g.style.display="inline-flex",g.style.opacity=S?"1":"0.5")}},N.prototype.checkExistingSignatures=function(){var u=!1,p=!1;if(this.clientSignaturePad&&!this.clientSignaturePad.isEmpty()&&(u=!0,this.updateSignatureStatus("contract",!0)),window.sowClientPad&&!window.sowClientPad.isEmpty()&&(p=!0,this.updateSignatureStatus("sow",!0)),u&&p){var g=a("#submitBothBtn");g&&(g.style.display="inline-flex")}},N.prototype.updateSignatureStatus=function(u,p){var g=a("#"+u+"Status"),b=a("#"+u+"Dot");p?(g&&(g.textContent=e("signing.signed"),g.style.color="#10b981"),b&&b.classList.add("completed")):(g&&(g.textContent=e("signing.pending"),g.style.color="#f59e0b"),b&&b.classList.remove("completed"));var S=a("#contractStatus")&&a("#contractStatus").textContent.includes(""),_=a("#sowStatus")&&a("#sowStatus").textContent.includes(""),D=a(".signing-tab.active"),T=D&&D.getAttribute("data-tab")==="sow",L=a("#submitBothBtn");L&&(L.style.display=T&&S&&_?"inline-flex":"none")},N.prototype.validateContractTab=function(){var u=[],p=a("#clientName");(!p||!p.value.trim())&&u.push(" Client Name / Company Name is required");var g=a("#clientSignerName");(!g||!g.value.trim())&&u.push(" Your Full Name is required");var b=a("#clientDate");(!b||!b.value)&&u.push(" Signature Date is required");var S=a("#acknowledgment");return(!S||!S.checked)&&u.push(" You must acknowledge the terms and conditions"),(!this.clientSignaturePad||this.clientSignaturePad.isEmpty())&&u.push(" Your signature is required"),u},N.prototype.checkPendingClientContract=function(u){var p=this;firebase.firestore().collection("contracts").where("clientEmail","==",u).where("status","==","pending_developer").limit(1).get().then(function(g){g.empty||p.showPendingStatus()}).catch(function(g){console.error("Error checking pending contracts:",g)})},N.prototype.showCompletedContract=function(u,p){console.log("Showing completed contract");var g=this;this.isViewingCompletedContract=!0;var b=a("#devPendingBlock");b&&(b.style.display="none");var S=a(".acknowledgment");S&&(S.style.display="none");var _=a("#clientName");_&&(_.value=p.clientName||"",_.setAttribute("readonly","readonly"),_.disabled=!0);var D=a("#clientSubmitMessage");D&&(D.innerHTML="<p><strong>"+e("contract.msg.fullyExecuted")+"</strong></p><p>"+e("contract.msg.bothSigned")+"</p><p>"+e("contract.msg.contractDate")+(p.clientDate||"N/A")+"</p><p>"+e("common.finalized")+": "+(p.finalizedTimestamp?new Date(p.finalizedTimestamp.toDate()).toLocaleDateString():"N/A")+"</p>",D.style.display="block",D.style.background="rgba(46, 204, 113, 0.15)",D.style.borderColor="rgba(46, 204, 113, 0.4)"),this.currentContract={id:u,data:p};var T=a("#submitBtn");if(T){var L=T.cloneNode(!0);L.innerHTML="<span>"+e("contract.btn.downloadSigned")+"</span>",L.style.display="inline-flex",L.disabled=!1,L.style.background="linear-gradient(135deg, #10b981 0%, #059669 100%)",T.parentNode.replaceChild(L,T),L.addEventListener("click",function(F){F.preventDefault(),F.stopPropagation(),console.log("Download button clicked - generating PDF"),g.generatePDF()})}this.displayBothSignatures(p)},N.prototype.displayBothSignatures=function(u){var p=this;console.log("Displaying both signatures..."),console.log("Client signature exists:",!!u.clientSignature),console.log("Dev signature exists:",!!u.devSignature);var g=a("#clientSignatureBlock");if(g){g.style.display="block",g.style.opacity="1";var b=document.getElementById("clientSignaturePad");if(b){var S=b.cloneNode(!0);b.parentNode.replaceChild(S,b)}g.style.pointerEvents="none",g.classList.add("signature-locked");var _=a("#clientSignerName");_&&(_.value=u.clientSignerName||"",_.setAttribute("readonly","readonly"));var D=a("#clientDate");D&&(D.value=u.clientDate||"",D.setAttribute("readonly","readonly"))}var T=a("#devSignatureBlock");if(T){T.style.display="block",T.style.opacity="1";var L=document.getElementById("devSignaturePad");if(L){var F=L.cloneNode(!0);L.parentNode.replaceChild(F,L)}T.style.pointerEvents="none",T.classList.add("signature-locked");var U=a("#devName");U&&(U.value=u.devName||"Carlos Martin",U.setAttribute("readonly","readonly"));var A=a("#devDate");A&&(A.value=u.devDate||"",A.setAttribute("readonly","readonly"))}setTimeout(function(){if(u.clientSignature){var $=document.getElementById("clientSignaturePad");$&&p.drawSignatureOnCanvas($,u.clientSignature)}if(u.devSignature){var K=document.getElementById("devSignaturePad");K&&p.drawSignatureOnCanvas(K,u.devSignature)}},300);var B=a("#devPendingBlock");B&&(B.style.display="none")},N.prototype.drawSignatureOnCanvas=function(u,p){if(!u||!p){console.log("Missing canvas or signature data");return}var g=u.getBoundingClientRect();console.log("Canvas rect:",g.width,g.height),(g.width===0||g.height===0)&&(u.style.width="100%",u.style.height="150px",g=u.getBoundingClientRect());var b=window.devicePixelRatio||1;u.width=g.width*b,u.height=g.height*b;var S=u.getContext("2d");S.scale(b,b),S.clearRect(0,0,g.width,g.height);var _=new Image;_.onload=function(){S.drawImage(_,0,0,g.width,g.height),console.log("Signature drawn on canvas")},_.onerror=function(){console.error("Failed to load signature image")},_.src=p},N.prototype.showPendingStatus=function(){console.log("Client has a pending contract");var u=a("#clientSignatureBlock");u&&(u.style.display="none");var p=a("#clientSubmitMessage");p&&(p.innerHTML="<p><strong>"+e("contract.msg.pendingDev")+"</strong></p><p>"+e("contract.msg.pendingDevDesc")+"</p><p>"+e("contract.msg.pendingDevDownload")+"</p>",p.style.display="block",p.style.background="rgba(241, 196, 15, 0.15)",p.style.borderColor="rgba(241, 196, 15, 0.4)");var g=a("#submitBtn");g&&(g.style.display="none")},N.prototype.loadPendingContract=function(){var u=this;console.log("Loading pending contracts..."),firebase.firestore().collection("contracts").where("status","==","pending_developer").orderBy("timestamp","desc").limit(1).get().then(function(p){if(p.empty)console.log("No pending contracts found");else{var g=p.docs[0];u.currentContract={id:g.id,data:g.data()},u.populateFormWithContract(u.currentContract.data),console.log("Loaded pending contract:",u.currentContract.id)}}).catch(function(p){console.error("Error loading pending contract:",p)})},N.prototype.populateFormWithContract=function(u){console.log("Populating form for developer with client data:",u.clientName);var p=document.createElement("div");p.id="pendingContractInfo",p.style.cssText="background: rgba(99, 102, 241, 0.15); border: 1px solid rgba(99, 102, 241, 0.4); border-radius: 8px; padding: 15px; margin-bottom: 20px; text-align: center;",p.innerHTML='<p style="margin: 0; color: #fff;"><strong>'+e("contract.msg.pendingFromClient")+'</strong></p><p style="margin: 5px 0 0 0; color: rgba(255,255,255,0.8);">'+e("common.client")+": <strong>"+(u.clientName||"N/A")+"</strong> | "+e("common.submitted")+": <strong>"+(u.clientDate||"N/A")+"</strong></p>";var g=a(".signatures");g&&!a("#pendingContractInfo")&&g.insertBefore(p,g.firstChild.nextSibling);var b=a("#clientName");b&&(b.value=u.clientName||"",b.setAttribute("readonly","readonly"),b.disabled=!0,b.style.opacity="0.7");var S=a("#clientNameDisplay");S&&(S.textContent=u.clientName||"Client Name");var _=a("#clientSignatureBlock");if(_&&u.clientSignature){_.style.display="block",_.style.opacity="0.7",_.style.pointerEvents="none";var D=_.querySelector("h3");D&&(D.innerHTML=e("contract.label.clientSig")+(u.clientName||e("common.client"))+' <span style="font-size: 12px; color: #10b981;">'+e("contract.label.signed")+"</span>");var T=a("#clientSignerName");T&&(T.value=u.clientSignerName||"",T.setAttribute("readonly","readonly"),T.disabled=!0);var L=a("#clientDate");L&&(L.value=u.clientDate||"",L.setAttribute("readonly","readonly"),L.disabled=!0);var F=document.getElementById("clientSignaturePad");F&&setTimeout(function(){var K=F.getBoundingClientRect(),Y=window.devicePixelRatio||1;F.width=K.width*Y,F.height=K.height*Y;var Q=F.getContext("2d");Q.scale(Y,Y);var te=new Image;te.onload=function(){Q.drawImage(te,0,0,K.width,K.height)},te.src=u.clientSignature},200);var U=a('.clear-btn[data-canvas="clientSignaturePad"]');U&&(U.style.display="none")}var A=a(".acknowledgment");A&&(A.style.display="none");var B=a("#devSignatureBlock");if(B){B.style.display="block",B.style.opacity="1";var $=B.querySelector("h3");$&&($.innerHTML=e("contract.label.devSig")+' <span style="font-size: 12px; color: #f59e0b;">'+e("contract.label.signBelow")+"</span>")}console.log("Form populated with contract data for developer review")},N.prototype.handleClientSubmit=function(){if(console.log("Handling client submit..."),!this.currentSOW){alert(e("contract.val.sowRequired"));return}var u=[],p=a("#clientName");(!p||!p.value.trim())&&u.push(e("contract.val.clientInfoMissing"));var g=a("#acknowledgment");(!g||!g.checked)&&u.push(e("contract.val.acknowledgment"));var b=a("#clientSignerName");(!b||!b.value.trim())&&u.push(e("contract.val.enterName")),(!this.clientSignaturePad||this.clientSignaturePad.isEmpty())&&u.push(e("contract.val.signatureRequired"));var S=a("#clientDate");if((!S||!S.value)&&u.push(e("contract.val.dateRequired")),u.length>0){alert(e("contract.val.completeRequired")+u.join(`
`));return}this.submitClientSignature()},N.prototype.submitClientSignature=function(){this.currentSOW?this.submitBothSignatures():alert(e("contract.val.sowRequired"))},N.prototype.handleDeveloperSubmit=function(){console.log("Handling developer submit...");var u=[];(!this.devSignaturePad||this.devSignaturePad.isEmpty())&&u.push(e("contract.val.devSignRequired"));var p=a("#devDate");if((!p||!p.value)&&u.push(e("contract.val.devDateRequired")),this.currentContract||u.push(e("contract.val.noPending")),u.length>0){alert(e("contract.val.completeRequired")+u.join(`
`));return}this.finalizeContract()},N.prototype.submitBothSignatures=function(){var u=this;if(console.log("Submitting both contract and SOW signatures..."),!this.clientSignaturePad||this.clientSignaturePad.isEmpty()){alert(e("contract.val.signContract")),this.switchSigningTab("contract");return}var p=a("#sowClientName"),g=a("#sowClientDate");if(!p||!p.value.trim()){alert(e("contract.val.sowName"));return}if(!g||!g.value){alert(e("contract.val.sowDate"));return}if(!window.sowClientPad||window.sowClientPad.isEmpty()){alert(e("contract.val.signSow"));return}var b=a("#submitBothBtn");b&&(b.disabled=!0,b.innerHTML="<span>"+e("contract.btn.submitting")+"</span>");var S=firebase.auth().currentUser,_=S.email||"",D=S.phoneNumber||"",T=this.currentSOW||{},L=T.isBusinessEntity||!1,F=T.businessName||"",U=T.entityType||"",A=T.stateOfFormation||"",B=T.representativeName||"",$=T.representativeTitle||"",K={clientName:L?F:T.clientName,clientSignerName:L?B:a("#clientSignerName").value.trim(),clientDate:a("#clientDate").value,clientSignature:this.clientSignaturePad.toDataURL(),clientEmail:_,clientPhone:M(D),timestamp:firebase.firestore.FieldValue.serverTimestamp(),status:"pending_developer",isBusinessEntity:L,businessName:F,entityType:U,stateOfFormation:A,representativeName:B,representativeTitle:$},Y=window.sowClientPad.toDataURL(),Q=a("#sowClientName").value.trim(),te=a("#sowClientDate").value,ce=null;firebase.firestore().collection("contracts").add(K).then(function(pe){return ce=pe.id,console.log(" Contract saved:",ce),firebase.firestore().collection("sow_documents").doc(u.currentSOW.id).update({clientSignature:Y,clientSignerName:Q,clientSignedDate:te,clientSignedTimestamp:firebase.firestore.FieldValue.serverTimestamp(),linkedContract:ce,linkedContractEmail:_,linkedContractPhone:M(D),status:"pending_developer"})}).then(function(){console.log(" SOW updated and linked to contract");var pe={clientName:Q,clientEmail:_,packageType:u.currentSOW.packageType,estimatedWeeks:u.currentSOW.estimatedWeeks,payment:u.currentSOW.payment,clientSignature:Y,clientSignerName:Q,clientSignedDate:te};u.showDualSigningCompleted(K,pe)}).catch(function(pe){console.error("Error submitting signatures:",pe),alert(e("contract.err.prefix")+pe.message),b&&(b.disabled=!1,b.innerHTML="<span>"+e("contract.btn.submitForDev")+"</span>")})},N.prototype.showExistingCompletion=function(u){var p=this;console.log("Recreating completion view for existing submission"),this.currentContract={id:u.id,data:u};var g=a("#clientSigningTabs");g&&(g.style.display="none");var b=a("#contractForm");b&&(b.style.display="none");var S=u.status==="completed"&&u.devSignature;u.clientEmail?firebase.firestore().collection("sow_documents").where("clientEmail","==",u.clientEmail).where("linkedContract","==",u.id).limit(1).get().then(function(_){var D=null;_.empty||(D=_.docs[0].data(),D.id=_.docs[0].id),p.renderExistingCompletionView(u,D,S)}).catch(function(_){console.error("Error fetching SOW:",_),p.renderExistingCompletionView(u,null,S)}):u.clientPhone?firebase.firestore().collection("sow_documents").where("clientPhone","==",u.clientPhone).where("linkedContract","==",u.id).limit(1).get().then(function(_){var D=null;_.empty||(D=_.docs[0].data(),D.id=_.docs[0].id),p.renderExistingCompletionView(u,D,S)}).catch(function(_){console.error("Error fetching SOW by phone:",_),p.renderExistingCompletionView(u,null,S)}):p.renderExistingCompletionView(u,null,S)},N.prototype.renderExistingCompletionView=function(u,p,g){var b=this,S=a("#closeModalBtn");S&&(S.style.display="flex",S.style.position="sticky",S.style.top="1rem",S.style.alignSelf="flex-end",S.style.marginRight="1.5rem",S.style.marginTop="1rem",S.style.marginBottom="-2.5rem",S.style.flexShrink="0");var _=document.getElementById("dualSigningCompleted");if(!_){_=document.createElement("div"),_.id="dualSigningCompleted",_.className="dual-signing-completed";var D=a(".modal-content"),T=a("#closeModalBtn");T&&T.nextSibling?D.insertBefore(_,T.nextSibling):D&&D.appendChild(_)}var L=g?'<span class="doc-status completed"> Fully Signed</span>':'<span class="doc-status pending"> Awaiting Developer Signature</span>',F=g?"Documents Fully Executed!":"Documents Successfully Submitted!",U=g?"Both you and the developer have signed these documents. Download them below.":"The developer will review and countersign shortly.",A=b.calculatePaymentStatus(p),B=A.allPaid?"paid":A.paidCount>0?"partial":"unpaid",$=A.allPaid?"Paid":A.paidCount+"/"+A.totalCount,K=g&&p&&p.devSignature&&p.clientSignature,Y='<div class="completion-header"><div class="completion-icon"></div><h2>'+F+'</h2><p class="completion-note">'+U+"</p>"+(K?'<button class="download-all-btn" id="downloadBothBtn"> Download All</button>':"")+'</div><div class="completion-tabs"><button class="completion-tab active" data-tab="documents"><span class="tab-icon"></span><span class="tab-label">Documents</span></button><button class="completion-tab" data-tab="payments"><span class="tab-icon"></span><span class="tab-label">Payment Status</span><span class="payment-badge '+B+'">'+$+'</span></button></div><div class="completion-tab-content"><div class="completion-tab-pane active" data-tab="documents"><div class="completed-documents"><div class="completed-doc-card"><div class="doc-card-header"><h3> Contract Agreement</h3>'+L+'</div><div class="doc-card-body"><div class="doc-field-row"><span class="field-label">Client:</span><span class="field-value">'+(u.clientName||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">'+(u.clientEmail?"Email:":"Phone:")+'</span><span class="field-value">'+(u.clientEmail||(u.clientPhone?C(u.clientPhone):"N/A"))+'</span></div><div class="doc-field-row"><span class="field-label">Client Signed:</span><span class="field-value">'+(u.clientDate||"N/A")+"</span></div>"+(g?'<div class="doc-field-row"><span class="field-label">Developer Signed:</span><span class="field-value">'+(u.devDate||"N/A")+"</span></div>":"")+'</div><div class="doc-signature-preview"><p class="signature-label">Your Signature:</p><img src="'+u.clientSignature+'" alt="Your signature" class="signature-image" style="width: 100%; max-width: 100%; height: auto; background: rgba(255, 255, 255, 0.05); border-radius: 6px; padding: 0.5rem; border: 1px solid rgba(255, 255, 255, 0.1);" /></div>';if(g&&(Y+='<div class="doc-actions"><button class="doc-action-btn doc-download-btn" id="downloadContractBtn"> Download Contract</button></div>'),Y+="</div>",p){var Q=p.devSignature&&p.clientSignature,te=Q?'<span class="doc-status completed"> Fully Signed</span>':'<span class="doc-status pending"> Awaiting Developer Signature</span>';if(Y+='<div class="completed-doc-card"><div class="doc-card-header"><h3> Statement of Work</h3>'+te+'</div><div class="doc-card-body"><div class="doc-field-row"><span class="field-label">Client Name:</span><span class="field-value">'+(p.clientName||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Package:</span><span class="field-value">'+(p.packageType||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Total Cost:</span><span class="field-value">$'+(p.payment?p.payment.total.toFixed(0):"0")+'</span></div><div class="doc-field-row"><span class="field-label">Timeline:</span><span class="field-value">'+(p.estimatedWeeks||"TBD")+' weeks</span></div><div class="doc-field-row"><span class="field-label">Client Signed:</span><span class="field-value">'+(p.clientSignedDate||"N/A")+"</span></div>"+(Q?'<div class="doc-field-row"><span class="field-label">Developer Signed:</span><span class="field-value">'+(p.devSignedDate||"N/A")+"</span></div>":"")+'</div><div class="doc-signature-preview"><p class="signature-label">Your Signature:</p><img src="'+p.clientSignature+'" alt="Your SOW signature" class="signature-image" style="width: 100%; max-width: 100%; height: auto; background: rgba(255, 255, 255, 0.05); border-radius: 6px; padding: 0.5rem; border: 1px solid rgba(255, 255, 255, 0.1);" /></div>',Q){var ce="sowData_"+p.id.replace(/[^a-zA-Z0-9]/g,"_");if(window[ce]=p,Y+='<div class="doc-actions doc-actions-split"><button type="button" class="doc-action-btn doc-download-btn" onclick="window.contractFormHandler.generateSOWPDF(window.'+ce+')"> Download SOW</button>',p.hasChangeRequest&&p.changeRequestId){var pe={pending:{bg:"linear-gradient(135deg, #f59e0b, #d97706)",text:" View Request"},approved:{bg:"linear-gradient(135deg, #10b981, #059669)",text:" View Approved"},rejected:{bg:"linear-gradient(135deg, #ef4444, #dc2626)",text:" View Response"},change_order:{bg:"linear-gradient(135deg, #6366f1, #4f46e5)",text:" View Order"}},ge=pe[p.changeRequestStatus]||pe.pending;Y+='<button type="button" id="changeRequestBtn-'+p.id+'" class="doc-action-btn doc-change-btn" style="background: '+ge.bg+`;" onclick="window.contractFormHandler.viewChangeRequest('`+p.changeRequestId+`')">`+ge.text+"</button>"}else Y+='<button type="button" id="changeRequestBtn-'+p.id+'" class="doc-action-btn doc-change-btn" onclick="window.contractFormHandler.showChangeRequestModal(window.'+ce+')"> Request Change</button>';Y+="</div>"}Y+="</div>"}Y+="</div>",Y+="</div>",Y+='<div class="completion-tab-pane" data-tab="payments">',Y+=b.renderPaymentStatusContent(p,A),Y+="</div>",Y+="</div>",_.innerHTML=Y,_.style.display="block";var Se=_.querySelectorAll(".completion-tab");Se.forEach(function(xe){xe.addEventListener("click",function(){var $e=this.getAttribute("data-tab");Se.forEach(function(je){je.classList.remove("active")}),this.classList.add("active");var it=_.querySelectorAll(".completion-tab-pane");it.forEach(function(je){je.getAttribute("data-tab")===$e?je.classList.add("active"):je.classList.remove("active")})})});var Ee=document.getElementById("downloadContractBtn");Ee&&Ee.addEventListener("click",function(xe){xe.preventDefault(),b.generatePDF()});var re=document.getElementById("downloadBothBtn");re&&re.addEventListener("click",function(xe){xe.preventDefault(),b.generateCombinedPDF(p)})},N.prototype.calculatePaymentStatus=function(u){var p={paidCount:0,totalCount:0,paidAmount:0,totalAmount:0,owedAmount:0,allPaid:!1,payments:[]};if(!u||!u.payment)return p;var g=u.payment,b=g.tracking||{},S=g.deferred&&g.deferred.enabled;if(S&&g.deferred.customSchedule&&g.deferred.customSchedule.length>0){var _=b.deferredPayments||[];g.deferred.customSchedule.forEach(function(T,L){var F=_[L]&&_[L].paid,U=_[L]?_[L].paidDate:null;p.payments.push({name:"Payment "+(L+1),amount:T.amount,dueDate:T.dueDate,paid:F,paidDate:U}),p.totalCount++,p.totalAmount+=T.amount,F&&(p.paidCount++,p.paidAmount+=T.amount)})}else{var D=[{key:"deposit",name:"Deposit (50%)",amount:g.deposit},{key:"milestone1",name:"Milestone (25%)",amount:g.milestone1},{key:"final",name:"Final (25%)",amount:g.final}];D.forEach(function(T){var L=b[T.key+"Paid"]||!1,F=b[T.key+"PaidDate"]||null;p.payments.push({name:T.name,amount:T.amount,paid:L,paidDate:F}),p.totalCount++,p.totalAmount+=T.amount,L&&(p.paidCount++,p.paidAmount+=T.amount)})}return p.owedAmount=p.totalAmount-p.paidAmount,p.allPaid=p.paidCount===p.totalCount&&p.totalCount>0,p},N.prototype.renderPaymentStatusContent=function(u,p){if(!u||!u.payment)return'<div class="payment-status-empty"><p>No payment information available.</p></div>';function g(U){if(!U)return"";var A=new Date(U+"T00:00:00"),B=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],$=B[A.getMonth()]+" "+A.getDate()+", "+A.getFullYear(),K=new Date;K.setHours(0,0,0,0);var Y=A.getTime()-K.getTime(),Q=Math.ceil(Y/(1e3*60*60*24)),te="";return Q===0?te="today":Q===1?te="tomorrow":Q>0?te="in "+Q+" days":Q===-1?te="1 day ago":te=Math.abs(Q)+" days ago","Due "+$+" ("+te+")"}var b=[],S=[];p.payments.forEach(function(U){U.paid?b.push(U):S.push(U)});var _=S.length>0?S[0]:null,D=S.slice(1),T=p.totalAmount>0?Math.round(p.paidAmount/p.totalAmount*100):0,L='<div class="payment-status-container">';if(L+='<div class="payment-progress-summary"><div class="progress-amounts"><span class="progress-paid">$'+p.paidAmount.toFixed(2)+'</span><span class="progress-total">of $'+p.totalAmount.toFixed(2)+'</span></div><div class="progress-bar-minimal"><div class="progress-bar-fill" style="width: '+T+'%;"></div></div></div>',b.length>0&&(L+='<div class="completed-payments-section"><div class="completed-payments-row">',b.forEach(function(U){L+='<div class="completed-payment-chip"><span class="chip-name">'+U.name+'</span><span class="chip-amount">$'+U.amount.toFixed(2)+"</span></div>"}),L+="</div></div>"),_?L+='<div class="next-payment-card"><div class="next-payment-label">Next Payment</div><div class="next-payment-main"><div class="next-payment-amount">$'+_.amount.toFixed(2)+'</div><div class="next-payment-info"><span class="next-payment-name">'+_.name+"</span>"+(_.dueDate?'<span class="next-payment-due">'+g(_.dueDate)+"</span>":"")+"</div></div></div>":p.allPaid&&(L+='<div class="next-payment-card"><div class="next-payment-label">Complete</div><div class="next-payment-main"><div class="next-payment-amount" style="color: #10b981;"></div><div class="next-payment-info"><span class="next-payment-name">All payments received</span><span class="next-payment-due">Thank you</span></div></div></div>'),D.length>0){var F=D.reduce(function(U,A){return U+A.amount},0);L+='<div class="future-payments-summary"><span class="future-count">'+D.length+" more payment"+(D.length>1?"s":"")+'</span><span class="future-total">$'+F.toFixed(2)+" remaining</span></div>"}return L+="</div>",L},N.prototype.showDualSigningCompleted=function(u,p){console.log("Showing dual signing completed view"),this.currentContract={id:u.id||"pending",data:u};var g=a("#clientSigningTabs");g&&(g.style.display="none",g.remove());var b=a("#contractForm");b&&(b.style.display="none");var S=a("#closeModalBtn");S&&(S.style.display="flex",S.style.position="sticky",S.style.top="1rem",S.style.alignSelf="flex-end",S.style.marginRight="1.5rem",S.style.marginTop="1rem",S.style.marginBottom="-2.5rem",S.style.flexShrink="0");var _=a(".modal-content");if(_){var D=document.createElement("div");D.id="dualSigningCompleted",D.className="dual-signing-completed",D.innerHTML='<div class="completion-header"><div class="completion-icon"></div><h2>Documents Successfully Submitted!</h2><p>Both your Contract and Statement of Work have been signed and submitted.</p><p class="completion-note">The developer will review and countersign shortly. You can download the PDFs once both parties have signed.</p></div><div class="completed-documents"><div class="completed-doc-card"><div class="doc-card-header"><h3> Contract Agreement</h3><span class="doc-status pending"> Awaiting Developer Signature</span></div><div class="doc-card-body"><div class="doc-field-row"><span class="field-label">Client Name:</span><span class="field-value">'+(u.clientName||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Signer Name:</span><span class="field-value">'+(u.clientSignerName||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Date Signed:</span><span class="field-value">'+(u.clientDate||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">'+(u.clientEmail?"Email:":"Phone:")+'</span><span class="field-value">'+(u.clientEmail||(u.clientPhone?C(u.clientPhone):"N/A"))+'</span></div></div><div class="doc-signature-preview"><p class="signature-label">Your Signature:</p><img src="'+u.clientSignature+'" alt="Your signature" class="signature-image" /></div></div><div class="completed-doc-card"><div class="doc-card-header"><h3> Statement of Work</h3><span class="doc-status pending"> Awaiting Developer Signature</span></div><div class="doc-card-body"><div class="doc-field-row"><span class="field-label">Client Name:</span><span class="field-value">'+(p.clientName||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Package:</span><span class="field-value">'+(p.packageType||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Total Cost:</span><span class="field-value">$'+(p.payment?p.payment.total.toFixed(0):"0")+'</span></div><div class="doc-field-row"><span class="field-label">Timeline:</span><span class="field-value">'+(p.estimatedWeeks||"TBD")+' weeks</span></div><div class="doc-field-row"><span class="field-label">Client Signed:</span><span class="field-value">'+(p.clientSignedDate||"N/A")+'</span></div></div><div class="doc-signature-preview"><p class="signature-label">Your Signature:</p><img src="'+p.clientSignature+'" alt="Your SOW signature" class="signature-image" /></div></div></div><div class="completion-actions"></div>';var T=a("#closeModalBtn");T&&T.nextSibling?_.insertBefore(D,T.nextSibling):_.appendChild(D),alert(e("contract.msg.submitSuccess"))}},N.prototype.finalizeContract=function(){var u=this,p=a("#submitBtn"),g=p?p.innerHTML:"";if(p&&(p.disabled=!0,p.innerHTML="<span>"+e("contract.btn.finalizing")+"</span>"),!this.currentContract){alert(e("contract.val.noPending")),p&&(p.disabled=!1,p.innerHTML=g);return}console.log("Finalizing contract:",this.currentContract.id);var b=this.devSignaturePad?this.devSignaturePad.toDataURL():"",S=a("#devDate")?a("#devDate").value:new Date().toISOString().split("T")[0],_={devName:"Carlos Martin",devSignature:b,devDate:S,devEmail:firebase.auth().currentUser.email,finalizedTimestamp:firebase.firestore.FieldValue.serverTimestamp(),status:"completed"},D=Object.assign({},this.currentContract.data,_);firebase.firestore().collection("contracts").doc(this.currentContract.id).update(_).then(function(){console.log("Contract finalized successfully in Firebase"),u.currentContract.data=D,u.showDeveloperSuccessMessage()}).catch(function(T){console.error("Error finalizing contract:",T),alert(e("contract.err.finalize")+T.message+e("contract.err.finalizeSuffix")),p&&(p.disabled=!1,p.innerHTML=g)})},N.prototype.showClientSuccessMessage=function(){var u=a("#clientSubmitMessage"),p=a("#clientEmailDisplay");if(u){var g=firebase.auth().currentUser;g&&p&&(p.textContent=g.email||g.phoneNumber||"your account"),u.style.display="block",u.scrollIntoView({behavior:"smooth",block:"center"})}var b=a("#clientSignatureBlock");b&&(b.style.display="none");var S=a("#devPendingBlock");S&&(S.style.display="none");var _=a(".acknowledgment");_&&(_.style.display="none")},N.prototype.showDeveloperSuccessMessage=function(){var u=this,p=a("#submitBtn");p&&(p.innerHTML="<span>"+e("contract.btn.uploadedDownload")+"</span>",p.style.background="linear-gradient(135deg, #10b981 0%, #059669 100%)",p.disabled=!1,p.onclick=function(b){b.preventDefault(),u.generatePDF()});var g=a("#downloadBtn");g&&(g.style.display="inline-flex",g.onclick=function(b){b.preventDefault(),u.generatePDF()}),alert(e("contract.msg.uploadSuccess"))},N.prototype.generatePDF=function(){var u=this.currentContract?this.currentContract.data:null,p=this.currentContract?this.currentContract.id:null;if(!u){alert(e("pdf.err.noContract"));return}var g=window.open("","_blank");if(!g){alert(e("pdf.err.popups"));return}var b=u.clientDate||"N/A",S=u.devDate||"N/A",_=u.clientName||"N/A",D=u.clientSignerName||"N/A",T=u.clientEmail||"",L=u.clientPhone||"",F=T||(L?C(L):"N/A"),U=T?"Email":"Phone",A=u.devName||"Carlos Martin",B=u.devEmail||"carlos@scarlo.dev",$=u.clientSignature||"",K=u.devSignature||"",Y=u.isBusinessEntity||!1,Q=u.businessName||"",te=u.entityType||"",ce=u.stateOfFormation||"",pe=u.representativeName||"",ge=u.representativeTitle||"",Se='<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=1024"><title>Website Development Agreement - '+(Y?Q:_)+'</title><link rel="icon" type="image/png" href="https://scarlo.dev/favicons/favicon-96x96.png"><style>* { margin: 0; padding: 0; box-sizing: border-box; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; text-size-adjust: 100%; }body { font-family: "Times New Roman", Times, serif; font-size: 11pt; line-height: 1.6; color: #000; background: #fff; padding: 0.75in 1in; }.contract-container { max-width: 750px; margin: 0 auto; }h1 { font-size: 18pt; text-align: center; margin-bottom: 8px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }h2 { font-size: 11pt; margin-top: 20px; margin-bottom: 10px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #000; padding-bottom: 4px; }h3 { font-size: 10.5pt; margin-top: 14px; margin-bottom: 6px; font-weight: bold; }p { margin-bottom: 10px; text-align: justify; }ul, ol { margin-left: 30px; margin-bottom: 10px; }li { margin-bottom: 5px; }.header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #000; }.subtitle { font-size: 11pt; margin-top: 6px; font-style: italic; }.parties { padding: 15px 20px; border: 1px solid #000; margin: 20px 0; }.section { margin-bottom: 18px; page-break-inside: avoid; }.caps-section { text-transform: uppercase; font-weight: bold; }.highlight-box { padding: 15px 20px; margin: 15px 0; border: 1px solid #000; border-left: 4px solid #000; }.signature-page { page-break-before: always; margin-top: 50px; }.signature-block { display: inline-block; width: 45%; vertical-align: top; margin: 20px 2%; }.signature-line { border-bottom: 1px solid #000; height: 70px; margin: 10px 0; display: flex; align-items: flex-end; justify-content: center; }.signature-line img { max-height: 60px; max-width: 100%; filter: invert(1) grayscale(1); }.signature-label { font-size: 9pt; margin-top: 5px; font-style: italic; }.signature-name { font-weight: bold; margin-top: 10px; font-size: 10pt; }.signature-date { margin-top: 5px; font-size: 10pt; }.signature-email { font-size: 9pt; font-style: italic; }.footer { margin-top: 50px; text-align: center; font-size: 9pt; border-top: 1px solid #000; padding-top: 20px; }.contract-id { font-size: 8pt; margin-top: 10px; font-style: italic; }.important { font-weight: bold; text-transform: uppercase; }.indented { margin-left: 25px; }.logo { max-width: 180px; max-height: 60px; margin-bottom: 15px; }@media print { body { padding: 0; margin: 0; } .contract-container { max-width: 100%; } .signature-page { page-break-before: always; } }@page { margin: 0.5in 0.6in; size: letter; }</style></head><body><div class="contract-container"><div class="header"><img src="'+x()+'" alt="Scarlo Logo" class="logo" /><h1>'+e("pdf.contract.title")+'</h1><div class="subtitle">'+e("pdf.contract.subtitle")+'</div></div><div class="section"><h2>'+e("pdf.contract.parties")+"</h2><p>"+e("pdf.contract.partiesIntro")+" <strong>"+b+"</strong> "+e("pdf.contract.between")+'</p><div class="parties"><p><strong>'+e("pdf.contract.developer")+"</strong> "+e("pdf.contract.developerDesc")+"</p>"+(Y?"<p><strong>"+e("pdf.contract.client")+"</strong> "+Q+", a "+te+(ce?" "+e("common.formedIn")+" "+ce:"")+(T?" ("+T+")":"")+"</p>":"<p><strong>"+e("pdf.contract.client")+"</strong> "+_+(T?" ("+T+")":"")+"</p>")+'</div></div><div class="section"><h2>'+e("pdf.contract.scope")+"</h2><p>"+e("pdf.contract.scopeText")+'</p></div><div class="section"><h2>'+e("pdf.contract.paymentTerms")+"</h2><p><strong>"+e("pdf.contract.paymentSchedule")+"</strong></p><ul><li><strong>"+e("pdf.contract.depositLine")+"</strong> "+e("pdf.contract.depositDesc")+"</li><li><strong>"+e("pdf.contract.milestoneLine")+"</strong> "+e("pdf.contract.milestoneDesc")+"</li><li><strong>"+e("pdf.contract.finalLine")+"</strong> "+e("pdf.contract.finalDesc")+"</li></ul><p><strong>"+e("pdf.contract.cancellationPolicy")+"</strong> "+e("pdf.contract.cancellationText")+"</p><p><strong>"+e("pdf.contract.latePayments")+"</strong> "+e("pdf.contract.latePaymentsText")+'</p></div><div class="section"><h2>'+e("pdf.contract.ip")+"</h2><p><strong>"+e("pdf.contract.ipClient")+"</strong> "+e("pdf.contract.ipClientDesc")+"</p><p><strong>"+e("pdf.contract.ipDev")+"</strong> "+e("pdf.contract.ipDevDesc")+"</p><p><strong>"+e("pdf.contract.ipImportant")+"</strong> "+e("pdf.contract.ipImportantDesc")+'</p></div><div class="section"><h2>'+e("pdf.contract.revisions")+"</h2><p>"+e("pdf.contract.revisionsText")+'</p></div><div class="section"><h2>'+e("pdf.contract.warranty")+"</h2><p><strong>"+e("pdf.contract.warranty").split(".")[0]+":</strong> "+e("pdf.contract.warrantyText")+'</p><div class="highlight-box"><p class="caps-section"><strong>'+e("pdf.contract.warrantyDisclaimer")+"</strong> "+e("pdf.contract.warrantyDisclaimerText")+'</p><p class="caps-section" style="margin-top: 10px;"><strong>'+e("pdf.contract.liabilityLimit")+"</strong> "+e("pdf.contract.liabilityLimitText")+'</p></div></div><div class="section"><h2>'+e("pdf.contract.indemnification")+"</h2><p><strong>"+e("pdf.contract.clientIndemnifies")+"</strong> "+e("pdf.contract.clientIndemnifiesText")+"</p><p><strong>"+e("pdf.contract.devIndemnifies")+"</strong> "+e("pdf.contract.devIndemnifiesText")+'</p></div><div class="section"><h2>'+e("pdf.contract.termination")+"</h2><p><strong>"+e("pdf.contract.termByClient")+"</strong> "+e("pdf.contract.termByClientText")+"</p><p><strong>"+e("pdf.contract.termByDev")+"</strong> "+e("pdf.contract.termByDevText")+"</p><p><strong>"+e("pdf.contract.termForCause")+"</strong> "+e("pdf.contract.termForCauseText")+'</p></div><div class="section"><h2>'+e("pdf.contract.disputeResolution")+"</h2><p><strong>"+e("pdf.contract.disputeProcess")+"</strong> "+e("pdf.contract.disputeProcessText")+"</p><p><strong>"+e("pdf.contract.attorneysFees")+"</strong> "+e("pdf.contract.attorneysFeesText")+'</p></div><div class="section"><h2>'+e("pdf.contract.generalTerms")+"</h2><p><strong>"+e("pdf.contract.governingLaw")+"</strong> "+e("pdf.contract.governingLawText")+"</p><p><strong>"+e("pdf.contract.forceMajeure")+"</strong> "+e("pdf.contract.forceMajeureText")+"</p><p><strong>"+e("pdf.contract.assignment")+"</strong> "+e("pdf.contract.assignmentText")+"</p><p><strong>"+e("pdf.contract.severability")+"</strong> "+e("pdf.contract.severabilityText")+"</p><p><strong>"+e("pdf.contract.confidentiality")+"</strong> "+e("pdf.contract.confidentialityText")+"</p><p><strong>"+e("pdf.contract.independentContractor")+"</strong> "+e("pdf.contract.independentContractorText")+"</p><p><strong>"+e("pdf.contract.entireAgreement")+"</strong> "+e("pdf.contract.entireAgreementText")+'</p></div><div class="signature-page"><h2 style="text-align: center; border: none; margin-bottom: 20px;">'+e("pdf.contract.signaturePage")+'</h2><p style="text-align: center; margin-bottom: 30px;">'+e("pdf.contract.signatureIntro")+'</p><div style="display: flex; justify-content: space-between; margin-top: 30px;"><div class="signature-block"><h3 style="font-size: 10pt;">'+e("pdf.contract.devSignature")+'</h3><div class="signature-line">'+(K?'<img src="'+K+'" alt="Developer Signature" />':'<span style="font-style: italic;">'+e("pdf.contract.awaitingSignature")+"</span>")+'</div><div class="signature-label">'+e("pdf.contract.authorizedSignature")+'</div><div class="signature-name">'+A+'</div><div class="signature-date">'+e("common.date")+" "+S+'</div><div class="signature-email">'+e("common.email")+" "+B+'</div></div><div class="signature-block"><h3 style="font-size: 10pt;">'+e("pdf.contract.clientSignature")+" "+(Y?Q:_)+"</h3>"+(Y?'<p style="font-size: 9pt; margin-bottom: 5px;">'+te+(ce?" ("+ce+")":"")+"</p>":"")+'<div class="signature-line">'+($?'<img src="'+$+'" alt="Client Signature" />':'<span style="font-style: italic;">'+e("pdf.contract.awaitingSignature")+"</span>")+'</div><div class="signature-label">'+e("pdf.contract.authorizedSignature")+'</div><div class="signature-name">'+(Y?e("common.by")+" "+pe+", "+ge:D)+'</div><div class="signature-date">'+e("common.date")+" "+b+'</div><div class="signature-email">'+U+": "+F+'</div></div></div></div><div class="footer"><p><strong> '+new Date().getFullYear()+" Scarlo  Carlos Martin</strong></p><p>"+e("pdf.contract.professionalServices")+'</p><p class="contract-id">Contract ID: '+(p||"DRAFT")+'</p><p class="contract-id">Generated: '+new Date().toLocaleString()+"</p></div></div><script>window.onload = function() {  var images = document.images;  var loaded = 0;  var total = images.length;  if (total === 0) { setTimeout(function() { window.print(); }, 300); return; }  for (var i = 0; i < total; i++) {    if (images[i].complete) { loaded++; }    else { images[i].onload = images[i].onerror = function() { loaded++; if (loaded >= total) setTimeout(function() { window.print(); }, 300); }; }  }  if (loaded >= total) setTimeout(function() { window.print(); }, 300);};<\/script></body></html>";g.document.write(Se),g.document.close()},N.prototype.generateCombinedPDF=function(u){var p=this,g=this.currentContract?this.currentContract.data:null;if(!g){alert(e("pdf.err.noContractData"));return}if(!u){alert(e("pdf.err.noSowData"));return}var b=window.open("","_blank");if(!b){alert(e("pdf.err.popups"));return}var S=g.clientDate||"N/A",_=g.devDate||"N/A",D=g.clientName||"N/A",T=g.clientSignerName||"N/A",L=g.clientEmail||"",F=g.clientPhone||"",U=L||(F?C(F):"N/A"),A=L?"Email":"Phone",B=g.devName||"Carlos Martin",$=g.devEmail||"N/A",K=g.clientSignature||"",Y=g.devSignature||"",Q=g.isBusinessEntity||u.isBusinessEntity||!1,te=g.businessName||u.businessName||"",ce=g.entityType||u.entityType||"",pe=g.stateOfFormation||u.stateOfFormation||"",ge=g.representativeName||u.representativeName||"",Se=g.representativeTitle||u.representativeTitle||"",Ee={essential:e("pkg.essential"),starter:e("pkg.starter"),growth:e("pkg.growth"),professional:e("pkg.professional"),enterprise:e("pkg.enterprise"),custom:e("pkg.custom")},re={essential:{includes:[e("pkg.essential.i1"),e("pkg.essential.i2"),e("pkg.essential.i3"),e("pkg.essential.i4"),e("pkg.essential.i5"),e("pkg.essential.i6")]},starter:{includes:[e("pkg.starter.i1"),e("pkg.starter.i2"),e("pkg.starter.i3"),e("pkg.starter.i4"),e("pkg.starter.i5"),e("pkg.starter.i6"),e("pkg.starter.i7")]},growth:{includes:[e("pkg.growth.i1"),e("pkg.growth.i2"),e("pkg.growth.i3"),e("pkg.growth.i4"),e("pkg.growth.i5"),e("pkg.growth.i6"),e("pkg.growth.i7")]},professional:{includes:[e("pkg.professional.i1"),e("pkg.professional.i2"),e("pkg.professional.i3"),e("pkg.professional.i4"),e("pkg.professional.i5"),e("pkg.professional.i6"),e("pkg.professional.i7"),e("pkg.professional.i8")]},enterprise:{includes:[e("pkg.enterprise.i1"),e("pkg.enterprise.i2"),e("pkg.enterprise.i3"),e("pkg.enterprise.i4"),e("pkg.enterprise.i5"),e("pkg.enterprise.i6"),e("pkg.enterprise.i7"),e("pkg.enterprise.i8")]}},xe=re[u.packageType]||{includes:[]},$e=u.payment?u.payment.total:0,it=$e*.5,je=$e*.25,nt=$e*.25,Qe={none:{name:e("maint.none.name"),cost:e("maint.none.price")},basic:{name:e("maint.basic.name"),cost:e("maint.basic.price"),desc:e("maint.basic.desc")},professional:{name:e("maint.professional.name"),cost:e("maint.professional.price"),desc:e("maint.professional.desc")},premium:{name:e("maint.premium.name"),cost:e("maint.premium.price"),desc:e("maint.premium.desc")}},at=Qe[u.maintenancePlan||"none"]||Qe.none,Ye='<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=1024"><title>Complete Agreement Package - '+(Q?te:D)+'</title><link rel="icon" type="image/png" href="https://scarlo.dev/favicons/favicon-96x96.png"><style>* { margin: 0; padding: 0; box-sizing: border-box; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; text-size-adjust: 100%; }body { font-family: "Times New Roman", Times, serif; font-size: 11pt; line-height: 1.6; color: #000; background: #fff; padding: 0.75in 1in; }h1 { font-size: 18pt; text-align: center; margin-bottom: 8px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }h2 { font-size: 11pt; margin-top: 20px; margin-bottom: 10px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #000; padding-bottom: 4px; }h3 { font-size: 10.5pt; margin-top: 14px; margin-bottom: 6px; font-weight: bold; }p { margin-bottom: 10px; text-align: justify; }ul, ol { margin-left: 30px; margin-bottom: 10px; }li { margin-bottom: 5px; }.header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #000; }.subtitle { font-size: 11pt; margin-top: 6px; font-style: italic; }.parties { padding: 15px 20px; border: 1px solid #000; margin: 20px 0; }.section { margin-bottom: 18px; page-break-inside: avoid; }.signature-page { page-break-before: always; margin-top: 50px; }.signature-block { display: inline-block; width: 45%; vertical-align: top; margin: 20px 2%; }.signature-line { border-bottom: 1px solid #000; height: 70px; margin: 10px 0; display: flex; align-items: flex-end; justify-content: center; }.signature-line img { max-height: 60px; max-width: 100%; filter: invert(1) grayscale(1); }.signature-label { font-size: 9pt; margin-top: 5px; font-style: italic; }.signature-name { font-weight: bold; margin-top: 10px; font-size: 10pt; }.signature-date { margin-top: 5px; font-size: 10pt; }.signature-email { font-size: 9pt; font-style: italic; }.footer { margin-top: 50px; text-align: center; font-size: 9pt; border-top: 1px solid #000; padding-top: 20px; }.contract-id { font-size: 8pt; margin-top: 10px; font-style: italic; }.page-break { page-break-before: always; }.info-box { padding: 15px 20px; border: 1px solid #000; border-left: 4px solid #000; margin: 20px 0; }.info-box h3 { margin-top: 0; }.payment-table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 10pt; }.payment-table th, .payment-table td { border: 1px solid #000; padding: 10px 12px; text-align: left; }.payment-table th { font-weight: bold; }.total-row { font-weight: bold; font-size: 11pt; border-top: 2px solid #000; }.highlight { font-weight: bold; }.logo { max-width: 180px; max-height: 60px; margin-bottom: 15px; }@media print { body { padding: 0; margin: 0; } .signature-page, .page-break { page-break-before: always; } }@page { margin: 0.5in 0.6in; size: letter; }</style></head><body><div class="header"><img src="'+x()+'" alt="Scarlo Logo" class="logo" /><h1>'+e("pdf.contract.title")+'</h1><div class="subtitle">'+e("pdf.contract.subtitle")+'</div></div><div class="section"><h2>'+e("pdf.combined.partiesToAgreement")+"</h2><p>"+e("pdf.combined.partiesIntro")+" <strong>"+S+"</strong> "+e("pdf.combined.effectiveDate")+'</p><div class="parties"><p><strong>Scarlo</strong>, '+e("pdf.combined.devDesc")+"</p><p>"+e("pdf.combined.and")+"</p>"+(Q?"<p><strong>"+te+"</strong>, a "+ce+(pe?" "+e("common.formedIn")+" "+pe:"")+" "+e("pdf.combined.theClient")+"</p>":"<p><strong>"+D+"</strong> "+e("pdf.combined.theClient")+"</p>")+'<p style="font-size: 10pt; font-style: italic; margin-top: 10px;">'+e("pdf.combined.partyNote")+'</p></div></div><div class="section"><h2>'+e("pdf.combined.projectScope")+"</h2><h3>"+e("pdf.combined.overview")+"</h3><p>"+e("pdf.combined.overviewText")+"</p><h3>"+e("pdf.combined.sowSection")+"</h3><p>"+e("pdf.combined.sowText")+"</p><h3>"+e("pdf.combined.scopeLimitations")+"</h3><p>"+e("pdf.combined.scopeLimitationsText")+'</p></div><div class="section"><h2>'+e("pdf.combined.packagesPricing")+"</h2><p>"+e("pdf.combined.packagesPricingText")+'</p></div><div class="section"><h2>'+e("pdf.combined.paymentTerms")+"</h2><p>"+e("pdf.combined.unlessSpecified")+"</p><h3>"+e("pdf.combined.deposit")+"</h3><p>"+e("pdf.combined.depositText")+"</p><h3>"+e("pdf.combined.milestonePayments")+"</h3><p>"+e("pdf.combined.milestonePaymentsIntro")+"</p><ul><li>"+e("pdf.combined.milestonePayment1")+"</li><li>"+e("pdf.combined.milestonePayment2")+"</li></ul><h3>"+e("pdf.combined.latePayments")+"</h3><p>"+e("pdf.combined.latePaymentsText")+'</p></div><div class="section"><h2>'+e("pdf.combined.clientResponsibilities")+"</h2><p>"+e("pdf.combined.clientRespText")+"</p><p>"+e("pdf.combined.clientRespText2")+'</p></div><div class="section"><h2>'+e("pdf.combined.revisions")+"</h2><p>"+e("pdf.combined.revisionsIntro")+"</p><ul><li>"+e("pdf.combined.revision1")+"</li><li>"+e("pdf.combined.revision2")+'</li></ul></div><div class="section"><h2>'+e("pdf.combined.ipRights")+"</h2><h3>"+e("pdf.combined.devOwnership")+"</h3><p>"+e("pdf.combined.devOwnershipText")+"</p><h3>"+e("pdf.combined.clientOwnership")+"</h3><p>"+e("pdf.combined.clientOwnershipText")+'</p></div><div class="section"><h2>'+e("pdf.combined.maintenanceSupport")+"</h2><p>"+e("pdf.combined.maintenanceSupportText")+'</p></div><div class="section"><h2>'+e("pdf.combined.timelineDelivery")+"</h2><p>"+e("pdf.combined.timelineDeliveryText")+'</p></div><div class="section"><h2>'+e("pdf.combined.changeOrders")+"</h2><p>"+e("pdf.combined.changeOrdersText")+'</p></div><div class="section"><h2>'+e("pdf.combined.warrantyLimitations")+"</h2><h3>"+e("pdf.combined.devWarranty")+"</h3><p>"+e("pdf.combined.devWarrantyText")+"</p><h3>"+e("pdf.combined.exclusions")+"</h3><p>"+e("pdf.combined.exclusionsText")+"</p><h3>"+e("pdf.combined.liabilityLimitations")+"</h3><p>"+e("pdf.combined.liabilityLimitationsText")+'</p></div><div class="section"><h2>'+e("pdf.combined.confidentiality")+"</h2><p>"+e("pdf.combined.confidentialityText")+'</p></div><div class="section"><h2>'+e("pdf.combined.indemnification")+"</h2><p>"+e("pdf.combined.indemnificationText")+'</p></div><div class="section"><h2>'+e("pdf.combined.termination")+"</h2><p>"+e("pdf.combined.terminationText")+'</p></div><div class="section"><h2>'+e("pdf.combined.governingLaw")+"</h2><p>"+e("pdf.combined.governingLawText")+'</p></div><div class="section"><h2>'+e("pdf.combined.entireAgreement")+"</h2><p>"+e("pdf.combined.entireAgreementText")+'</p></div><div class="signature-page"><h2 style="text-align: center; border: none;">'+e("pdf.combined.contractSignatures")+'</h2><p style="text-align: center; margin-bottom: 30px;">'+e("pdf.combined.contractSignIntro")+'</p><div style="display: flex; justify-content: space-between; margin-top: 40px;"><div class="signature-block"><h3>'+e("pdf.combined.devSignature")+'</h3><div class="signature-line">'+(Y?'<img src="'+Y+'" alt="Developer Signature" />':'<span style="font-style: italic;">'+e("pdf.combined.pending")+"</span>")+'</div><div class="signature-label">'+e("pdf.combined.signature")+'</div><div class="signature-name">'+B+'</div><div class="signature-date">'+e("common.date")+" "+_+'</div><div class="signature-email">'+$+'</div></div><div class="signature-block"><h3>'+e("pdf.combined.clientSignature")+" "+(Q?te:D)+"</h3>"+(Q?'<p style="font-size: 9pt; margin-bottom: 5px;">'+ce+(pe?" ("+pe+")":"")+"</p>":"")+'<div class="signature-line">'+(K?'<img src="'+K+'" alt="Client Signature" />':'<span style="font-style: italic;">'+e("pdf.combined.pending")+"</span>")+'</div><div class="signature-label">'+e("pdf.combined.signature")+'</div><div class="signature-name">'+(Q?e("common.by")+" "+ge+", "+Se:T)+'</div><div class="signature-date">'+e("common.date")+" "+S+'</div><div class="signature-email">'+A+": "+U+'</div></div></div></div><div class="page-break"></div><div class="header"><img src="'+x()+'" alt="Scarlo Logo" class="logo" /><h1>'+e("pdf.combined.sowSection2")+'</h1><div class="subtitle">'+e("pdf.combined.sowSubtitle")+'</div><div style="font-size: 10pt; font-style: italic; margin-top: 10px;">'+e("pdf.sow.generated")+" "+new Date().toLocaleDateString(t()==="es"?"es-MX":"en-US",{year:"numeric",month:"long",day:"numeric"})+'</div></div><div class="info-box"><h3>'+e("pdf.combined.clientInfo")+"</h3>"+(Q?"<p><strong>"+e("pdf.sow.businessName")+"</strong> "+te+"</p><p><strong>"+e("pdf.sow.entityType")+"</strong> "+ce+(pe?" ("+pe+")":"")+"</p><p><strong>"+e("pdf.sow.representative")+"</strong> "+ge+", "+Se+"</p>":"<p><strong>"+e("pdf.sow.clientName")+"</strong> "+(u.clientName||D)+"</p>")+"<p><strong>"+e("pdf.sow.contact")+"</strong> "+(u.clientEmail||u.clientPhone||L||e("common.na"))+"</p><p><strong>"+e("sow.package")+"</strong> "+(Ee[u.packageType]||u.packageType)+' <span class="highlight">$'+$e.toFixed(0)+"</span></p><p><strong>"+e("pdf.sow.estimatedTimeline")+"</strong> "+(u.estimatedWeeks||e("common.tbd"))+" "+e("sow.weeks")+(u.startDate?" ("+new Date(u.startDate).toLocaleDateString()+")":"")+'</p></div><div class="section"><h2>'+e("pdf.combined.packageIncludes")+"</h2><ul>";u.packageType==="custom"?u.features&&u.features.length>0&&u.features.forEach(function(pt){Ye+="<li>"+s(pt)+"</li>"}):xe.includes&&xe.includes.length>0&&xe.includes.forEach(function(pt){Ye+="<li>"+pt+"</li>"}),Ye+="</ul></div>",u.packageType!=="custom"&&u.features&&u.features.length>0&&(Ye+='<div class="section"><h2>'+e("pdf.combined.additionalFeatures")+"</h2><ul>",u.features.forEach(function(pt){Ye+="<li>"+s(pt)+"</li>"}),Ye+="</ul></div>"),u.notes&&(Ye+='<div class="section"><h2>'+e("pdf.combined.specialRequirements")+"</h2><p>"+u.notes+"</p></div>"),Ye+='<div class="section"><h2>'+e("pdf.combined.paymentStructure")+'</h2><table class="payment-table"><thead><tr><th>'+e("pdf.combined.paymentMilestone")+"</th><th>"+e("sow.description")+"</th><th>"+e("sow.amount")+"</th></tr></thead><tbody><tr><td><strong>"+e("pdf.combined.initialDeposit")+"</strong></td><td>"+e("pdf.combined.dueBeforeWork")+"</td><td><strong>$"+it.toFixed(0)+"</strong></td></tr><tr><td><strong>"+e("pdf.combined.milestone1")+"</strong></td><td>"+e("pdf.combined.designApproval")+"</td><td><strong>$"+je.toFixed(0)+"</strong></td></tr><tr><td><strong>"+e("pdf.combined.finalPayment")+"</strong></td><td>"+e("pdf.combined.priorToDeployment")+"</td><td><strong>$"+nt.toFixed(0)+'</strong></td></tr><tr class="total-row"><td colspan="2">'+e("pdf.combined.totalProjectCost")+"</td><td>$"+$e.toFixed(0)+"</td></tr></tbody></table></div>",u.maintenancePlan==="none"?Ye+='<div class="section"><h2>'+e("pdf.combined.ongoingMaintenance")+'</h2><div class="info-box" style="background: #fff3cd; border-color: #856404;"><h3 style="color: #856404;">'+e("pdf.combined.noMaintenanceTitle")+'</h3><p style="color: #856404;"><strong>'+e("pdf.combined.noMaintenanceWarning")+"</strong> "+e("pdf.combined.noMaintenanceText")+"</p></div></div>":u.maintenancePlan&&(Ye+='<div class="section"><h2>'+e("pdf.combined.ongoingMaintenance")+'</h2><div class="info-box"><h3>'+at.name+"  "+at.cost+"</h3><p>"+(at.desc||"")+"</p></div></div>"),Ye+='<div class="section"><h2>'+e("pdf.combined.termsConditions")+"</h2><p>"+e("sow.termsText1")+" <strong>"+D+"</strong>"+e("sow.termsText2")+"</p><p>"+e("sow.termsText3")+"</p></div>",Ye+='<div class="signature-page"><h2 style="text-align: center; border: none;">'+e("pdf.combined.sowSignatures")+'</h2><p style="text-align: center; margin-bottom: 30px;">'+e("pdf.combined.sowSignIntro")+'</p><div style="display: flex; justify-content: space-between; margin-top: 40px;"><div class="signature-block"><h3>'+e("pdf.combined.devSignature")+'</h3><div class="signature-line">'+(u.devSignature?'<img src="'+u.devSignature+'" alt="Developer Signature" />':'<span style="font-style: italic;">'+e("pdf.combined.pending")+"</span>")+'</div><div class="signature-label">'+e("pdf.combined.signature")+'</div><div class="signature-name">'+(u.devSignerName||"Carlos Martin")+'</div><div class="signature-date">'+e("common.date")+" "+(u.devSignedDate||e("common.na"))+'</div></div><div class="signature-block"><h3>'+e("pdf.combined.clientSignature")+" "+(Q?te:D)+"</h3>"+(Q?'<p style="font-size: 9pt; margin-bottom: 5px;">'+ce+(pe?" ("+pe+")":"")+"</p>":"")+'<div class="signature-line">'+(u.clientSignature?'<img src="'+u.clientSignature+'" alt="Client Signature" />':'<span style="font-style: italic;">'+e("pdf.combined.pending")+"</span>")+'</div><div class="signature-label">'+e("pdf.combined.signature")+'</div><div class="signature-name">'+(Q?e("common.by")+" "+ge+", "+Se:u.clientSignerName||D)+'</div><div class="signature-date">'+e("common.date")+" "+(u.clientSignedDate||e("common.na"))+'</div></div></div></div><div class="footer"><p><strong> '+new Date().getFullYear()+" Scarlo</strong>  "+e("pdf.combined.footer")+'</p><p style="margin-top: 8px;">'+e("pdf.combined.footerDev")+'</p><p class="contract-id">Contract ID: '+(p.currentContract?p.currentContract.id:e("common.na"))+" | SOW ID: "+u.id+"</p></div><script>window.onload = function() {  var images = document.images;  var loaded = 0;  var total = images.length;  if (total === 0) { setTimeout(function() { window.print(); }, 300); return; }  for (var i = 0; i < total; i++) {    if (images[i].complete) { loaded++; }    else { images[i].onload = images[i].onerror = function() { loaded++; if (loaded >= total) setTimeout(function() { window.print(); }, 300); }; }  }  if (loaded >= total) setTimeout(function() { window.print(); }, 300);};<\/script></body></html>",b.document.write(Ye),b.document.close()};var me=function(){window.addEventListener("load",function(){document.body.classList.add("loaded")})},be=function(){if("ontouchstart"in window&&!window.matchMedia("(pointer: fine)").matches){console.log("Custom cursor disabled - touch-only device");return}console.log("Custom cursor enabled - mouse devices only"),this.cursor=document.createElement("div"),this.cursor.className="custom-cursor",this.cursor.style.cssText="position:fixed;left:0;top:0;width:10px;height:10px;background:rgba(255,255,255,0.9);border-radius:50%;pointer-events:none;z-index:99999;opacity:0;mix-blend-mode:difference;transition:width 0.2s cubic-bezier(0.4,0,0.2,1),height 0.2s cubic-bezier(0.4,0,0.2,1),opacity 0.15s ease-out;will-change:transform;backface-visibility:hidden;transform:translate3d(0,0,0);",document.body.appendChild(this.cursor),this.position={x:0,y:0},this.target={x:0,y:0},this.currentSize=10,this.isVisible=!1,this.isHovering=!1,this.isAnimating=!1,this.hoverCheckFrame=0,this.interactiveSelectors="a, button, input, textarea, select, canvas, .clear-btn, .modal-close, .auth-close, .nav-link, .btn, .hamburger, .item, .item__image, .enlarge",this.init(),this.handleResize()};be.prototype.init=function(){var u=this,p=document.createElement("style");p.id="custom-cursor-style",p.textContent="@media (min-width: 1024px) {  body:not(.modal-open):not(.custom-cursor-hidden) * { cursor: none !important; }  body.modal-open, body.modal-open * { cursor: auto !important; }  body.modal-open .signature-pad { cursor: crosshair !important; }  body.custom-cursor-hidden, body.custom-cursor-hidden * { cursor: auto !important; }}",document.head.appendChild(p);var g=!1;document.addEventListener("pointermove",function(b){if(b.pointerType!=="mouse"){u.isVisible&&(u.cursor.style.opacity="0",u.isVisible=!1,u.isAnimating=!1);return}var S=document.body.classList.contains("modal-open");if(g&&!S&&(u.isVisible=!0,u.cursor.style.opacity="1",document.body.classList.remove("custom-cursor-hidden")),g=S,S){u.cursor.style.opacity="0",u.isAnimating=!1,document.body.classList.add("custom-cursor-hidden");return}if(u.target.x=b.clientX,u.target.y=b.clientY,u.isVisible||(u.position.x=b.clientX,u.position.y=b.clientY,u.updateCursorPosition(),u.isVisible=!0,u.cursor.style.opacity="1"),u.isAnimating||(u.isAnimating=!0,u.animate()),u.hoverCheckFrame++,u.hoverCheckFrame%2===0){var _=document.elementFromPoint(b.clientX,b.clientY);u.checkHoverState(_)}},{passive:!0}),document.addEventListener("pointerleave",function(){u.isVisible=!1,u.isAnimating=!1,u.cursor.style.opacity="0",document.body.classList.add("custom-cursor-hidden")}),document.addEventListener("pointerenter",function(){document.body.classList.remove("custom-cursor-hidden")})},be.prototype.handleResize=function(){},be.prototype.checkHoverState=function(u){if(!(!u||document.body.classList.contains("modal-open"))){var p=!!u.closest(this.interactiveSelectors);p!==this.isHovering&&(this.isHovering=p,p?(this.cursor.style.width="40px",this.cursor.style.height="40px",this.currentSize=40):(this.cursor.style.width="10px",this.cursor.style.height="10px",this.currentSize=10),this.updateCursorPosition())}},be.prototype.updateCursorPosition=function(){var u=this.currentSize/2;this.cursor.style.transform="translate3d("+(this.position.x-u)+"px, "+(this.position.y-u)+"px, 0)"},be.prototype.animate=function(){if(this.isAnimating){var u=this,p=.65,g=.5,b=this.target.x-this.position.x,S=this.target.y-this.position.y,_=Math.sqrt(b*b+S*S);if(_<g){this.position.x=this.target.x,this.position.y=this.target.y,this.updateCursorPosition(),this.isAnimating=!1;return}this.position.x+=b*p,this.position.y+=S*p,this.updateCursorPosition(),requestAnimationFrame(function(){u.animate()})}};var ye=function(){this.setVH();var u=this;window.addEventListener("resize",h(function(){u.setVH()},250))};ye.prototype.setVH=function(){var u=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",u+"px")};var We=function(){var u=window.matchMedia("(prefers-reduced-motion: reduce)");u.matches&&document.body.classList.add("reduce-motion"),document.addEventListener("keydown",function(p){p.key==="Tab"&&document.body.classList.add("keyboard-nav")}),document.addEventListener("mousedown",function(){document.body.classList.remove("keyboard-nav")})},Ae=function(){console.log("Initializing Section Separator Glow...");var u=c("section");if(!(!u||u.length===0)){var p=window.innerWidth<=1024,g=p?20:50,b=function(){var _=window.innerHeight;u.forEach(function(D){if(!D.classList.contains("separator-visible")&&!D.classList.contains("footer")){var T=D.getBoundingClientRect(),L=T.bottom>0&&T.bottom<_*.85;L&&(D.classList.add("separator-visible"),console.log("Section separator triggered:",D.id||D.className))}})},S=!1;window.addEventListener("scroll",function(){window.pageYOffset<g||S||(requestAnimationFrame(function(){b(),S=!1}),S=!0)},{passive:!0})}},ke=function(){var u=a(".footer-back-to-top");if(u){var p=300,g=!1,b=function(){var S=window.pageYOffset>p;S!==g&&(g=S,S?u.classList.add("visible"):u.classList.remove("visible"))};window.addEventListener("scroll",f(b,100),{passive:!0}),b()}},oe=function(){console.log("Scarlo - Crafted with precision"),y(),console.log("Device: "+(R.isMobile()?"Mobile":"Desktop")),console.log("Screen width:",window.innerWidth);var u=a(".navbar-logo-ambient"),p=a(".navbar-text-ambient");u&&p&&requestAnimationFrame(function(){u.style.animation="none",p.style.animation="none",requestAnimationFrame(function(){u.style.animation="navbarAmbientPulse 3s ease-in-out infinite",p.style.animation="navbarAmbientPulse 3s ease-in-out infinite"})}),new G,new O,window.rotatingText=new j,new z,new W,new V,new H,window.contractFormHandler=new N,new me,new be,new ye,new We,new Ae,new ke};function _e(){window.firebaseReady?window.firebaseReady.then(oe).catch(function(u){console.error("Firebase initialization failed, starting app anyway:",u),oe()}):oe()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",_e):_e()})();const Ra=document.getElementById("message");Ra&&(Ra.addEventListener("input",function(){this.style.height="auto",this.style.height=Math.min(this.scrollHeight,400)+"px"}),Ra.style.height="auto",Ra.style.height=Math.min(Ra.scrollHeight,400)+"px");(function(){var e="scarlo_cookie_consent",t="userPreferences",i=7,s=i*24*60*60*1e3,o=document.getElementById("cookieConsent"),a=document.getElementById("cookieSettingsBtn"),c=document.getElementById("cookieAccept"),f=document.getElementById("cookieDecline"),h=document.getElementById("cookieAnalytics"),v=document.getElementById("cookieMarketing");if(!o)return;function y(G){return G&&G.analytics===!0&&G.marketing===!0}function x(G){if(!G)return!0;if(y(G))return!1;var se=Date.now()-(G.timestamp||0);return se>=s}function k(){try{var G=localStorage.getItem(e);return G?JSON.parse(G):null}catch{return null}}function C(G){try{localStorage.setItem(e,JSON.stringify(G))}catch{}}function M(){return window.auth&&window.auth.currentUser?window.auth.currentUser:null}function E(G){var se=M();return!se||!window.db?Promise.resolve():window.db.collection(t).doc(se.uid).set({cookieConsent:G,updatedAt:firebase.firestore.FieldValue.serverTimestamp()},{merge:!0}).catch(function(fe){console.warn("Failed to save cookie consent to Firestore:",fe)})}function R(){var G=M();return!G||!window.db?Promise.resolve(null):window.db.collection(t).doc(G.uid).get().then(function(se){return se.exists&&se.data().cookieConsent?se.data().cookieConsent:null}).catch(function(se){return console.warn("Failed to load cookie consent from Firestore:",se),null})}function O(){o.classList.add("visible"),o.setAttribute("aria-hidden","false"),a.classList.remove("visible"),a.setAttribute("aria-hidden","true")}function j(){o.classList.remove("visible"),o.setAttribute("aria-hidden","true"),a.classList.add("visible"),a.setAttribute("aria-hidden","false")}function z(G){G&&(h.checked=G.analytics,v.checked=G.marketing)}function W(G){window.dispatchEvent(new CustomEvent("cookieConsentUpdated",{detail:G})),G.analytics,G.marketing}function V(G){C(G),E(G)}function H(){var G=k();x(G)?(z(G),O()):(z(G),a.classList.add("visible"),a.setAttribute("aria-hidden","false"),W(G))}function J(G){G&&R().then(function(se){var fe=k(),me=null;se&&fe?se.timestamp>fe.timestamp?(me=se,C(se)):(me=fe,E(fe)):se&&!fe?(me=se,C(se)):!se&&fe&&(me=fe,E(fe)),me&&(z(me),x(me)?O():(o.classList.remove("visible"),a.classList.add("visible"),a.setAttribute("aria-hidden","false"),W(me)))})}function N(){window.auth&&window.auth.onAuthStateChanged(J)}c.addEventListener("click",function(){var G={essential:!0,analytics:h.checked,marketing:v.checked,timestamp:new Date().toLocaleString()};V(G),j(),W(G)}),f.addEventListener("click",function(){var G={essential:!0,analytics:!1,marketing:!1,timestamp:new Date().toLocaleString()};h.checked=!1,v.checked=!1,V(G),j(),W(G)}),a.addEventListener("click",function(){var G=k();z(G),O()}),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",H):H(),window.firebaseReady?window.firebaseReady.then(N).catch(function(){}):window.addEventListener("firebaseReady",N)})();
