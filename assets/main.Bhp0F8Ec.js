(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=r(o);fetch(o.href,c)}})();const yv={apiKey:"AIzaSyCT-kY_DS5WTZ0RhMR4qXzII0pSPYNPOMQ",authDomain:"csites-b6d37.firebaseapp.com",projectId:"csites-b6d37",storageBucket:"csites-b6d37.firebasestorage.app",messagingSenderId:"877559835942",appId:"1:877559835942:web:0a573534ae0ac3e056a5e7"};window.VITE_DEVELOPER_EMAIL="vistafly.services@gmail.com";yv.apiKey||(console.error("Firebase configuration error: Missing environment variables!"),console.error("Please create a .env file based on .env.example"),console.error("Add your Firebase credentials from Firebase Console"));window.VITE_DEVELOPER_EMAIL||(console.error("VITE_DEVELOPER_EMAIL not set in .env file!"),console.error("Add this line to your .env: VITE_DEVELOPER_EMAIL=your-email@gmail.com"));function U1(n=50){return new Promise((e,r)=>{let a=0;const o=()=>{a++,typeof firebase<"u"&&firebase.initializeApp&&firebase.auth&&firebase.firestore?e():a>=n?r(new Error("Firebase SDK failed to load")):setTimeout(o,100)};o()})}window.firebaseReady=U1().then(()=>(firebase.initializeApp(yv),window.auth=firebase.auth(),window.db=firebase.firestore(),window.googleProvider=new firebase.auth.GoogleAuthProvider,window.auth.settings.appVerificationDisabledForTesting=!0,console.log("Firebase initialized successfully"),window.dispatchEvent(new Event("firebaseReady")),{auth:window.auth,db:window.db,googleProvider:window.googleProvider})).catch(n=>{throw console.error("Failed to initialize Firebase:",n),n});class W1{constructor(){this.position={x:window.innerWidth/2,y:window.innerHeight/2},this.listeners=new Set,this.ready=!1,this.init()}init(){const e=this;let r=!1;document.addEventListener("pointermove",function(a){e.position.x=a.clientX,e.position.y=a.clientY,r||(r=!0,requestAnimationFrame(function(){r=!1,e.listeners.forEach(o=>o(e.position))}))},{passive:!0}),document.addEventListener("pointerleave",function(){e.position.x=window.innerWidth/2,e.position.y=window.innerHeight/2,e.listeners.forEach(a=>a(e.position))},{passive:!0}),this.ready=!0}subscribe(e){return this.listeners.add(e),e(this.position),()=>{this.listeners.delete(e)}}getNormalizedPosition(e){if(!e)return{x:.5,y:.5};const r=e.getBoundingClientRect(),a=this.position.x,o=this.position.y;return a<r.left||a>r.right||o<r.top||o>r.bottom?{x:.5,y:.5}:{x:(a-r.left)/r.width,y:1-(o-r.top)/r.height}}}window.mouseTracker=new W1;function wv(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var xu={exports:{}},Ea={},Su={exports:{}},$e={};var om;function j1(){if(om)return $e;om=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),u=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),k=Symbol.iterator;function T(S){return S===null||typeof S!="object"?null:(S=k&&S[k]||S["@@iterator"],typeof S=="function"?S:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,D={};function R(S,C,F){this.props=S,this.context=C,this.refs=D,this.updater=F||P}R.prototype.isReactComponent={},R.prototype.setState=function(S,C){if(typeof S!="object"&&typeof S!="function"&&S!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,S,C,"setState")},R.prototype.forceUpdate=function(S){this.updater.enqueueForceUpdate(this,S,"forceUpdate")};function N(){}N.prototype=R.prototype;function H(S,C,F){this.props=S,this.context=C,this.refs=D,this.updater=F||P}var A=H.prototype=new N;A.constructor=H,M(A,R.prototype),A.isPureReactComponent=!0;var W=Array.isArray,U=Object.prototype.hasOwnProperty,Z={current:null},ne={key:!0,ref:!0,__self:!0,__source:!0};function ee(S,C,F){var I,z={},O=null,q=null;if(C!=null)for(I in C.ref!==void 0&&(q=C.ref),C.key!==void 0&&(O=""+C.key),C)U.call(C,I)&&!ne.hasOwnProperty(I)&&(z[I]=C[I]);var V=arguments.length-2;if(V===1)z.children=F;else if(1<V){for(var X=Array(V),G=0;G<V;G++)X[G]=arguments[G+2];z.children=X}if(S&&S.defaultProps)for(I in V=S.defaultProps,V)z[I]===void 0&&(z[I]=V[I]);return{$$typeof:n,type:S,key:O,ref:q,props:z,_owner:Z.current}}function Q(S,C){return{$$typeof:n,type:S.type,key:C,ref:S.ref,props:S.props,_owner:S._owner}}function ce(S){return typeof S=="object"&&S!==null&&S.$$typeof===n}function me(S){var C={"=":"=0",":":"=2"};return"$"+S.replace(/[=:]/g,function(F){return C[F]})}var ve=/\/+/g;function ke(S,C){return typeof S=="object"&&S!==null&&S.key!=null?me(""+S.key):C.toString(36)}function we(S,C,F,I,z){var O=typeof S;(O==="undefined"||O==="boolean")&&(S=null);var q=!1;if(S===null)q=!0;else switch(O){case"string":case"number":q=!0;break;case"object":switch(S.$$typeof){case n:case e:q=!0}}if(q)return q=S,z=z(q),S=I===""?"."+ke(q,0):I,W(z)?(F="",S!=null&&(F=S.replace(ve,"$&/")+"/"),we(z,C,F,"",function(G){return G})):z!=null&&(ce(z)&&(z=Q(z,F+(!z.key||q&&q.key===z.key?"":(""+z.key).replace(ve,"$&/")+"/")+S)),C.push(z)),1;if(q=0,I=I===""?".":I+":",W(S))for(var V=0;V<S.length;V++){O=S[V];var X=I+ke(O,V);q+=we(O,C,F,X,z)}else if(X=T(S),typeof X=="function")for(S=X.call(S),V=0;!(O=S.next()).done;)O=O.value,X=I+ke(O,V++),q+=we(O,C,F,X,z);else if(O==="object")throw C=String(S),Error("Objects are not valid as a React child (found: "+(C==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":C)+"). If you meant to render a collection of children, use an array instead.");return q}function d(S,C,F){if(S==null)return S;var I=[],z=0;return we(S,I,"","",function(O){return C.call(F,O,z++)}),I}function y(S){if(S._status===-1){var C=S._result;C=C(),C.then(function(F){(S._status===0||S._status===-1)&&(S._status=1,S._result=F)},function(F){(S._status===0||S._status===-1)&&(S._status=2,S._result=F)}),S._status===-1&&(S._status=0,S._result=C)}if(S._status===1)return S._result.default;throw S._result}var w={current:null},b={transition:null},_={ReactCurrentDispatcher:w,ReactCurrentBatchConfig:b,ReactCurrentOwner:Z};function E(){throw Error("act(...) is not supported in production builds of React.")}return $e.Children={map:d,forEach:function(S,C,F){d(S,function(){C.apply(this,arguments)},F)},count:function(S){var C=0;return d(S,function(){C++}),C},toArray:function(S){return d(S,function(C){return C})||[]},only:function(S){if(!ce(S))throw Error("React.Children.only expected to receive a single React element child.");return S}},$e.Component=R,$e.Fragment=r,$e.Profiler=o,$e.PureComponent=H,$e.StrictMode=a,$e.Suspense=h,$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_,$e.act=E,$e.cloneElement=function(S,C,F){if(S==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+S+".");var I=M({},S.props),z=S.key,O=S.ref,q=S._owner;if(C!=null){if(C.ref!==void 0&&(O=C.ref,q=Z.current),C.key!==void 0&&(z=""+C.key),S.type&&S.type.defaultProps)var V=S.type.defaultProps;for(X in C)U.call(C,X)&&!ne.hasOwnProperty(X)&&(I[X]=C[X]===void 0&&V!==void 0?V[X]:C[X])}var X=arguments.length-2;if(X===1)I.children=F;else if(1<X){V=Array(X);for(var G=0;G<X;G++)V[G]=arguments[G+2];I.children=V}return{$$typeof:n,type:S.type,key:z,ref:O,props:I,_owner:q}},$e.createContext=function(S){return S={$$typeof:u,_currentValue:S,_currentValue2:S,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},S.Provider={$$typeof:c,_context:S},S.Consumer=S},$e.createElement=ee,$e.createFactory=function(S){var C=ee.bind(null,S);return C.type=S,C},$e.createRef=function(){return{current:null}},$e.forwardRef=function(S){return{$$typeof:p,render:S}},$e.isValidElement=ce,$e.lazy=function(S){return{$$typeof:v,_payload:{_status:-1,_result:S},_init:y}},$e.memo=function(S,C){return{$$typeof:g,type:S,compare:C===void 0?null:C}},$e.startTransition=function(S){var C=b.transition;b.transition={};try{S()}finally{b.transition=C}},$e.unstable_act=E,$e.useCallback=function(S,C){return w.current.useCallback(S,C)},$e.useContext=function(S){return w.current.useContext(S)},$e.useDebugValue=function(){},$e.useDeferredValue=function(S){return w.current.useDeferredValue(S)},$e.useEffect=function(S,C){return w.current.useEffect(S,C)},$e.useId=function(){return w.current.useId()},$e.useImperativeHandle=function(S,C,F){return w.current.useImperativeHandle(S,C,F)},$e.useInsertionEffect=function(S,C){return w.current.useInsertionEffect(S,C)},$e.useLayoutEffect=function(S,C){return w.current.useLayoutEffect(S,C)},$e.useMemo=function(S,C){return w.current.useMemo(S,C)},$e.useReducer=function(S,C,F){return w.current.useReducer(S,C,F)},$e.useRef=function(S){return w.current.useRef(S)},$e.useState=function(S){return w.current.useState(S)},$e.useSyncExternalStore=function(S,C,F){return w.current.useSyncExternalStore(S,C,F)},$e.useTransition=function(){return w.current.useTransition()},$e.version="18.3.1",$e}var lm;function Bd(){return lm||(lm=1,Su.exports=j1()),Su.exports}var cm;function q1(){if(cm)return Ea;cm=1;var n=Bd(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function u(p,h,g){var v,k={},T=null,P=null;g!==void 0&&(T=""+g),h.key!==void 0&&(T=""+h.key),h.ref!==void 0&&(P=h.ref);for(v in h)a.call(h,v)&&!c.hasOwnProperty(v)&&(k[v]=h[v]);if(p&&p.defaultProps)for(v in h=p.defaultProps,h)k[v]===void 0&&(k[v]=h[v]);return{$$typeof:e,type:p,key:T,ref:P,props:k,_owner:o.current}}return Ea.Fragment=r,Ea.jsx=u,Ea.jsxs=u,Ea}var um;function H1(){return um||(um=1,xu.exports=q1()),xu.exports}var xe=H1(),se=Bd();const bv=wv(se);var ul={},ku={exports:{}},An={},_u={exports:{}},Cu={};var dm;function $1(){return dm||(dm=1,(function(n){function e(b,_){var E=b.length;b.push(_);e:for(;0<E;){var S=E-1>>>1,C=b[S];if(0<o(C,_))b[S]=_,b[E]=C,E=S;else break e}}function r(b){return b.length===0?null:b[0]}function a(b){if(b.length===0)return null;var _=b[0],E=b.pop();if(E!==_){b[0]=E;e:for(var S=0,C=b.length,F=C>>>1;S<F;){var I=2*(S+1)-1,z=b[I],O=I+1,q=b[O];if(0>o(z,E))O<C&&0>o(q,z)?(b[S]=q,b[O]=E,S=O):(b[S]=z,b[I]=E,S=I);else if(O<C&&0>o(q,E))b[S]=q,b[O]=E,S=O;else break e}}return _}function o(b,_){var E=b.sortIndex-_.sortIndex;return E!==0?E:b.id-_.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var u=Date,p=u.now();n.unstable_now=function(){return u.now()-p}}var h=[],g=[],v=1,k=null,T=3,P=!1,M=!1,D=!1,R=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(b){for(var _=r(g);_!==null;){if(_.callback===null)a(g);else if(_.startTime<=b)a(g),_.sortIndex=_.expirationTime,e(h,_);else break;_=r(g)}}function W(b){if(D=!1,A(b),!M)if(r(h)!==null)M=!0,y(U);else{var _=r(g);_!==null&&w(W,_.startTime-b)}}function U(b,_){M=!1,D&&(D=!1,N(ee),ee=-1),P=!0;var E=T;try{for(A(_),k=r(h);k!==null&&(!(k.expirationTime>_)||b&&!me());){var S=k.callback;if(typeof S=="function"){k.callback=null,T=k.priorityLevel;var C=S(k.expirationTime<=_);_=n.unstable_now(),typeof C=="function"?k.callback=C:k===r(h)&&a(h),A(_)}else a(h);k=r(h)}if(k!==null)var F=!0;else{var I=r(g);I!==null&&w(W,I.startTime-_),F=!1}return F}finally{k=null,T=E,P=!1}}var Z=!1,ne=null,ee=-1,Q=5,ce=-1;function me(){return!(n.unstable_now()-ce<Q)}function ve(){if(ne!==null){var b=n.unstable_now();ce=b;var _=!0;try{_=ne(!0,b)}finally{_?ke():(Z=!1,ne=null)}}else Z=!1}var ke;if(typeof H=="function")ke=function(){H(ve)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,d=we.port2;we.port1.onmessage=ve,ke=function(){d.postMessage(null)}}else ke=function(){R(ve,0)};function y(b){ne=b,Z||(Z=!0,ke())}function w(b,_){ee=R(function(){b(n.unstable_now())},_)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(b){b.callback=null},n.unstable_continueExecution=function(){M||P||(M=!0,y(U))},n.unstable_forceFrameRate=function(b){0>b||125<b?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<b?Math.floor(1e3/b):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_getFirstCallbackNode=function(){return r(h)},n.unstable_next=function(b){switch(T){case 1:case 2:case 3:var _=3;break;default:_=T}var E=T;T=_;try{return b()}finally{T=E}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(b,_){switch(b){case 1:case 2:case 3:case 4:case 5:break;default:b=3}var E=T;T=b;try{return _()}finally{T=E}},n.unstable_scheduleCallback=function(b,_,E){var S=n.unstable_now();switch(typeof E=="object"&&E!==null?(E=E.delay,E=typeof E=="number"&&0<E?S+E:S):E=S,b){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=E+C,b={id:v++,callback:_,priorityLevel:b,startTime:E,expirationTime:C,sortIndex:-1},E>S?(b.sortIndex=E,e(g,b),r(h)===null&&b===r(g)&&(D?(N(ee),ee=-1):D=!0,w(W,E-S))):(b.sortIndex=C,e(h,b),M||P||(M=!0,y(U))),b},n.unstable_shouldYield=me,n.unstable_wrapCallback=function(b){var _=T;return function(){var E=T;T=_;try{return b.apply(this,arguments)}finally{T=E}}}})(Cu)),Cu}var fm;function Y1(){return fm||(fm=1,_u.exports=$1()),_u.exports}var pm;function X1(){if(pm)return An;pm=1;var n=Bd(),e=Y1();function r(i){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+i,l=1;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function c(i,s){u(i,s),u(i+"Capture",s)}function u(i,s){for(o[i]=s,i=0;i<s.length;i++)a.add(s[i])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},k={};function T(i){return h.call(k,i)?!0:h.call(v,i)?!1:g.test(i)?k[i]=!0:(v[i]=!0,!1)}function P(i,s,l,f){if(l!==null&&l.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return f?!1:l!==null?!l.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function M(i,s,l,f){if(s===null||typeof s>"u"||P(i,s,l,f))return!0;if(f)return!1;if(l!==null)switch(l.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function D(i,s,l,f,m,x,L){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=f,this.attributeNamespace=m,this.mustUseProperty=l,this.propertyName=i,this.type=s,this.sanitizeURL=x,this.removeEmptyString=L}var R={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){R[i]=new D(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var s=i[0];R[s]=new D(s,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){R[i]=new D(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){R[i]=new D(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){R[i]=new D(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){R[i]=new D(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){R[i]=new D(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){R[i]=new D(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){R[i]=new D(i,5,!1,i.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function H(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var s=i.replace(N,H);R[s]=new D(s,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var s=i.replace(N,H);R[s]=new D(s,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var s=i.replace(N,H);R[s]=new D(s,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){R[i]=new D(i,1,!1,i.toLowerCase(),null,!1,!1)}),R.xlinkHref=new D("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){R[i]=new D(i,1,!1,i.toLowerCase(),null,!0,!0)});function A(i,s,l,f){var m=R.hasOwnProperty(s)?R[s]:null;(m!==null?m.type!==0:f||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(M(s,l,m,f)&&(l=null),f||m===null?T(s)&&(l===null?i.removeAttribute(s):i.setAttribute(s,""+l)):m.mustUseProperty?i[m.propertyName]=l===null?m.type===3?!1:"":l:(s=m.attributeName,f=m.attributeNamespace,l===null?i.removeAttribute(s):(m=m.type,l=m===3||m===4&&l===!0?"":""+l,f?i.setAttributeNS(f,s,l):i.setAttribute(s,l))))}var W=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,U=Symbol.for("react.element"),Z=Symbol.for("react.portal"),ne=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),Q=Symbol.for("react.profiler"),ce=Symbol.for("react.provider"),me=Symbol.for("react.context"),ve=Symbol.for("react.forward_ref"),ke=Symbol.for("react.suspense"),we=Symbol.for("react.suspense_list"),d=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),b=Symbol.iterator;function _(i){return i===null||typeof i!="object"?null:(i=b&&i[b]||i["@@iterator"],typeof i=="function"?i:null)}var E=Object.assign,S;function C(i){if(S===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);S=s&&s[1]||""}return`
`+S+i}var F=!1;function I(i,s){if(!i||F)return"";F=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(re){var f=re}Reflect.construct(i,[],s)}else{try{s.call()}catch(re){f=re}i.call(s.prototype)}else{try{throw Error()}catch(re){f=re}i()}}catch(re){if(re&&f&&typeof re.stack=="string"){for(var m=re.stack.split(`
`),x=f.stack.split(`
`),L=m.length-1,B=x.length-1;1<=L&&0<=B&&m[L]!==x[B];)B--;for(;1<=L&&0<=B;L--,B--)if(m[L]!==x[B]){if(L!==1||B!==1)do if(L--,B--,0>B||m[L]!==x[B]){var $=`
`+m[L].replace(" at new "," at ");return i.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",i.displayName)),$}while(1<=L&&0<=B);break}}}finally{F=!1,Error.prepareStackTrace=l}return(i=i?i.displayName||i.name:"")?C(i):""}function z(i){switch(i.tag){case 5:return C(i.type);case 16:return C("Lazy");case 13:return C("Suspense");case 19:return C("SuspenseList");case 0:case 2:case 15:return i=I(i.type,!1),i;case 11:return i=I(i.type.render,!1),i;case 1:return i=I(i.type,!0),i;default:return""}}function O(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case ne:return"Fragment";case Z:return"Portal";case Q:return"Profiler";case ee:return"StrictMode";case ke:return"Suspense";case we:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case me:return(i.displayName||"Context")+".Consumer";case ce:return(i._context.displayName||"Context")+".Provider";case ve:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case d:return s=i.displayName||null,s!==null?s:O(i.type)||"Memo";case y:s=i._payload,i=i._init;try{return O(i(s))}catch{}}return null}function q(i){var s=i.type;switch(i.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=s.render,i=i.displayName||i.name||"",s.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return O(s);case 8:return s===ee?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function V(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function X(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function G(i){var s=X(i)?"checked":"value",l=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),f=""+i[s];if(!i.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,x=l.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return m.call(this)},set:function(L){f=""+L,x.call(this,L)}}),Object.defineProperty(i,s,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(L){f=""+L},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function j(i){i._valueTracker||(i._valueTracker=G(i))}function Y(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var l=s.getValue(),f="";return i&&(f=X(i)?i.checked?"true":"false":i.value),i=f,i!==l?(s.setValue(i),!0):!1}function ie(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function ae(i,s){var l=s.checked;return E({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??i._wrapperState.initialChecked})}function le(i,s){var l=s.defaultValue==null?"":s.defaultValue,f=s.checked!=null?s.checked:s.defaultChecked;l=V(s.value!=null?s.value:l),i._wrapperState={initialChecked:f,initialValue:l,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function pe(i,s){s=s.checked,s!=null&&A(i,"checked",s,!1)}function _e(i,s){pe(i,s);var l=V(s.value),f=s.type;if(l!=null)f==="number"?(l===0&&i.value===""||i.value!=l)&&(i.value=""+l):i.value!==""+l&&(i.value=""+l);else if(f==="submit"||f==="reset"){i.removeAttribute("value");return}s.hasOwnProperty("value")?be(i,s.type,l):s.hasOwnProperty("defaultValue")&&be(i,s.type,V(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(i.defaultChecked=!!s.defaultChecked)}function oe(i,s,l){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var f=s.type;if(!(f!=="submit"&&f!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+i._wrapperState.initialValue,l||s===i.value||(i.value=s),i.defaultValue=s}l=i.name,l!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,l!==""&&(i.name=l)}function be(i,s,l){(s!=="number"||ie(i.ownerDocument)!==i)&&(l==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+l&&(i.defaultValue=""+l))}var Ie=Array.isArray;function We(i,s,l,f){if(i=i.options,s){s={};for(var m=0;m<l.length;m++)s["$"+l[m]]=!0;for(l=0;l<i.length;l++)m=s.hasOwnProperty("$"+i[l].value),i[l].selected!==m&&(i[l].selected=m),m&&f&&(i[l].defaultSelected=!0)}else{for(l=""+V(l),s=null,m=0;m<i.length;m++){if(i[m].value===l){i[m].selected=!0,f&&(i[m].defaultSelected=!0);return}s!==null||i[m].disabled||(s=i[m])}s!==null&&(s.selected=!0)}}function qe(i,s){if(s.dangerouslySetInnerHTML!=null)throw Error(r(91));return E({},s,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function tt(i,s){var l=s.value;if(l==null){if(l=s.children,s=s.defaultValue,l!=null){if(s!=null)throw Error(r(92));if(Ie(l)){if(1<l.length)throw Error(r(93));l=l[0]}s=l}s==null&&(s=""),l=s}i._wrapperState={initialValue:V(l)}}function Ke(i,s){var l=V(s.value),f=V(s.defaultValue);l!=null&&(l=""+l,l!==i.value&&(i.value=l),s.defaultValue==null&&i.defaultValue!==l&&(i.defaultValue=l)),f!=null&&(i.defaultValue=""+f)}function at(i){var s=i.textContent;s===i._wrapperState.initialValue&&s!==""&&s!==null&&(i.value=s)}function Ye(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ot(i,s){return i==null||i==="http://www.w3.org/1999/xhtml"?Ye(s):i==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Ft,zt=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,l,f,m){MSApp.execUnsafeLocalFunction(function(){return i(s,l,f,m)})}:i})(function(i,s){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=s;else{for(Ft=Ft||document.createElement("div"),Ft.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=Ft.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;s.firstChild;)i.appendChild(s.firstChild)}});function De(i,s){if(s){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=s;return}}i.textContent=s}var Pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kt=["Webkit","ms","Moz","O"];Object.keys(Pe).forEach(function(i){kt.forEach(function(s){s=s+i.charAt(0).toUpperCase()+i.substring(1),Pe[s]=Pe[i]})});function He(i,s,l){return s==null||typeof s=="boolean"||s===""?"":l||typeof s!="number"||s===0||Pe.hasOwnProperty(i)&&Pe[i]?(""+s).trim():s+"px"}function gt(i,s){i=i.style;for(var l in s)if(s.hasOwnProperty(l)){var f=l.indexOf("--")===0,m=He(l,s[l],f);l==="float"&&(l="cssFloat"),f?i.setProperty(l,m):i[l]=m}}var qt=E({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lt(i,s){if(s){if(qt[i]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(r(137,i));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(r(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(r(61))}if(s.style!=null&&typeof s.style!="object")throw Error(r(62))}}function Qe(i,s){if(i.indexOf("-")===-1)return typeof s.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ze=null;function ut(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ht=null,Kt=null,Ot=null;function zn(i){if(i=fa(i)){if(typeof Ht!="function")throw Error(r(280));var s=i.stateNode;s&&(s=Co(s),Ht(i.stateNode,i.type,s))}}function pt(i){Kt?Ot?Ot.push(i):Ot=[i]:Kt=i}function Ri(){if(Kt){var i=Kt,s=Ot;if(Ot=Kt=null,zn(i),s)for(i=0;i<s.length;i++)zn(s[i])}}function Vn(i,s){return i(s)}function fi(){}var nn=!1;function _t(i,s,l){if(nn)return i(s,l);nn=!0;try{return Vn(i,s,l)}finally{nn=!1,(Kt!==null||Ot!==null)&&(fi(),Ri())}}function un(i,s){var l=i.stateNode;if(l===null)return null;var f=Co(l);if(f===null)return null;l=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(r(231,s,typeof l));return l}var $t=!1;if(p)try{var rn={};Object.defineProperty(rn,"passive",{get:function(){$t=!0}}),window.addEventListener("test",rn,rn),window.removeEventListener("test",rn,rn)}catch{$t=!1}function wn(i,s,l,f,m,x,L,B,$){var re=Array.prototype.slice.call(arguments,3);try{s.apply(l,re)}catch(he){this.onError(he)}}var sn=!1,Qt=null,Cn=!1,bn=null,Ce={onError:function(i){sn=!0,Qt=i}};function Nt(i,s,l,f,m,x,L,B,$){sn=!1,Qt=null,wn.apply(Ce,arguments)}function nt(i,s,l,f,m,x,L,B,$){if(Nt.apply(this,arguments),sn){if(sn){var re=Qt;sn=!1,Qt=null}else throw Error(r(198));Cn||(Cn=!0,bn=re)}}function ht(i){var s=i,l=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(l=s.return),i=s.return;while(i)}return s.tag===3?l:null}function Tn(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function Xi(i){if(ht(i)!==i)throw Error(r(188))}function Xe(i){var s=i.alternate;if(!s){if(s=ht(i),s===null)throw Error(r(188));return s!==i?null:i}for(var l=i,f=s;;){var m=l.return;if(m===null)break;var x=m.alternate;if(x===null){if(f=m.return,f!==null){l=f;continue}break}if(m.child===x.child){for(x=m.child;x;){if(x===l)return Xi(m),i;if(x===f)return Xi(m),s;x=x.sibling}throw Error(r(188))}if(l.return!==f.return)l=m,f=x;else{for(var L=!1,B=m.child;B;){if(B===l){L=!0,l=m,f=x;break}if(B===f){L=!0,f=m,l=x;break}B=B.sibling}if(!L){for(B=x.child;B;){if(B===l){L=!0,l=x,f=m;break}if(B===f){L=!0,f=x,l=m;break}B=B.sibling}if(!L)throw Error(r(189))}}if(l.alternate!==f)throw Error(r(190))}if(l.tag!==3)throw Error(r(188));return l.stateNode.current===l?i:s}function ue(i){return i=Xe(i),i!==null?fe(i):null}function fe(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var s=fe(i);if(s!==null)return s;i=i.sibling}return null}var Oe=e.unstable_scheduleCallback,Re=e.unstable_cancelCallback,Te=e.unstable_shouldYield,Me=e.unstable_requestPaint,Se=e.unstable_now,it=e.unstable_getCurrentPriorityLevel,Ge=e.unstable_ImmediatePriority,rt=e.unstable_UserBlockingPriority,dn=e.unstable_NormalPriority,pi=e.unstable_LowPriority,Tr=e.unstable_IdlePriority,je=null,vt=null;function Er(i){if(vt&&typeof vt.onCommitFiberRoot=="function")try{vt.onCommitFiberRoot(je,i,void 0,(i.current.flags&128)===128)}catch{}}var Un=Math.clz32?Math.clz32:sw,iw=Math.log,rw=Math.LN2;function sw(i){return i>>>=0,i===0?32:31-(iw(i)/rw|0)|0}var ao=64,oo=4194304;function Xs(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function lo(i,s){var l=i.pendingLanes;if(l===0)return 0;var f=0,m=i.suspendedLanes,x=i.pingedLanes,L=l&268435455;if(L!==0){var B=L&~m;B!==0?f=Xs(B):(x&=L,x!==0&&(f=Xs(x)))}else L=l&~m,L!==0?f=Xs(L):x!==0&&(f=Xs(x));if(f===0)return 0;if(s!==0&&s!==f&&(s&m)===0&&(m=f&-f,x=s&-s,m>=x||m===16&&(x&4194240)!==0))return s;if((f&4)!==0&&(f|=l&16),s=i.entangledLanes,s!==0)for(i=i.entanglements,s&=f;0<s;)l=31-Un(s),m=1<<l,f|=i[l],s&=~m;return f}function aw(i,s){switch(i){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ow(i,s){for(var l=i.suspendedLanes,f=i.pingedLanes,m=i.expirationTimes,x=i.pendingLanes;0<x;){var L=31-Un(x),B=1<<L,$=m[L];$===-1?((B&l)===0||(B&f)!==0)&&(m[L]=aw(B,s)):$<=s&&(i.expiredLanes|=B),x&=~B}}function Wl(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Bf(){var i=ao;return ao<<=1,(ao&4194240)===0&&(ao=64),i}function jl(i){for(var s=[],l=0;31>l;l++)s.push(i);return s}function Gs(i,s,l){i.pendingLanes|=s,s!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,s=31-Un(s),i[s]=l}function lw(i,s){var l=i.pendingLanes&~s;i.pendingLanes=s,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=s,i.mutableReadLanes&=s,i.entangledLanes&=s,s=i.entanglements;var f=i.eventTimes;for(i=i.expirationTimes;0<l;){var m=31-Un(l),x=1<<m;s[m]=0,f[m]=-1,i[m]=-1,l&=~x}}function ql(i,s){var l=i.entangledLanes|=s;for(i=i.entanglements;l;){var f=31-Un(l),m=1<<f;m&s|i[f]&s&&(i[f]|=s),l&=~m}}var lt=0;function zf(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Vf,Hl,Uf,Wf,jf,$l=!1,co=[],Gi=null,Ki=null,Qi=null,Ks=new Map,Qs=new Map,Zi=[],cw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qf(i,s){switch(i){case"focusin":case"focusout":Gi=null;break;case"dragenter":case"dragleave":Ki=null;break;case"mouseover":case"mouseout":Qi=null;break;case"pointerover":case"pointerout":Ks.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qs.delete(s.pointerId)}}function Zs(i,s,l,f,m,x){return i===null||i.nativeEvent!==x?(i={blockedOn:s,domEventName:l,eventSystemFlags:f,nativeEvent:x,targetContainers:[m]},s!==null&&(s=fa(s),s!==null&&Hl(s)),i):(i.eventSystemFlags|=f,s=i.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),i)}function uw(i,s,l,f,m){switch(s){case"focusin":return Gi=Zs(Gi,i,s,l,f,m),!0;case"dragenter":return Ki=Zs(Ki,i,s,l,f,m),!0;case"mouseover":return Qi=Zs(Qi,i,s,l,f,m),!0;case"pointerover":var x=m.pointerId;return Ks.set(x,Zs(Ks.get(x)||null,i,s,l,f,m)),!0;case"gotpointercapture":return x=m.pointerId,Qs.set(x,Zs(Qs.get(x)||null,i,s,l,f,m)),!0}return!1}function Hf(i){var s=Pr(i.target);if(s!==null){var l=ht(s);if(l!==null){if(s=l.tag,s===13){if(s=Tn(l),s!==null){i.blockedOn=s,jf(i.priority,function(){Uf(l)});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function uo(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var l=Xl(i.domEventName,i.eventSystemFlags,s[0],i.nativeEvent);if(l===null){l=i.nativeEvent;var f=new l.constructor(l.type,l);Ze=f,l.target.dispatchEvent(f),Ze=null}else return s=fa(l),s!==null&&Hl(s),i.blockedOn=l,!1;s.shift()}return!0}function $f(i,s,l){uo(i)&&l.delete(s)}function dw(){$l=!1,Gi!==null&&uo(Gi)&&(Gi=null),Ki!==null&&uo(Ki)&&(Ki=null),Qi!==null&&uo(Qi)&&(Qi=null),Ks.forEach($f),Qs.forEach($f)}function Js(i,s){i.blockedOn===s&&(i.blockedOn=null,$l||($l=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,dw)))}function ea(i){function s(m){return Js(m,i)}if(0<co.length){Js(co[0],i);for(var l=1;l<co.length;l++){var f=co[l];f.blockedOn===i&&(f.blockedOn=null)}}for(Gi!==null&&Js(Gi,i),Ki!==null&&Js(Ki,i),Qi!==null&&Js(Qi,i),Ks.forEach(s),Qs.forEach(s),l=0;l<Zi.length;l++)f=Zi[l],f.blockedOn===i&&(f.blockedOn=null);for(;0<Zi.length&&(l=Zi[0],l.blockedOn===null);)Hf(l),l.blockedOn===null&&Zi.shift()}var is=W.ReactCurrentBatchConfig,fo=!0;function fw(i,s,l,f){var m=lt,x=is.transition;is.transition=null;try{lt=1,Yl(i,s,l,f)}finally{lt=m,is.transition=x}}function pw(i,s,l,f){var m=lt,x=is.transition;is.transition=null;try{lt=4,Yl(i,s,l,f)}finally{lt=m,is.transition=x}}function Yl(i,s,l,f){if(fo){var m=Xl(i,s,l,f);if(m===null)dc(i,s,f,po,l),qf(i,f);else if(uw(m,i,s,l,f))f.stopPropagation();else if(qf(i,f),s&4&&-1<cw.indexOf(i)){for(;m!==null;){var x=fa(m);if(x!==null&&Vf(x),x=Xl(i,s,l,f),x===null&&dc(i,s,f,po,l),x===m)break;m=x}m!==null&&f.stopPropagation()}else dc(i,s,f,null,l)}}var po=null;function Xl(i,s,l,f){if(po=null,i=ut(f),i=Pr(i),i!==null)if(s=ht(i),s===null)i=null;else if(l=s.tag,l===13){if(i=Tn(s),i!==null)return i;i=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null);return po=i,null}function Yf(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(it()){case Ge:return 1;case rt:return 4;case dn:case pi:return 16;case Tr:return 536870912;default:return 16}default:return 16}}var Ji=null,Gl=null,ho=null;function Xf(){if(ho)return ho;var i,s=Gl,l=s.length,f,m="value"in Ji?Ji.value:Ji.textContent,x=m.length;for(i=0;i<l&&s[i]===m[i];i++);var L=l-i;for(f=1;f<=L&&s[l-f]===m[x-f];f++);return ho=m.slice(i,1<f?1-f:void 0)}function mo(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function go(){return!0}function Gf(){return!1}function Wn(i){function s(l,f,m,x,L){this._reactName=l,this._targetInst=m,this.type=f,this.nativeEvent=x,this.target=L,this.currentTarget=null;for(var B in i)i.hasOwnProperty(B)&&(l=i[B],this[B]=l?l(x):x[B]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?go:Gf,this.isPropagationStopped=Gf,this}return E(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=go)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=go)},persist:function(){},isPersistent:go}),s}var rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kl=Wn(rs),ta=E({},rs,{view:0,detail:0}),hw=Wn(ta),Ql,Zl,na,vo=E({},ta,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ec,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==na&&(na&&i.type==="mousemove"?(Ql=i.screenX-na.screenX,Zl=i.screenY-na.screenY):Zl=Ql=0,na=i),Ql)},movementY:function(i){return"movementY"in i?i.movementY:Zl}}),Kf=Wn(vo),mw=E({},vo,{dataTransfer:0}),gw=Wn(mw),vw=E({},ta,{relatedTarget:0}),Jl=Wn(vw),yw=E({},rs,{animationName:0,elapsedTime:0,pseudoElement:0}),ww=Wn(yw),bw=E({},rs,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),xw=Wn(bw),Sw=E({},rs,{data:0}),Qf=Wn(Sw),kw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_w={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tw(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=Cw[i])?!!s[i]:!1}function ec(){return Tw}var Ew=E({},ta,{key:function(i){if(i.key){var s=kw[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=mo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?_w[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ec,charCode:function(i){return i.type==="keypress"?mo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?mo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Pw=Wn(Ew),Dw=E({},vo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zf=Wn(Dw),Lw=E({},ta,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ec}),Mw=Wn(Lw),Aw=E({},rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rw=Wn(Aw),Fw=E({},vo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Ow=Wn(Fw),Nw=[9,13,27,32],tc=p&&"CompositionEvent"in window,ia=null;p&&"documentMode"in document&&(ia=document.documentMode);var Iw=p&&"TextEvent"in window&&!ia,Jf=p&&(!tc||ia&&8<ia&&11>=ia),ep=" ",tp=!1;function np(i,s){switch(i){case"keyup":return Nw.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ip(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ss=!1;function Bw(i,s){switch(i){case"compositionend":return ip(s);case"keypress":return s.which!==32?null:(tp=!0,ep);case"textInput":return i=s.data,i===ep&&tp?null:i;default:return null}}function zw(i,s){if(ss)return i==="compositionend"||!tc&&np(i,s)?(i=Xf(),ho=Gl=Ji=null,ss=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Jf&&s.locale!=="ko"?null:s.data;default:return null}}var Vw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rp(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Vw[i.type]:s==="textarea"}function sp(i,s,l,f){pt(f),s=So(s,"onChange"),0<s.length&&(l=new Kl("onChange","change",null,l,f),i.push({event:l,listeners:s}))}var ra=null,sa=null;function Uw(i){kp(i,0)}function yo(i){var s=us(i);if(Y(s))return i}function Ww(i,s){if(i==="change")return s}var ap=!1;if(p){var nc;if(p){var ic="oninput"in document;if(!ic){var op=document.createElement("div");op.setAttribute("oninput","return;"),ic=typeof op.oninput=="function"}nc=ic}else nc=!1;ap=nc&&(!document.documentMode||9<document.documentMode)}function lp(){ra&&(ra.detachEvent("onpropertychange",cp),sa=ra=null)}function cp(i){if(i.propertyName==="value"&&yo(sa)){var s=[];sp(s,sa,i,ut(i)),_t(Uw,s)}}function jw(i,s,l){i==="focusin"?(lp(),ra=s,sa=l,ra.attachEvent("onpropertychange",cp)):i==="focusout"&&lp()}function qw(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return yo(sa)}function Hw(i,s){if(i==="click")return yo(s)}function $w(i,s){if(i==="input"||i==="change")return yo(s)}function Yw(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var hi=typeof Object.is=="function"?Object.is:Yw;function aa(i,s){if(hi(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var l=Object.keys(i),f=Object.keys(s);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var m=l[f];if(!h.call(s,m)||!hi(i[m],s[m]))return!1}return!0}function up(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function dp(i,s){var l=up(i);i=0;for(var f;l;){if(l.nodeType===3){if(f=i+l.textContent.length,i<=s&&f>=s)return{node:l,offset:s-i};i=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=up(l)}}function fp(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?fp(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function pp(){for(var i=window,s=ie();s instanceof i.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)i=s.contentWindow;else break;s=ie(i.document)}return s}function rc(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}function Xw(i){var s=pp(),l=i.focusedElem,f=i.selectionRange;if(s!==l&&l&&l.ownerDocument&&fp(l.ownerDocument.documentElement,l)){if(f!==null&&rc(l)){if(s=f.start,i=f.end,i===void 0&&(i=s),"selectionStart"in l)l.selectionStart=s,l.selectionEnd=Math.min(i,l.value.length);else if(i=(s=l.ownerDocument||document)&&s.defaultView||window,i.getSelection){i=i.getSelection();var m=l.textContent.length,x=Math.min(f.start,m);f=f.end===void 0?x:Math.min(f.end,m),!i.extend&&x>f&&(m=f,f=x,x=m),m=dp(l,x);var L=dp(l,f);m&&L&&(i.rangeCount!==1||i.anchorNode!==m.node||i.anchorOffset!==m.offset||i.focusNode!==L.node||i.focusOffset!==L.offset)&&(s=s.createRange(),s.setStart(m.node,m.offset),i.removeAllRanges(),x>f?(i.addRange(s),i.extend(L.node,L.offset)):(s.setEnd(L.node,L.offset),i.addRange(s)))}}for(s=[],i=l;i=i.parentNode;)i.nodeType===1&&s.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<s.length;l++)i=s[l],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Gw=p&&"documentMode"in document&&11>=document.documentMode,as=null,sc=null,oa=null,ac=!1;function hp(i,s,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;ac||as==null||as!==ie(f)||(f=as,"selectionStart"in f&&rc(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),oa&&aa(oa,f)||(oa=f,f=So(sc,"onSelect"),0<f.length&&(s=new Kl("onSelect","select",null,s,l),i.push({event:s,listeners:f}),s.target=as)))}function wo(i,s){var l={};return l[i.toLowerCase()]=s.toLowerCase(),l["Webkit"+i]="webkit"+s,l["Moz"+i]="moz"+s,l}var os={animationend:wo("Animation","AnimationEnd"),animationiteration:wo("Animation","AnimationIteration"),animationstart:wo("Animation","AnimationStart"),transitionend:wo("Transition","TransitionEnd")},oc={},mp={};p&&(mp=document.createElement("div").style,"AnimationEvent"in window||(delete os.animationend.animation,delete os.animationiteration.animation,delete os.animationstart.animation),"TransitionEvent"in window||delete os.transitionend.transition);function bo(i){if(oc[i])return oc[i];if(!os[i])return i;var s=os[i],l;for(l in s)if(s.hasOwnProperty(l)&&l in mp)return oc[i]=s[l];return i}var gp=bo("animationend"),vp=bo("animationiteration"),yp=bo("animationstart"),wp=bo("transitionend"),bp=new Map,xp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function er(i,s){bp.set(i,s),c(s,[i])}for(var lc=0;lc<xp.length;lc++){var cc=xp[lc],Kw=cc.toLowerCase(),Qw=cc[0].toUpperCase()+cc.slice(1);er(Kw,"on"+Qw)}er(gp,"onAnimationEnd"),er(vp,"onAnimationIteration"),er(yp,"onAnimationStart"),er("dblclick","onDoubleClick"),er("focusin","onFocus"),er("focusout","onBlur"),er(wp,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var la="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zw=new Set("cancel close invalid load scroll toggle".split(" ").concat(la));function Sp(i,s,l){var f=i.type||"unknown-event";i.currentTarget=l,nt(f,s,void 0,i),i.currentTarget=null}function kp(i,s){s=(s&4)!==0;for(var l=0;l<i.length;l++){var f=i[l],m=f.event;f=f.listeners;e:{var x=void 0;if(s)for(var L=f.length-1;0<=L;L--){var B=f[L],$=B.instance,re=B.currentTarget;if(B=B.listener,$!==x&&m.isPropagationStopped())break e;Sp(m,B,re),x=$}else for(L=0;L<f.length;L++){if(B=f[L],$=B.instance,re=B.currentTarget,B=B.listener,$!==x&&m.isPropagationStopped())break e;Sp(m,B,re),x=$}}}if(Cn)throw i=bn,Cn=!1,bn=null,i}function yt(i,s){var l=s[vc];l===void 0&&(l=s[vc]=new Set);var f=i+"__bubble";l.has(f)||(_p(s,i,2,!1),l.add(f))}function uc(i,s,l){var f=0;s&&(f|=4),_p(l,i,f,s)}var xo="_reactListening"+Math.random().toString(36).slice(2);function ca(i){if(!i[xo]){i[xo]=!0,a.forEach(function(l){l!=="selectionchange"&&(Zw.has(l)||uc(l,!1,i),uc(l,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[xo]||(s[xo]=!0,uc("selectionchange",!1,s))}}function _p(i,s,l,f){switch(Yf(s)){case 1:var m=fw;break;case 4:m=pw;break;default:m=Yl}l=m.bind(null,s,l,i),m=void 0,!$t||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),f?m!==void 0?i.addEventListener(s,l,{capture:!0,passive:m}):i.addEventListener(s,l,!0):m!==void 0?i.addEventListener(s,l,{passive:m}):i.addEventListener(s,l,!1)}function dc(i,s,l,f,m){var x=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var L=f.tag;if(L===3||L===4){var B=f.stateNode.containerInfo;if(B===m||B.nodeType===8&&B.parentNode===m)break;if(L===4)for(L=f.return;L!==null;){var $=L.tag;if(($===3||$===4)&&($=L.stateNode.containerInfo,$===m||$.nodeType===8&&$.parentNode===m))return;L=L.return}for(;B!==null;){if(L=Pr(B),L===null)return;if($=L.tag,$===5||$===6){f=x=L;continue e}B=B.parentNode}}f=f.return}_t(function(){var re=x,he=ut(l),ge=[];e:{var de=bp.get(i);if(de!==void 0){var Ee=Kl,Ae=i;switch(i){case"keypress":if(mo(l)===0)break e;case"keydown":case"keyup":Ee=Pw;break;case"focusin":Ae="focus",Ee=Jl;break;case"focusout":Ae="blur",Ee=Jl;break;case"beforeblur":case"afterblur":Ee=Jl;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=Kf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=gw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=Mw;break;case gp:case vp:case yp:Ee=ww;break;case wp:Ee=Rw;break;case"scroll":Ee=hw;break;case"wheel":Ee=Ow;break;case"copy":case"cut":case"paste":Ee=xw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=Zf}var Fe=(s&4)!==0,It=!Fe&&i==="scroll",J=Fe?de!==null?de+"Capture":null:de;Fe=[];for(var K=re,te;K!==null;){te=K;var ye=te.stateNode;if(te.tag===5&&ye!==null&&(te=ye,J!==null&&(ye=un(K,J),ye!=null&&Fe.push(ua(K,ye,te)))),It)break;K=K.return}0<Fe.length&&(de=new Ee(de,Ae,null,l,he),ge.push({event:de,listeners:Fe}))}}if((s&7)===0){e:{if(de=i==="mouseover"||i==="pointerover",Ee=i==="mouseout"||i==="pointerout",de&&l!==Ze&&(Ae=l.relatedTarget||l.fromElement)&&(Pr(Ae)||Ae[Fi]))break e;if((Ee||de)&&(de=he.window===he?he:(de=he.ownerDocument)?de.defaultView||de.parentWindow:window,Ee?(Ae=l.relatedTarget||l.toElement,Ee=re,Ae=Ae?Pr(Ae):null,Ae!==null&&(It=ht(Ae),Ae!==It||Ae.tag!==5&&Ae.tag!==6)&&(Ae=null)):(Ee=null,Ae=re),Ee!==Ae)){if(Fe=Kf,ye="onMouseLeave",J="onMouseEnter",K="mouse",(i==="pointerout"||i==="pointerover")&&(Fe=Zf,ye="onPointerLeave",J="onPointerEnter",K="pointer"),It=Ee==null?de:us(Ee),te=Ae==null?de:us(Ae),de=new Fe(ye,K+"leave",Ee,l,he),de.target=It,de.relatedTarget=te,ye=null,Pr(he)===re&&(Fe=new Fe(J,K+"enter",Ae,l,he),Fe.target=te,Fe.relatedTarget=It,ye=Fe),It=ye,Ee&&Ae)t:{for(Fe=Ee,J=Ae,K=0,te=Fe;te;te=ls(te))K++;for(te=0,ye=J;ye;ye=ls(ye))te++;for(;0<K-te;)Fe=ls(Fe),K--;for(;0<te-K;)J=ls(J),te--;for(;K--;){if(Fe===J||J!==null&&Fe===J.alternate)break t;Fe=ls(Fe),J=ls(J)}Fe=null}else Fe=null;Ee!==null&&Cp(ge,de,Ee,Fe,!1),Ae!==null&&It!==null&&Cp(ge,It,Ae,Fe,!0)}}e:{if(de=re?us(re):window,Ee=de.nodeName&&de.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&de.type==="file")var Ne=Ww;else if(rp(de))if(ap)Ne=$w;else{Ne=qw;var Be=jw}else(Ee=de.nodeName)&&Ee.toLowerCase()==="input"&&(de.type==="checkbox"||de.type==="radio")&&(Ne=Hw);if(Ne&&(Ne=Ne(i,re))){sp(ge,Ne,l,he);break e}Be&&Be(i,de,re),i==="focusout"&&(Be=de._wrapperState)&&Be.controlled&&de.type==="number"&&be(de,"number",de.value)}switch(Be=re?us(re):window,i){case"focusin":(rp(Be)||Be.contentEditable==="true")&&(as=Be,sc=re,oa=null);break;case"focusout":oa=sc=as=null;break;case"mousedown":ac=!0;break;case"contextmenu":case"mouseup":case"dragend":ac=!1,hp(ge,l,he);break;case"selectionchange":if(Gw)break;case"keydown":case"keyup":hp(ge,l,he)}var ze;if(tc)e:{switch(i){case"compositionstart":var Ue="onCompositionStart";break e;case"compositionend":Ue="onCompositionEnd";break e;case"compositionupdate":Ue="onCompositionUpdate";break e}Ue=void 0}else ss?np(i,l)&&(Ue="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(Ue="onCompositionStart");Ue&&(Jf&&l.locale!=="ko"&&(ss||Ue!=="onCompositionStart"?Ue==="onCompositionEnd"&&ss&&(ze=Xf()):(Ji=he,Gl="value"in Ji?Ji.value:Ji.textContent,ss=!0)),Be=So(re,Ue),0<Be.length&&(Ue=new Qf(Ue,i,null,l,he),ge.push({event:Ue,listeners:Be}),ze?Ue.data=ze:(ze=ip(l),ze!==null&&(Ue.data=ze)))),(ze=Iw?Bw(i,l):zw(i,l))&&(re=So(re,"onBeforeInput"),0<re.length&&(he=new Qf("onBeforeInput","beforeinput",null,l,he),ge.push({event:he,listeners:re}),he.data=ze))}kp(ge,s)})}function ua(i,s,l){return{instance:i,listener:s,currentTarget:l}}function So(i,s){for(var l=s+"Capture",f=[];i!==null;){var m=i,x=m.stateNode;m.tag===5&&x!==null&&(m=x,x=un(i,l),x!=null&&f.unshift(ua(i,x,m)),x=un(i,s),x!=null&&f.push(ua(i,x,m))),i=i.return}return f}function ls(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Cp(i,s,l,f,m){for(var x=s._reactName,L=[];l!==null&&l!==f;){var B=l,$=B.alternate,re=B.stateNode;if($!==null&&$===f)break;B.tag===5&&re!==null&&(B=re,m?($=un(l,x),$!=null&&L.unshift(ua(l,$,B))):m||($=un(l,x),$!=null&&L.push(ua(l,$,B)))),l=l.return}L.length!==0&&i.push({event:s,listeners:L})}var Jw=/\r\n?/g,e1=/\u0000|\uFFFD/g;function Tp(i){return(typeof i=="string"?i:""+i).replace(Jw,`
`).replace(e1,"")}function ko(i,s,l){if(s=Tp(s),Tp(i)!==s&&l)throw Error(r(425))}function _o(){}var fc=null,pc=null;function hc(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var mc=typeof setTimeout=="function"?setTimeout:void 0,t1=typeof clearTimeout=="function"?clearTimeout:void 0,Ep=typeof Promise=="function"?Promise:void 0,n1=typeof queueMicrotask=="function"?queueMicrotask:typeof Ep<"u"?function(i){return Ep.resolve(null).then(i).catch(i1)}:mc;function i1(i){setTimeout(function(){throw i})}function gc(i,s){var l=s,f=0;do{var m=l.nextSibling;if(i.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"){if(f===0){i.removeChild(m),ea(s);return}f--}else l!=="$"&&l!=="$?"&&l!=="$!"||f++;l=m}while(l);ea(s)}function tr(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return i}function Pp(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return i;s--}else l==="/$"&&s++}i=i.previousSibling}return null}var cs=Math.random().toString(36).slice(2),ki="__reactFiber$"+cs,da="__reactProps$"+cs,Fi="__reactContainer$"+cs,vc="__reactEvents$"+cs,r1="__reactListeners$"+cs,s1="__reactHandles$"+cs;function Pr(i){var s=i[ki];if(s)return s;for(var l=i.parentNode;l;){if(s=l[Fi]||l[ki]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(i=Pp(i);i!==null;){if(l=i[ki])return l;i=Pp(i)}return s}i=l,l=i.parentNode}return null}function fa(i){return i=i[ki]||i[Fi],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function us(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(r(33))}function Co(i){return i[da]||null}var yc=[],ds=-1;function nr(i){return{current:i}}function wt(i){0>ds||(i.current=yc[ds],yc[ds]=null,ds--)}function mt(i,s){ds++,yc[ds]=i.current,i.current=s}var ir={},fn=nr(ir),En=nr(!1),Dr=ir;function fs(i,s){var l=i.type.contextTypes;if(!l)return ir;var f=i.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===s)return f.__reactInternalMemoizedMaskedChildContext;var m={},x;for(x in l)m[x]=s[x];return f&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=s,i.__reactInternalMemoizedMaskedChildContext=m),m}function Pn(i){return i=i.childContextTypes,i!=null}function To(){wt(En),wt(fn)}function Dp(i,s,l){if(fn.current!==ir)throw Error(r(168));mt(fn,s),mt(En,l)}function Lp(i,s,l){var f=i.stateNode;if(s=s.childContextTypes,typeof f.getChildContext!="function")return l;f=f.getChildContext();for(var m in f)if(!(m in s))throw Error(r(108,q(i)||"Unknown",m));return E({},l,f)}function Eo(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ir,Dr=fn.current,mt(fn,i),mt(En,En.current),!0}function Mp(i,s,l){var f=i.stateNode;if(!f)throw Error(r(169));l?(i=Lp(i,s,Dr),f.__reactInternalMemoizedMergedChildContext=i,wt(En),wt(fn),mt(fn,i)):wt(En),mt(En,l)}var Oi=null,Po=!1,wc=!1;function Ap(i){Oi===null?Oi=[i]:Oi.push(i)}function a1(i){Po=!0,Ap(i)}function rr(){if(!wc&&Oi!==null){wc=!0;var i=0,s=lt;try{var l=Oi;for(lt=1;i<l.length;i++){var f=l[i];do f=f(!0);while(f!==null)}Oi=null,Po=!1}catch(m){throw Oi!==null&&(Oi=Oi.slice(i+1)),Oe(Ge,rr),m}finally{lt=s,wc=!1}}return null}var ps=[],hs=0,Do=null,Lo=0,Zn=[],Jn=0,Lr=null,Ni=1,Ii="";function Mr(i,s){ps[hs++]=Lo,ps[hs++]=Do,Do=i,Lo=s}function Rp(i,s,l){Zn[Jn++]=Ni,Zn[Jn++]=Ii,Zn[Jn++]=Lr,Lr=i;var f=Ni;i=Ii;var m=32-Un(f)-1;f&=~(1<<m),l+=1;var x=32-Un(s)+m;if(30<x){var L=m-m%5;x=(f&(1<<L)-1).toString(32),f>>=L,m-=L,Ni=1<<32-Un(s)+m|l<<m|f,Ii=x+i}else Ni=1<<x|l<<m|f,Ii=i}function bc(i){i.return!==null&&(Mr(i,1),Rp(i,1,0))}function xc(i){for(;i===Do;)Do=ps[--hs],ps[hs]=null,Lo=ps[--hs],ps[hs]=null;for(;i===Lr;)Lr=Zn[--Jn],Zn[Jn]=null,Ii=Zn[--Jn],Zn[Jn]=null,Ni=Zn[--Jn],Zn[Jn]=null}var jn=null,qn=null,bt=!1,mi=null;function Fp(i,s){var l=ii(5,null,null,0);l.elementType="DELETED",l.stateNode=s,l.return=i,s=i.deletions,s===null?(i.deletions=[l],i.flags|=16):s.push(l)}function Op(i,s){switch(i.tag){case 5:var l=i.type;return s=s.nodeType!==1||l.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(i.stateNode=s,jn=i,qn=tr(s.firstChild),!0):!1;case 6:return s=i.pendingProps===""||s.nodeType!==3?null:s,s!==null?(i.stateNode=s,jn=i,qn=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(l=Lr!==null?{id:Ni,overflow:Ii}:null,i.memoizedState={dehydrated:s,treeContext:l,retryLane:1073741824},l=ii(18,null,null,0),l.stateNode=s,l.return=i,i.child=l,jn=i,qn=null,!0):!1;default:return!1}}function Sc(i){return(i.mode&1)!==0&&(i.flags&128)===0}function kc(i){if(bt){var s=qn;if(s){var l=s;if(!Op(i,s)){if(Sc(i))throw Error(r(418));s=tr(l.nextSibling);var f=jn;s&&Op(i,s)?Fp(f,l):(i.flags=i.flags&-4097|2,bt=!1,jn=i)}}else{if(Sc(i))throw Error(r(418));i.flags=i.flags&-4097|2,bt=!1,jn=i}}}function Np(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;jn=i}function Mo(i){if(i!==jn)return!1;if(!bt)return Np(i),bt=!0,!1;var s;if((s=i.tag!==3)&&!(s=i.tag!==5)&&(s=i.type,s=s!=="head"&&s!=="body"&&!hc(i.type,i.memoizedProps)),s&&(s=qn)){if(Sc(i))throw Ip(),Error(r(418));for(;s;)Fp(i,s),s=tr(s.nextSibling)}if(Np(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8){var l=i.data;if(l==="/$"){if(s===0){qn=tr(i.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++}i=i.nextSibling}qn=null}}else qn=jn?tr(i.stateNode.nextSibling):null;return!0}function Ip(){for(var i=qn;i;)i=tr(i.nextSibling)}function ms(){qn=jn=null,bt=!1}function _c(i){mi===null?mi=[i]:mi.push(i)}var o1=W.ReactCurrentBatchConfig;function pa(i,s,l){if(i=l.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(r(309));var f=l.stateNode}if(!f)throw Error(r(147,i));var m=f,x=""+i;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===x?s.ref:(s=function(L){var B=m.refs;L===null?delete B[x]:B[x]=L},s._stringRef=x,s)}if(typeof i!="string")throw Error(r(284));if(!l._owner)throw Error(r(290,i))}return i}function Ao(i,s){throw i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i))}function Bp(i){var s=i._init;return s(i._payload)}function zp(i){function s(J,K){if(i){var te=J.deletions;te===null?(J.deletions=[K],J.flags|=16):te.push(K)}}function l(J,K){if(!i)return null;for(;K!==null;)s(J,K),K=K.sibling;return null}function f(J,K){for(J=new Map;K!==null;)K.key!==null?J.set(K.key,K):J.set(K.index,K),K=K.sibling;return J}function m(J,K){return J=fr(J,K),J.index=0,J.sibling=null,J}function x(J,K,te){return J.index=te,i?(te=J.alternate,te!==null?(te=te.index,te<K?(J.flags|=2,K):te):(J.flags|=2,K)):(J.flags|=1048576,K)}function L(J){return i&&J.alternate===null&&(J.flags|=2),J}function B(J,K,te,ye){return K===null||K.tag!==6?(K=mu(te,J.mode,ye),K.return=J,K):(K=m(K,te),K.return=J,K)}function $(J,K,te,ye){var Ne=te.type;return Ne===ne?he(J,K,te.props.children,ye,te.key):K!==null&&(K.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===y&&Bp(Ne)===K.type)?(ye=m(K,te.props),ye.ref=pa(J,K,te),ye.return=J,ye):(ye=nl(te.type,te.key,te.props,null,J.mode,ye),ye.ref=pa(J,K,te),ye.return=J,ye)}function re(J,K,te,ye){return K===null||K.tag!==4||K.stateNode.containerInfo!==te.containerInfo||K.stateNode.implementation!==te.implementation?(K=gu(te,J.mode,ye),K.return=J,K):(K=m(K,te.children||[]),K.return=J,K)}function he(J,K,te,ye,Ne){return K===null||K.tag!==7?(K=zr(te,J.mode,ye,Ne),K.return=J,K):(K=m(K,te),K.return=J,K)}function ge(J,K,te){if(typeof K=="string"&&K!==""||typeof K=="number")return K=mu(""+K,J.mode,te),K.return=J,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case U:return te=nl(K.type,K.key,K.props,null,J.mode,te),te.ref=pa(J,null,K),te.return=J,te;case Z:return K=gu(K,J.mode,te),K.return=J,K;case y:var ye=K._init;return ge(J,ye(K._payload),te)}if(Ie(K)||_(K))return K=zr(K,J.mode,te,null),K.return=J,K;Ao(J,K)}return null}function de(J,K,te,ye){var Ne=K!==null?K.key:null;if(typeof te=="string"&&te!==""||typeof te=="number")return Ne!==null?null:B(J,K,""+te,ye);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case U:return te.key===Ne?$(J,K,te,ye):null;case Z:return te.key===Ne?re(J,K,te,ye):null;case y:return Ne=te._init,de(J,K,Ne(te._payload),ye)}if(Ie(te)||_(te))return Ne!==null?null:he(J,K,te,ye,null);Ao(J,te)}return null}function Ee(J,K,te,ye,Ne){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return J=J.get(te)||null,B(K,J,""+ye,Ne);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case U:return J=J.get(ye.key===null?te:ye.key)||null,$(K,J,ye,Ne);case Z:return J=J.get(ye.key===null?te:ye.key)||null,re(K,J,ye,Ne);case y:var Be=ye._init;return Ee(J,K,te,Be(ye._payload),Ne)}if(Ie(ye)||_(ye))return J=J.get(te)||null,he(K,J,ye,Ne,null);Ao(K,ye)}return null}function Ae(J,K,te,ye){for(var Ne=null,Be=null,ze=K,Ue=K=0,en=null;ze!==null&&Ue<te.length;Ue++){ze.index>Ue?(en=ze,ze=null):en=ze.sibling;var st=de(J,ze,te[Ue],ye);if(st===null){ze===null&&(ze=en);break}i&&ze&&st.alternate===null&&s(J,ze),K=x(st,K,Ue),Be===null?Ne=st:Be.sibling=st,Be=st,ze=en}if(Ue===te.length)return l(J,ze),bt&&Mr(J,Ue),Ne;if(ze===null){for(;Ue<te.length;Ue++)ze=ge(J,te[Ue],ye),ze!==null&&(K=x(ze,K,Ue),Be===null?Ne=ze:Be.sibling=ze,Be=ze);return bt&&Mr(J,Ue),Ne}for(ze=f(J,ze);Ue<te.length;Ue++)en=Ee(ze,J,Ue,te[Ue],ye),en!==null&&(i&&en.alternate!==null&&ze.delete(en.key===null?Ue:en.key),K=x(en,K,Ue),Be===null?Ne=en:Be.sibling=en,Be=en);return i&&ze.forEach(function(pr){return s(J,pr)}),bt&&Mr(J,Ue),Ne}function Fe(J,K,te,ye){var Ne=_(te);if(typeof Ne!="function")throw Error(r(150));if(te=Ne.call(te),te==null)throw Error(r(151));for(var Be=Ne=null,ze=K,Ue=K=0,en=null,st=te.next();ze!==null&&!st.done;Ue++,st=te.next()){ze.index>Ue?(en=ze,ze=null):en=ze.sibling;var pr=de(J,ze,st.value,ye);if(pr===null){ze===null&&(ze=en);break}i&&ze&&pr.alternate===null&&s(J,ze),K=x(pr,K,Ue),Be===null?Ne=pr:Be.sibling=pr,Be=pr,ze=en}if(st.done)return l(J,ze),bt&&Mr(J,Ue),Ne;if(ze===null){for(;!st.done;Ue++,st=te.next())st=ge(J,st.value,ye),st!==null&&(K=x(st,K,Ue),Be===null?Ne=st:Be.sibling=st,Be=st);return bt&&Mr(J,Ue),Ne}for(ze=f(J,ze);!st.done;Ue++,st=te.next())st=Ee(ze,J,Ue,st.value,ye),st!==null&&(i&&st.alternate!==null&&ze.delete(st.key===null?Ue:st.key),K=x(st,K,Ue),Be===null?Ne=st:Be.sibling=st,Be=st);return i&&ze.forEach(function(V1){return s(J,V1)}),bt&&Mr(J,Ue),Ne}function It(J,K,te,ye){if(typeof te=="object"&&te!==null&&te.type===ne&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case U:e:{for(var Ne=te.key,Be=K;Be!==null;){if(Be.key===Ne){if(Ne=te.type,Ne===ne){if(Be.tag===7){l(J,Be.sibling),K=m(Be,te.props.children),K.return=J,J=K;break e}}else if(Be.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===y&&Bp(Ne)===Be.type){l(J,Be.sibling),K=m(Be,te.props),K.ref=pa(J,Be,te),K.return=J,J=K;break e}l(J,Be);break}else s(J,Be);Be=Be.sibling}te.type===ne?(K=zr(te.props.children,J.mode,ye,te.key),K.return=J,J=K):(ye=nl(te.type,te.key,te.props,null,J.mode,ye),ye.ref=pa(J,K,te),ye.return=J,J=ye)}return L(J);case Z:e:{for(Be=te.key;K!==null;){if(K.key===Be)if(K.tag===4&&K.stateNode.containerInfo===te.containerInfo&&K.stateNode.implementation===te.implementation){l(J,K.sibling),K=m(K,te.children||[]),K.return=J,J=K;break e}else{l(J,K);break}else s(J,K);K=K.sibling}K=gu(te,J.mode,ye),K.return=J,J=K}return L(J);case y:return Be=te._init,It(J,K,Be(te._payload),ye)}if(Ie(te))return Ae(J,K,te,ye);if(_(te))return Fe(J,K,te,ye);Ao(J,te)}return typeof te=="string"&&te!==""||typeof te=="number"?(te=""+te,K!==null&&K.tag===6?(l(J,K.sibling),K=m(K,te),K.return=J,J=K):(l(J,K),K=mu(te,J.mode,ye),K.return=J,J=K),L(J)):l(J,K)}return It}var gs=zp(!0),Vp=zp(!1),Ro=nr(null),Fo=null,vs=null,Cc=null;function Tc(){Cc=vs=Fo=null}function Ec(i){var s=Ro.current;wt(Ro),i._currentValue=s}function Pc(i,s,l){for(;i!==null;){var f=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),i===l)break;i=i.return}}function ys(i,s){Fo=i,Cc=vs=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&s)!==0&&(Dn=!0),i.firstContext=null)}function ei(i){var s=i._currentValue;if(Cc!==i)if(i={context:i,memoizedValue:s,next:null},vs===null){if(Fo===null)throw Error(r(308));vs=i,Fo.dependencies={lanes:0,firstContext:i}}else vs=vs.next=i;return s}var Ar=null;function Dc(i){Ar===null?Ar=[i]:Ar.push(i)}function Up(i,s,l,f){var m=s.interleaved;return m===null?(l.next=l,Dc(s)):(l.next=m.next,m.next=l),s.interleaved=l,Bi(i,f)}function Bi(i,s){i.lanes|=s;var l=i.alternate;for(l!==null&&(l.lanes|=s),l=i,i=i.return;i!==null;)i.childLanes|=s,l=i.alternate,l!==null&&(l.childLanes|=s),l=i,i=i.return;return l.tag===3?l.stateNode:null}var sr=!1;function Lc(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wp(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function zi(i,s){return{eventTime:i,lane:s,tag:0,payload:null,callback:null,next:null}}function ar(i,s,l){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(et&2)!==0){var m=f.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),f.pending=s,Bi(i,l)}return m=f.interleaved,m===null?(s.next=s,Dc(f)):(s.next=m.next,m.next=s),f.interleaved=s,Bi(i,l)}function Oo(i,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194240)!==0)){var f=s.lanes;f&=i.pendingLanes,l|=f,s.lanes=l,ql(i,l)}}function jp(i,s){var l=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var m=null,x=null;if(l=l.firstBaseUpdate,l!==null){do{var L={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};x===null?m=x=L:x=x.next=L,l=l.next}while(l!==null);x===null?m=x=s:x=x.next=s}else m=x=s;l={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:x,shared:f.shared,effects:f.effects},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=s:i.next=s,l.lastBaseUpdate=s}function No(i,s,l,f){var m=i.updateQueue;sr=!1;var x=m.firstBaseUpdate,L=m.lastBaseUpdate,B=m.shared.pending;if(B!==null){m.shared.pending=null;var $=B,re=$.next;$.next=null,L===null?x=re:L.next=re,L=$;var he=i.alternate;he!==null&&(he=he.updateQueue,B=he.lastBaseUpdate,B!==L&&(B===null?he.firstBaseUpdate=re:B.next=re,he.lastBaseUpdate=$))}if(x!==null){var ge=m.baseState;L=0,he=re=$=null,B=x;do{var de=B.lane,Ee=B.eventTime;if((f&de)===de){he!==null&&(he=he.next={eventTime:Ee,lane:0,tag:B.tag,payload:B.payload,callback:B.callback,next:null});e:{var Ae=i,Fe=B;switch(de=s,Ee=l,Fe.tag){case 1:if(Ae=Fe.payload,typeof Ae=="function"){ge=Ae.call(Ee,ge,de);break e}ge=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=Fe.payload,de=typeof Ae=="function"?Ae.call(Ee,ge,de):Ae,de==null)break e;ge=E({},ge,de);break e;case 2:sr=!0}}B.callback!==null&&B.lane!==0&&(i.flags|=64,de=m.effects,de===null?m.effects=[B]:de.push(B))}else Ee={eventTime:Ee,lane:de,tag:B.tag,payload:B.payload,callback:B.callback,next:null},he===null?(re=he=Ee,$=ge):he=he.next=Ee,L|=de;if(B=B.next,B===null){if(B=m.shared.pending,B===null)break;de=B,B=de.next,de.next=null,m.lastBaseUpdate=de,m.shared.pending=null}}while(!0);if(he===null&&($=ge),m.baseState=$,m.firstBaseUpdate=re,m.lastBaseUpdate=he,s=m.shared.interleaved,s!==null){m=s;do L|=m.lane,m=m.next;while(m!==s)}else x===null&&(m.shared.lanes=0);Or|=L,i.lanes=L,i.memoizedState=ge}}function qp(i,s,l){if(i=s.effects,s.effects=null,i!==null)for(s=0;s<i.length;s++){var f=i[s],m=f.callback;if(m!==null){if(f.callback=null,f=l,typeof m!="function")throw Error(r(191,m));m.call(f)}}}var ha={},_i=nr(ha),ma=nr(ha),ga=nr(ha);function Rr(i){if(i===ha)throw Error(r(174));return i}function Mc(i,s){switch(mt(ga,s),mt(ma,i),mt(_i,ha),i=s.nodeType,i){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:ot(null,"");break;default:i=i===8?s.parentNode:s,s=i.namespaceURI||null,i=i.tagName,s=ot(s,i)}wt(_i),mt(_i,s)}function ws(){wt(_i),wt(ma),wt(ga)}function Hp(i){Rr(ga.current);var s=Rr(_i.current),l=ot(s,i.type);s!==l&&(mt(ma,i),mt(_i,l))}function Ac(i){ma.current===i&&(wt(_i),wt(ma))}var Ct=nr(0);function Io(i){for(var s=i;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Rc=[];function Fc(){for(var i=0;i<Rc.length;i++)Rc[i]._workInProgressVersionPrimary=null;Rc.length=0}var Bo=W.ReactCurrentDispatcher,Oc=W.ReactCurrentBatchConfig,Fr=0,Tt=null,Yt=null,Zt=null,zo=!1,va=!1,ya=0,l1=0;function pn(){throw Error(r(321))}function Nc(i,s){if(s===null)return!1;for(var l=0;l<s.length&&l<i.length;l++)if(!hi(i[l],s[l]))return!1;return!0}function Ic(i,s,l,f,m,x){if(Fr=x,Tt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,Bo.current=i===null||i.memoizedState===null?f1:p1,i=l(f,m),va){x=0;do{if(va=!1,ya=0,25<=x)throw Error(r(301));x+=1,Zt=Yt=null,s.updateQueue=null,Bo.current=h1,i=l(f,m)}while(va)}if(Bo.current=Wo,s=Yt!==null&&Yt.next!==null,Fr=0,Zt=Yt=Tt=null,zo=!1,s)throw Error(r(300));return i}function Bc(){var i=ya!==0;return ya=0,i}function Ci(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?Tt.memoizedState=Zt=i:Zt=Zt.next=i,Zt}function ti(){if(Yt===null){var i=Tt.alternate;i=i!==null?i.memoizedState:null}else i=Yt.next;var s=Zt===null?Tt.memoizedState:Zt.next;if(s!==null)Zt=s,Yt=i;else{if(i===null)throw Error(r(310));Yt=i,i={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},Zt===null?Tt.memoizedState=Zt=i:Zt=Zt.next=i}return Zt}function wa(i,s){return typeof s=="function"?s(i):s}function zc(i){var s=ti(),l=s.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=i;var f=Yt,m=f.baseQueue,x=l.pending;if(x!==null){if(m!==null){var L=m.next;m.next=x.next,x.next=L}f.baseQueue=m=x,l.pending=null}if(m!==null){x=m.next,f=f.baseState;var B=L=null,$=null,re=x;do{var he=re.lane;if((Fr&he)===he)$!==null&&($=$.next={lane:0,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),f=re.hasEagerState?re.eagerState:i(f,re.action);else{var ge={lane:he,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null};$===null?(B=$=ge,L=f):$=$.next=ge,Tt.lanes|=he,Or|=he}re=re.next}while(re!==null&&re!==x);$===null?L=f:$.next=B,hi(f,s.memoizedState)||(Dn=!0),s.memoizedState=f,s.baseState=L,s.baseQueue=$,l.lastRenderedState=f}if(i=l.interleaved,i!==null){m=i;do x=m.lane,Tt.lanes|=x,Or|=x,m=m.next;while(m!==i)}else m===null&&(l.lanes=0);return[s.memoizedState,l.dispatch]}function Vc(i){var s=ti(),l=s.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=i;var f=l.dispatch,m=l.pending,x=s.memoizedState;if(m!==null){l.pending=null;var L=m=m.next;do x=i(x,L.action),L=L.next;while(L!==m);hi(x,s.memoizedState)||(Dn=!0),s.memoizedState=x,s.baseQueue===null&&(s.baseState=x),l.lastRenderedState=x}return[x,f]}function $p(){}function Yp(i,s){var l=Tt,f=ti(),m=s(),x=!hi(f.memoizedState,m);if(x&&(f.memoizedState=m,Dn=!0),f=f.queue,Uc(Kp.bind(null,l,f,i),[i]),f.getSnapshot!==s||x||Zt!==null&&Zt.memoizedState.tag&1){if(l.flags|=2048,ba(9,Gp.bind(null,l,f,m,s),void 0,null),Jt===null)throw Error(r(349));(Fr&30)!==0||Xp(l,s,m)}return m}function Xp(i,s,l){i.flags|=16384,i={getSnapshot:s,value:l},s=Tt.updateQueue,s===null?(s={lastEffect:null,stores:null},Tt.updateQueue=s,s.stores=[i]):(l=s.stores,l===null?s.stores=[i]:l.push(i))}function Gp(i,s,l,f){s.value=l,s.getSnapshot=f,Qp(s)&&Zp(i)}function Kp(i,s,l){return l(function(){Qp(s)&&Zp(i)})}function Qp(i){var s=i.getSnapshot;i=i.value;try{var l=s();return!hi(i,l)}catch{return!0}}function Zp(i){var s=Bi(i,1);s!==null&&wi(s,i,1,-1)}function Jp(i){var s=Ci();return typeof i=="function"&&(i=i()),s.memoizedState=s.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:i},s.queue=i,i=i.dispatch=d1.bind(null,Tt,i),[s.memoizedState,i]}function ba(i,s,l,f){return i={tag:i,create:s,destroy:l,deps:f,next:null},s=Tt.updateQueue,s===null?(s={lastEffect:null,stores:null},Tt.updateQueue=s,s.lastEffect=i.next=i):(l=s.lastEffect,l===null?s.lastEffect=i.next=i:(f=l.next,l.next=i,i.next=f,s.lastEffect=i)),i}function eh(){return ti().memoizedState}function Vo(i,s,l,f){var m=Ci();Tt.flags|=i,m.memoizedState=ba(1|s,l,void 0,f===void 0?null:f)}function Uo(i,s,l,f){var m=ti();f=f===void 0?null:f;var x=void 0;if(Yt!==null){var L=Yt.memoizedState;if(x=L.destroy,f!==null&&Nc(f,L.deps)){m.memoizedState=ba(s,l,x,f);return}}Tt.flags|=i,m.memoizedState=ba(1|s,l,x,f)}function th(i,s){return Vo(8390656,8,i,s)}function Uc(i,s){return Uo(2048,8,i,s)}function nh(i,s){return Uo(4,2,i,s)}function ih(i,s){return Uo(4,4,i,s)}function rh(i,s){if(typeof s=="function")return i=i(),s(i),function(){s(null)};if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function sh(i,s,l){return l=l!=null?l.concat([i]):null,Uo(4,4,rh.bind(null,s,i),l)}function Wc(){}function ah(i,s){var l=ti();s=s===void 0?null:s;var f=l.memoizedState;return f!==null&&s!==null&&Nc(s,f[1])?f[0]:(l.memoizedState=[i,s],i)}function oh(i,s){var l=ti();s=s===void 0?null:s;var f=l.memoizedState;return f!==null&&s!==null&&Nc(s,f[1])?f[0]:(i=i(),l.memoizedState=[i,s],i)}function lh(i,s,l){return(Fr&21)===0?(i.baseState&&(i.baseState=!1,Dn=!0),i.memoizedState=l):(hi(l,s)||(l=Bf(),Tt.lanes|=l,Or|=l,i.baseState=!0),s)}function c1(i,s){var l=lt;lt=l!==0&&4>l?l:4,i(!0);var f=Oc.transition;Oc.transition={};try{i(!1),s()}finally{lt=l,Oc.transition=f}}function ch(){return ti().memoizedState}function u1(i,s,l){var f=ur(i);if(l={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null},uh(i))dh(s,l);else if(l=Up(i,s,l,f),l!==null){var m=Sn();wi(l,i,f,m),fh(l,s,f)}}function d1(i,s,l){var f=ur(i),m={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null};if(uh(i))dh(s,m);else{var x=i.alternate;if(i.lanes===0&&(x===null||x.lanes===0)&&(x=s.lastRenderedReducer,x!==null))try{var L=s.lastRenderedState,B=x(L,l);if(m.hasEagerState=!0,m.eagerState=B,hi(B,L)){var $=s.interleaved;$===null?(m.next=m,Dc(s)):(m.next=$.next,$.next=m),s.interleaved=m;return}}catch{}l=Up(i,s,m,f),l!==null&&(m=Sn(),wi(l,i,f,m),fh(l,s,f))}}function uh(i){var s=i.alternate;return i===Tt||s!==null&&s===Tt}function dh(i,s){va=zo=!0;var l=i.pending;l===null?s.next=s:(s.next=l.next,l.next=s),i.pending=s}function fh(i,s,l){if((l&4194240)!==0){var f=s.lanes;f&=i.pendingLanes,l|=f,s.lanes=l,ql(i,l)}}var Wo={readContext:ei,useCallback:pn,useContext:pn,useEffect:pn,useImperativeHandle:pn,useInsertionEffect:pn,useLayoutEffect:pn,useMemo:pn,useReducer:pn,useRef:pn,useState:pn,useDebugValue:pn,useDeferredValue:pn,useTransition:pn,useMutableSource:pn,useSyncExternalStore:pn,useId:pn,unstable_isNewReconciler:!1},f1={readContext:ei,useCallback:function(i,s){return Ci().memoizedState=[i,s===void 0?null:s],i},useContext:ei,useEffect:th,useImperativeHandle:function(i,s,l){return l=l!=null?l.concat([i]):null,Vo(4194308,4,rh.bind(null,s,i),l)},useLayoutEffect:function(i,s){return Vo(4194308,4,i,s)},useInsertionEffect:function(i,s){return Vo(4,2,i,s)},useMemo:function(i,s){var l=Ci();return s=s===void 0?null:s,i=i(),l.memoizedState=[i,s],i},useReducer:function(i,s,l){var f=Ci();return s=l!==void 0?l(s):s,f.memoizedState=f.baseState=s,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:s},f.queue=i,i=i.dispatch=u1.bind(null,Tt,i),[f.memoizedState,i]},useRef:function(i){var s=Ci();return i={current:i},s.memoizedState=i},useState:Jp,useDebugValue:Wc,useDeferredValue:function(i){return Ci().memoizedState=i},useTransition:function(){var i=Jp(!1),s=i[0];return i=c1.bind(null,i[1]),Ci().memoizedState=i,[s,i]},useMutableSource:function(){},useSyncExternalStore:function(i,s,l){var f=Tt,m=Ci();if(bt){if(l===void 0)throw Error(r(407));l=l()}else{if(l=s(),Jt===null)throw Error(r(349));(Fr&30)!==0||Xp(f,s,l)}m.memoizedState=l;var x={value:l,getSnapshot:s};return m.queue=x,th(Kp.bind(null,f,x,i),[i]),f.flags|=2048,ba(9,Gp.bind(null,f,x,l,s),void 0,null),l},useId:function(){var i=Ci(),s=Jt.identifierPrefix;if(bt){var l=Ii,f=Ni;l=(f&~(1<<32-Un(f)-1)).toString(32)+l,s=":"+s+"R"+l,l=ya++,0<l&&(s+="H"+l.toString(32)),s+=":"}else l=l1++,s=":"+s+"r"+l.toString(32)+":";return i.memoizedState=s},unstable_isNewReconciler:!1},p1={readContext:ei,useCallback:ah,useContext:ei,useEffect:Uc,useImperativeHandle:sh,useInsertionEffect:nh,useLayoutEffect:ih,useMemo:oh,useReducer:zc,useRef:eh,useState:function(){return zc(wa)},useDebugValue:Wc,useDeferredValue:function(i){var s=ti();return lh(s,Yt.memoizedState,i)},useTransition:function(){var i=zc(wa)[0],s=ti().memoizedState;return[i,s]},useMutableSource:$p,useSyncExternalStore:Yp,useId:ch,unstable_isNewReconciler:!1},h1={readContext:ei,useCallback:ah,useContext:ei,useEffect:Uc,useImperativeHandle:sh,useInsertionEffect:nh,useLayoutEffect:ih,useMemo:oh,useReducer:Vc,useRef:eh,useState:function(){return Vc(wa)},useDebugValue:Wc,useDeferredValue:function(i){var s=ti();return Yt===null?s.memoizedState=i:lh(s,Yt.memoizedState,i)},useTransition:function(){var i=Vc(wa)[0],s=ti().memoizedState;return[i,s]},useMutableSource:$p,useSyncExternalStore:Yp,useId:ch,unstable_isNewReconciler:!1};function gi(i,s){if(i&&i.defaultProps){s=E({},s),i=i.defaultProps;for(var l in i)s[l]===void 0&&(s[l]=i[l]);return s}return s}function jc(i,s,l,f){s=i.memoizedState,l=l(f,s),l=l==null?s:E({},s,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var jo={isMounted:function(i){return(i=i._reactInternals)?ht(i)===i:!1},enqueueSetState:function(i,s,l){i=i._reactInternals;var f=Sn(),m=ur(i),x=zi(f,m);x.payload=s,l!=null&&(x.callback=l),s=ar(i,x,m),s!==null&&(wi(s,i,m,f),Oo(s,i,m))},enqueueReplaceState:function(i,s,l){i=i._reactInternals;var f=Sn(),m=ur(i),x=zi(f,m);x.tag=1,x.payload=s,l!=null&&(x.callback=l),s=ar(i,x,m),s!==null&&(wi(s,i,m,f),Oo(s,i,m))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var l=Sn(),f=ur(i),m=zi(l,f);m.tag=2,s!=null&&(m.callback=s),s=ar(i,m,f),s!==null&&(wi(s,i,f,l),Oo(s,i,f))}};function ph(i,s,l,f,m,x,L){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,x,L):s.prototype&&s.prototype.isPureReactComponent?!aa(l,f)||!aa(m,x):!0}function hh(i,s,l){var f=!1,m=ir,x=s.contextType;return typeof x=="object"&&x!==null?x=ei(x):(m=Pn(s)?Dr:fn.current,f=s.contextTypes,x=(f=f!=null)?fs(i,m):ir),s=new s(l,x),i.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=jo,i.stateNode=s,s._reactInternals=i,f&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=m,i.__reactInternalMemoizedMaskedChildContext=x),s}function mh(i,s,l,f){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,f),s.state!==i&&jo.enqueueReplaceState(s,s.state,null)}function qc(i,s,l,f){var m=i.stateNode;m.props=l,m.state=i.memoizedState,m.refs={},Lc(i);var x=s.contextType;typeof x=="object"&&x!==null?m.context=ei(x):(x=Pn(s)?Dr:fn.current,m.context=fs(i,x)),m.state=i.memoizedState,x=s.getDerivedStateFromProps,typeof x=="function"&&(jc(i,s,x,l),m.state=i.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(s=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),s!==m.state&&jo.enqueueReplaceState(m,m.state,null),No(i,l,m,f),m.state=i.memoizedState),typeof m.componentDidMount=="function"&&(i.flags|=4194308)}function bs(i,s){try{var l="",f=s;do l+=z(f),f=f.return;while(f);var m=l}catch(x){m=`
Error generating stack: `+x.message+`
`+x.stack}return{value:i,source:s,stack:m,digest:null}}function Hc(i,s,l){return{value:i,source:null,stack:l??null,digest:s??null}}function $c(i,s){try{console.error(s.value)}catch(l){setTimeout(function(){throw l})}}var m1=typeof WeakMap=="function"?WeakMap:Map;function gh(i,s,l){l=zi(-1,l),l.tag=3,l.payload={element:null};var f=s.value;return l.callback=function(){Ko||(Ko=!0,ou=f),$c(i,s)},l}function vh(i,s,l){l=zi(-1,l),l.tag=3;var f=i.type.getDerivedStateFromError;if(typeof f=="function"){var m=s.value;l.payload=function(){return f(m)},l.callback=function(){$c(i,s)}}var x=i.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(l.callback=function(){$c(i,s),typeof f!="function"&&(lr===null?lr=new Set([this]):lr.add(this));var L=s.stack;this.componentDidCatch(s.value,{componentStack:L!==null?L:""})}),l}function yh(i,s,l){var f=i.pingCache;if(f===null){f=i.pingCache=new m1;var m=new Set;f.set(s,m)}else m=f.get(s),m===void 0&&(m=new Set,f.set(s,m));m.has(l)||(m.add(l),i=D1.bind(null,i,s,l),s.then(i,i))}function wh(i){do{var s;if((s=i.tag===13)&&(s=i.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return i;i=i.return}while(i!==null);return null}function bh(i,s,l,f,m){return(i.mode&1)===0?(i===s?i.flags|=65536:(i.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(s=zi(-1,1),s.tag=2,ar(l,s,1))),l.lanes|=1),i):(i.flags|=65536,i.lanes=m,i)}var g1=W.ReactCurrentOwner,Dn=!1;function xn(i,s,l,f){s.child=i===null?Vp(s,null,l,f):gs(s,i.child,l,f)}function xh(i,s,l,f,m){l=l.render;var x=s.ref;return ys(s,m),f=Ic(i,s,l,f,x,m),l=Bc(),i!==null&&!Dn?(s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~m,Vi(i,s,m)):(bt&&l&&bc(s),s.flags|=1,xn(i,s,f,m),s.child)}function Sh(i,s,l,f,m){if(i===null){var x=l.type;return typeof x=="function"&&!hu(x)&&x.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(s.tag=15,s.type=x,kh(i,s,x,f,m)):(i=nl(l.type,null,f,s,s.mode,m),i.ref=s.ref,i.return=s,s.child=i)}if(x=i.child,(i.lanes&m)===0){var L=x.memoizedProps;if(l=l.compare,l=l!==null?l:aa,l(L,f)&&i.ref===s.ref)return Vi(i,s,m)}return s.flags|=1,i=fr(x,f),i.ref=s.ref,i.return=s,s.child=i}function kh(i,s,l,f,m){if(i!==null){var x=i.memoizedProps;if(aa(x,f)&&i.ref===s.ref)if(Dn=!1,s.pendingProps=f=x,(i.lanes&m)!==0)(i.flags&131072)!==0&&(Dn=!0);else return s.lanes=i.lanes,Vi(i,s,m)}return Yc(i,s,l,f,m)}function _h(i,s,l){var f=s.pendingProps,m=f.children,x=i!==null?i.memoizedState:null;if(f.mode==="hidden")if((s.mode&1)===0)s.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(Ss,Hn),Hn|=l;else{if((l&1073741824)===0)return i=x!==null?x.baseLanes|l:l,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:i,cachePool:null,transitions:null},s.updateQueue=null,mt(Ss,Hn),Hn|=i,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=x!==null?x.baseLanes:l,mt(Ss,Hn),Hn|=f}else x!==null?(f=x.baseLanes|l,s.memoizedState=null):f=l,mt(Ss,Hn),Hn|=f;return xn(i,s,m,l),s.child}function Ch(i,s){var l=s.ref;(i===null&&l!==null||i!==null&&i.ref!==l)&&(s.flags|=512,s.flags|=2097152)}function Yc(i,s,l,f,m){var x=Pn(l)?Dr:fn.current;return x=fs(s,x),ys(s,m),l=Ic(i,s,l,f,x,m),f=Bc(),i!==null&&!Dn?(s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~m,Vi(i,s,m)):(bt&&f&&bc(s),s.flags|=1,xn(i,s,l,m),s.child)}function Th(i,s,l,f,m){if(Pn(l)){var x=!0;Eo(s)}else x=!1;if(ys(s,m),s.stateNode===null)Ho(i,s),hh(s,l,f),qc(s,l,f,m),f=!0;else if(i===null){var L=s.stateNode,B=s.memoizedProps;L.props=B;var $=L.context,re=l.contextType;typeof re=="object"&&re!==null?re=ei(re):(re=Pn(l)?Dr:fn.current,re=fs(s,re));var he=l.getDerivedStateFromProps,ge=typeof he=="function"||typeof L.getSnapshotBeforeUpdate=="function";ge||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(B!==f||$!==re)&&mh(s,L,f,re),sr=!1;var de=s.memoizedState;L.state=de,No(s,f,L,m),$=s.memoizedState,B!==f||de!==$||En.current||sr?(typeof he=="function"&&(jc(s,l,he,f),$=s.memoizedState),(B=sr||ph(s,l,B,f,de,$,re))?(ge||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(s.flags|=4194308)):(typeof L.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=$),L.props=f,L.state=$,L.context=re,f=B):(typeof L.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{L=s.stateNode,Wp(i,s),B=s.memoizedProps,re=s.type===s.elementType?B:gi(s.type,B),L.props=re,ge=s.pendingProps,de=L.context,$=l.contextType,typeof $=="object"&&$!==null?$=ei($):($=Pn(l)?Dr:fn.current,$=fs(s,$));var Ee=l.getDerivedStateFromProps;(he=typeof Ee=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(B!==ge||de!==$)&&mh(s,L,f,$),sr=!1,de=s.memoizedState,L.state=de,No(s,f,L,m);var Ae=s.memoizedState;B!==ge||de!==Ae||En.current||sr?(typeof Ee=="function"&&(jc(s,l,Ee,f),Ae=s.memoizedState),(re=sr||ph(s,l,re,f,de,Ae,$)||!1)?(he||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(f,Ae,$),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(f,Ae,$)),typeof L.componentDidUpdate=="function"&&(s.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof L.componentDidUpdate!="function"||B===i.memoizedProps&&de===i.memoizedState||(s.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||B===i.memoizedProps&&de===i.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=Ae),L.props=f,L.state=Ae,L.context=$,f=re):(typeof L.componentDidUpdate!="function"||B===i.memoizedProps&&de===i.memoizedState||(s.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||B===i.memoizedProps&&de===i.memoizedState||(s.flags|=1024),f=!1)}return Xc(i,s,l,f,x,m)}function Xc(i,s,l,f,m,x){Ch(i,s);var L=(s.flags&128)!==0;if(!f&&!L)return m&&Mp(s,l,!1),Vi(i,s,x);f=s.stateNode,g1.current=s;var B=L&&typeof l.getDerivedStateFromError!="function"?null:f.render();return s.flags|=1,i!==null&&L?(s.child=gs(s,i.child,null,x),s.child=gs(s,null,B,x)):xn(i,s,B,x),s.memoizedState=f.state,m&&Mp(s,l,!0),s.child}function Eh(i){var s=i.stateNode;s.pendingContext?Dp(i,s.pendingContext,s.pendingContext!==s.context):s.context&&Dp(i,s.context,!1),Mc(i,s.containerInfo)}function Ph(i,s,l,f,m){return ms(),_c(m),s.flags|=256,xn(i,s,l,f),s.child}var Gc={dehydrated:null,treeContext:null,retryLane:0};function Kc(i){return{baseLanes:i,cachePool:null,transitions:null}}function Dh(i,s,l){var f=s.pendingProps,m=Ct.current,x=!1,L=(s.flags&128)!==0,B;if((B=L)||(B=i!==null&&i.memoizedState===null?!1:(m&2)!==0),B?(x=!0,s.flags&=-129):(i===null||i.memoizedState!==null)&&(m|=1),mt(Ct,m&1),i===null)return kc(s),i=s.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((s.mode&1)===0?s.lanes=1:i.data==="$!"?s.lanes=8:s.lanes=1073741824,null):(L=f.children,i=f.fallback,x?(f=s.mode,x=s.child,L={mode:"hidden",children:L},(f&1)===0&&x!==null?(x.childLanes=0,x.pendingProps=L):x=il(L,f,0,null),i=zr(i,f,l,null),x.return=s,i.return=s,x.sibling=i,s.child=x,s.child.memoizedState=Kc(l),s.memoizedState=Gc,i):Qc(s,L));if(m=i.memoizedState,m!==null&&(B=m.dehydrated,B!==null))return v1(i,s,L,f,B,m,l);if(x){x=f.fallback,L=s.mode,m=i.child,B=m.sibling;var $={mode:"hidden",children:f.children};return(L&1)===0&&s.child!==m?(f=s.child,f.childLanes=0,f.pendingProps=$,s.deletions=null):(f=fr(m,$),f.subtreeFlags=m.subtreeFlags&14680064),B!==null?x=fr(B,x):(x=zr(x,L,l,null),x.flags|=2),x.return=s,f.return=s,f.sibling=x,s.child=f,f=x,x=s.child,L=i.child.memoizedState,L=L===null?Kc(l):{baseLanes:L.baseLanes|l,cachePool:null,transitions:L.transitions},x.memoizedState=L,x.childLanes=i.childLanes&~l,s.memoizedState=Gc,f}return x=i.child,i=x.sibling,f=fr(x,{mode:"visible",children:f.children}),(s.mode&1)===0&&(f.lanes=l),f.return=s,f.sibling=null,i!==null&&(l=s.deletions,l===null?(s.deletions=[i],s.flags|=16):l.push(i)),s.child=f,s.memoizedState=null,f}function Qc(i,s){return s=il({mode:"visible",children:s},i.mode,0,null),s.return=i,i.child=s}function qo(i,s,l,f){return f!==null&&_c(f),gs(s,i.child,null,l),i=Qc(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function v1(i,s,l,f,m,x,L){if(l)return s.flags&256?(s.flags&=-257,f=Hc(Error(r(422))),qo(i,s,L,f)):s.memoizedState!==null?(s.child=i.child,s.flags|=128,null):(x=f.fallback,m=s.mode,f=il({mode:"visible",children:f.children},m,0,null),x=zr(x,m,L,null),x.flags|=2,f.return=s,x.return=s,f.sibling=x,s.child=f,(s.mode&1)!==0&&gs(s,i.child,null,L),s.child.memoizedState=Kc(L),s.memoizedState=Gc,x);if((s.mode&1)===0)return qo(i,s,L,null);if(m.data==="$!"){if(f=m.nextSibling&&m.nextSibling.dataset,f)var B=f.dgst;return f=B,x=Error(r(419)),f=Hc(x,f,void 0),qo(i,s,L,f)}if(B=(L&i.childLanes)!==0,Dn||B){if(f=Jt,f!==null){switch(L&-L){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(f.suspendedLanes|L))!==0?0:m,m!==0&&m!==x.retryLane&&(x.retryLane=m,Bi(i,m),wi(f,i,m,-1))}return pu(),f=Hc(Error(r(421))),qo(i,s,L,f)}return m.data==="$?"?(s.flags|=128,s.child=i.child,s=L1.bind(null,i),m._reactRetry=s,null):(i=x.treeContext,qn=tr(m.nextSibling),jn=s,bt=!0,mi=null,i!==null&&(Zn[Jn++]=Ni,Zn[Jn++]=Ii,Zn[Jn++]=Lr,Ni=i.id,Ii=i.overflow,Lr=s),s=Qc(s,f.children),s.flags|=4096,s)}function Lh(i,s,l){i.lanes|=s;var f=i.alternate;f!==null&&(f.lanes|=s),Pc(i.return,s,l)}function Zc(i,s,l,f,m){var x=i.memoizedState;x===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:m}:(x.isBackwards=s,x.rendering=null,x.renderingStartTime=0,x.last=f,x.tail=l,x.tailMode=m)}function Mh(i,s,l){var f=s.pendingProps,m=f.revealOrder,x=f.tail;if(xn(i,s,f.children,l),f=Ct.current,(f&2)!==0)f=f&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Lh(i,l,s);else if(i.tag===19)Lh(i,l,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}f&=1}if(mt(Ct,f),(s.mode&1)===0)s.memoizedState=null;else switch(m){case"forwards":for(l=s.child,m=null;l!==null;)i=l.alternate,i!==null&&Io(i)===null&&(m=l),l=l.sibling;l=m,l===null?(m=s.child,s.child=null):(m=l.sibling,l.sibling=null),Zc(s,!1,m,l,x);break;case"backwards":for(l=null,m=s.child,s.child=null;m!==null;){if(i=m.alternate,i!==null&&Io(i)===null){s.child=m;break}i=m.sibling,m.sibling=l,l=m,m=i}Zc(s,!0,l,null,x);break;case"together":Zc(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ho(i,s){(s.mode&1)===0&&i!==null&&(i.alternate=null,s.alternate=null,s.flags|=2)}function Vi(i,s,l){if(i!==null&&(s.dependencies=i.dependencies),Or|=s.lanes,(l&s.childLanes)===0)return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,l=fr(i,i.pendingProps),s.child=l,l.return=s;i.sibling!==null;)i=i.sibling,l=l.sibling=fr(i,i.pendingProps),l.return=s;l.sibling=null}return s.child}function y1(i,s,l){switch(s.tag){case 3:Eh(s),ms();break;case 5:Hp(s);break;case 1:Pn(s.type)&&Eo(s);break;case 4:Mc(s,s.stateNode.containerInfo);break;case 10:var f=s.type._context,m=s.memoizedProps.value;mt(Ro,f._currentValue),f._currentValue=m;break;case 13:if(f=s.memoizedState,f!==null)return f.dehydrated!==null?(mt(Ct,Ct.current&1),s.flags|=128,null):(l&s.child.childLanes)!==0?Dh(i,s,l):(mt(Ct,Ct.current&1),i=Vi(i,s,l),i!==null?i.sibling:null);mt(Ct,Ct.current&1);break;case 19:if(f=(l&s.childLanes)!==0,(i.flags&128)!==0){if(f)return Mh(i,s,l);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),mt(Ct,Ct.current),f)break;return null;case 22:case 23:return s.lanes=0,_h(i,s,l)}return Vi(i,s,l)}var Ah,Jc,Rh,Fh;Ah=function(i,s){for(var l=s.child;l!==null;){if(l.tag===5||l.tag===6)i.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},Jc=function(){},Rh=function(i,s,l,f){var m=i.memoizedProps;if(m!==f){i=s.stateNode,Rr(_i.current);var x=null;switch(l){case"input":m=ae(i,m),f=ae(i,f),x=[];break;case"select":m=E({},m,{value:void 0}),f=E({},f,{value:void 0}),x=[];break;case"textarea":m=qe(i,m),f=qe(i,f),x=[];break;default:typeof m.onClick!="function"&&typeof f.onClick=="function"&&(i.onclick=_o)}Lt(l,f);var L;l=null;for(re in m)if(!f.hasOwnProperty(re)&&m.hasOwnProperty(re)&&m[re]!=null)if(re==="style"){var B=m[re];for(L in B)B.hasOwnProperty(L)&&(l||(l={}),l[L]="")}else re!=="dangerouslySetInnerHTML"&&re!=="children"&&re!=="suppressContentEditableWarning"&&re!=="suppressHydrationWarning"&&re!=="autoFocus"&&(o.hasOwnProperty(re)?x||(x=[]):(x=x||[]).push(re,null));for(re in f){var $=f[re];if(B=m?.[re],f.hasOwnProperty(re)&&$!==B&&($!=null||B!=null))if(re==="style")if(B){for(L in B)!B.hasOwnProperty(L)||$&&$.hasOwnProperty(L)||(l||(l={}),l[L]="");for(L in $)$.hasOwnProperty(L)&&B[L]!==$[L]&&(l||(l={}),l[L]=$[L])}else l||(x||(x=[]),x.push(re,l)),l=$;else re==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,B=B?B.__html:void 0,$!=null&&B!==$&&(x=x||[]).push(re,$)):re==="children"?typeof $!="string"&&typeof $!="number"||(x=x||[]).push(re,""+$):re!=="suppressContentEditableWarning"&&re!=="suppressHydrationWarning"&&(o.hasOwnProperty(re)?($!=null&&re==="onScroll"&&yt("scroll",i),x||B===$||(x=[])):(x=x||[]).push(re,$))}l&&(x=x||[]).push("style",l);var re=x;(s.updateQueue=re)&&(s.flags|=4)}},Fh=function(i,s,l,f){l!==f&&(s.flags|=4)};function xa(i,s){if(!bt)switch(i.tailMode){case"hidden":s=i.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function hn(i){var s=i.alternate!==null&&i.alternate.child===i.child,l=0,f=0;if(s)for(var m=i.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags&14680064,f|=m.flags&14680064,m.return=i,m=m.sibling;else for(m=i.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=i,m=m.sibling;return i.subtreeFlags|=f,i.childLanes=l,s}function w1(i,s,l){var f=s.pendingProps;switch(xc(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(s),null;case 1:return Pn(s.type)&&To(),hn(s),null;case 3:return f=s.stateNode,ws(),wt(En),wt(fn),Fc(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(Mo(s)?s.flags|=4:i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,mi!==null&&(uu(mi),mi=null))),Jc(i,s),hn(s),null;case 5:Ac(s);var m=Rr(ga.current);if(l=s.type,i!==null&&s.stateNode!=null)Rh(i,s,l,f,m),i.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!f){if(s.stateNode===null)throw Error(r(166));return hn(s),null}if(i=Rr(_i.current),Mo(s)){f=s.stateNode,l=s.type;var x=s.memoizedProps;switch(f[ki]=s,f[da]=x,i=(s.mode&1)!==0,l){case"dialog":yt("cancel",f),yt("close",f);break;case"iframe":case"object":case"embed":yt("load",f);break;case"video":case"audio":for(m=0;m<la.length;m++)yt(la[m],f);break;case"source":yt("error",f);break;case"img":case"image":case"link":yt("error",f),yt("load",f);break;case"details":yt("toggle",f);break;case"input":le(f,x),yt("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!x.multiple},yt("invalid",f);break;case"textarea":tt(f,x),yt("invalid",f)}Lt(l,x),m=null;for(var L in x)if(x.hasOwnProperty(L)){var B=x[L];L==="children"?typeof B=="string"?f.textContent!==B&&(x.suppressHydrationWarning!==!0&&ko(f.textContent,B,i),m=["children",B]):typeof B=="number"&&f.textContent!==""+B&&(x.suppressHydrationWarning!==!0&&ko(f.textContent,B,i),m=["children",""+B]):o.hasOwnProperty(L)&&B!=null&&L==="onScroll"&&yt("scroll",f)}switch(l){case"input":j(f),oe(f,x,!0);break;case"textarea":j(f),at(f);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(f.onclick=_o)}f=m,s.updateQueue=f,f!==null&&(s.flags|=4)}else{L=m.nodeType===9?m:m.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Ye(l)),i==="http://www.w3.org/1999/xhtml"?l==="script"?(i=L.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof f.is=="string"?i=L.createElement(l,{is:f.is}):(i=L.createElement(l),l==="select"&&(L=i,f.multiple?L.multiple=!0:f.size&&(L.size=f.size))):i=L.createElementNS(i,l),i[ki]=s,i[da]=f,Ah(i,s,!1,!1),s.stateNode=i;e:{switch(L=Qe(l,f),l){case"dialog":yt("cancel",i),yt("close",i),m=f;break;case"iframe":case"object":case"embed":yt("load",i),m=f;break;case"video":case"audio":for(m=0;m<la.length;m++)yt(la[m],i);m=f;break;case"source":yt("error",i),m=f;break;case"img":case"image":case"link":yt("error",i),yt("load",i),m=f;break;case"details":yt("toggle",i),m=f;break;case"input":le(i,f),m=ae(i,f),yt("invalid",i);break;case"option":m=f;break;case"select":i._wrapperState={wasMultiple:!!f.multiple},m=E({},f,{value:void 0}),yt("invalid",i);break;case"textarea":tt(i,f),m=qe(i,f),yt("invalid",i);break;default:m=f}Lt(l,m),B=m;for(x in B)if(B.hasOwnProperty(x)){var $=B[x];x==="style"?gt(i,$):x==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&zt(i,$)):x==="children"?typeof $=="string"?(l!=="textarea"||$!=="")&&De(i,$):typeof $=="number"&&De(i,""+$):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(o.hasOwnProperty(x)?$!=null&&x==="onScroll"&&yt("scroll",i):$!=null&&A(i,x,$,L))}switch(l){case"input":j(i),oe(i,f,!1);break;case"textarea":j(i),at(i);break;case"option":f.value!=null&&i.setAttribute("value",""+V(f.value));break;case"select":i.multiple=!!f.multiple,x=f.value,x!=null?We(i,!!f.multiple,x,!1):f.defaultValue!=null&&We(i,!!f.multiple,f.defaultValue,!0);break;default:typeof m.onClick=="function"&&(i.onclick=_o)}switch(l){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return hn(s),null;case 6:if(i&&s.stateNode!=null)Fh(i,s,i.memoizedProps,f);else{if(typeof f!="string"&&s.stateNode===null)throw Error(r(166));if(l=Rr(ga.current),Rr(_i.current),Mo(s)){if(f=s.stateNode,l=s.memoizedProps,f[ki]=s,(x=f.nodeValue!==l)&&(i=jn,i!==null))switch(i.tag){case 3:ko(f.nodeValue,l,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&ko(f.nodeValue,l,(i.mode&1)!==0)}x&&(s.flags|=4)}else f=(l.nodeType===9?l:l.ownerDocument).createTextNode(f),f[ki]=s,s.stateNode=f}return hn(s),null;case 13:if(wt(Ct),f=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(bt&&qn!==null&&(s.mode&1)!==0&&(s.flags&128)===0)Ip(),ms(),s.flags|=98560,x=!1;else if(x=Mo(s),f!==null&&f.dehydrated!==null){if(i===null){if(!x)throw Error(r(318));if(x=s.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[ki]=s}else ms(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;hn(s),x=!1}else mi!==null&&(uu(mi),mi=null),x=!0;if(!x)return s.flags&65536?s:null}return(s.flags&128)!==0?(s.lanes=l,s):(f=f!==null,f!==(i!==null&&i.memoizedState!==null)&&f&&(s.child.flags|=8192,(s.mode&1)!==0&&(i===null||(Ct.current&1)!==0?Xt===0&&(Xt=3):pu())),s.updateQueue!==null&&(s.flags|=4),hn(s),null);case 4:return ws(),Jc(i,s),i===null&&ca(s.stateNode.containerInfo),hn(s),null;case 10:return Ec(s.type._context),hn(s),null;case 17:return Pn(s.type)&&To(),hn(s),null;case 19:if(wt(Ct),x=s.memoizedState,x===null)return hn(s),null;if(f=(s.flags&128)!==0,L=x.rendering,L===null)if(f)xa(x,!1);else{if(Xt!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(L=Io(i),L!==null){for(s.flags|=128,xa(x,!1),f=L.updateQueue,f!==null&&(s.updateQueue=f,s.flags|=4),s.subtreeFlags=0,f=l,l=s.child;l!==null;)x=l,i=f,x.flags&=14680066,L=x.alternate,L===null?(x.childLanes=0,x.lanes=i,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=L.childLanes,x.lanes=L.lanes,x.child=L.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=L.memoizedProps,x.memoizedState=L.memoizedState,x.updateQueue=L.updateQueue,x.type=L.type,i=L.dependencies,x.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),l=l.sibling;return mt(Ct,Ct.current&1|2),s.child}i=i.sibling}x.tail!==null&&Se()>ks&&(s.flags|=128,f=!0,xa(x,!1),s.lanes=4194304)}else{if(!f)if(i=Io(L),i!==null){if(s.flags|=128,f=!0,l=i.updateQueue,l!==null&&(s.updateQueue=l,s.flags|=4),xa(x,!0),x.tail===null&&x.tailMode==="hidden"&&!L.alternate&&!bt)return hn(s),null}else 2*Se()-x.renderingStartTime>ks&&l!==1073741824&&(s.flags|=128,f=!0,xa(x,!1),s.lanes=4194304);x.isBackwards?(L.sibling=s.child,s.child=L):(l=x.last,l!==null?l.sibling=L:s.child=L,x.last=L)}return x.tail!==null?(s=x.tail,x.rendering=s,x.tail=s.sibling,x.renderingStartTime=Se(),s.sibling=null,l=Ct.current,mt(Ct,f?l&1|2:l&1),s):(hn(s),null);case 22:case 23:return fu(),f=s.memoizedState!==null,i!==null&&i.memoizedState!==null!==f&&(s.flags|=8192),f&&(s.mode&1)!==0?(Hn&1073741824)!==0&&(hn(s),s.subtreeFlags&6&&(s.flags|=8192)):hn(s),null;case 24:return null;case 25:return null}throw Error(r(156,s.tag))}function b1(i,s){switch(xc(s),s.tag){case 1:return Pn(s.type)&&To(),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return ws(),wt(En),wt(fn),Fc(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 5:return Ac(s),null;case 13:if(wt(Ct),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));ms()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return wt(Ct),null;case 4:return ws(),null;case 10:return Ec(s.type._context),null;case 22:case 23:return fu(),null;case 24:return null;default:return null}}var $o=!1,mn=!1,x1=typeof WeakSet=="function"?WeakSet:Set,Le=null;function xs(i,s){var l=i.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(f){Mt(i,s,f)}else l.current=null}function eu(i,s,l){try{l()}catch(f){Mt(i,s,f)}}var Oh=!1;function S1(i,s){if(fc=fo,i=pp(),rc(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var m=f.anchorOffset,x=f.focusNode;f=f.focusOffset;try{l.nodeType,x.nodeType}catch{l=null;break e}var L=0,B=-1,$=-1,re=0,he=0,ge=i,de=null;t:for(;;){for(var Ee;ge!==l||m!==0&&ge.nodeType!==3||(B=L+m),ge!==x||f!==0&&ge.nodeType!==3||($=L+f),ge.nodeType===3&&(L+=ge.nodeValue.length),(Ee=ge.firstChild)!==null;)de=ge,ge=Ee;for(;;){if(ge===i)break t;if(de===l&&++re===m&&(B=L),de===x&&++he===f&&($=L),(Ee=ge.nextSibling)!==null)break;ge=de,de=ge.parentNode}ge=Ee}l=B===-1||$===-1?null:{start:B,end:$}}else l=null}l=l||{start:0,end:0}}else l=null;for(pc={focusedElem:i,selectionRange:l},fo=!1,Le=s;Le!==null;)if(s=Le,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,Le=i;else for(;Le!==null;){s=Le;try{var Ae=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if(Ae!==null){var Fe=Ae.memoizedProps,It=Ae.memoizedState,J=s.stateNode,K=J.getSnapshotBeforeUpdate(s.elementType===s.type?Fe:gi(s.type,Fe),It);J.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var te=s.stateNode.containerInfo;te.nodeType===1?te.textContent="":te.nodeType===9&&te.documentElement&&te.removeChild(te.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(ye){Mt(s,s.return,ye)}if(i=s.sibling,i!==null){i.return=s.return,Le=i;break}Le=s.return}return Ae=Oh,Oh=!1,Ae}function Sa(i,s,l){var f=s.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var m=f=f.next;do{if((m.tag&i)===i){var x=m.destroy;m.destroy=void 0,x!==void 0&&eu(s,l,x)}m=m.next}while(m!==f)}}function Yo(i,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&i)===i){var f=l.create;l.destroy=f()}l=l.next}while(l!==s)}}function tu(i){var s=i.ref;if(s!==null){var l=i.stateNode;i.tag,i=l,typeof s=="function"?s(i):s.current=i}}function Nh(i){var s=i.alternate;s!==null&&(i.alternate=null,Nh(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&(delete s[ki],delete s[da],delete s[vc],delete s[r1],delete s[s1])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Ih(i){return i.tag===5||i.tag===3||i.tag===4}function Bh(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Ih(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function nu(i,s,l){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?l.nodeType===8?l.parentNode.insertBefore(i,s):l.insertBefore(i,s):(l.nodeType===8?(s=l.parentNode,s.insertBefore(i,l)):(s=l,s.appendChild(i)),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=_o));else if(f!==4&&(i=i.child,i!==null))for(nu(i,s,l),i=i.sibling;i!==null;)nu(i,s,l),i=i.sibling}function iu(i,s,l){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?l.insertBefore(i,s):l.appendChild(i);else if(f!==4&&(i=i.child,i!==null))for(iu(i,s,l),i=i.sibling;i!==null;)iu(i,s,l),i=i.sibling}var an=null,vi=!1;function or(i,s,l){for(l=l.child;l!==null;)zh(i,s,l),l=l.sibling}function zh(i,s,l){if(vt&&typeof vt.onCommitFiberUnmount=="function")try{vt.onCommitFiberUnmount(je,l)}catch{}switch(l.tag){case 5:mn||xs(l,s);case 6:var f=an,m=vi;an=null,or(i,s,l),an=f,vi=m,an!==null&&(vi?(i=an,l=l.stateNode,i.nodeType===8?i.parentNode.removeChild(l):i.removeChild(l)):an.removeChild(l.stateNode));break;case 18:an!==null&&(vi?(i=an,l=l.stateNode,i.nodeType===8?gc(i.parentNode,l):i.nodeType===1&&gc(i,l),ea(i)):gc(an,l.stateNode));break;case 4:f=an,m=vi,an=l.stateNode.containerInfo,vi=!0,or(i,s,l),an=f,vi=m;break;case 0:case 11:case 14:case 15:if(!mn&&(f=l.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){m=f=f.next;do{var x=m,L=x.destroy;x=x.tag,L!==void 0&&((x&2)!==0||(x&4)!==0)&&eu(l,s,L),m=m.next}while(m!==f)}or(i,s,l);break;case 1:if(!mn&&(xs(l,s),f=l.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=l.memoizedProps,f.state=l.memoizedState,f.componentWillUnmount()}catch(B){Mt(l,s,B)}or(i,s,l);break;case 21:or(i,s,l);break;case 22:l.mode&1?(mn=(f=mn)||l.memoizedState!==null,or(i,s,l),mn=f):or(i,s,l);break;default:or(i,s,l)}}function Vh(i){var s=i.updateQueue;if(s!==null){i.updateQueue=null;var l=i.stateNode;l===null&&(l=i.stateNode=new x1),s.forEach(function(f){var m=M1.bind(null,i,f);l.has(f)||(l.add(f),f.then(m,m))})}}function yi(i,s){var l=s.deletions;if(l!==null)for(var f=0;f<l.length;f++){var m=l[f];try{var x=i,L=s,B=L;e:for(;B!==null;){switch(B.tag){case 5:an=B.stateNode,vi=!1;break e;case 3:an=B.stateNode.containerInfo,vi=!0;break e;case 4:an=B.stateNode.containerInfo,vi=!0;break e}B=B.return}if(an===null)throw Error(r(160));zh(x,L,m),an=null,vi=!1;var $=m.alternate;$!==null&&($.return=null),m.return=null}catch(re){Mt(m,s,re)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)Uh(s,i),s=s.sibling}function Uh(i,s){var l=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(yi(s,i),Ti(i),f&4){try{Sa(3,i,i.return),Yo(3,i)}catch(Fe){Mt(i,i.return,Fe)}try{Sa(5,i,i.return)}catch(Fe){Mt(i,i.return,Fe)}}break;case 1:yi(s,i),Ti(i),f&512&&l!==null&&xs(l,l.return);break;case 5:if(yi(s,i),Ti(i),f&512&&l!==null&&xs(l,l.return),i.flags&32){var m=i.stateNode;try{De(m,"")}catch(Fe){Mt(i,i.return,Fe)}}if(f&4&&(m=i.stateNode,m!=null)){var x=i.memoizedProps,L=l!==null?l.memoizedProps:x,B=i.type,$=i.updateQueue;if(i.updateQueue=null,$!==null)try{B==="input"&&x.type==="radio"&&x.name!=null&&pe(m,x),Qe(B,L);var re=Qe(B,x);for(L=0;L<$.length;L+=2){var he=$[L],ge=$[L+1];he==="style"?gt(m,ge):he==="dangerouslySetInnerHTML"?zt(m,ge):he==="children"?De(m,ge):A(m,he,ge,re)}switch(B){case"input":_e(m,x);break;case"textarea":Ke(m,x);break;case"select":var de=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!x.multiple;var Ee=x.value;Ee!=null?We(m,!!x.multiple,Ee,!1):de!==!!x.multiple&&(x.defaultValue!=null?We(m,!!x.multiple,x.defaultValue,!0):We(m,!!x.multiple,x.multiple?[]:"",!1))}m[da]=x}catch(Fe){Mt(i,i.return,Fe)}}break;case 6:if(yi(s,i),Ti(i),f&4){if(i.stateNode===null)throw Error(r(162));m=i.stateNode,x=i.memoizedProps;try{m.nodeValue=x}catch(Fe){Mt(i,i.return,Fe)}}break;case 3:if(yi(s,i),Ti(i),f&4&&l!==null&&l.memoizedState.isDehydrated)try{ea(s.containerInfo)}catch(Fe){Mt(i,i.return,Fe)}break;case 4:yi(s,i),Ti(i);break;case 13:yi(s,i),Ti(i),m=i.child,m.flags&8192&&(x=m.memoizedState!==null,m.stateNode.isHidden=x,!x||m.alternate!==null&&m.alternate.memoizedState!==null||(au=Se())),f&4&&Vh(i);break;case 22:if(he=l!==null&&l.memoizedState!==null,i.mode&1?(mn=(re=mn)||he,yi(s,i),mn=re):yi(s,i),Ti(i),f&8192){if(re=i.memoizedState!==null,(i.stateNode.isHidden=re)&&!he&&(i.mode&1)!==0)for(Le=i,he=i.child;he!==null;){for(ge=Le=he;Le!==null;){switch(de=Le,Ee=de.child,de.tag){case 0:case 11:case 14:case 15:Sa(4,de,de.return);break;case 1:xs(de,de.return);var Ae=de.stateNode;if(typeof Ae.componentWillUnmount=="function"){f=de,l=de.return;try{s=f,Ae.props=s.memoizedProps,Ae.state=s.memoizedState,Ae.componentWillUnmount()}catch(Fe){Mt(f,l,Fe)}}break;case 5:xs(de,de.return);break;case 22:if(de.memoizedState!==null){qh(ge);continue}}Ee!==null?(Ee.return=de,Le=Ee):qh(ge)}he=he.sibling}e:for(he=null,ge=i;;){if(ge.tag===5){if(he===null){he=ge;try{m=ge.stateNode,re?(x=m.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(B=ge.stateNode,$=ge.memoizedProps.style,L=$!=null&&$.hasOwnProperty("display")?$.display:null,B.style.display=He("display",L))}catch(Fe){Mt(i,i.return,Fe)}}}else if(ge.tag===6){if(he===null)try{ge.stateNode.nodeValue=re?"":ge.memoizedProps}catch(Fe){Mt(i,i.return,Fe)}}else if((ge.tag!==22&&ge.tag!==23||ge.memoizedState===null||ge===i)&&ge.child!==null){ge.child.return=ge,ge=ge.child;continue}if(ge===i)break e;for(;ge.sibling===null;){if(ge.return===null||ge.return===i)break e;he===ge&&(he=null),ge=ge.return}he===ge&&(he=null),ge.sibling.return=ge.return,ge=ge.sibling}}break;case 19:yi(s,i),Ti(i),f&4&&Vh(i);break;case 21:break;default:yi(s,i),Ti(i)}}function Ti(i){var s=i.flags;if(s&2){try{e:{for(var l=i.return;l!==null;){if(Ih(l)){var f=l;break e}l=l.return}throw Error(r(160))}switch(f.tag){case 5:var m=f.stateNode;f.flags&32&&(De(m,""),f.flags&=-33);var x=Bh(i);iu(i,x,m);break;case 3:case 4:var L=f.stateNode.containerInfo,B=Bh(i);nu(i,B,L);break;default:throw Error(r(161))}}catch($){Mt(i,i.return,$)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function k1(i,s,l){Le=i,Wh(i)}function Wh(i,s,l){for(var f=(i.mode&1)!==0;Le!==null;){var m=Le,x=m.child;if(m.tag===22&&f){var L=m.memoizedState!==null||$o;if(!L){var B=m.alternate,$=B!==null&&B.memoizedState!==null||mn;B=$o;var re=mn;if($o=L,(mn=$)&&!re)for(Le=m;Le!==null;)L=Le,$=L.child,L.tag===22&&L.memoizedState!==null?Hh(m):$!==null?($.return=L,Le=$):Hh(m);for(;x!==null;)Le=x,Wh(x),x=x.sibling;Le=m,$o=B,mn=re}jh(i)}else(m.subtreeFlags&8772)!==0&&x!==null?(x.return=m,Le=x):jh(i)}}function jh(i){for(;Le!==null;){var s=Le;if((s.flags&8772)!==0){var l=s.alternate;try{if((s.flags&8772)!==0)switch(s.tag){case 0:case 11:case 15:mn||Yo(5,s);break;case 1:var f=s.stateNode;if(s.flags&4&&!mn)if(l===null)f.componentDidMount();else{var m=s.elementType===s.type?l.memoizedProps:gi(s.type,l.memoizedProps);f.componentDidUpdate(m,l.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var x=s.updateQueue;x!==null&&qp(s,x,f);break;case 3:var L=s.updateQueue;if(L!==null){if(l=null,s.child!==null)switch(s.child.tag){case 5:l=s.child.stateNode;break;case 1:l=s.child.stateNode}qp(s,L,l)}break;case 5:var B=s.stateNode;if(l===null&&s.flags&4){l=B;var $=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&l.focus();break;case"img":$.src&&(l.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var re=s.alternate;if(re!==null){var he=re.memoizedState;if(he!==null){var ge=he.dehydrated;ge!==null&&ea(ge)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}mn||s.flags&512&&tu(s)}catch(de){Mt(s,s.return,de)}}if(s===i){Le=null;break}if(l=s.sibling,l!==null){l.return=s.return,Le=l;break}Le=s.return}}function qh(i){for(;Le!==null;){var s=Le;if(s===i){Le=null;break}var l=s.sibling;if(l!==null){l.return=s.return,Le=l;break}Le=s.return}}function Hh(i){for(;Le!==null;){var s=Le;try{switch(s.tag){case 0:case 11:case 15:var l=s.return;try{Yo(4,s)}catch($){Mt(s,l,$)}break;case 1:var f=s.stateNode;if(typeof f.componentDidMount=="function"){var m=s.return;try{f.componentDidMount()}catch($){Mt(s,m,$)}}var x=s.return;try{tu(s)}catch($){Mt(s,x,$)}break;case 5:var L=s.return;try{tu(s)}catch($){Mt(s,L,$)}}}catch($){Mt(s,s.return,$)}if(s===i){Le=null;break}var B=s.sibling;if(B!==null){B.return=s.return,Le=B;break}Le=s.return}}var _1=Math.ceil,Xo=W.ReactCurrentDispatcher,ru=W.ReactCurrentOwner,ni=W.ReactCurrentBatchConfig,et=0,Jt=null,Vt=null,on=0,Hn=0,Ss=nr(0),Xt=0,ka=null,Or=0,Go=0,su=0,_a=null,Ln=null,au=0,ks=1/0,Ui=null,Ko=!1,ou=null,lr=null,Qo=!1,cr=null,Zo=0,Ca=0,lu=null,Jo=-1,el=0;function Sn(){return(et&6)!==0?Se():Jo!==-1?Jo:Jo=Se()}function ur(i){return(i.mode&1)===0?1:(et&2)!==0&&on!==0?on&-on:o1.transition!==null?(el===0&&(el=Bf()),el):(i=lt,i!==0||(i=window.event,i=i===void 0?16:Yf(i.type)),i)}function wi(i,s,l,f){if(50<Ca)throw Ca=0,lu=null,Error(r(185));Gs(i,l,f),((et&2)===0||i!==Jt)&&(i===Jt&&((et&2)===0&&(Go|=l),Xt===4&&dr(i,on)),Mn(i,f),l===1&&et===0&&(s.mode&1)===0&&(ks=Se()+500,Po&&rr()))}function Mn(i,s){var l=i.callbackNode;ow(i,s);var f=lo(i,i===Jt?on:0);if(f===0)l!==null&&Re(l),i.callbackNode=null,i.callbackPriority=0;else if(s=f&-f,i.callbackPriority!==s){if(l!=null&&Re(l),s===1)i.tag===0?a1(Yh.bind(null,i)):Ap(Yh.bind(null,i)),n1(function(){(et&6)===0&&rr()}),l=null;else{switch(zf(f)){case 1:l=Ge;break;case 4:l=rt;break;case 16:l=dn;break;case 536870912:l=Tr;break;default:l=dn}l=tm(l,$h.bind(null,i))}i.callbackPriority=s,i.callbackNode=l}}function $h(i,s){if(Jo=-1,el=0,(et&6)!==0)throw Error(r(327));var l=i.callbackNode;if(_s()&&i.callbackNode!==l)return null;var f=lo(i,i===Jt?on:0);if(f===0)return null;if((f&30)!==0||(f&i.expiredLanes)!==0||s)s=tl(i,f);else{s=f;var m=et;et|=2;var x=Gh();(Jt!==i||on!==s)&&(Ui=null,ks=Se()+500,Ir(i,s));do try{E1();break}catch(B){Xh(i,B)}while(!0);Tc(),Xo.current=x,et=m,Vt!==null?s=0:(Jt=null,on=0,s=Xt)}if(s!==0){if(s===2&&(m=Wl(i),m!==0&&(f=m,s=cu(i,m))),s===1)throw l=ka,Ir(i,0),dr(i,f),Mn(i,Se()),l;if(s===6)dr(i,f);else{if(m=i.current.alternate,(f&30)===0&&!C1(m)&&(s=tl(i,f),s===2&&(x=Wl(i),x!==0&&(f=x,s=cu(i,x))),s===1))throw l=ka,Ir(i,0),dr(i,f),Mn(i,Se()),l;switch(i.finishedWork=m,i.finishedLanes=f,s){case 0:case 1:throw Error(r(345));case 2:Br(i,Ln,Ui);break;case 3:if(dr(i,f),(f&130023424)===f&&(s=au+500-Se(),10<s)){if(lo(i,0)!==0)break;if(m=i.suspendedLanes,(m&f)!==f){Sn(),i.pingedLanes|=i.suspendedLanes&m;break}i.timeoutHandle=mc(Br.bind(null,i,Ln,Ui),s);break}Br(i,Ln,Ui);break;case 4:if(dr(i,f),(f&4194240)===f)break;for(s=i.eventTimes,m=-1;0<f;){var L=31-Un(f);x=1<<L,L=s[L],L>m&&(m=L),f&=~x}if(f=m,f=Se()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*_1(f/1960))-f,10<f){i.timeoutHandle=mc(Br.bind(null,i,Ln,Ui),f);break}Br(i,Ln,Ui);break;case 5:Br(i,Ln,Ui);break;default:throw Error(r(329))}}}return Mn(i,Se()),i.callbackNode===l?$h.bind(null,i):null}function cu(i,s){var l=_a;return i.current.memoizedState.isDehydrated&&(Ir(i,s).flags|=256),i=tl(i,s),i!==2&&(s=Ln,Ln=l,s!==null&&uu(s)),i}function uu(i){Ln===null?Ln=i:Ln.push.apply(Ln,i)}function C1(i){for(var s=i;;){if(s.flags&16384){var l=s.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var f=0;f<l.length;f++){var m=l[f],x=m.getSnapshot;m=m.value;try{if(!hi(x(),m))return!1}catch{return!1}}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function dr(i,s){for(s&=~su,s&=~Go,i.suspendedLanes|=s,i.pingedLanes&=~s,i=i.expirationTimes;0<s;){var l=31-Un(s),f=1<<l;i[l]=-1,s&=~f}}function Yh(i){if((et&6)!==0)throw Error(r(327));_s();var s=lo(i,0);if((s&1)===0)return Mn(i,Se()),null;var l=tl(i,s);if(i.tag!==0&&l===2){var f=Wl(i);f!==0&&(s=f,l=cu(i,f))}if(l===1)throw l=ka,Ir(i,0),dr(i,s),Mn(i,Se()),l;if(l===6)throw Error(r(345));return i.finishedWork=i.current.alternate,i.finishedLanes=s,Br(i,Ln,Ui),Mn(i,Se()),null}function du(i,s){var l=et;et|=1;try{return i(s)}finally{et=l,et===0&&(ks=Se()+500,Po&&rr())}}function Nr(i){cr!==null&&cr.tag===0&&(et&6)===0&&_s();var s=et;et|=1;var l=ni.transition,f=lt;try{if(ni.transition=null,lt=1,i)return i()}finally{lt=f,ni.transition=l,et=s,(et&6)===0&&rr()}}function fu(){Hn=Ss.current,wt(Ss)}function Ir(i,s){i.finishedWork=null,i.finishedLanes=0;var l=i.timeoutHandle;if(l!==-1&&(i.timeoutHandle=-1,t1(l)),Vt!==null)for(l=Vt.return;l!==null;){var f=l;switch(xc(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&To();break;case 3:ws(),wt(En),wt(fn),Fc();break;case 5:Ac(f);break;case 4:ws();break;case 13:wt(Ct);break;case 19:wt(Ct);break;case 10:Ec(f.type._context);break;case 22:case 23:fu()}l=l.return}if(Jt=i,Vt=i=fr(i.current,null),on=Hn=s,Xt=0,ka=null,su=Go=Or=0,Ln=_a=null,Ar!==null){for(s=0;s<Ar.length;s++)if(l=Ar[s],f=l.interleaved,f!==null){l.interleaved=null;var m=f.next,x=l.pending;if(x!==null){var L=x.next;x.next=m,f.next=L}l.pending=f}Ar=null}return i}function Xh(i,s){do{var l=Vt;try{if(Tc(),Bo.current=Wo,zo){for(var f=Tt.memoizedState;f!==null;){var m=f.queue;m!==null&&(m.pending=null),f=f.next}zo=!1}if(Fr=0,Zt=Yt=Tt=null,va=!1,ya=0,ru.current=null,l===null||l.return===null){Xt=1,ka=s,Vt=null;break}e:{var x=i,L=l.return,B=l,$=s;if(s=on,B.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var re=$,he=B,ge=he.tag;if((he.mode&1)===0&&(ge===0||ge===11||ge===15)){var de=he.alternate;de?(he.updateQueue=de.updateQueue,he.memoizedState=de.memoizedState,he.lanes=de.lanes):(he.updateQueue=null,he.memoizedState=null)}var Ee=wh(L);if(Ee!==null){Ee.flags&=-257,bh(Ee,L,B,x,s),Ee.mode&1&&yh(x,re,s),s=Ee,$=re;var Ae=s.updateQueue;if(Ae===null){var Fe=new Set;Fe.add($),s.updateQueue=Fe}else Ae.add($);break e}else{if((s&1)===0){yh(x,re,s),pu();break e}$=Error(r(426))}}else if(bt&&B.mode&1){var It=wh(L);if(It!==null){(It.flags&65536)===0&&(It.flags|=256),bh(It,L,B,x,s),_c(bs($,B));break e}}x=$=bs($,B),Xt!==4&&(Xt=2),_a===null?_a=[x]:_a.push(x),x=L;do{switch(x.tag){case 3:x.flags|=65536,s&=-s,x.lanes|=s;var J=gh(x,$,s);jp(x,J);break e;case 1:B=$;var K=x.type,te=x.stateNode;if((x.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||te!==null&&typeof te.componentDidCatch=="function"&&(lr===null||!lr.has(te)))){x.flags|=65536,s&=-s,x.lanes|=s;var ye=vh(x,B,s);jp(x,ye);break e}}x=x.return}while(x!==null)}Qh(l)}catch(Ne){s=Ne,Vt===l&&l!==null&&(Vt=l=l.return);continue}break}while(!0)}function Gh(){var i=Xo.current;return Xo.current=Wo,i===null?Wo:i}function pu(){(Xt===0||Xt===3||Xt===2)&&(Xt=4),Jt===null||(Or&268435455)===0&&(Go&268435455)===0||dr(Jt,on)}function tl(i,s){var l=et;et|=2;var f=Gh();(Jt!==i||on!==s)&&(Ui=null,Ir(i,s));do try{T1();break}catch(m){Xh(i,m)}while(!0);if(Tc(),et=l,Xo.current=f,Vt!==null)throw Error(r(261));return Jt=null,on=0,Xt}function T1(){for(;Vt!==null;)Kh(Vt)}function E1(){for(;Vt!==null&&!Te();)Kh(Vt)}function Kh(i){var s=em(i.alternate,i,Hn);i.memoizedProps=i.pendingProps,s===null?Qh(i):Vt=s,ru.current=null}function Qh(i){var s=i;do{var l=s.alternate;if(i=s.return,(s.flags&32768)===0){if(l=w1(l,s,Hn),l!==null){Vt=l;return}}else{if(l=b1(l,s),l!==null){l.flags&=32767,Vt=l;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Xt=6,Vt=null;return}}if(s=s.sibling,s!==null){Vt=s;return}Vt=s=i}while(s!==null);Xt===0&&(Xt=5)}function Br(i,s,l){var f=lt,m=ni.transition;try{ni.transition=null,lt=1,P1(i,s,l,f)}finally{ni.transition=m,lt=f}return null}function P1(i,s,l,f){do _s();while(cr!==null);if((et&6)!==0)throw Error(r(327));l=i.finishedWork;var m=i.finishedLanes;if(l===null)return null;if(i.finishedWork=null,i.finishedLanes=0,l===i.current)throw Error(r(177));i.callbackNode=null,i.callbackPriority=0;var x=l.lanes|l.childLanes;if(lw(i,x),i===Jt&&(Vt=Jt=null,on=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||Qo||(Qo=!0,tm(dn,function(){return _s(),null})),x=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||x){x=ni.transition,ni.transition=null;var L=lt;lt=1;var B=et;et|=4,ru.current=null,S1(i,l),Uh(l,i),Xw(pc),fo=!!fc,pc=fc=null,i.current=l,k1(l),Me(),et=B,lt=L,ni.transition=x}else i.current=l;if(Qo&&(Qo=!1,cr=i,Zo=m),x=i.pendingLanes,x===0&&(lr=null),Er(l.stateNode),Mn(i,Se()),s!==null)for(f=i.onRecoverableError,l=0;l<s.length;l++)m=s[l],f(m.value,{componentStack:m.stack,digest:m.digest});if(Ko)throw Ko=!1,i=ou,ou=null,i;return(Zo&1)!==0&&i.tag!==0&&_s(),x=i.pendingLanes,(x&1)!==0?i===lu?Ca++:(Ca=0,lu=i):Ca=0,rr(),null}function _s(){if(cr!==null){var i=zf(Zo),s=ni.transition,l=lt;try{if(ni.transition=null,lt=16>i?16:i,cr===null)var f=!1;else{if(i=cr,cr=null,Zo=0,(et&6)!==0)throw Error(r(331));var m=et;for(et|=4,Le=i.current;Le!==null;){var x=Le,L=x.child;if((Le.flags&16)!==0){var B=x.deletions;if(B!==null){for(var $=0;$<B.length;$++){var re=B[$];for(Le=re;Le!==null;){var he=Le;switch(he.tag){case 0:case 11:case 15:Sa(8,he,x)}var ge=he.child;if(ge!==null)ge.return=he,Le=ge;else for(;Le!==null;){he=Le;var de=he.sibling,Ee=he.return;if(Nh(he),he===re){Le=null;break}if(de!==null){de.return=Ee,Le=de;break}Le=Ee}}}var Ae=x.alternate;if(Ae!==null){var Fe=Ae.child;if(Fe!==null){Ae.child=null;do{var It=Fe.sibling;Fe.sibling=null,Fe=It}while(Fe!==null)}}Le=x}}if((x.subtreeFlags&2064)!==0&&L!==null)L.return=x,Le=L;else e:for(;Le!==null;){if(x=Le,(x.flags&2048)!==0)switch(x.tag){case 0:case 11:case 15:Sa(9,x,x.return)}var J=x.sibling;if(J!==null){J.return=x.return,Le=J;break e}Le=x.return}}var K=i.current;for(Le=K;Le!==null;){L=Le;var te=L.child;if((L.subtreeFlags&2064)!==0&&te!==null)te.return=L,Le=te;else e:for(L=K;Le!==null;){if(B=Le,(B.flags&2048)!==0)try{switch(B.tag){case 0:case 11:case 15:Yo(9,B)}}catch(Ne){Mt(B,B.return,Ne)}if(B===L){Le=null;break e}var ye=B.sibling;if(ye!==null){ye.return=B.return,Le=ye;break e}Le=B.return}}if(et=m,rr(),vt&&typeof vt.onPostCommitFiberRoot=="function")try{vt.onPostCommitFiberRoot(je,i)}catch{}f=!0}return f}finally{lt=l,ni.transition=s}}return!1}function Zh(i,s,l){s=bs(l,s),s=gh(i,s,1),i=ar(i,s,1),s=Sn(),i!==null&&(Gs(i,1,s),Mn(i,s))}function Mt(i,s,l){if(i.tag===3)Zh(i,i,l);else for(;s!==null;){if(s.tag===3){Zh(s,i,l);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(lr===null||!lr.has(f))){i=bs(l,i),i=vh(s,i,1),s=ar(s,i,1),i=Sn(),s!==null&&(Gs(s,1,i),Mn(s,i));break}}s=s.return}}function D1(i,s,l){var f=i.pingCache;f!==null&&f.delete(s),s=Sn(),i.pingedLanes|=i.suspendedLanes&l,Jt===i&&(on&l)===l&&(Xt===4||Xt===3&&(on&130023424)===on&&500>Se()-au?Ir(i,0):su|=l),Mn(i,s)}function Jh(i,s){s===0&&((i.mode&1)===0?s=1:(s=oo,oo<<=1,(oo&130023424)===0&&(oo=4194304)));var l=Sn();i=Bi(i,s),i!==null&&(Gs(i,s,l),Mn(i,l))}function L1(i){var s=i.memoizedState,l=0;s!==null&&(l=s.retryLane),Jh(i,l)}function M1(i,s){var l=0;switch(i.tag){case 13:var f=i.stateNode,m=i.memoizedState;m!==null&&(l=m.retryLane);break;case 19:f=i.stateNode;break;default:throw Error(r(314))}f!==null&&f.delete(s),Jh(i,l)}var em;em=function(i,s,l){if(i!==null)if(i.memoizedProps!==s.pendingProps||En.current)Dn=!0;else{if((i.lanes&l)===0&&(s.flags&128)===0)return Dn=!1,y1(i,s,l);Dn=(i.flags&131072)!==0}else Dn=!1,bt&&(s.flags&1048576)!==0&&Rp(s,Lo,s.index);switch(s.lanes=0,s.tag){case 2:var f=s.type;Ho(i,s),i=s.pendingProps;var m=fs(s,fn.current);ys(s,l),m=Ic(null,s,f,i,m,l);var x=Bc();return s.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Pn(f)?(x=!0,Eo(s)):x=!1,s.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,Lc(s),m.updater=jo,s.stateNode=m,m._reactInternals=s,qc(s,f,i,l),s=Xc(null,s,f,!0,x,l)):(s.tag=0,bt&&x&&bc(s),xn(null,s,m,l),s=s.child),s;case 16:f=s.elementType;e:{switch(Ho(i,s),i=s.pendingProps,m=f._init,f=m(f._payload),s.type=f,m=s.tag=R1(f),i=gi(f,i),m){case 0:s=Yc(null,s,f,i,l);break e;case 1:s=Th(null,s,f,i,l);break e;case 11:s=xh(null,s,f,i,l);break e;case 14:s=Sh(null,s,f,gi(f.type,i),l);break e}throw Error(r(306,f,""))}return s;case 0:return f=s.type,m=s.pendingProps,m=s.elementType===f?m:gi(f,m),Yc(i,s,f,m,l);case 1:return f=s.type,m=s.pendingProps,m=s.elementType===f?m:gi(f,m),Th(i,s,f,m,l);case 3:e:{if(Eh(s),i===null)throw Error(r(387));f=s.pendingProps,x=s.memoizedState,m=x.element,Wp(i,s),No(s,f,null,l);var L=s.memoizedState;if(f=L.element,x.isDehydrated)if(x={element:f,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){m=bs(Error(r(423)),s),s=Ph(i,s,f,l,m);break e}else if(f!==m){m=bs(Error(r(424)),s),s=Ph(i,s,f,l,m);break e}else for(qn=tr(s.stateNode.containerInfo.firstChild),jn=s,bt=!0,mi=null,l=Vp(s,null,f,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(ms(),f===m){s=Vi(i,s,l);break e}xn(i,s,f,l)}s=s.child}return s;case 5:return Hp(s),i===null&&kc(s),f=s.type,m=s.pendingProps,x=i!==null?i.memoizedProps:null,L=m.children,hc(f,m)?L=null:x!==null&&hc(f,x)&&(s.flags|=32),Ch(i,s),xn(i,s,L,l),s.child;case 6:return i===null&&kc(s),null;case 13:return Dh(i,s,l);case 4:return Mc(s,s.stateNode.containerInfo),f=s.pendingProps,i===null?s.child=gs(s,null,f,l):xn(i,s,f,l),s.child;case 11:return f=s.type,m=s.pendingProps,m=s.elementType===f?m:gi(f,m),xh(i,s,f,m,l);case 7:return xn(i,s,s.pendingProps,l),s.child;case 8:return xn(i,s,s.pendingProps.children,l),s.child;case 12:return xn(i,s,s.pendingProps.children,l),s.child;case 10:e:{if(f=s.type._context,m=s.pendingProps,x=s.memoizedProps,L=m.value,mt(Ro,f._currentValue),f._currentValue=L,x!==null)if(hi(x.value,L)){if(x.children===m.children&&!En.current){s=Vi(i,s,l);break e}}else for(x=s.child,x!==null&&(x.return=s);x!==null;){var B=x.dependencies;if(B!==null){L=x.child;for(var $=B.firstContext;$!==null;){if($.context===f){if(x.tag===1){$=zi(-1,l&-l),$.tag=2;var re=x.updateQueue;if(re!==null){re=re.shared;var he=re.pending;he===null?$.next=$:($.next=he.next,he.next=$),re.pending=$}}x.lanes|=l,$=x.alternate,$!==null&&($.lanes|=l),Pc(x.return,l,s),B.lanes|=l;break}$=$.next}}else if(x.tag===10)L=x.type===s.type?null:x.child;else if(x.tag===18){if(L=x.return,L===null)throw Error(r(341));L.lanes|=l,B=L.alternate,B!==null&&(B.lanes|=l),Pc(L,l,s),L=x.sibling}else L=x.child;if(L!==null)L.return=x;else for(L=x;L!==null;){if(L===s){L=null;break}if(x=L.sibling,x!==null){x.return=L.return,L=x;break}L=L.return}x=L}xn(i,s,m.children,l),s=s.child}return s;case 9:return m=s.type,f=s.pendingProps.children,ys(s,l),m=ei(m),f=f(m),s.flags|=1,xn(i,s,f,l),s.child;case 14:return f=s.type,m=gi(f,s.pendingProps),m=gi(f.type,m),Sh(i,s,f,m,l);case 15:return kh(i,s,s.type,s.pendingProps,l);case 17:return f=s.type,m=s.pendingProps,m=s.elementType===f?m:gi(f,m),Ho(i,s),s.tag=1,Pn(f)?(i=!0,Eo(s)):i=!1,ys(s,l),hh(s,f,m),qc(s,f,m,l),Xc(null,s,f,!0,i,l);case 19:return Mh(i,s,l);case 22:return _h(i,s,l)}throw Error(r(156,s.tag))};function tm(i,s){return Oe(i,s)}function A1(i,s,l,f){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ii(i,s,l,f){return new A1(i,s,l,f)}function hu(i){return i=i.prototype,!(!i||!i.isReactComponent)}function R1(i){if(typeof i=="function")return hu(i)?1:0;if(i!=null){if(i=i.$$typeof,i===ve)return 11;if(i===d)return 14}return 2}function fr(i,s){var l=i.alternate;return l===null?(l=ii(i.tag,s,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=s,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&14680064,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,s=i.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l}function nl(i,s,l,f,m,x){var L=2;if(f=i,typeof i=="function")hu(i)&&(L=1);else if(typeof i=="string")L=5;else e:switch(i){case ne:return zr(l.children,m,x,s);case ee:L=8,m|=8;break;case Q:return i=ii(12,l,s,m|2),i.elementType=Q,i.lanes=x,i;case ke:return i=ii(13,l,s,m),i.elementType=ke,i.lanes=x,i;case we:return i=ii(19,l,s,m),i.elementType=we,i.lanes=x,i;case w:return il(l,m,x,s);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case ce:L=10;break e;case me:L=9;break e;case ve:L=11;break e;case d:L=14;break e;case y:L=16,f=null;break e}throw Error(r(130,i==null?i:typeof i,""))}return s=ii(L,l,s,m),s.elementType=i,s.type=f,s.lanes=x,s}function zr(i,s,l,f){return i=ii(7,i,f,s),i.lanes=l,i}function il(i,s,l,f){return i=ii(22,i,f,s),i.elementType=w,i.lanes=l,i.stateNode={isHidden:!1},i}function mu(i,s,l){return i=ii(6,i,null,s),i.lanes=l,i}function gu(i,s,l){return s=ii(4,i.children!==null?i.children:[],i.key,s),s.lanes=l,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}function F1(i,s,l,f,m){this.tag=s,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jl(0),this.expirationTimes=jl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jl(0),this.identifierPrefix=f,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function vu(i,s,l,f,m,x,L,B,$){return i=new F1(i,s,l,B,$),s===1?(s=1,x===!0&&(s|=8)):s=0,x=ii(3,null,null,s),i.current=x,x.stateNode=i,x.memoizedState={element:f,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lc(x),i}function O1(i,s,l){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Z,key:f==null?null:""+f,children:i,containerInfo:s,implementation:l}}function nm(i){if(!i)return ir;i=i._reactInternals;e:{if(ht(i)!==i||i.tag!==1)throw Error(r(170));var s=i;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Pn(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(r(171))}if(i.tag===1){var l=i.type;if(Pn(l))return Lp(i,l,s)}return s}function im(i,s,l,f,m,x,L,B,$){return i=vu(l,f,!0,i,m,x,L,B,$),i.context=nm(null),l=i.current,f=Sn(),m=ur(l),x=zi(f,m),x.callback=s??null,ar(l,x,m),i.current.lanes=m,Gs(i,m,f),Mn(i,f),i}function rl(i,s,l,f){var m=s.current,x=Sn(),L=ur(m);return l=nm(l),s.context===null?s.context=l:s.pendingContext=l,s=zi(x,L),s.payload={element:i},f=f===void 0?null:f,f!==null&&(s.callback=f),i=ar(m,s,L),i!==null&&(wi(i,m,L,x),Oo(i,m,L)),L}function sl(i){return i=i.current,i.child?(i.child.tag===5,i.child.stateNode):null}function rm(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<s?l:s}}function yu(i,s){rm(i,s),(i=i.alternate)&&rm(i,s)}function N1(){return null}var sm=typeof reportError=="function"?reportError:function(i){console.error(i)};function wu(i){this._internalRoot=i}al.prototype.render=wu.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));rl(i,s,null,null)},al.prototype.unmount=wu.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Nr(function(){rl(null,i,null,null)}),s[Fi]=null}};function al(i){this._internalRoot=i}al.prototype.unstable_scheduleHydration=function(i){if(i){var s=Wf();i={blockedOn:null,target:i,priority:s};for(var l=0;l<Zi.length&&s!==0&&s<Zi[l].priority;l++);Zi.splice(l,0,i),l===0&&Hf(i)}};function bu(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function ol(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function am(){}function I1(i,s,l,f,m){if(m){if(typeof f=="function"){var x=f;f=function(){var re=sl(L);x.call(re)}}var L=im(s,f,i,0,null,!1,!1,"",am);return i._reactRootContainer=L,i[Fi]=L.current,ca(i.nodeType===8?i.parentNode:i),Nr(),L}for(;m=i.lastChild;)i.removeChild(m);if(typeof f=="function"){var B=f;f=function(){var re=sl($);B.call(re)}}var $=vu(i,0,!1,null,null,!1,!1,"",am);return i._reactRootContainer=$,i[Fi]=$.current,ca(i.nodeType===8?i.parentNode:i),Nr(function(){rl(s,$,l,f)}),$}function ll(i,s,l,f,m){var x=l._reactRootContainer;if(x){var L=x;if(typeof m=="function"){var B=m;m=function(){var $=sl(L);B.call($)}}rl(s,L,i,m)}else L=I1(l,s,i,m,f);return sl(L)}Vf=function(i){switch(i.tag){case 3:var s=i.stateNode;if(s.current.memoizedState.isDehydrated){var l=Xs(s.pendingLanes);l!==0&&(ql(s,l|1),Mn(s,Se()),(et&6)===0&&(ks=Se()+500,rr()))}break;case 13:Nr(function(){var f=Bi(i,1);if(f!==null){var m=Sn();wi(f,i,1,m)}}),yu(i,1)}},Hl=function(i){if(i.tag===13){var s=Bi(i,134217728);if(s!==null){var l=Sn();wi(s,i,134217728,l)}yu(i,134217728)}},Uf=function(i){if(i.tag===13){var s=ur(i),l=Bi(i,s);if(l!==null){var f=Sn();wi(l,i,s,f)}yu(i,s)}},Wf=function(){return lt},jf=function(i,s){var l=lt;try{return lt=i,s()}finally{lt=l}},Ht=function(i,s,l){switch(s){case"input":if(_e(i,l),s=l.name,l.type==="radio"&&s!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<l.length;s++){var f=l[s];if(f!==i&&f.form===i.form){var m=Co(f);if(!m)throw Error(r(90));Y(f),_e(f,m)}}}break;case"textarea":Ke(i,l);break;case"select":s=l.value,s!=null&&We(i,!!l.multiple,s,!1)}},Vn=du,fi=Nr;var B1={usingClientEntryPoint:!1,Events:[fa,us,Co,pt,Ri,du]},Ta={findFiberByHostInstance:Pr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},z1={bundleType:Ta.bundleType,version:Ta.version,rendererPackageName:Ta.rendererPackageName,rendererConfig:Ta.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:W.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=ue(i),i===null?null:i.stateNode},findFiberByHostInstance:Ta.findFiberByHostInstance||N1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cl.isDisabled&&cl.supportsFiber)try{je=cl.inject(z1),vt=cl}catch{}}return An.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B1,An.createPortal=function(i,s){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bu(s))throw Error(r(200));return O1(i,s,null,l)},An.createRoot=function(i,s){if(!bu(i))throw Error(r(299));var l=!1,f="",m=sm;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onRecoverableError!==void 0&&(m=s.onRecoverableError)),s=vu(i,1,!1,null,null,l,!1,f,m),i[Fi]=s.current,ca(i.nodeType===8?i.parentNode:i),new wu(s)},An.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=ue(s),i=i===null?null:i.stateNode,i},An.flushSync=function(i){return Nr(i)},An.hydrate=function(i,s,l){if(!ol(s))throw Error(r(200));return ll(null,i,s,!0,l)},An.hydrateRoot=function(i,s,l){if(!bu(i))throw Error(r(405));var f=l!=null&&l.hydratedSources||null,m=!1,x="",L=sm;if(l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(x=l.identifierPrefix),l.onRecoverableError!==void 0&&(L=l.onRecoverableError)),s=im(s,null,i,1,l??null,m,!1,x,L),i[Fi]=s.current,ca(i),f)for(i=0;i<f.length;i++)l=f[i],m=l._getVersion,m=m(l._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[l,m]:s.mutableSourceEagerHydrationData.push(l,m);return new al(s)},An.render=function(i,s,l){if(!ol(s))throw Error(r(200));return ll(null,i,s,!1,l)},An.unmountComponentAtNode=function(i){if(!ol(i))throw Error(r(40));return i._reactRootContainer?(Nr(function(){ll(null,null,i,!1,function(){i._reactRootContainer=null,i[Fi]=null})}),!0):!1},An.unstable_batchedUpdates=du,An.unstable_renderSubtreeIntoContainer=function(i,s,l,f){if(!ol(l))throw Error(r(200));if(i==null||i._reactInternals===void 0)throw Error(r(38));return ll(i,s,l,!1,f)},An.version="18.3.1-next-f1338f8080-20240426",An}var hm;function G1(){if(hm)return ku.exports;hm=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ku.exports=X1(),ku.exports}var mm;function K1(){if(mm)return ul;mm=1;var n=G1();return ul.createRoot=n.createRoot,ul.hydrateRoot=n.hydrateRoot,ul}var xv=K1();const zd=wv(xv);function Fa(n){let e=n[0],r=n[1],a=n[2];return Math.sqrt(e*e+r*r+a*a)}function Ju(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}function Q1(n,e,r,a){return n[0]=e,n[1]=r,n[2]=a,n}function gm(n,e,r){return n[0]=e[0]+r[0],n[1]=e[1]+r[1],n[2]=e[2]+r[2],n}function vm(n,e,r){return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],n}function Z1(n,e,r){return n[0]=e[0]*r[0],n[1]=e[1]*r[1],n[2]=e[2]*r[2],n}function J1(n,e,r){return n[0]=e[0]/r[0],n[1]=e[1]/r[1],n[2]=e[2]/r[2],n}function Tu(n,e,r){return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n}function eb(n,e){let r=e[0]-n[0],a=e[1]-n[1],o=e[2]-n[2];return Math.sqrt(r*r+a*a+o*o)}function tb(n,e){let r=e[0]-n[0],a=e[1]-n[1],o=e[2]-n[2];return r*r+a*a+o*o}function ym(n){let e=n[0],r=n[1],a=n[2];return e*e+r*r+a*a}function nb(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function ib(n,e){return n[0]=1/e[0],n[1]=1/e[1],n[2]=1/e[2],n}function ed(n,e){let r=e[0],a=e[1],o=e[2],c=r*r+a*a+o*o;return c>0&&(c=1/Math.sqrt(c)),n[0]=e[0]*c,n[1]=e[1]*c,n[2]=e[2]*c,n}function Sv(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function wm(n,e,r){let a=e[0],o=e[1],c=e[2],u=r[0],p=r[1],h=r[2];return n[0]=o*h-c*p,n[1]=c*u-a*h,n[2]=a*p-o*u,n}function rb(n,e,r,a){let o=e[0],c=e[1],u=e[2];return n[0]=o+a*(r[0]-o),n[1]=c+a*(r[1]-c),n[2]=u+a*(r[2]-u),n}function sb(n,e,r,a,o){const c=Math.exp(-a*o);let u=e[0],p=e[1],h=e[2];return n[0]=r[0]+(u-r[0])*c,n[1]=r[1]+(p-r[1])*c,n[2]=r[2]+(h-r[2])*c,n}function ab(n,e,r){let a=e[0],o=e[1],c=e[2],u=r[3]*a+r[7]*o+r[11]*c+r[15];return u=u||1,n[0]=(r[0]*a+r[4]*o+r[8]*c+r[12])/u,n[1]=(r[1]*a+r[5]*o+r[9]*c+r[13])/u,n[2]=(r[2]*a+r[6]*o+r[10]*c+r[14])/u,n}function ob(n,e,r){let a=e[0],o=e[1],c=e[2],u=r[3]*a+r[7]*o+r[11]*c+r[15];return u=u||1,n[0]=(r[0]*a+r[4]*o+r[8]*c)/u,n[1]=(r[1]*a+r[5]*o+r[9]*c)/u,n[2]=(r[2]*a+r[6]*o+r[10]*c)/u,n}function lb(n,e,r){let a=e[0],o=e[1],c=e[2];return n[0]=a*r[0]+o*r[3]+c*r[6],n[1]=a*r[1]+o*r[4]+c*r[7],n[2]=a*r[2]+o*r[5]+c*r[8],n}function cb(n,e,r){let a=e[0],o=e[1],c=e[2],u=r[0],p=r[1],h=r[2],g=r[3],v=p*c-h*o,k=h*a-u*c,T=u*o-p*a,P=p*T-h*k,M=h*v-u*T,D=u*k-p*v,R=g*2;return v*=R,k*=R,T*=R,P*=2,M*=2,D*=2,n[0]=a+v+P,n[1]=o+k+M,n[2]=c+T+D,n}const ub=(function(){const n=[0,0,0],e=[0,0,0];return function(r,a){Ju(n,r),Ju(e,a),ed(n,n),ed(e,e);let o=Sv(n,e);return o>1?0:o<-1?Math.PI:Math.acos(o)}})();function db(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]}class Si extends Array{constructor(e=0,r=e,a=e){return super(e,r,a),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this[0]=e}set y(e){this[1]=e}set z(e){this[2]=e}set(e,r=e,a=e){return e.length?this.copy(e):(Q1(this,e,r,a),this)}copy(e){return Ju(this,e),this}add(e,r){return r?gm(this,e,r):gm(this,this,e),this}sub(e,r){return r?vm(this,e,r):vm(this,this,e),this}multiply(e){return e.length?Z1(this,this,e):Tu(this,this,e),this}divide(e){return e.length?J1(this,this,e):Tu(this,this,1/e),this}inverse(e=this){return ib(this,e),this}len(){return Fa(this)}distance(e){return e?eb(this,e):Fa(this)}squaredLen(){return ym(this)}squaredDistance(e){return e?tb(this,e):ym(this)}negate(e=this){return nb(this,e),this}cross(e,r){return r?wm(this,e,r):wm(this,this,e),this}scale(e){return Tu(this,this,e),this}normalize(){return ed(this,this),this}dot(e){return Sv(this,e)}equals(e){return db(this,e)}applyMatrix3(e){return lb(this,this,e),this}applyMatrix4(e){return ab(this,this,e),this}scaleRotateMatrix4(e){return ob(this,this,e),this}applyQuaternion(e){return cb(this,this,e),this}angle(e){return ub(this,e)}lerp(e,r){return rb(this,this,e,r),this}smoothLerp(e,r,a){return sb(this,this,e,r,a),this}clone(){return new Si(this[0],this[1],this[2])}fromArray(e,r=0){return this[0]=e[r],this[1]=e[r+1],this[2]=e[r+2],this}toArray(e=[],r=0){return e[r]=this[0],e[r+1]=this[1],e[r+2]=this[2],e}transformDirection(e){const r=this[0],a=this[1],o=this[2];return this[0]=e[0]*r+e[4]*a+e[8]*o,this[1]=e[1]*r+e[5]*a+e[9]*o,this[2]=e[2]*r+e[6]*a+e[10]*o,this.normalize()}}const bm=new Si;let fb=1,pb=1,xm=!1;class hb{constructor(e,r={}){e.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=e,this.attributes=r,this.id=fb++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let a in r)this.addAttribute(a,r[a])}addAttribute(e,r){if(this.attributes[e]=r,r.id=pb++,r.size=r.size||1,r.type=r.type||(r.data.constructor===Float32Array?this.gl.FLOAT:r.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),r.target=e==="index"?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,r.normalized=r.normalized||!1,r.stride=r.stride||0,r.offset=r.offset||0,r.count=r.count||(r.stride?r.data.byteLength/r.stride:r.data.length/r.size),r.divisor=r.instanced||0,r.needsUpdate=!1,r.usage=r.usage||this.gl.STATIC_DRAW,r.buffer||this.updateAttribute(r),r.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==r.count*r.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,r.count*r.divisor);this.instancedCount=r.count*r.divisor}else e==="index"?this.drawRange.count=r.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,r.count))}updateAttribute(e){const r=!e.buffer;r&&(e.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==e.buffer&&(this.gl.bindBuffer(e.target,e.buffer),this.glState.boundBuffer=e.buffer),r?this.gl.bufferData(e.target,e.data,e.usage):this.gl.bufferSubData(e.target,0,e.data),e.needsUpdate=!1}setIndex(e){this.addAttribute("index",e)}setDrawRange(e,r){this.drawRange.start=e,this.drawRange.count=r}setInstancedCount(e){this.instancedCount=e}createVAO(e){this.VAOs[e.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.bindAttributes(e)}bindAttributes(e){e.attributeLocations.forEach((r,{name:a,type:o})=>{if(!this.attributes[a]){console.warn(`active attribute ${a} not being supplied`);return}const c=this.attributes[a];this.gl.bindBuffer(c.target,c.buffer),this.glState.boundBuffer=c.buffer;let u=1;o===35674&&(u=2),o===35675&&(u=3),o===35676&&(u=4);const p=c.size/u,h=u===1?0:u*u*4,g=u===1?0:u*4;for(let v=0;v<u;v++)this.gl.vertexAttribPointer(r+v,p,c.type,c.normalized,c.stride+h,c.offset+v*g),this.gl.enableVertexAttribArray(r+v),this.gl.renderer.vertexAttribDivisor(r+v,c.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:e,mode:r=this.gl.TRIANGLES}){this.gl.renderer.currentGeometry!==`${this.id}_${e.attributeOrder}`&&(this.VAOs[e.attributeOrder]||this.createVAO(e),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${e.attributeOrder}`),e.attributeLocations.forEach((o,{name:c})=>{const u=this.attributes[c];u.needsUpdate&&this.updateAttribute(u)});let a=2;this.attributes.index?.type===this.gl.UNSIGNED_INT&&(a=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(r,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*a,this.instancedCount):this.gl.renderer.drawArraysInstanced(r,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(r,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*a):this.gl.drawArrays(r,this.drawRange.start,this.drawRange.count)}getPosition(){const e=this.attributes.position;if(e.data)return e;if(!xm)return console.warn("No position buffer data found to compute bounds"),xm=!0}computeBoundingBox(e){e||(e=this.getPosition());const r=e.data,a=e.size;this.bounds||(this.bounds={min:new Si,max:new Si,center:new Si,scale:new Si,radius:1/0});const o=this.bounds.min,c=this.bounds.max,u=this.bounds.center,p=this.bounds.scale;o.set(1/0),c.set(-1/0);for(let h=0,g=r.length;h<g;h+=a){const v=r[h],k=r[h+1],T=r[h+2];o.x=Math.min(v,o.x),o.y=Math.min(k,o.y),o.z=Math.min(T,o.z),c.x=Math.max(v,c.x),c.y=Math.max(k,c.y),c.z=Math.max(T,c.z)}p.sub(c,o),u.add(o,c).divide(2)}computeBoundingSphere(e){e||(e=this.getPosition());const r=e.data,a=e.size;this.bounds||this.computeBoundingBox(e);let o=0;for(let c=0,u=r.length;c<u;c+=a)bm.fromArray(r,c),o=Math.max(o,this.bounds.center.squaredDistance(bm));this.bounds.radius=Math.sqrt(o)}remove(){for(let e in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[e]),delete this.VAOs[e];for(let e in this.attributes)this.gl.deleteBuffer(this.attributes[e].buffer),delete this.attributes[e]}}let mb=1;const Sm={};class gb{constructor(e,{vertex:r,fragment:a,uniforms:o={},transparent:c=!1,cullFace:u=e.BACK,frontFace:p=e.CCW,depthTest:h=!0,depthWrite:g=!0,depthFunc:v=e.LEQUAL}={}){e.canvas||console.error("gl not passed as first argument to Program"),this.gl=e,this.uniforms=o,this.id=mb++,r||console.warn("vertex shader not supplied"),a||console.warn("fragment shader not supplied"),this.transparent=c,this.cullFace=u,this.frontFace=p,this.depthTest=h,this.depthWrite=g,this.depthFunc=v,this.blendFunc={},this.blendEquation={},this.stencilFunc={},this.stencilOp={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this.vertexShader=e.createShader(e.VERTEX_SHADER),this.fragmentShader=e.createShader(e.FRAGMENT_SHADER),this.program=e.createProgram(),e.attachShader(this.program,this.vertexShader),e.attachShader(this.program,this.fragmentShader),this.setShaders({vertex:r,fragment:a})}setShaders({vertex:e,fragment:r}){if(e&&(this.gl.shaderSource(this.vertexShader,e),this.gl.compileShader(this.vertexShader),this.gl.getShaderInfoLog(this.vertexShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.vertexShader)}
Vertex Shader
${km(e)}`)),r&&(this.gl.shaderSource(this.fragmentShader,r),this.gl.compileShader(this.fragmentShader),this.gl.getShaderInfoLog(this.fragmentShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.fragmentShader)}
Fragment Shader
${km(r)}`)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.warn(this.gl.getProgramInfoLog(this.program));this.uniformLocations=new Map;let a=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let u=0;u<a;u++){let p=this.gl.getActiveUniform(this.program,u);this.uniformLocations.set(p,this.gl.getUniformLocation(this.program,p.name));const h=p.name.match(/(\w+)/g);p.uniformName=h[0],p.nameComponents=h.slice(1)}this.attributeLocations=new Map;const o=[],c=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let u=0;u<c;u++){const p=this.gl.getActiveAttrib(this.program,u),h=this.gl.getAttribLocation(this.program,p.name);h!==-1&&(o[h]=p.name,this.attributeLocations.set(p,h))}this.attributeOrder=o.join("")}setBlendFunc(e,r,a,o){this.blendFunc.src=e,this.blendFunc.dst=r,this.blendFunc.srcAlpha=a,this.blendFunc.dstAlpha=o,e&&(this.transparent=!0)}setBlendEquation(e,r){this.blendEquation.modeRGB=e,this.blendEquation.modeAlpha=r}setStencilFunc(e,r,a){this.stencilRef=r,this.stencilFunc.func=e,this.stencilFunc.ref=r,this.stencilFunc.mask=a}setStencilOp(e,r,a){this.stencilOp.stencilFail=e,this.stencilOp.depthFail=r,this.stencilOp.depthPass=a}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha),this.stencilFunc.func||this.stencilOp.stencilFail?this.gl.renderer.enable(this.gl.STENCIL_TEST):this.gl.renderer.disable(this.gl.STENCIL_TEST),this.gl.renderer.setStencilFunc(this.stencilFunc.func,this.stencilFunc.ref,this.stencilFunc.mask),this.gl.renderer.setStencilOp(this.stencilOp.stencilFail,this.stencilOp.depthFail,this.stencilOp.depthPass)}use({flipFaces:e=!1}={}){let r=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((o,c)=>{let u=this.uniforms[c.uniformName];for(const p of c.nameComponents){if(!u)break;if(p in u)u=u[p];else{if(Array.isArray(u.value))break;u=void 0;break}}if(!u)return _m(`Active uniform ${c.name} has not been supplied`);if(u&&u.value===void 0)return _m(`${c.name} uniform is missing a value parameter`);if(u.value.texture)return r=r+1,u.value.update(r),Eu(this.gl,c.type,o,r);if(u.value.length&&u.value[0].texture){const p=[];return u.value.forEach(h=>{r=r+1,h.update(r),p.push(r)}),Eu(this.gl,c.type,o,p)}Eu(this.gl,c.type,o,u.value)}),this.applyState(),e&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function Eu(n,e,r,a){a=a.length?vb(a):a;const o=n.renderer.state.uniformLocations.get(r);if(a.length)if(o===void 0||o.length!==a.length)n.renderer.state.uniformLocations.set(r,a.slice(0));else{if(yb(o,a))return;o.set?o.set(a):wb(o,a),n.renderer.state.uniformLocations.set(r,o)}else{if(o===a)return;n.renderer.state.uniformLocations.set(r,a)}switch(e){case 5126:return a.length?n.uniform1fv(r,a):n.uniform1f(r,a);case 35664:return n.uniform2fv(r,a);case 35665:return n.uniform3fv(r,a);case 35666:return n.uniform4fv(r,a);case 35670:case 5124:case 35678:case 36306:case 35680:case 36289:return a.length?n.uniform1iv(r,a):n.uniform1i(r,a);case 35671:case 35667:return n.uniform2iv(r,a);case 35672:case 35668:return n.uniform3iv(r,a);case 35673:case 35669:return n.uniform4iv(r,a);case 35674:return n.uniformMatrix2fv(r,!1,a);case 35675:return n.uniformMatrix3fv(r,!1,a);case 35676:return n.uniformMatrix4fv(r,!1,a)}}function km(n){let e=n.split(`
`);for(let r=0;r<e.length;r++)e[r]=r+1+": "+e[r];return e.join(`
`)}function vb(n){const e=n.length,r=n[0].length;if(r===void 0)return n;const a=e*r;let o=Sm[a];o||(Sm[a]=o=new Float32Array(a));for(let c=0;c<e;c++)o.set(n[c],c*r);return o}function yb(n,e){if(n.length!==e.length)return!1;for(let r=0,a=n.length;r<a;r++)if(n[r]!==e[r])return!1;return!0}function wb(n,e){for(let r=0,a=n.length;r<a;r++)n[r]=e[r]}let Pu=0;function _m(n){Pu>100||(console.warn(n),Pu++,Pu>100&&console.warn("More than 100 program warnings - stopping logs."))}const Du=new Si;let bb=1;class xb{constructor({canvas:e=document.createElement("canvas"),width:r=300,height:a=150,dpr:o=1,alpha:c=!1,depth:u=!0,stencil:p=!1,antialias:h=!1,premultipliedAlpha:g=!1,preserveDrawingBuffer:v=!1,powerPreference:k="default",autoClear:T=!0,webgl:P=2}={}){const M={alpha:c,depth:u,stencil:p,antialias:h,premultipliedAlpha:g,preserveDrawingBuffer:v,powerPreference:k};this.dpr=o,this.alpha=c,this.color=!0,this.depth=u,this.stencil=p,this.premultipliedAlpha=g,this.autoClear=T,this.id=bb++,P===2&&(this.gl=e.getContext("webgl2",M)),this.isWebgl2=!!this.gl,this.gl||(this.gl=e.getContext("webgl",M)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(r,a),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=!1,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LEQUAL,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(e,r){this.width=e,this.height=r,this.gl.canvas.width=e*this.dpr,this.gl.canvas.height=r*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:e+"px",height:r+"px"})}setViewport(e,r,a=0,o=0){this.state.viewport.width===e&&this.state.viewport.height===r||(this.state.viewport.width=e,this.state.viewport.height=r,this.state.viewport.x=a,this.state.viewport.y=o,this.gl.viewport(a,o,e,r))}setScissor(e,r,a=0,o=0){this.gl.scissor(a,o,e,r)}enable(e){this.state[e]!==!0&&(this.gl.enable(e),this.state[e]=!0)}disable(e){this.state[e]!==!1&&(this.gl.disable(e),this.state[e]=!1)}setBlendFunc(e,r,a,o){this.state.blendFunc.src===e&&this.state.blendFunc.dst===r&&this.state.blendFunc.srcAlpha===a&&this.state.blendFunc.dstAlpha===o||(this.state.blendFunc.src=e,this.state.blendFunc.dst=r,this.state.blendFunc.srcAlpha=a,this.state.blendFunc.dstAlpha=o,a!==void 0?this.gl.blendFuncSeparate(e,r,a,o):this.gl.blendFunc(e,r))}setBlendEquation(e,r){e=e||this.gl.FUNC_ADD,!(this.state.blendEquation.modeRGB===e&&this.state.blendEquation.modeAlpha===r)&&(this.state.blendEquation.modeRGB=e,this.state.blendEquation.modeAlpha=r,r!==void 0?this.gl.blendEquationSeparate(e,r):this.gl.blendEquation(e))}setCullFace(e){this.state.cullFace!==e&&(this.state.cullFace=e,this.gl.cullFace(e))}setFrontFace(e){this.state.frontFace!==e&&(this.state.frontFace=e,this.gl.frontFace(e))}setDepthMask(e){this.state.depthMask!==e&&(this.state.depthMask=e,this.gl.depthMask(e))}setDepthFunc(e){this.state.depthFunc!==e&&(this.state.depthFunc=e,this.gl.depthFunc(e))}setStencilMask(e){this.state.stencilMask!==e&&(this.state.stencilMask=e,this.gl.stencilMask(e))}setStencilFunc(e,r,a){this.state.stencilFunc===e&&this.state.stencilRef===r&&this.state.stencilFuncMask===a||(this.state.stencilFunc=e||this.gl.ALWAYS,this.state.stencilRef=r||0,this.state.stencilFuncMask=a||0,this.gl.stencilFunc(e||this.gl.ALWAYS,r||0,a||0))}setStencilOp(e,r,a){this.state.stencilFail===e&&this.state.stencilDepthFail===r&&this.state.stencilDepthPass===a||(this.state.stencilFail=e,this.state.stencilDepthFail=r,this.state.stencilDepthPass=a,this.gl.stencilOp(e,r,a))}activeTexture(e){this.state.activeTextureUnit!==e&&(this.state.activeTextureUnit=e,this.gl.activeTexture(this.gl.TEXTURE0+e))}bindFramebuffer({target:e=this.gl.FRAMEBUFFER,buffer:r=null}={}){this.state.framebuffer!==r&&(this.state.framebuffer=r,this.gl.bindFramebuffer(e,r))}getExtension(e,r,a){return r&&this.gl[r]?this.gl[r].bind(this.gl):(this.extensions[e]||(this.extensions[e]=this.gl.getExtension(e)),r?this.extensions[e]?this.extensions[e][a].bind(this.extensions[e]):null:this.extensions[e])}sortOpaque(e,r){return e.renderOrder!==r.renderOrder?e.renderOrder-r.renderOrder:e.program.id!==r.program.id?e.program.id-r.program.id:e.zDepth!==r.zDepth?e.zDepth-r.zDepth:r.id-e.id}sortTransparent(e,r){return e.renderOrder!==r.renderOrder?e.renderOrder-r.renderOrder:e.zDepth!==r.zDepth?r.zDepth-e.zDepth:r.id-e.id}sortUI(e,r){return e.renderOrder!==r.renderOrder?e.renderOrder-r.renderOrder:e.program.id!==r.program.id?e.program.id-r.program.id:r.id-e.id}getRenderList({scene:e,camera:r,frustumCull:a,sort:o}){let c=[];if(r&&a&&r.updateFrustum(),e.traverse(u=>{if(!u.visible)return!0;u.draw&&(a&&u.frustumCulled&&r&&!r.frustumIntersectsMesh(u)||c.push(u))}),o){const u=[],p=[],h=[];c.forEach(g=>{g.program.transparent?g.program.depthTest?p.push(g):h.push(g):u.push(g),g.zDepth=0,!(g.renderOrder!==0||!g.program.depthTest||!r)&&(g.worldMatrix.getTranslation(Du),Du.applyMatrix4(r.projectionViewMatrix),g.zDepth=Du.z)}),u.sort(this.sortOpaque),p.sort(this.sortTransparent),h.sort(this.sortUI),c=u.concat(p,h)}return c}render({scene:e,camera:r,target:a=null,update:o=!0,sort:c=!0,frustumCull:u=!0,clear:p}){a===null?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(a),this.setViewport(a.width,a.height)),(p||this.autoClear&&p!==!1)&&(this.depth&&(!a||a.depth)&&(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),(this.stencil||!a||a.stencil)&&(this.enable(this.gl.STENCIL_TEST),this.setStencilMask(255)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),o&&e.updateMatrixWorld(),r&&r.updateMatrixWorld(),this.getRenderList({scene:e,camera:r,frustumCull:u,sort:c}).forEach(g=>{g.draw({camera:r})})}}function Sb(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}function kb(n,e,r,a,o){return n[0]=e,n[1]=r,n[2]=a,n[3]=o,n}function _b(n,e){let r=e[0],a=e[1],o=e[2],c=e[3],u=r*r+a*a+o*o+c*c;return u>0&&(u=1/Math.sqrt(u)),n[0]=r*u,n[1]=a*u,n[2]=o*u,n[3]=c*u,n}function Cb(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}function Tb(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function Eb(n,e,r){r=r*.5;let a=Math.sin(r);return n[0]=a*e[0],n[1]=a*e[1],n[2]=a*e[2],n[3]=Math.cos(r),n}function Cm(n,e,r){let a=e[0],o=e[1],c=e[2],u=e[3],p=r[0],h=r[1],g=r[2],v=r[3];return n[0]=a*v+u*p+o*g-c*h,n[1]=o*v+u*h+c*p-a*g,n[2]=c*v+u*g+a*h-o*p,n[3]=u*v-a*p-o*h-c*g,n}function Pb(n,e,r){r*=.5;let a=e[0],o=e[1],c=e[2],u=e[3],p=Math.sin(r),h=Math.cos(r);return n[0]=a*h+u*p,n[1]=o*h+c*p,n[2]=c*h-o*p,n[3]=u*h-a*p,n}function Db(n,e,r){r*=.5;let a=e[0],o=e[1],c=e[2],u=e[3],p=Math.sin(r),h=Math.cos(r);return n[0]=a*h-c*p,n[1]=o*h+u*p,n[2]=c*h+a*p,n[3]=u*h-o*p,n}function Lb(n,e,r){r*=.5;let a=e[0],o=e[1],c=e[2],u=e[3],p=Math.sin(r),h=Math.cos(r);return n[0]=a*h+o*p,n[1]=o*h-a*p,n[2]=c*h+u*p,n[3]=u*h-c*p,n}function Mb(n,e,r,a){let o=e[0],c=e[1],u=e[2],p=e[3],h=r[0],g=r[1],v=r[2],k=r[3],T,P,M,D,R;return P=o*h+c*g+u*v+p*k,P<0&&(P=-P,h=-h,g=-g,v=-v,k=-k),1-P>1e-6?(T=Math.acos(P),M=Math.sin(T),D=Math.sin((1-a)*T)/M,R=Math.sin(a*T)/M):(D=1-a,R=a),n[0]=D*o+R*h,n[1]=D*c+R*g,n[2]=D*u+R*v,n[3]=D*p+R*k,n}function Ab(n,e){let r=e[0],a=e[1],o=e[2],c=e[3],u=r*r+a*a+o*o+c*c,p=u?1/u:0;return n[0]=-r*p,n[1]=-a*p,n[2]=-o*p,n[3]=c*p,n}function Rb(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n}function Fb(n,e){let r=e[0]+e[4]+e[8],a;if(r>0)a=Math.sqrt(r+1),n[3]=.5*a,a=.5/a,n[0]=(e[5]-e[7])*a,n[1]=(e[6]-e[2])*a,n[2]=(e[1]-e[3])*a;else{let o=0;e[4]>e[0]&&(o=1),e[8]>e[o*3+o]&&(o=2);let c=(o+1)%3,u=(o+2)%3;a=Math.sqrt(e[o*3+o]-e[c*3+c]-e[u*3+u]+1),n[o]=.5*a,a=.5/a,n[3]=(e[c*3+u]-e[u*3+c])*a,n[c]=(e[c*3+o]+e[o*3+c])*a,n[u]=(e[u*3+o]+e[o*3+u])*a}return n}function Ob(n,e,r="YXZ"){let a=Math.sin(e[0]*.5),o=Math.cos(e[0]*.5),c=Math.sin(e[1]*.5),u=Math.cos(e[1]*.5),p=Math.sin(e[2]*.5),h=Math.cos(e[2]*.5);return r==="XYZ"?(n[0]=a*u*h+o*c*p,n[1]=o*c*h-a*u*p,n[2]=o*u*p+a*c*h,n[3]=o*u*h-a*c*p):r==="YXZ"?(n[0]=a*u*h+o*c*p,n[1]=o*c*h-a*u*p,n[2]=o*u*p-a*c*h,n[3]=o*u*h+a*c*p):r==="ZXY"?(n[0]=a*u*h-o*c*p,n[1]=o*c*h+a*u*p,n[2]=o*u*p+a*c*h,n[3]=o*u*h-a*c*p):r==="ZYX"?(n[0]=a*u*h-o*c*p,n[1]=o*c*h+a*u*p,n[2]=o*u*p-a*c*h,n[3]=o*u*h+a*c*p):r==="YZX"?(n[0]=a*u*h+o*c*p,n[1]=o*c*h+a*u*p,n[2]=o*u*p-a*c*h,n[3]=o*u*h-a*c*p):r==="XZY"&&(n[0]=a*u*h-o*c*p,n[1]=o*c*h-a*u*p,n[2]=o*u*p+a*c*h,n[3]=o*u*h+a*c*p),n}const Nb=Sb,Ib=kb,Bb=Cb,zb=_b;class Vb extends Array{constructor(e=0,r=0,a=0,o=1){super(e,r,a,o),this.onChange=()=>{},this._target=this;const c=["0","1","2","3"];return new Proxy(this,{set(u,p){const h=Reflect.set(...arguments);return h&&c.includes(p)&&u.onChange(),h}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set w(e){this._target[3]=e,this.onChange()}identity(){return Tb(this._target),this.onChange(),this}set(e,r,a,o){return e.length?this.copy(e):(Ib(this._target,e,r,a,o),this.onChange(),this)}rotateX(e){return Pb(this._target,this._target,e),this.onChange(),this}rotateY(e){return Db(this._target,this._target,e),this.onChange(),this}rotateZ(e){return Lb(this._target,this._target,e),this.onChange(),this}inverse(e=this._target){return Ab(this._target,e),this.onChange(),this}conjugate(e=this._target){return Rb(this._target,e),this.onChange(),this}copy(e){return Nb(this._target,e),this.onChange(),this}normalize(e=this._target){return zb(this._target,e),this.onChange(),this}multiply(e,r){return r?Cm(this._target,e,r):Cm(this._target,this._target,e),this.onChange(),this}dot(e){return Bb(this._target,e)}fromMatrix3(e){return Fb(this._target,e),this.onChange(),this}fromEuler(e,r){return Ob(this._target,e,e.order),r||this.onChange(),this}fromAxisAngle(e,r){return Eb(this._target,e,r),this.onChange(),this}slerp(e,r){return Mb(this._target,this._target,e,r),this.onChange(),this}fromArray(e,r=0){return this._target[0]=e[r],this._target[1]=e[r+1],this._target[2]=e[r+2],this._target[3]=e[r+3],this.onChange(),this}toArray(e=[],r=0){return e[r]=this[0],e[r+1]=this[1],e[r+2]=this[2],e[r+3]=this[3],e}}const Ub=1e-6;function Wb(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function jb(n,e,r,a,o,c,u,p,h,g,v,k,T,P,M,D,R){return n[0]=e,n[1]=r,n[2]=a,n[3]=o,n[4]=c,n[5]=u,n[6]=p,n[7]=h,n[8]=g,n[9]=v,n[10]=k,n[11]=T,n[12]=P,n[13]=M,n[14]=D,n[15]=R,n}function qb(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Hb(n,e){let r=e[0],a=e[1],o=e[2],c=e[3],u=e[4],p=e[5],h=e[6],g=e[7],v=e[8],k=e[9],T=e[10],P=e[11],M=e[12],D=e[13],R=e[14],N=e[15],H=r*p-a*u,A=r*h-o*u,W=r*g-c*u,U=a*h-o*p,Z=a*g-c*p,ne=o*g-c*h,ee=v*D-k*M,Q=v*R-T*M,ce=v*N-P*M,me=k*R-T*D,ve=k*N-P*D,ke=T*N-P*R,we=H*ke-A*ve+W*me+U*ce-Z*Q+ne*ee;return we?(we=1/we,n[0]=(p*ke-h*ve+g*me)*we,n[1]=(o*ve-a*ke-c*me)*we,n[2]=(D*ne-R*Z+N*U)*we,n[3]=(T*Z-k*ne-P*U)*we,n[4]=(h*ce-u*ke-g*Q)*we,n[5]=(r*ke-o*ce+c*Q)*we,n[6]=(R*W-M*ne-N*A)*we,n[7]=(v*ne-T*W+P*A)*we,n[8]=(u*ve-p*ce+g*ee)*we,n[9]=(a*ce-r*ve-c*ee)*we,n[10]=(M*Z-D*W+N*H)*we,n[11]=(k*W-v*Z-P*H)*we,n[12]=(p*Q-u*me-h*ee)*we,n[13]=(r*me-a*Q+o*ee)*we,n[14]=(D*A-M*U-R*H)*we,n[15]=(v*U-k*A+T*H)*we,n):null}function kv(n){let e=n[0],r=n[1],a=n[2],o=n[3],c=n[4],u=n[5],p=n[6],h=n[7],g=n[8],v=n[9],k=n[10],T=n[11],P=n[12],M=n[13],D=n[14],R=n[15],N=e*u-r*c,H=e*p-a*c,A=e*h-o*c,W=r*p-a*u,U=r*h-o*u,Z=a*h-o*p,ne=g*M-v*P,ee=g*D-k*P,Q=g*R-T*P,ce=v*D-k*M,me=v*R-T*M,ve=k*R-T*D;return N*ve-H*me+A*ce+W*Q-U*ee+Z*ne}function Tm(n,e,r){let a=e[0],o=e[1],c=e[2],u=e[3],p=e[4],h=e[5],g=e[6],v=e[7],k=e[8],T=e[9],P=e[10],M=e[11],D=e[12],R=e[13],N=e[14],H=e[15],A=r[0],W=r[1],U=r[2],Z=r[3];return n[0]=A*a+W*p+U*k+Z*D,n[1]=A*o+W*h+U*T+Z*R,n[2]=A*c+W*g+U*P+Z*N,n[3]=A*u+W*v+U*M+Z*H,A=r[4],W=r[5],U=r[6],Z=r[7],n[4]=A*a+W*p+U*k+Z*D,n[5]=A*o+W*h+U*T+Z*R,n[6]=A*c+W*g+U*P+Z*N,n[7]=A*u+W*v+U*M+Z*H,A=r[8],W=r[9],U=r[10],Z=r[11],n[8]=A*a+W*p+U*k+Z*D,n[9]=A*o+W*h+U*T+Z*R,n[10]=A*c+W*g+U*P+Z*N,n[11]=A*u+W*v+U*M+Z*H,A=r[12],W=r[13],U=r[14],Z=r[15],n[12]=A*a+W*p+U*k+Z*D,n[13]=A*o+W*h+U*T+Z*R,n[14]=A*c+W*g+U*P+Z*N,n[15]=A*u+W*v+U*M+Z*H,n}function $b(n,e,r){let a=r[0],o=r[1],c=r[2],u,p,h,g,v,k,T,P,M,D,R,N;return e===n?(n[12]=e[0]*a+e[4]*o+e[8]*c+e[12],n[13]=e[1]*a+e[5]*o+e[9]*c+e[13],n[14]=e[2]*a+e[6]*o+e[10]*c+e[14],n[15]=e[3]*a+e[7]*o+e[11]*c+e[15]):(u=e[0],p=e[1],h=e[2],g=e[3],v=e[4],k=e[5],T=e[6],P=e[7],M=e[8],D=e[9],R=e[10],N=e[11],n[0]=u,n[1]=p,n[2]=h,n[3]=g,n[4]=v,n[5]=k,n[6]=T,n[7]=P,n[8]=M,n[9]=D,n[10]=R,n[11]=N,n[12]=u*a+v*o+M*c+e[12],n[13]=p*a+k*o+D*c+e[13],n[14]=h*a+T*o+R*c+e[14],n[15]=g*a+P*o+N*c+e[15]),n}function Yb(n,e,r){let a=r[0],o=r[1],c=r[2];return n[0]=e[0]*a,n[1]=e[1]*a,n[2]=e[2]*a,n[3]=e[3]*a,n[4]=e[4]*o,n[5]=e[5]*o,n[6]=e[6]*o,n[7]=e[7]*o,n[8]=e[8]*c,n[9]=e[9]*c,n[10]=e[10]*c,n[11]=e[11]*c,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Xb(n,e,r,a){let o=a[0],c=a[1],u=a[2],p=Math.hypot(o,c,u),h,g,v,k,T,P,M,D,R,N,H,A,W,U,Z,ne,ee,Q,ce,me,ve,ke,we,d;return Math.abs(p)<Ub?null:(p=1/p,o*=p,c*=p,u*=p,h=Math.sin(r),g=Math.cos(r),v=1-g,k=e[0],T=e[1],P=e[2],M=e[3],D=e[4],R=e[5],N=e[6],H=e[7],A=e[8],W=e[9],U=e[10],Z=e[11],ne=o*o*v+g,ee=c*o*v+u*h,Q=u*o*v-c*h,ce=o*c*v-u*h,me=c*c*v+g,ve=u*c*v+o*h,ke=o*u*v+c*h,we=c*u*v-o*h,d=u*u*v+g,n[0]=k*ne+D*ee+A*Q,n[1]=T*ne+R*ee+W*Q,n[2]=P*ne+N*ee+U*Q,n[3]=M*ne+H*ee+Z*Q,n[4]=k*ce+D*me+A*ve,n[5]=T*ce+R*me+W*ve,n[6]=P*ce+N*me+U*ve,n[7]=M*ce+H*me+Z*ve,n[8]=k*ke+D*we+A*d,n[9]=T*ke+R*we+W*d,n[10]=P*ke+N*we+U*d,n[11]=M*ke+H*we+Z*d,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}function Gb(n,e){return n[0]=e[12],n[1]=e[13],n[2]=e[14],n}function _v(n,e){let r=e[0],a=e[1],o=e[2],c=e[4],u=e[5],p=e[6],h=e[8],g=e[9],v=e[10];return n[0]=Math.hypot(r,a,o),n[1]=Math.hypot(c,u,p),n[2]=Math.hypot(h,g,v),n}function Kb(n){let e=n[0],r=n[1],a=n[2],o=n[4],c=n[5],u=n[6],p=n[8],h=n[9],g=n[10];const v=e*e+r*r+a*a,k=o*o+c*c+u*u,T=p*p+h*h+g*g;return Math.sqrt(Math.max(v,k,T))}const Cv=(function(){const n=[1,1,1];return function(e,r){let a=n;_v(a,r);let o=1/a[0],c=1/a[1],u=1/a[2],p=r[0]*o,h=r[1]*c,g=r[2]*u,v=r[4]*o,k=r[5]*c,T=r[6]*u,P=r[8]*o,M=r[9]*c,D=r[10]*u,R=p+k+D,N=0;return R>0?(N=Math.sqrt(R+1)*2,e[3]=.25*N,e[0]=(T-M)/N,e[1]=(P-g)/N,e[2]=(h-v)/N):p>k&&p>D?(N=Math.sqrt(1+p-k-D)*2,e[3]=(T-M)/N,e[0]=.25*N,e[1]=(h+v)/N,e[2]=(P+g)/N):k>D?(N=Math.sqrt(1+k-p-D)*2,e[3]=(P-g)/N,e[0]=(h+v)/N,e[1]=.25*N,e[2]=(T+M)/N):(N=Math.sqrt(1+D-p-k)*2,e[3]=(h-v)/N,e[0]=(P+g)/N,e[1]=(T+M)/N,e[2]=.25*N),e}})();function Qb(n,e,r,a){let o=Fa([n[0],n[1],n[2]]);const c=Fa([n[4],n[5],n[6]]),u=Fa([n[8],n[9],n[10]]);kv(n)<0&&(o=-o),r[0]=n[12],r[1]=n[13],r[2]=n[14];const h=n.slice(),g=1/o,v=1/c,k=1/u;h[0]*=g,h[1]*=g,h[2]*=g,h[4]*=v,h[5]*=v,h[6]*=v,h[8]*=k,h[9]*=k,h[10]*=k,Cv(e,h),a[0]=o,a[1]=c,a[2]=u}function Zb(n,e,r,a){const o=n,c=e[0],u=e[1],p=e[2],h=e[3],g=c+c,v=u+u,k=p+p,T=c*g,P=c*v,M=c*k,D=u*v,R=u*k,N=p*k,H=h*g,A=h*v,W=h*k,U=a[0],Z=a[1],ne=a[2];return o[0]=(1-(D+N))*U,o[1]=(P+W)*U,o[2]=(M-A)*U,o[3]=0,o[4]=(P-W)*Z,o[5]=(1-(T+N))*Z,o[6]=(R+H)*Z,o[7]=0,o[8]=(M+A)*ne,o[9]=(R-H)*ne,o[10]=(1-(T+D))*ne,o[11]=0,o[12]=r[0],o[13]=r[1],o[14]=r[2],o[15]=1,o}function Jb(n,e){let r=e[0],a=e[1],o=e[2],c=e[3],u=r+r,p=a+a,h=o+o,g=r*u,v=a*u,k=a*p,T=o*u,P=o*p,M=o*h,D=c*u,R=c*p,N=c*h;return n[0]=1-k-M,n[1]=v+N,n[2]=T-R,n[3]=0,n[4]=v-N,n[5]=1-g-M,n[6]=P+D,n[7]=0,n[8]=T+R,n[9]=P-D,n[10]=1-g-k,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function ex(n,e,r,a,o){let c=1/Math.tan(e/2),u=1/(a-o);return n[0]=c/r,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(o+a)*u,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*o*a*u,n[15]=0,n}function tx(n,e,r,a,o,c,u){let p=1/(e-r),h=1/(a-o),g=1/(c-u);return n[0]=-2*p,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*h,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*g,n[11]=0,n[12]=(e+r)*p,n[13]=(o+a)*h,n[14]=(u+c)*g,n[15]=1,n}function nx(n,e,r,a){let o=e[0],c=e[1],u=e[2],p=a[0],h=a[1],g=a[2],v=o-r[0],k=c-r[1],T=u-r[2],P=v*v+k*k+T*T;P===0?T=1:(P=1/Math.sqrt(P),v*=P,k*=P,T*=P);let M=h*T-g*k,D=g*v-p*T,R=p*k-h*v;return P=M*M+D*D+R*R,P===0&&(g?p+=1e-6:h?g+=1e-6:h+=1e-6,M=h*T-g*k,D=g*v-p*T,R=p*k-h*v,P=M*M+D*D+R*R),P=1/Math.sqrt(P),M*=P,D*=P,R*=P,n[0]=M,n[1]=D,n[2]=R,n[3]=0,n[4]=k*R-T*D,n[5]=T*M-v*R,n[6]=v*D-k*M,n[7]=0,n[8]=v,n[9]=k,n[10]=T,n[11]=0,n[12]=o,n[13]=c,n[14]=u,n[15]=1,n}function Em(n,e,r){return n[0]=e[0]+r[0],n[1]=e[1]+r[1],n[2]=e[2]+r[2],n[3]=e[3]+r[3],n[4]=e[4]+r[4],n[5]=e[5]+r[5],n[6]=e[6]+r[6],n[7]=e[7]+r[7],n[8]=e[8]+r[8],n[9]=e[9]+r[9],n[10]=e[10]+r[10],n[11]=e[11]+r[11],n[12]=e[12]+r[12],n[13]=e[13]+r[13],n[14]=e[14]+r[14],n[15]=e[15]+r[15],n}function Pm(n,e,r){return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],n[3]=e[3]-r[3],n[4]=e[4]-r[4],n[5]=e[5]-r[5],n[6]=e[6]-r[6],n[7]=e[7]-r[7],n[8]=e[8]-r[8],n[9]=e[9]-r[9],n[10]=e[10]-r[10],n[11]=e[11]-r[11],n[12]=e[12]-r[12],n[13]=e[13]-r[13],n[14]=e[14]-r[14],n[15]=e[15]-r[15],n}function ix(n,e,r){return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*r,n[9]=e[9]*r,n[10]=e[10]*r,n[11]=e[11]*r,n[12]=e[12]*r,n[13]=e[13]*r,n[14]=e[14]*r,n[15]=e[15]*r,n}class Sl extends Array{constructor(e=1,r=0,a=0,o=0,c=0,u=1,p=0,h=0,g=0,v=0,k=1,T=0,P=0,M=0,D=0,R=1){return super(e,r,a,o,c,u,p,h,g,v,k,T,P,M,D,R),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(e){this[12]=e}set y(e){this[13]=e}set z(e){this[14]=e}set w(e){this[15]=e}set(e,r,a,o,c,u,p,h,g,v,k,T,P,M,D,R){return e.length?this.copy(e):(jb(this,e,r,a,o,c,u,p,h,g,v,k,T,P,M,D,R),this)}translate(e,r=this){return $b(this,r,e),this}rotate(e,r,a=this){return Xb(this,a,e,r),this}scale(e,r=this){return Yb(this,r,typeof e=="number"?[e,e,e]:e),this}add(e,r){return r?Em(this,e,r):Em(this,this,e),this}sub(e,r){return r?Pm(this,e,r):Pm(this,this,e),this}multiply(e,r){return e.length?r?Tm(this,e,r):Tm(this,this,e):ix(this,this,e),this}identity(){return qb(this),this}copy(e){return Wb(this,e),this}fromPerspective({fov:e,aspect:r,near:a,far:o}={}){return ex(this,e,r,a,o),this}fromOrthogonal({left:e,right:r,bottom:a,top:o,near:c,far:u}){return tx(this,e,r,a,o,c,u),this}fromQuaternion(e){return Jb(this,e),this}setPosition(e){return this.x=e[0],this.y=e[1],this.z=e[2],this}inverse(e=this){return Hb(this,e),this}compose(e,r,a){return Zb(this,e,r,a),this}decompose(e,r,a){return Qb(this,e,r,a),this}getRotation(e){return Cv(e,this),this}getTranslation(e){return Gb(e,this),this}getScaling(e){return _v(e,this),this}getMaxScaleOnAxis(){return Kb(this)}lookAt(e,r,a){return nx(this,e,r,a),this}determinant(){return kv(this)}fromArray(e,r=0){return this[0]=e[r],this[1]=e[r+1],this[2]=e[r+2],this[3]=e[r+3],this[4]=e[r+4],this[5]=e[r+5],this[6]=e[r+6],this[7]=e[r+7],this[8]=e[r+8],this[9]=e[r+9],this[10]=e[r+10],this[11]=e[r+11],this[12]=e[r+12],this[13]=e[r+13],this[14]=e[r+14],this[15]=e[r+15],this}toArray(e=[],r=0){return e[r]=this[0],e[r+1]=this[1],e[r+2]=this[2],e[r+3]=this[3],e[r+4]=this[4],e[r+5]=this[5],e[r+6]=this[6],e[r+7]=this[7],e[r+8]=this[8],e[r+9]=this[9],e[r+10]=this[10],e[r+11]=this[11],e[r+12]=this[12],e[r+13]=this[13],e[r+14]=this[14],e[r+15]=this[15],e}}function rx(n,e,r="YXZ"){return r==="XYZ"?(n[1]=Math.asin(Math.min(Math.max(e[8],-1),1)),Math.abs(e[8])<.99999?(n[0]=Math.atan2(-e[9],e[10]),n[2]=Math.atan2(-e[4],e[0])):(n[0]=Math.atan2(e[6],e[5]),n[2]=0)):r==="YXZ"?(n[0]=Math.asin(-Math.min(Math.max(e[9],-1),1)),Math.abs(e[9])<.99999?(n[1]=Math.atan2(e[8],e[10]),n[2]=Math.atan2(e[1],e[5])):(n[1]=Math.atan2(-e[2],e[0]),n[2]=0)):r==="ZXY"?(n[0]=Math.asin(Math.min(Math.max(e[6],-1),1)),Math.abs(e[6])<.99999?(n[1]=Math.atan2(-e[2],e[10]),n[2]=Math.atan2(-e[4],e[5])):(n[1]=0,n[2]=Math.atan2(e[1],e[0]))):r==="ZYX"?(n[1]=Math.asin(-Math.min(Math.max(e[2],-1),1)),Math.abs(e[2])<.99999?(n[0]=Math.atan2(e[6],e[10]),n[2]=Math.atan2(e[1],e[0])):(n[0]=0,n[2]=Math.atan2(-e[4],e[5]))):r==="YZX"?(n[2]=Math.asin(Math.min(Math.max(e[1],-1),1)),Math.abs(e[1])<.99999?(n[0]=Math.atan2(-e[9],e[5]),n[1]=Math.atan2(-e[2],e[0])):(n[0]=0,n[1]=Math.atan2(e[8],e[10]))):r==="XZY"&&(n[2]=Math.asin(-Math.min(Math.max(e[4],-1),1)),Math.abs(e[4])<.99999?(n[0]=Math.atan2(e[6],e[5]),n[1]=Math.atan2(e[8],e[0])):(n[0]=Math.atan2(-e[9],e[10]),n[1]=0)),n}const Dm=new Sl;class sx extends Array{constructor(e=0,r=e,a=e,o="YXZ"){super(e,r,a),this.order=o,this.onChange=()=>{},this._target=this;const c=["0","1","2"];return new Proxy(this,{set(u,p){const h=Reflect.set(...arguments);return h&&c.includes(p)&&u.onChange(),h}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set(e,r=e,a=e){return e.length?this.copy(e):(this._target[0]=e,this._target[1]=r,this._target[2]=a,this.onChange(),this)}copy(e){return this._target[0]=e[0],this._target[1]=e[1],this._target[2]=e[2],this.onChange(),this}reorder(e){return this._target.order=e,this.onChange(),this}fromRotationMatrix(e,r=this.order){return rx(this._target,e,r),this.onChange(),this}fromQuaternion(e,r=this.order,a){return Dm.fromQuaternion(e),this._target.fromRotationMatrix(Dm,r),a||this.onChange(),this}fromArray(e,r=0){return this._target[0]=e[r],this._target[1]=e[r+1],this._target[2]=e[r+2],this}toArray(e=[],r=0){return e[r]=this[0],e[r+1]=this[1],e[r+2]=this[2],e}}class ax{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new Sl,this.worldMatrix=new Sl,this.matrixAutoUpdate=!0,this.worldMatrixNeedsUpdate=!1,this.position=new Si,this.quaternion=new Vb,this.scale=new Si(1),this.rotation=new sx,this.up=new Si(0,1,0),this.rotation._target.onChange=()=>this.quaternion.fromEuler(this.rotation,!0),this.quaternion._target.onChange=()=>this.rotation.fromQuaternion(this.quaternion,void 0,!0)}setParent(e,r=!0){this.parent&&e!==this.parent&&this.parent.removeChild(this,!1),this.parent=e,r&&e&&e.addChild(this,!1)}addChild(e,r=!0){~this.children.indexOf(e)||this.children.push(e),r&&e.setParent(this,!1)}removeChild(e,r=!0){~this.children.indexOf(e)&&this.children.splice(this.children.indexOf(e),1),r&&e.setParent(null,!1)}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||e)&&(this.parent===null?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,e=!0);for(let r=0,a=this.children.length;r<a;r++)this.children[r].updateMatrixWorld(e)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(e){if(!e(this))for(let r=0,a=this.children.length;r<a;r++)this.children[r].traverse(e)}decompose(){this.matrix.decompose(this.quaternion._target,this.position,this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(e,r=!1){r?this.matrix.lookAt(this.position,e,this.up):this.matrix.lookAt(e,this.position,this.up),this.matrix.getRotation(this.quaternion._target),this.rotation.fromQuaternion(this.quaternion)}}function ox(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n}function lx(n,e){let r=e[0],a=e[1],o=e[2],c=e[3],u=r+r,p=a+a,h=o+o,g=r*u,v=a*u,k=a*p,T=o*u,P=o*p,M=o*h,D=c*u,R=c*p,N=c*h;return n[0]=1-k-M,n[3]=v-N,n[6]=T+R,n[1]=v+N,n[4]=1-g-M,n[7]=P-D,n[2]=T-R,n[5]=P+D,n[8]=1-g-k,n}function cx(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function ux(n,e,r,a,o,c,u,p,h,g){return n[0]=e,n[1]=r,n[2]=a,n[3]=o,n[4]=c,n[5]=u,n[6]=p,n[7]=h,n[8]=g,n}function dx(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function fx(n,e){let r=e[0],a=e[1],o=e[2],c=e[3],u=e[4],p=e[5],h=e[6],g=e[7],v=e[8],k=v*u-p*g,T=-v*c+p*h,P=g*c-u*h,M=r*k+a*T+o*P;return M?(M=1/M,n[0]=k*M,n[1]=(-v*a+o*g)*M,n[2]=(p*a-o*u)*M,n[3]=T*M,n[4]=(v*r-o*h)*M,n[5]=(-p*r+o*c)*M,n[6]=P*M,n[7]=(-g*r+a*h)*M,n[8]=(u*r-a*c)*M,n):null}function Lm(n,e,r){let a=e[0],o=e[1],c=e[2],u=e[3],p=e[4],h=e[5],g=e[6],v=e[7],k=e[8],T=r[0],P=r[1],M=r[2],D=r[3],R=r[4],N=r[5],H=r[6],A=r[7],W=r[8];return n[0]=T*a+P*u+M*g,n[1]=T*o+P*p+M*v,n[2]=T*c+P*h+M*k,n[3]=D*a+R*u+N*g,n[4]=D*o+R*p+N*v,n[5]=D*c+R*h+N*k,n[6]=H*a+A*u+W*g,n[7]=H*o+A*p+W*v,n[8]=H*c+A*h+W*k,n}function px(n,e,r){let a=e[0],o=e[1],c=e[2],u=e[3],p=e[4],h=e[5],g=e[6],v=e[7],k=e[8],T=r[0],P=r[1];return n[0]=a,n[1]=o,n[2]=c,n[3]=u,n[4]=p,n[5]=h,n[6]=T*a+P*u+g,n[7]=T*o+P*p+v,n[8]=T*c+P*h+k,n}function hx(n,e,r){let a=e[0],o=e[1],c=e[2],u=e[3],p=e[4],h=e[5],g=e[6],v=e[7],k=e[8],T=Math.sin(r),P=Math.cos(r);return n[0]=P*a+T*u,n[1]=P*o+T*p,n[2]=P*c+T*h,n[3]=P*u-T*a,n[4]=P*p-T*o,n[5]=P*h-T*c,n[6]=g,n[7]=v,n[8]=k,n}function mx(n,e,r){let a=r[0],o=r[1];return n[0]=a*e[0],n[1]=a*e[1],n[2]=a*e[2],n[3]=o*e[3],n[4]=o*e[4],n[5]=o*e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}function gx(n,e){let r=e[0],a=e[1],o=e[2],c=e[3],u=e[4],p=e[5],h=e[6],g=e[7],v=e[8],k=e[9],T=e[10],P=e[11],M=e[12],D=e[13],R=e[14],N=e[15],H=r*p-a*u,A=r*h-o*u,W=r*g-c*u,U=a*h-o*p,Z=a*g-c*p,ne=o*g-c*h,ee=v*D-k*M,Q=v*R-T*M,ce=v*N-P*M,me=k*R-T*D,ve=k*N-P*D,ke=T*N-P*R,we=H*ke-A*ve+W*me+U*ce-Z*Q+ne*ee;return we?(we=1/we,n[0]=(p*ke-h*ve+g*me)*we,n[1]=(h*ce-u*ke-g*Q)*we,n[2]=(u*ve-p*ce+g*ee)*we,n[3]=(o*ve-a*ke-c*me)*we,n[4]=(r*ke-o*ce+c*Q)*we,n[5]=(a*ce-r*ve-c*ee)*we,n[6]=(D*ne-R*Z+N*U)*we,n[7]=(R*W-M*ne-N*A)*we,n[8]=(M*Z-D*W+N*H)*we,n):null}class vx extends Array{constructor(e=1,r=0,a=0,o=0,c=1,u=0,p=0,h=0,g=1){return super(e,r,a,o,c,u,p,h,g),this}set(e,r,a,o,c,u,p,h,g){return e.length?this.copy(e):(ux(this,e,r,a,o,c,u,p,h,g),this)}translate(e,r=this){return px(this,r,e),this}rotate(e,r=this){return hx(this,r,e),this}scale(e,r=this){return mx(this,r,e),this}multiply(e,r){return r?Lm(this,e,r):Lm(this,this,e),this}identity(){return dx(this),this}copy(e){return cx(this,e),this}fromMatrix4(e){return ox(this,e),this}fromQuaternion(e){return lx(this,e),this}fromBasis(e,r,a){return this.set(e[0],e[1],e[2],r[0],r[1],r[2],a[0],a[1],a[2]),this}inverse(e=this){return fx(this,e),this}getNormalMatrix(e){return gx(this,e),this}}let yx=0;class wx extends ax{constructor(e,{geometry:r,program:a,mode:o=e.TRIANGLES,frustumCulled:c=!0,renderOrder:u=0}={}){super(),e.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=e,this.id=yx++,this.geometry=r,this.program=a,this.mode=o,this.frustumCulled=c,this.renderOrder=u,this.modelViewMatrix=new Sl,this.normalMatrix=new vx,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(e){return this.beforeRenderCallbacks.push(e),this}onAfterRender(e){return this.afterRenderCallbacks.push(e),this}draw({camera:e}={}){e&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=e.projectionMatrix,this.program.uniforms.cameraPosition.value=e.worldPosition,this.program.uniforms.viewMatrix.value=e.viewMatrix,this.modelViewMatrix.multiply(e.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix),this.beforeRenderCallbacks.forEach(a=>a&&a({mesh:this,camera:e}));let r=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:r}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(a=>a&&a({mesh:this,camera:e}))}}const Mm={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#00ff00",blue:"#0000ff",fuchsia:"#ff00ff",cyan:"#00ffff",yellow:"#ffff00",orange:"#ff8000"};function Am(n){n.length===4&&(n=n[0]+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]);const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return e||console.warn(`Unable to convert hex string ${n} to rgb values`),[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255]}function bx(n){return n=parseInt(n),[(n>>16&255)/255,(n>>8&255)/255,(n&255)/255]}function Rm(n){return n===void 0?[0,0,0]:arguments.length===3?arguments:isNaN(n)?n[0]==="#"?Am(n):Mm[n.toLowerCase()]?Am(Mm[n.toLowerCase()]):(console.warn("Color format not recognised"),[0,0,0]):bx(n)}class Fm extends Array{constructor(e){return Array.isArray(e)?super(...e):super(...Rm(...arguments))}get r(){return this[0]}get g(){return this[1]}get b(){return this[2]}set r(e){this[0]=e}set g(e){this[1]=e}set b(e){this[2]=e}set(e){return Array.isArray(e)?this.copy(e):this.copy(Rm(...arguments))}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this}}class xx extends hb{constructor(e,{attributes:r={}}={}){Object.assign(r,{position:{size:2,data:new Float32Array([-1,-1,3,-1,-1,3])},uv:{size:2,data:new Float32Array([0,0,2,0,0,2])}}),super(e,r)}}const Sx=`
attribute vec2 position;
attribute vec2 uv;
varying vec2 vUv;
void main() {
  vUv = uv;
  gl_Position = vec4(position, 0.0, 1.0);
}
`,kx=`
precision highp float;

uniform float iTime;
uniform vec3 iResolution;
uniform vec3 uColor;
uniform float uAmplitude;
uniform float uDistance;
uniform vec2 uMouse;

#define PI 3.1415926538

uniform int u_line_count;
const float u_line_width = 7.0;
const float u_line_blur = 10.0;

float Perlin2D(vec2 P) {
    vec2 Pi = floor(P);
    vec4 Pf_Pfmin1 = P.xyxy - vec4(Pi, Pi + 1.0);
    vec4 Pt = vec4(Pi.xy, Pi.xy + 1.0);
    Pt = Pt - floor(Pt * (1.0 / 71.0)) * 71.0;
    Pt += vec2(26.0, 161.0).xyxy;
    Pt *= Pt;
    Pt = Pt.xzxz * Pt.yyww;
    vec4 hash_x = fract(Pt * (1.0 / 951.135664));
    vec4 hash_y = fract(Pt * (1.0 / 642.949883));
    vec4 grad_x = hash_x - 0.49999;
    vec4 grad_y = hash_y - 0.49999;
    vec4 grad_results = inversesqrt(grad_x * grad_x + grad_y * grad_y)
        * (grad_x * Pf_Pfmin1.xzxz + grad_y * Pf_Pfmin1.yyww);
    grad_results *= 1.4142135623730950;
    vec2 blend = Pf_Pfmin1.xy * Pf_Pfmin1.xy * Pf_Pfmin1.xy
               * (Pf_Pfmin1.xy * (Pf_Pfmin1.xy * 6.0 - 15.0) + 10.0);
    vec4 blend2 = vec4(blend, vec2(1.0 - blend));
    return dot(grad_results, blend2.zxzx * blend2.wwyy);
}

float pixel(float count, vec2 resolution) {
    return (1.0 / max(resolution.x, resolution.y)) * count;
}

float lineFn(vec2 st, float width, float perc, float offset, vec2 mouse, float time, float amplitude, float distance) {
    float split_offset = (perc * 0.4);
    float split_point = 0.1 + split_offset;

    float amplitude_normal = smoothstep(split_point, 0.7, st.x);
    float amplitude_strength = 0.5;
    float finalAmplitude = amplitude_normal * amplitude_strength
                           * amplitude * (1.0 + (mouse.y - 0.5) * 0.2);

    float time_scaled = time / 10.0 + (mouse.x - 0.5) * 1.0;
    float blur = smoothstep(split_point, split_point + 0.05, st.x) * perc;

    float xnoise = mix(
        Perlin2D(vec2(time_scaled, st.x + perc) * 2.5),
        Perlin2D(vec2(time_scaled, st.x + time_scaled) * 3.5) / 1.5,
        st.x * 0.3
    );

    float y = 0.5 + (perc - 0.5) * distance + xnoise / 2.0 * finalAmplitude;

    float line_start = smoothstep(
        y + (width / 2.0) + (u_line_blur * pixel(1.0, iResolution.xy) * blur),
        y,
        st.y
    );

    float line_end = smoothstep(
        y,
        y - (width / 2.0) - (u_line_blur * pixel(1.0, iResolution.xy) * blur),
        st.y
    );

    return clamp(
        (line_start - line_end) * (1.0 - smoothstep(0.0, 1.0, pow(perc, 0.3))),
        0.0,
        1.0
    );
}

void mainImage(out vec4 fragColor, in vec2 fragCoord) {
    vec2 uv = fragCoord / iResolution.xy;

    float line_strength = 1.0;
    for (int i = 0; i < 40; i++) {
        if (i >= u_line_count) break;
        float p = float(i) / float(u_line_count);
        line_strength *= (1.0 - lineFn(
            uv,
            u_line_width * pixel(1.0, iResolution.xy) * (1.0 - p),
            p,
            (PI * 1.0) * p,
            uMouse,
            iTime,
            uAmplitude,
            uDistance
        ));
    }

    float colorVal = 1.0 - line_strength;
    fragColor = vec4(uColor * colorVal, colorVal);
}

void main() {
    mainImage(gl_FragColor, gl_FragCoord.xy);
}
`;class _x{constructor(){this.frameTimes=[],this.maxSamples=60,this.lastTime=performance.now()}tick(){const e=performance.now(),r=e-this.lastTime;this.lastTime=e,this.frameTimes.push(r),this.frameTimes.length>this.maxSamples&&this.frameTimes.shift()}getAverageFPS(){if(this.frameTimes.length===0)return 60;const e=this.frameTimes.reduce((r,a)=>r+a,0)/this.frameTimes.length;return Math.round(1e3/e)}isPerformancePoor(){return this.getAverageFPS()<30}isPerformanceGood(){return this.getAverageFPS()>=50}}function Om(){const n=window.innerWidth;let e=1;n<480?e=.4:n<768?e=.55:n<1024?e=.7:n<1440&&(e=.85);let r=1;return n<480?r=.6:n<768?r=.75:n<1024&&(r=.85),{distanceScale:e,amplitudeScale:r}}function Cx(){const n="ontouchstart"in window||navigator.maxTouchPoints>0;return window.innerWidth>=1024&&!n}function Tx(n=null){const e=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)||window.innerWidth<768,r="ontouchstart"in window||navigator.maxTouchPoints>0,a=navigator.hardwareConcurrency||4,o=navigator.deviceMemory||4,c=n!==null?n:Cx();let u="high",p="";if(!e)try{const v=document.createElement("canvas").getContext("webgl",{powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0});if(v){const k=v.getExtension("WEBGL_debug_renderer_info");k&&(p=v.getParameter(k.UNMASKED_RENDERER_WEBGL).toLowerCase(),p.includes("intel")&&!p.includes("iris xe")&&(u="low"),["mx","max-q","mobile","laptop"].some(P=>p.includes(P))&&(u="mid")),v.getExtension("WEBGL_lose_context")?.loseContext()}}catch{u="low"}const h=r?.12:.06;return(a<4||o<4)&&u==="low"?(console.log("Threads: Ultra-low profile (15 lines)"),{lineCount:15,amplitude:.8,smoothing:h,quality:"ultra-low",isTouch:r,targetFPS:60}):a===4||u==="low"?(console.log("Threads: Low-end profile (20 lines)"),{lineCount:20,amplitude:1,smoothing:h,quality:"low",isTouch:r,targetFPS:60}):e?(console.log("Threads: Mobile profile (25 lines)"),{lineCount:25,amplitude:.8,smoothing:h,quality:"mobile",isTouch:r,targetFPS:60}):c||u==="mid"?(console.log("Threads: Laptop profile (28 lines, 45fps)"),{lineCount:28,amplitude:1.2,smoothing:.09,quality:"laptop",isTouch:r,targetFPS:45}):(console.log("Threads: High-end profile (40 lines)"),{lineCount:40,amplitude:1.5,smoothing:h,quality:"desktop",isTouch:r,targetFPS:60})}const Ex=({color:n=[1,1,1],amplitude:e=1,distance:r=0,enableMouseInteraction:a=!1,externalMouseRef:o=null,...c})=>{const u=se.useRef(null),p=se.useRef(),h=se.useRef(null),g=se.useRef(Tx()),v=se.useRef(new _x),k=se.useRef(g.current.lineCount),T=se.useRef(!0),P=se.useRef(Om());return se.useEffect(()=>{if(!u.current)return;const M=u.current,D=new xb({alpha:!0,antialias:!1,powerPreference:"high-performance",depth:!1,stencil:!1}),R=D.gl;R.clearColor(0,0,0,0),R.enable(R.BLEND),R.blendFunc(R.SRC_ALPHA,R.ONE_MINUS_SRC_ALPHA),R.disable(R.DEPTH_TEST),R.disable(R.CULL_FACE),M.appendChild(R.canvas);const N=new xx(R),H=e*g.current.amplitude*P.current.amplitudeScale,A=r*P.current.distanceScale,W=new gb(R,{vertex:Sx,fragment:kx,uniforms:{iTime:{value:0},iResolution:{value:new Fm(R.canvas.width,R.canvas.height,R.canvas.width/R.canvas.height)},uColor:{value:new Fm(...n)},uAmplitude:{value:H},uDistance:{value:A},uMouse:{value:new Float32Array([.5,.5])},u_line_count:{value:k.current}}});h.current=W;const U=new wx(R,{geometry:N,program:W});function Z(){const{clientWidth:S,clientHeight:C}=M,F=g.current.quality==="laptop"?.8:g.current.quality==="low"?.75:g.current.quality==="ultra-low"?.6:1,I=Math.floor(S*F),z=Math.floor(C*F);D.setSize(I,z),R.canvas.style.width=S+"px",R.canvas.style.height=C+"px",W.uniforms.iResolution.value.r=I,W.uniforms.iResolution.value.g=z,W.uniforms.iResolution.value.b=I/z,P.current=Om();const O=e*g.current.amplitude*P.current.amplitudeScale,q=r*P.current.distanceScale;W.uniforms.uAmplitude.value=O,W.uniforms.uDistance.value=q}let ne;const ee=()=>{clearTimeout(ne),ne=setTimeout(Z,150)};window.addEventListener("resize",ee),Z();const Q=new IntersectionObserver(S=>{T.current=S[0].isIntersecting,T.current&&!p.current&&(ke=performance.now(),p.current=requestAnimationFrame(E))},{threshold:.1});Q.observe(M);let ce=[.5,.5],me=[.5,.5],ve=[0,0],ke=performance.now(),we=0,d=0,y=0;const w=120,b=10,_=1e3/(g.current.targetFPS||60);function E(S){if(!T.current){p.current=null;return}if(S-we<_){p.current=requestAnimationFrame(E);return}if(we=S,ke=S,v.current.tick(),d++,d>=w&&(d=0,v.current.isPerformancePoor()&&k.current>10?(k.current=Math.max(10,k.current-5),W.uniforms.u_line_count.value=k.current,console.log(` Threads: Reduced to ${k.current} lines (low FPS)`)):v.current.isPerformanceGood()&&k.current<g.current.lineCount&&(k.current=Math.min(g.current.lineCount,k.current+3),W.uniforms.u_line_count.value=k.current,console.log(` Threads: Increased to ${k.current} lines (good FPS)`))),a&&o){const C=o.current.x,F=o.current.y,I=Math.abs(C-me[0]),z=Math.abs(F-me[1]);(I>.5||z>.5)&&y===0&&(y=b),me[0]=C,me[1]=F;let q=g.current.smoothing;if(y>0){const G=y/b;q=q*(.5+.5*(1-G)),y--}const V=me[0]-ce[0],X=me[1]-ce[1];ve[0]+=(V*.3-ve[0])*.4,ve[1]+=(X*.3-ve[1])*.4,ce[0]+=V*q+ve[0]*.15,ce[1]+=X*q+ve[1]*.15,ce[0]=Math.max(0,Math.min(1,ce[0])),ce[1]=Math.max(0,Math.min(1,ce[1])),W.uniforms.uMouse.value[0]=ce[0],W.uniforms.uMouse.value[1]=ce[1]}else ce[0]+=(.5-ce[0])*.02,ce[1]+=(.5-ce[1])*.02,ve=[0,0],y=0,W.uniforms.uMouse.value[0]=ce[0],W.uniforms.uMouse.value[1]=ce[1];W.uniforms.iTime.value=S*.001,D.render({scene:U}),p.current=requestAnimationFrame(E)}return()=>{p.current&&cancelAnimationFrame(p.current),window.removeEventListener("resize",ee),clearTimeout(ne),Q.disconnect(),M.contains(R.canvas)&&M.removeChild(R.canvas),R.getExtension("WEBGL_lose_context")?.loseContext()}},[n,e,r,a,o]),xe.jsx("div",{ref:u,className:"threads-container",...c})};function Px(){const n=se.useRef({x:.5,y:.5}),e=se.useRef(null),r=se.useRef(0),a=se.useRef({x:0,y:0}),o=se.useRef(!1),c=se.useRef({x:.5,y:.5});return se.useEffect(()=>{const u=document.getElementById("home");if(e.current=u,!u)return;if(window.mouseTracker){const T=u.getBoundingClientRect(),P=window.mouseTracker.position.x,M=window.mouseTracker.position.y;if(P>=T.left&&P<=T.right&&M>=T.top&&M<=T.bottom){o.current=!0;const D=window.mouseTracker.getNormalizedPosition(u);n.current=D,c.current=D,console.log(" Hero Threads: Mouse detected in section on load",D)}}const p=()=>{o.current=!0},h=()=>{o.current=!1,c.current={...n.current}},g=T=>{const P=Date.now(),M=P-r.current;if(r.current=P,T.touches.length>0){const D=T.touches[0],R=u.getBoundingClientRect(),N=(D.clientX-R.left)/R.width,H=(D.clientY-R.top)/R.height;M>0&&(a.current.x=(N-n.current.x)/M,a.current.y=(H-n.current.y)/M);const A={x:Math.max(0,Math.min(1,N)),y:Math.max(0,Math.min(1,H))};n.current=A,c.current=A}},v=()=>{a.current={x:0,y:0}};u.addEventListener("mouseenter",p),u.addEventListener("mouseleave",h),u.addEventListener("touchmove",g,{passive:!0}),u.addEventListener("touchend",v,{passive:!0}),u.addEventListener("touchcancel",v,{passive:!0});const k=window.mouseTracker.subscribe(T=>{if(o.current){const P=window.mouseTracker.getNormalizedPosition(u);n.current=P,c.current=P}});if(o.current&&window.mouseTracker){const T=window.mouseTracker.getNormalizedPosition(u);n.current=T,c.current=T}return()=>{u.removeEventListener("mouseenter",p),u.removeEventListener("mouseleave",h),u.removeEventListener("touchmove",g),u.removeEventListener("touchend",v),u.removeEventListener("touchcancel",v),typeof k=="function"&&k()}},[]),xe.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0,pointerEvents:"none",touchAction:"none",WebkitUserSelect:"none",userSelect:"none"},children:xe.jsx(Ex,{color:[.4,.6,1],amplitude:1,distance:.3,enableMouseInteraction:!0,externalMouseRef:n})})}const Nm=document.getElementById("hero-threads-root");Nm&&zd.createRoot(Nm).render(xe.jsx(Px,{}));const Im=(n,e,r)=>Math.min(Math.max(n,e),r),Dx=n=>((n+180)%360+360)%360-180;function Lx(n,e){const r=Array.from({length:e},(P,M)=>-28+M*2),a=[-3,-1,1,3],o=[-2,0,2,4],c=r.flatMap((P,M)=>(M%2===0?a:o).map(R=>({x:P,y:R,sizeX:2,sizeY:2})));if(n.length===0)return c.map(P=>({...P,preview:"",url:"",alt:"",type:"image"}));const u=n.map(P=>({preview:P.preview||P.src||"",url:P.url||P.src||"",alt:P.alt||"",type:P.type||"image"})),p=(P,M)=>{const D=P.x-M.x,R=P.y-M.y,H=Math.min(Math.abs(D),56-Math.abs(D));return Math.sqrt(H*H+R*R)},h=u.length,g=c.length,v=new Array(g).fill(null),k=new Array(h).fill(0),T=Math.ceil(g/h);for(let P=0;P<g;P++){let M=-1,D=-1/0;for(let R=0;R<h;R++){if(k[R]>=T)continue;const N=u[R],H=[];for(let U=0;U<P;U++)v[U]&&v[U].url===N.url&&H.push(U);let A;if(H.length===0)A=1e3;else{let U=1/0;H.forEach(Z=>{const ne=p(c[P],c[Z]);U=Math.min(U,ne)}),A=U}const W=(T-k[R])*.5;A+=W,A>D&&(D=A,M=R)}M===-1&&(M=P%h),v[P]=u[M],k[M]++}for(let P=0;P<v.length;P++)v[P]||(console.error("Empty position found at index:",P),v[P]=u[P%h]);return c.map((P,M)=>({...P,preview:v[M].preview,url:v[M].url,alt:v[M].alt,type:v[M].type}))}function Mx({images:n=[],fit:e=.6,minRadius:r=650,maxRadius:a=1e3,segments:o=28,maxVerticalRotationDeg:c=10,dragSensitivity:u=18,openedImageWidth:p="85vw",openedImageHeight:h="85vh",imageBorderRadius:g="12px",openedImageBorderRadius:v="20px",overlayBlurColor:k="#0a0a0a",grayscale:T=!1,pressHoldDuration:P=400,scrollThreshold:M=12}){const D=se.useRef(null),R=se.useRef(null),N=se.useRef(null),H=se.useRef(null),A=se.useRef(null),W=se.useRef({x:0,y:0}),U=se.useRef({x:0,y:0}),Z=se.useRef(null),ne=se.useRef(!1),ee=se.useRef(!1),Q=se.useRef(0),ce=se.useRef(!1),me=se.useRef(null),ve=se.useRef(null),ke=se.useRef(!1),we=se.useRef(null),d=se.useRef(0),y=se.useRef(!1),w=se.useRef(null),b=se.useMemo(()=>Lx(n,o),[n,o]),_=se.useCallback(()=>{try{if(window.navigator&&window.navigator.vibrate&&window.navigator.vibrate(10),window.AudioContext||window.webkitAudioContext){const j=new(window.AudioContext||window.webkitAudioContext),Y=j.createOscillator(),ie=j.createGain();Y.connect(ie),ie.connect(j.destination),Y.frequency.value=200,ie.gain.value=.1,Y.start(j.currentTime),Y.stop(j.currentTime+.01)}}catch{}},[]),E=se.useCallback(j=>{w.current||(w.current=requestAnimationFrame(()=>{if(w.current=null,!N.current)return;N.current.querySelectorAll(".item").forEach(ie=>{const le=(ie.getAttribute("style")||"").match(/--offset-x:\s*(-?\d+(?:\.\d+)?)/),pe=le?parseFloat(le[1]):0;let oe=360/o*(pe+.5)-j;for(;oe>180;)oe-=360;for(;oe<-180;)oe+=360;const be=Math.round(500+499*Math.cos(oe*Math.PI/180));ie.style.zIndex=Math.max(1,be)})}))},[o]),S=se.useCallback((j,Y)=>{N.current&&(N.current.style.transform=`translateZ(calc(var(--radius) * -1)) rotateX(${j}deg) rotateY(${Y}deg)`,E(Y))},[E]);se.useEffect(()=>{const j=D.current;if(!j)return;const Y=()=>{const ae=j.getBoundingClientRect(),le=Math.max(1,ae.width),pe=Math.max(1,ae.height);let oe=Math.min(le,pe)*e;oe=Im(oe,r,a),j.style.setProperty("--radius",`${Math.round(oe)}px`),j.style.setProperty("--segments-x",o),j.style.setProperty("--segments-y",o),j.style.setProperty("--tile-radius",g),j.style.setProperty("--enlarge-radius",v),j.style.setProperty("--overlay-blur-color",k),j.style.setProperty("--image-filter",T?"grayscale(1)":"none"),S(W.current.x,W.current.y)};Y();const ie=new ResizeObserver(Y);return ie.observe(j),()=>ie.disconnect()},[e,r,a,o,g,v,k,T,S]),se.useEffect(()=>{const j=setTimeout(()=>{E(0)},100);return()=>clearTimeout(j)},[E]);const C=se.useCallback((j,Y)=>{ne.current=!0,ee.current=!1,y.current=!0,U.current={...W.current},Z.current={x:j,y:Y}},[]),F=se.useCallback((j,Y)=>{if(!ne.current||!Z.current)return;const ie=j-Z.current.x,ae=Y-Z.current.y;!ee.current&&ie*ie+ae*ae>25&&(ee.current=!0);const le=Im(U.current.x-ae/u,-c,c),pe=Dx(U.current.y+ie/u);W.current={x:le,y:pe},S(le,pe)},[u,c,S]),I=se.useCallback(()=>{ne.current&&ee.current&&(Q.current=performance.now()),ne.current=!1,ee.current=!1,Z.current=null,setTimeout(()=>{y.current=!1},100)},[]);se.useEffect(()=>{const j=le=>{if(ne.current&&le.touches[0]){const pe=le.touches[0];F(pe.clientX,pe.clientY)}},Y=()=>{I()},ie=le=>{ne.current&&F(le.clientX,le.clientY)},ae=()=>{I()};return window.addEventListener("touchmove",j,{passive:!0}),window.addEventListener("touchend",Y),window.addEventListener("touchcancel",Y),window.addEventListener("mousemove",ie),window.addEventListener("mouseup",ae),()=>{window.removeEventListener("touchmove",j),window.removeEventListener("touchend",Y),window.removeEventListener("touchcancel",Y),window.removeEventListener("mousemove",ie),window.removeEventListener("mouseup",ae)}},[F,I]),se.useEffect(()=>{const j=R.current;if(!j)return;const Y=ae=>{ae.button===0&&C(ae.clientX,ae.clientY)},ie=ae=>{if(!ae.target.closest(".item__image")){const le=ae.touches[0];C(le.clientX,le.clientY)}};return j.addEventListener("mousedown",Y),j.addEventListener("touchstart",ie,{passive:!0}),()=>{j.removeEventListener("mousedown",Y),j.removeEventListener("touchstart",ie)}},[C]);const z=se.useCallback(j=>{if(ce.current)return;const Y=j.dataset.url,ie=j.dataset.type,ae=j.dataset.preview;ce.current=!0;const le=document.createElement("div");if(le.className="enlarge",le.style.cssText=`
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: ${p};
      height: ${h};
      max-width: 92vw;
      max-height: 92vh;
      z-index: 9999;
      border-radius: ${v};
      overflow: hidden;
      box-shadow: 0 25px 80px rgba(92, 92, 92, 0.24);
      background: #000000;
      pointer-events: auto;
    `,ie==="iframe"&&Y){const pe=document.createElement("iframe");pe.src=Y,pe.style.cssText="width:100%;height:100%;border:none;",pe.setAttribute("allowfullscreen",""),le.appendChild(pe)}else{const pe=document.createElement("img");pe.src=ae||Y,pe.style.cssText="width:100%;height:100%;object-fit:cover;",le.appendChild(pe)}le.addEventListener("wheel",pe=>{pe.stopPropagation()},{passive:!1}),H.current.appendChild(le),D.current?.setAttribute("data-enlarging","true"),_()},[p,h,v,_]),O=se.useCallback(j=>{const Y=j.touches[0],ie=j.currentTarget.parentElement;we.current={x:Y.clientX,y:Y.clientY},d.current=performance.now(),ve.current=ie,ke.current=!1,y.current=!1,me.current&&clearTimeout(me.current),me.current=setTimeout(()=>{ve.current&&!y.current&&(ke.current=!0,_())},P)},[_,P]),q=se.useCallback(j=>{if(y.current||!we.current)return;const Y=j.touches[0],ie=Y.clientX-we.current.x,ae=Y.clientY-we.current.y,le=ie*ie+ae*ae,pe=M*M;le>pe&&(y.current=!0,me.current&&(clearTimeout(me.current),me.current=null),ke.current=!1,ne.current||C(Y.clientX,Y.clientY))},[M,C]),V=se.useCallback(j=>{const Y=ve.current,ie=ke.current,ae=y.current;me.current&&(clearTimeout(me.current),me.current=null),ie&&!ae&&Y&&(j.preventDefault(),j.stopPropagation(),z(Y)),ve.current=null,we.current=null,d.current=0,ke.current=!1,y.current=!1},[z]),X=se.useCallback(()=>{me.current&&(clearTimeout(me.current),me.current=null),ve.current=null,we.current=null,d.current=0,ke.current=!1,y.current=!1},[]),G=se.useCallback(j=>{if("ontouchstart"in window||ne.current||ee.current||performance.now()-Q.current<100)return;const Y=j.currentTarget.parentElement;z(Y)},[z]);return se.useEffect(()=>()=>{me.current&&clearTimeout(me.current),w.current&&cancelAnimationFrame(w.current)},[]),se.useEffect(()=>{const j=()=>{const ae=H.current?.querySelector(".enlarge");ae&&ae.remove(),D.current?.removeAttribute("data-enlarging"),ce.current=!1},Y=A.current;if(Y&&(Y.addEventListener("click",j),Y.addEventListener("touchend",j),!("ontouchstart"in window))){const ae=le=>{le.preventDefault(),j()};return Y.addEventListener("wheel",ae,{passive:!1}),()=>{Y.removeEventListener("click",j),Y.removeEventListener("touchend",j),Y.removeEventListener("wheel",ae)}}const ie=ae=>{ae.key==="Escape"&&j()};return window.addEventListener("keydown",ie),()=>{Y&&(Y.removeEventListener("click",j),Y.removeEventListener("touchend",j)),window.removeEventListener("keydown",ie)}},[]),xe.jsx("div",{ref:D,className:"sphere-root",children:xe.jsxs("main",{ref:R,className:"sphere-main",children:[xe.jsx("div",{className:"stage",children:xe.jsx("div",{ref:N,className:"sphere",children:b.map((j,Y)=>xe.jsx("div",{className:"item","data-preview":j.preview,"data-url":j.url,"data-type":j.type,style:{"--offset-x":j.x,"--offset-y":j.y,"--item-size-x":j.sizeX,"--item-size-y":j.sizeY},children:xe.jsx("div",{className:"item__image","data-interactive":"true",role:"button",tabIndex:0,onClick:G,onTouchStart:O,onTouchMove:q,onTouchEnd:V,onTouchCancel:X,onKeyDown:ie=>{(ie.key==="Enter"||ie.key===" ")&&(ie.preventDefault(),G(ie))},children:xe.jsx("img",{src:j.preview,draggable:!1,alt:j.alt,loading:"lazy"})})},`${j.x},${j.y},${Y}`))})}),xe.jsx("div",{className:"viewer",ref:H,children:xe.jsx("div",{ref:A,className:"scrim"})})]})})}const ri="./",Ax=[{preview:`${ri}images/logo.png`,url:"https://vistafly.services/",alt:"VistaFly Services - FPV drone videography",type:"iframe"},{preview:`${ri}images/logo1.png`,url:"https://vistafly.github.io/CSAnew/",alt:"CSA Entertainment - Sports & Music Programs",type:"iframe"},{preview:`${ri}images/logo2.png`,url:"https://themorenosband.com/",alt:"The Morenos Band - Official Music Website",type:"iframe"},{preview:`${ri}images/logo3.png`,url:"https://cultivanetwork.com/",alt:"CultivaNetwork - Agricultural Platform",type:"iframe"},{preview:`${ri}images/logo5.png`,url:"https://vistafly.github.io/thebox/",alt:"The Box - Creative Digital Project",type:"iframe"},{preview:`${ri}images/logo6.png`,url:"https://vistafly.github.io/landscapingcultura/",alt:"Landscaping Cultura - Professional Landscaping",type:"iframe"},{preview:`${ri}images/logo7.png`,url:"https://vistafly.github.io/sproutscloth/",alt:"Sprouts Clothing - Sustainable Fashion",type:"iframe"},{preview:`${ri}images/logo8.png`,url:"https://agstounding.com/",alt:"Agstounding - Professional Services",type:"iframe"},{preview:`${ri}images/logo9.png`,url:"https://eltacochingonllc.vercel.app/",alt:"El Taco Chingon - Authentic Mexican Street Food in Fresno, CA",type:"iframe"},{preview:`${ri}images/logo10.png`,url:"https://handyman-sam.vercel.app/",alt:"Handyman Sam - Professional Handyman Services in Fresno, CA",type:"iframe"},{preview:`${ri}images/logo11.png`,url:"https://vistafly.github.io/vistafly-studyguide/",alt:"VistaFly Academy - Drone Pilot Training Portal",type:"iframe"},{preview:`${ri}images/logo12.png`,url:"https://vistafly.github.io/Part-107studyguide/",alt:"Part 107 Study Guide - FAA Drone Certification Prep",type:"iframe"}];function Rx(){const[n,e]=se.useState({minRadius:1100,maxRadius:1300,fit:1,maxVerticalRotationDeg:2,dragSensitivity:18,segments:30,openedImageWidth:"70vw",openedImageHeight:"70vh",imageBorderRadius:"40px",openedImageBorderRadius:"20px"});return se.useEffect(()=>{const r=()=>{const a=window.innerWidth;a<=430?e({minRadius:500,maxRadius:650,fit:.9,maxVerticalRotationDeg:1.5,dragSensitivity:16,segments:20,openedImageWidth:"85vw",openedImageHeight:"78vh",imageBorderRadius:"20px",openedImageBorderRadius:"12px"}):a<=768?e({minRadius:700,maxRadius:700,fit:.95,maxVerticalRotationDeg:1.8,dragSensitivity:17,segments:25,openedImageWidth:"90vw",openedImageHeight:"80vh",imageBorderRadius:"30px",openedImageBorderRadius:"15px"}):a<=1024?e({minRadius:1e3,maxRadius:1200,fit:.98,maxVerticalRotationDeg:2,dragSensitivity:19,segments:28,openedImageWidth:"90vw",openedImageHeight:"80vh",imageBorderRadius:"35px",openedImageBorderRadius:"18px"}):e({minRadius:1e3,maxRadius:1200,fit:1,maxVerticalRotationDeg:2,dragSensitivity:18,segments:30,openedImageWidth:"85vw",openedImageHeight:"80vh",imageBorderRadius:"40px",openedImageBorderRadius:"20px"})};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),xe.jsx(Mx,{images:Ax,minRadius:n.minRadius,maxRadius:n.maxRadius,fit:n.fit,maxVerticalRotationDeg:n.maxVerticalRotationDeg,dragSensitivity:n.dragSensitivity,segments:n.segments,openedImageWidth:n.openedImageWidth,openedImageHeight:n.openedImageHeight,imageBorderRadius:n.imageBorderRadius,openedImageBorderRadius:n.openedImageBorderRadius,overlayBlurColor:"#0a0a0a",grayscale:!1})}const Fx=zd.createRoot(document.getElementById("portfolio-dome-root"));Fx.render(xe.jsx(bv.StrictMode,{children:xe.jsx(Rx,{})}));function Wi(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Tv(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}var Gn={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Bs={duration:.5,overwrite:!1,delay:0},Vd,cn,xt,oi=1e8,ft=1/oi,td=Math.PI*2,Ox=td/4,Nx=0,Ev=Math.sqrt,Ix=Math.cos,Bx=Math.sin,tn=function(e){return typeof e=="string"},Rt=function(e){return typeof e=="function"},qi=function(e){return typeof e=="number"},Ud=function(e){return typeof e>"u"},Ai=function(e){return typeof e=="object"},Fn=function(e){return e!==!1},Wd=function(){return typeof window<"u"},dl=function(e){return Rt(e)||tn(e)},Pv=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},yn=Array.isArray,nd=/(?:-?\.?\d|\.)+/gi,Dv=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Es=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Lu=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Lv=/[+-]=-?[.\d]+/,Mv=/[^,'"\[\]\s]+/gi,zx=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Et,Ei,id,jd,Kn={},kl={},Av,Rv=function(e){return(kl=zs(e,Kn))&&Bn},qd=function(e,r){return console.warn("Invalid property",e,"set to",r,"Missing plugin? gsap.registerPlugin()")},Wa=function(e,r){return!r&&console.warn(e)},Fv=function(e,r){return e&&(Kn[e]=r)&&kl&&(kl[e]=r)||Kn},ja=function(){return 0},Vx={suppressEvents:!0,isStart:!0,kill:!1},ml={suppressEvents:!0,kill:!1},Ux={suppressEvents:!0},Hd={},yr=[],rd={},Ov,$n={},Mu={},Bm=30,gl=[],$d="",Yd=function(e){var r=e[0],a,o;if(Ai(r)||Rt(r)||(e=[e]),!(a=(r._gsap||{}).harness)){for(o=gl.length;o--&&!gl[o].targetTest(r););a=gl[o]}for(o=e.length;o--;)e[o]&&(e[o]._gsap||(e[o]._gsap=new sy(e[o],a)))||e.splice(o,1);return e},Xr=function(e){return e._gsap||Yd(li(e))[0]._gsap},Nv=function(e,r,a){return(a=e[r])&&Rt(a)?e[r]():Ud(a)&&e.getAttribute&&e.getAttribute(r)||a},On=function(e,r){return(e=e.split(",")).forEach(r)||e},Bt=function(e){return Math.round(e*1e5)/1e5||0},jt=function(e){return Math.round(e*1e7)/1e7||0},Fs=function(e,r){var a=r.charAt(0),o=parseFloat(r.substr(2));return e=parseFloat(e),a==="+"?e+o:a==="-"?e-o:a==="*"?e*o:e/o},Wx=function(e,r){for(var a=r.length,o=0;e.indexOf(r[o])<0&&++o<a;);return o<a},_l=function(){var e=yr.length,r=yr.slice(0),a,o;for(rd={},yr.length=0,a=0;a<e;a++)o=r[a],o&&o._lazy&&(o.render(o._lazy[0],o._lazy[1],!0)._lazy=0)},Xd=function(e){return!!(e._initted||e._startAt||e.add)},Iv=function(e,r,a,o){yr.length&&!cn&&_l(),e.render(r,a,!!(cn&&r<0&&Xd(e))),yr.length&&!cn&&_l()},Bv=function(e){var r=parseFloat(e);return(r||r===0)&&(e+"").match(Mv).length<2?r:tn(e)?e.trim():e},zv=function(e){return e},Qn=function(e,r){for(var a in r)a in e||(e[a]=r[a]);return e},jx=function(e){return function(r,a){for(var o in a)o in r||o==="duration"&&e||o==="ease"||(r[o]=a[o])}},zs=function(e,r){for(var a in r)e[a]=r[a];return e},zm=function n(e,r){for(var a in r)a!=="__proto__"&&a!=="constructor"&&a!=="prototype"&&(e[a]=Ai(r[a])?n(e[a]||(e[a]={}),r[a]):r[a]);return e},Cl=function(e,r){var a={},o;for(o in e)o in r||(a[o]=e[o]);return a},Oa=function(e){var r=e.parent||Et,a=e.keyframes?jx(yn(e.keyframes)):Qn;if(Fn(e.inherit))for(;r;)a(e,r.vars.defaults),r=r.parent||r._dp;return e},qx=function(e,r){for(var a=e.length,o=a===r.length;o&&a--&&e[a]===r[a];);return a<0},Vv=function(e,r,a,o,c){var u=e[o],p;if(c)for(p=r[c];u&&u[c]>p;)u=u._prev;return u?(r._next=u._next,u._next=r):(r._next=e[a],e[a]=r),r._next?r._next._prev=r:e[o]=r,r._prev=u,r.parent=r._dp=e,r},Nl=function(e,r,a,o){a===void 0&&(a="_first"),o===void 0&&(o="_last");var c=r._prev,u=r._next;c?c._next=u:e[a]===r&&(e[a]=u),u?u._prev=c:e[o]===r&&(e[o]=c),r._next=r._prev=r.parent=null},br=function(e,r){e.parent&&(!r||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},Gr=function(e,r){if(e&&(!r||r._end>e._dur||r._start<0))for(var a=e;a;)a._dirty=1,a=a.parent;return e},Hx=function(e){for(var r=e.parent;r&&r.parent;)r._dirty=1,r.totalDuration(),r=r.parent;return e},sd=function(e,r,a,o){return e._startAt&&(cn?e._startAt.revert(ml):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(r,!0,o))},$x=function n(e){return!e||e._ts&&n(e.parent)},Vm=function(e){return e._repeat?Vs(e._tTime,e=e.duration()+e._rDelay)*e:0},Vs=function(e,r){var a=Math.floor(e=jt(e/r));return e&&a===e?a-1:a},Tl=function(e,r){return(e-r._start)*r._ts+(r._ts>=0?0:r._dirty?r.totalDuration():r._tDur)},Il=function(e){return e._end=jt(e._start+(e._tDur/Math.abs(e._ts||e._rts||ft)||0))},Bl=function(e,r){var a=e._dp;return a&&a.smoothChildTiming&&e._ts&&(e._start=jt(a._time-(e._ts>0?r/e._ts:((e._dirty?e.totalDuration():e._tDur)-r)/-e._ts)),Il(e),a._dirty||Gr(a,e)),e},Uv=function(e,r){var a;if((r._time||!r._dur&&r._initted||r._start<e._time&&(r._dur||!r.add))&&(a=Tl(e.rawTime(),r),(!r._dur||to(0,r.totalDuration(),a)-r._tTime>ft)&&r.render(a,!0)),Gr(e,r)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(a=e;a._dp;)a.rawTime()>=0&&a.totalTime(a._tTime),a=a._dp;e._zTime=-ft}},Pi=function(e,r,a,o){return r.parent&&br(r),r._start=jt((qi(a)?a:a||e!==Et?si(e,a,r):e._time)+r._delay),r._end=jt(r._start+(r.totalDuration()/Math.abs(r.timeScale())||0)),Vv(e,r,"_first","_last",e._sort?"_start":0),ad(r)||(e._recent=r),o||Uv(e,r),e._ts<0&&Bl(e,e._tTime),e},Wv=function(e,r){return(Kn.ScrollTrigger||qd("scrollTrigger",r))&&Kn.ScrollTrigger.create(r,e)},jv=function(e,r,a,o,c){if(Kd(e,r,c),!e._initted)return 1;if(!a&&e._pt&&!cn&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&Ov!==Yn.frame)return yr.push(e),e._lazy=[c,o],1},Yx=function n(e){var r=e.parent;return r&&r._ts&&r._initted&&!r._lock&&(r.rawTime()<0||n(r))},ad=function(e){var r=e.data;return r==="isFromStart"||r==="isStart"},Xx=function(e,r,a,o){var c=e.ratio,u=r<0||!r&&(!e._start&&Yx(e)&&!(!e._initted&&ad(e))||(e._ts<0||e._dp._ts<0)&&!ad(e))?0:1,p=e._rDelay,h=0,g,v,k;if(p&&e._repeat&&(h=to(0,e._tDur,r),v=Vs(h,p),e._yoyo&&v&1&&(u=1-u),v!==Vs(e._tTime,p)&&(c=1-u,e.vars.repeatRefresh&&e._initted&&e.invalidate())),u!==c||cn||o||e._zTime===ft||!r&&e._zTime){if(!e._initted&&jv(e,r,o,a,h))return;for(k=e._zTime,e._zTime=r||(a?ft:0),a||(a=r&&!k),e.ratio=u,e._from&&(u=1-u),e._time=0,e._tTime=h,g=e._pt;g;)g.r(u,g.d),g=g._next;r<0&&sd(e,r,a,!0),e._onUpdate&&!a&&Xn(e,"onUpdate"),h&&e._repeat&&!a&&e.parent&&Xn(e,"onRepeat"),(r>=e._tDur||r<0)&&e.ratio===u&&(u&&br(e,1),!a&&!cn&&(Xn(e,u?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=r)},Gx=function(e,r,a){var o;if(a>r)for(o=e._first;o&&o._start<=a;){if(o.data==="isPause"&&o._start>r)return o;o=o._next}else for(o=e._last;o&&o._start>=a;){if(o.data==="isPause"&&o._start<r)return o;o=o._prev}},Us=function(e,r,a,o){var c=e._repeat,u=jt(r)||0,p=e._tTime/e._tDur;return p&&!o&&(e._time*=u/e._dur),e._dur=u,e._tDur=c?c<0?1e10:jt(u*(c+1)+e._rDelay*c):u,p>0&&!o&&Bl(e,e._tTime=e._tDur*p),e.parent&&Il(e),a||Gr(e.parent,e),e},Um=function(e){return e instanceof kn?Gr(e):Us(e,e._dur)},Kx={_start:0,endTime:ja,totalDuration:ja},si=function n(e,r,a){var o=e.labels,c=e._recent||Kx,u=e.duration()>=oi?c.endTime(!1):e._dur,p,h,g;return tn(r)&&(isNaN(r)||r in o)?(h=r.charAt(0),g=r.substr(-1)==="%",p=r.indexOf("="),h==="<"||h===">"?(p>=0&&(r=r.replace(/=/,"")),(h==="<"?c._start:c.endTime(c._repeat>=0))+(parseFloat(r.substr(1))||0)*(g?(p<0?c:a).totalDuration()/100:1)):p<0?(r in o||(o[r]=u),o[r]):(h=parseFloat(r.charAt(p-1)+r.substr(p+1)),g&&a&&(h=h/100*(yn(a)?a[0]:a).totalDuration()),p>1?n(e,r.substr(0,p-1),a)+h:u+h)):r==null?u:+r},Na=function(e,r,a){var o=qi(r[1]),c=(o?2:1)+(e<2?0:1),u=r[c],p,h;if(o&&(u.duration=r[1]),u.parent=a,e){for(p=u,h=a;h&&!("immediateRender"in p);)p=h.vars.defaults||{},h=Fn(h.vars.inherit)&&h.parent;u.immediateRender=Fn(p.immediateRender),e<2?u.runBackwards=1:u.startAt=r[c-1]}return new Wt(r[0],u,r[c+1])},_r=function(e,r){return e||e===0?r(e):r},to=function(e,r,a){return a<e?e:a>r?r:a},gn=function(e,r){return!tn(e)||!(r=zx.exec(e))?"":r[1]},Qx=function(e,r,a){return _r(a,function(o){return to(e,r,o)})},od=[].slice,qv=function(e,r){return e&&Ai(e)&&"length"in e&&(!r&&!e.length||e.length-1 in e&&Ai(e[0]))&&!e.nodeType&&e!==Ei},Zx=function(e,r,a){return a===void 0&&(a=[]),e.forEach(function(o){var c;return tn(o)&&!r||qv(o,1)?(c=a).push.apply(c,li(o)):a.push(o)})||a},li=function(e,r,a){return xt&&!r&&xt.selector?xt.selector(e):tn(e)&&!a&&(id||!Ws())?od.call((r||jd).querySelectorAll(e),0):yn(e)?Zx(e,a):qv(e)?od.call(e,0):e?[e]:[]},ld=function(e){return e=li(e)[0]||Wa("Invalid scope")||{},function(r){var a=e.current||e.nativeElement||e;return li(r,a.querySelectorAll?a:a===e?Wa("Invalid scope")||jd.createElement("div"):e)}},Hv=function(e){return e.sort(function(){return .5-Math.random()})},$v=function(e){if(Rt(e))return e;var r=Ai(e)?e:{each:e},a=Kr(r.ease),o=r.from||0,c=parseFloat(r.base)||0,u={},p=o>0&&o<1,h=isNaN(o)||p,g=r.axis,v=o,k=o;return tn(o)?v=k={center:.5,edges:.5,end:1}[o]||0:!p&&h&&(v=o[0],k=o[1]),function(T,P,M){var D=(M||r).length,R=u[D],N,H,A,W,U,Z,ne,ee,Q;if(!R){if(Q=r.grid==="auto"?0:(r.grid||[1,oi])[1],!Q){for(ne=-oi;ne<(ne=M[Q++].getBoundingClientRect().left)&&Q<D;);Q<D&&Q--}for(R=u[D]=[],N=h?Math.min(Q,D)*v-.5:o%Q,H=Q===oi?0:h?D*k/Q-.5:o/Q|0,ne=0,ee=oi,Z=0;Z<D;Z++)A=Z%Q-N,W=H-(Z/Q|0),R[Z]=U=g?Math.abs(g==="y"?W:A):Ev(A*A+W*W),U>ne&&(ne=U),U<ee&&(ee=U);o==="random"&&Hv(R),R.max=ne-ee,R.min=ee,R.v=D=(parseFloat(r.amount)||parseFloat(r.each)*(Q>D?D-1:g?g==="y"?D/Q:Q:Math.max(Q,D/Q))||0)*(o==="edges"?-1:1),R.b=D<0?c-D:c,R.u=gn(r.amount||r.each)||0,a=a&&D<0?ny(a):a}return D=(R[T]-R.min)/R.max||0,jt(R.b+(a?a(D):D)*R.v)+R.u}},cd=function(e){var r=Math.pow(10,((e+"").split(".")[1]||"").length);return function(a){var o=jt(Math.round(parseFloat(a)/e)*e*r);return(o-o%1)/r+(qi(a)?0:gn(a))}},Yv=function(e,r){var a=yn(e),o,c;return!a&&Ai(e)&&(o=a=e.radius||oi,e.values?(e=li(e.values),(c=!qi(e[0]))&&(o*=o)):e=cd(e.increment)),_r(r,a?Rt(e)?function(u){return c=e(u),Math.abs(c-u)<=o?c:u}:function(u){for(var p=parseFloat(c?u.x:u),h=parseFloat(c?u.y:0),g=oi,v=0,k=e.length,T,P;k--;)c?(T=e[k].x-p,P=e[k].y-h,T=T*T+P*P):T=Math.abs(e[k]-p),T<g&&(g=T,v=k);return v=!o||g<=o?e[v]:u,c||v===u||qi(u)?v:v+gn(u)}:cd(e))},Xv=function(e,r,a,o){return _r(yn(e)?!r:a===!0?!!(a=0):!o,function(){return yn(e)?e[~~(Math.random()*e.length)]:(a=a||1e-5)&&(o=a<1?Math.pow(10,(a+"").length-2):1)&&Math.floor(Math.round((e-a/2+Math.random()*(r-e+a*.99))/a)*a*o)/o})},Jx=function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return function(o){return r.reduce(function(c,u){return u(c)},o)}},eS=function(e,r){return function(a){return e(parseFloat(a))+(r||gn(a))}},tS=function(e,r,a){return Kv(e,r,0,1,a)},Gv=function(e,r,a){return _r(a,function(o){return e[~~r(o)]})},nS=function n(e,r,a){var o=r-e;return yn(e)?Gv(e,n(0,e.length),r):_r(a,function(c){return(o+(c-e)%o)%o+e})},iS=function n(e,r,a){var o=r-e,c=o*2;return yn(e)?Gv(e,n(0,e.length-1),r):_r(a,function(u){return u=(c+(u-e)%c)%c||0,e+(u>o?c-u:u)})},qa=function(e){for(var r=0,a="",o,c,u,p;~(o=e.indexOf("random(",r));)u=e.indexOf(")",o),p=e.charAt(o+7)==="[",c=e.substr(o+7,u-o-7).match(p?Mv:nd),a+=e.substr(r,o-r)+Xv(p?c:+c[0],p?0:+c[1],+c[2]||1e-5),r=u+1;return a+e.substr(r,e.length-r)},Kv=function(e,r,a,o,c){var u=r-e,p=o-a;return _r(c,function(h){return a+((h-e)/u*p||0)})},rS=function n(e,r,a,o){var c=isNaN(e+r)?0:function(P){return(1-P)*e+P*r};if(!c){var u=tn(e),p={},h,g,v,k,T;if(a===!0&&(o=1)&&(a=null),u)e={p:e},r={p:r};else if(yn(e)&&!yn(r)){for(v=[],k=e.length,T=k-2,g=1;g<k;g++)v.push(n(e[g-1],e[g]));k--,c=function(M){M*=k;var D=Math.min(T,~~M);return v[D](M-D)},a=r}else o||(e=zs(yn(e)?[]:{},e));if(!v){for(h in r)Gd.call(p,e,h,"get",r[h]);c=function(M){return Jd(M,p)||(u?e.p:e)}}}return _r(a,c)},Wm=function(e,r,a){var o=e.labels,c=oi,u,p,h;for(u in o)p=o[u]-r,p<0==!!a&&p&&c>(p=Math.abs(p))&&(h=u,c=p);return h},Xn=function(e,r,a){var o=e.vars,c=o[r],u=xt,p=e._ctx,h,g,v;if(c)return h=o[r+"Params"],g=o.callbackScope||e,a&&yr.length&&_l(),p&&(xt=p),v=h?c.apply(g,h):c.call(g),xt=u,v},Ma=function(e){return br(e),e.scrollTrigger&&e.scrollTrigger.kill(!!cn),e.progress()<1&&Xn(e,"onInterrupt"),e},Ps,Qv=[],Zv=function(e){if(e)if(e=!e.name&&e.default||e,Wd()||e.headless){var r=e.name,a=Rt(e),o=r&&!a&&e.init?function(){this._props=[]}:e,c={init:ja,render:Jd,add:Gd,kill:bS,modifier:wS,rawVars:0},u={targetTest:0,get:0,getSetter:Zd,aliases:{},register:0};if(Ws(),e!==o){if($n[r])return;Qn(o,Qn(Cl(e,c),u)),zs(o.prototype,zs(c,Cl(e,u))),$n[o.prop=r]=o,e.targetTest&&(gl.push(o),Hd[r]=1),r=(r==="css"?"CSS":r.charAt(0).toUpperCase()+r.substr(1))+"Plugin"}Fv(r,o),e.register&&e.register(Bn,o,Nn)}else Qv.push(e)},dt=255,Aa={aqua:[0,dt,dt],lime:[0,dt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,dt],navy:[0,0,128],white:[dt,dt,dt],olive:[128,128,0],yellow:[dt,dt,0],orange:[dt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[dt,0,0],pink:[dt,192,203],cyan:[0,dt,dt],transparent:[dt,dt,dt,0]},Au=function(e,r,a){return e+=e<0?1:e>1?-1:0,(e*6<1?r+(a-r)*e*6:e<.5?a:e*3<2?r+(a-r)*(2/3-e)*6:r)*dt+.5|0},Jv=function(e,r,a){var o=e?qi(e)?[e>>16,e>>8&dt,e&dt]:0:Aa.black,c,u,p,h,g,v,k,T,P,M;if(!o){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Aa[e])o=Aa[e];else if(e.charAt(0)==="#"){if(e.length<6&&(c=e.charAt(1),u=e.charAt(2),p=e.charAt(3),e="#"+c+c+u+u+p+p+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return o=parseInt(e.substr(1,6),16),[o>>16,o>>8&dt,o&dt,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),o=[e>>16,e>>8&dt,e&dt]}else if(e.substr(0,3)==="hsl"){if(o=M=e.match(nd),!r)h=+o[0]%360/360,g=+o[1]/100,v=+o[2]/100,u=v<=.5?v*(g+1):v+g-v*g,c=v*2-u,o.length>3&&(o[3]*=1),o[0]=Au(h+1/3,c,u),o[1]=Au(h,c,u),o[2]=Au(h-1/3,c,u);else if(~e.indexOf("="))return o=e.match(Dv),a&&o.length<4&&(o[3]=1),o}else o=e.match(nd)||Aa.transparent;o=o.map(Number)}return r&&!M&&(c=o[0]/dt,u=o[1]/dt,p=o[2]/dt,k=Math.max(c,u,p),T=Math.min(c,u,p),v=(k+T)/2,k===T?h=g=0:(P=k-T,g=v>.5?P/(2-k-T):P/(k+T),h=k===c?(u-p)/P+(u<p?6:0):k===u?(p-c)/P+2:(c-u)/P+4,h*=60),o[0]=~~(h+.5),o[1]=~~(g*100+.5),o[2]=~~(v*100+.5)),a&&o.length<4&&(o[3]=1),o},ey=function(e){var r=[],a=[],o=-1;return e.split(wr).forEach(function(c){var u=c.match(Es)||[];r.push.apply(r,u),a.push(o+=u.length+1)}),r.c=a,r},jm=function(e,r,a){var o="",c=(e+o).match(wr),u=r?"hsla(":"rgba(",p=0,h,g,v,k;if(!c)return e;if(c=c.map(function(T){return(T=Jv(T,r,1))&&u+(r?T[0]+","+T[1]+"%,"+T[2]+"%,"+T[3]:T.join(","))+")"}),a&&(v=ey(e),h=a.c,h.join(o)!==v.c.join(o)))for(g=e.replace(wr,"1").split(Es),k=g.length-1;p<k;p++)o+=g[p]+(~h.indexOf(p)?c.shift()||u+"0,0,0,0)":(v.length?v:c.length?c:a).shift());if(!g)for(g=e.split(wr),k=g.length-1;p<k;p++)o+=g[p]+c[p];return o+g[k]},wr=(function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Aa)n+="|"+e+"\\b";return new RegExp(n+")","gi")})(),sS=/hsl[a]?\(/,ty=function(e){var r=e.join(" "),a;if(wr.lastIndex=0,wr.test(r))return a=sS.test(r),e[1]=jm(e[1],a),e[0]=jm(e[0],a,ey(e[1])),!0},Ha,Yn=(function(){var n=Date.now,e=500,r=33,a=n(),o=a,c=1e3/240,u=c,p=[],h,g,v,k,T,P,M=function D(R){var N=n()-o,H=R===!0,A,W,U,Z;if((N>e||N<0)&&(a+=N-r),o+=N,U=o-a,A=U-u,(A>0||H)&&(Z=++k.frame,T=U-k.time*1e3,k.time=U=U/1e3,u+=A+(A>=c?4:c-A),W=1),H||(h=g(D)),W)for(P=0;P<p.length;P++)p[P](U,T,Z,R)};return k={time:0,frame:0,tick:function(){M(!0)},deltaRatio:function(R){return T/(1e3/(R||60))},wake:function(){Av&&(!id&&Wd()&&(Ei=id=window,jd=Ei.document||{},Kn.gsap=Bn,(Ei.gsapVersions||(Ei.gsapVersions=[])).push(Bn.version),Rv(kl||Ei.GreenSockGlobals||!Ei.gsap&&Ei||{}),Qv.forEach(Zv)),v=typeof requestAnimationFrame<"u"&&requestAnimationFrame,h&&k.sleep(),g=v||function(R){return setTimeout(R,u-k.time*1e3+1|0)},Ha=1,M(2))},sleep:function(){(v?cancelAnimationFrame:clearTimeout)(h),Ha=0,g=ja},lagSmoothing:function(R,N){e=R||1/0,r=Math.min(N||33,e)},fps:function(R){c=1e3/(R||240),u=k.time*1e3+c},add:function(R,N,H){var A=N?function(W,U,Z,ne){R(W,U,Z,ne),k.remove(A)}:R;return k.remove(R),p[H?"unshift":"push"](A),Ws(),A},remove:function(R,N){~(N=p.indexOf(R))&&p.splice(N,1)&&P>=N&&P--},_listeners:p},k})(),Ws=function(){return!Ha&&Yn.wake()},Je={},aS=/^[\d.\-M][\d.\-,\s]/,oS=/["']/g,lS=function(e){for(var r={},a=e.substr(1,e.length-3).split(":"),o=a[0],c=1,u=a.length,p,h,g;c<u;c++)h=a[c],p=c!==u-1?h.lastIndexOf(","):h.length,g=h.substr(0,p),r[o]=isNaN(g)?g.replace(oS,"").trim():+g,o=h.substr(p+1).trim();return r},cS=function(e){var r=e.indexOf("(")+1,a=e.indexOf(")"),o=e.indexOf("(",r);return e.substring(r,~o&&o<a?e.indexOf(")",a+1):a)},uS=function(e){var r=(e+"").split("("),a=Je[r[0]];return a&&r.length>1&&a.config?a.config.apply(null,~e.indexOf("{")?[lS(r[1])]:cS(e).split(",").map(Bv)):Je._CE&&aS.test(e)?Je._CE("",e):a},ny=function(e){return function(r){return 1-e(1-r)}},iy=function n(e,r){for(var a=e._first,o;a;)a instanceof kn?n(a,r):a.vars.yoyoEase&&(!a._yoyo||!a._repeat)&&a._yoyo!==r&&(a.timeline?n(a.timeline,r):(o=a._ease,a._ease=a._yEase,a._yEase=o,a._yoyo=r)),a=a._next},Kr=function(e,r){return e&&(Rt(e)?e:Je[e]||uS(e))||r},ns=function(e,r,a,o){a===void 0&&(a=function(h){return 1-r(1-h)}),o===void 0&&(o=function(h){return h<.5?r(h*2)/2:1-r((1-h)*2)/2});var c={easeIn:r,easeOut:a,easeInOut:o},u;return On(e,function(p){Je[p]=Kn[p]=c,Je[u=p.toLowerCase()]=a;for(var h in c)Je[u+(h==="easeIn"?".in":h==="easeOut"?".out":".inOut")]=Je[p+"."+h]=c[h]}),c},ry=function(e){return function(r){return r<.5?(1-e(1-r*2))/2:.5+e((r-.5)*2)/2}},Ru=function n(e,r,a){var o=r>=1?r:1,c=(a||(e?.3:.45))/(r<1?r:1),u=c/td*(Math.asin(1/o)||0),p=function(v){return v===1?1:o*Math.pow(2,-10*v)*Bx((v-u)*c)+1},h=e==="out"?p:e==="in"?function(g){return 1-p(1-g)}:ry(p);return c=td/c,h.config=function(g,v){return n(e,g,v)},h},Fu=function n(e,r){r===void 0&&(r=1.70158);var a=function(u){return u?--u*u*((r+1)*u+r)+1:0},o=e==="out"?a:e==="in"?function(c){return 1-a(1-c)}:ry(a);return o.config=function(c){return n(e,c)},o};On("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var r=e<5?e+1:e;ns(n+",Power"+(r-1),e?function(a){return Math.pow(a,r)}:function(a){return a},function(a){return 1-Math.pow(1-a,r)},function(a){return a<.5?Math.pow(a*2,r)/2:1-Math.pow((1-a)*2,r)/2})});Je.Linear.easeNone=Je.none=Je.Linear.easeIn;ns("Elastic",Ru("in"),Ru("out"),Ru());(function(n,e){var r=1/e,a=2*r,o=2.5*r,c=function(p){return p<r?n*p*p:p<a?n*Math.pow(p-1.5/e,2)+.75:p<o?n*(p-=2.25/e)*p+.9375:n*Math.pow(p-2.625/e,2)+.984375};ns("Bounce",function(u){return 1-c(1-u)},c)})(7.5625,2.75);ns("Expo",function(n){return Math.pow(2,10*(n-1))*n+n*n*n*n*n*n*(1-n)});ns("Circ",function(n){return-(Ev(1-n*n)-1)});ns("Sine",function(n){return n===1?1:-Ix(n*Ox)+1});ns("Back",Fu("in"),Fu("out"),Fu());Je.SteppedEase=Je.steps=Kn.SteppedEase={config:function(e,r){e===void 0&&(e=1);var a=1/e,o=e+(r?0:1),c=r?1:0,u=1-ft;return function(p){return((o*to(0,u,p)|0)+c)*a}}};Bs.ease=Je["quad.out"];On("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return $d+=n+","+n+"Params,"});var sy=function(e,r){this.id=Nx++,e._gsap=this,this.target=e,this.harness=r,this.get=r?r.get:Nv,this.set=r?r.getSetter:Zd},$a=(function(){function n(r){this.vars=r,this._delay=+r.delay||0,(this._repeat=r.repeat===1/0?-2:r.repeat||0)&&(this._rDelay=r.repeatDelay||0,this._yoyo=!!r.yoyo||!!r.yoyoEase),this._ts=1,Us(this,+r.duration,1,1),this.data=r.data,xt&&(this._ctx=xt,xt.data.push(this)),Ha||Yn.wake()}var e=n.prototype;return e.delay=function(a){return a||a===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+a-this._delay),this._delay=a,this):this._delay},e.duration=function(a){return arguments.length?this.totalDuration(this._repeat>0?a+(a+this._rDelay)*this._repeat:a):this.totalDuration()&&this._dur},e.totalDuration=function(a){return arguments.length?(this._dirty=0,Us(this,this._repeat<0?a:(a-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(a,o){if(Ws(),!arguments.length)return this._tTime;var c=this._dp;if(c&&c.smoothChildTiming&&this._ts){for(Bl(this,a),!c._dp||c.parent||Uv(c,this);c&&c.parent;)c.parent._time!==c._start+(c._ts>=0?c._tTime/c._ts:(c.totalDuration()-c._tTime)/-c._ts)&&c.totalTime(c._tTime,!0),c=c.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&a<this._tDur||this._ts<0&&a>0||!this._tDur&&!a)&&Pi(this._dp,this,this._start-this._delay)}return(this._tTime!==a||!this._dur&&!o||this._initted&&Math.abs(this._zTime)===ft||!a&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=a),Iv(this,a,o)),this},e.time=function(a,o){return arguments.length?this.totalTime(Math.min(this.totalDuration(),a+Vm(this))%(this._dur+this._rDelay)||(a?this._dur:0),o):this._time},e.totalProgress=function(a,o){return arguments.length?this.totalTime(this.totalDuration()*a,o):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(a,o){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-a:a)+Vm(this),o):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(a,o){var c=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(a-1)*c,o):this._repeat?Vs(this._tTime,c)+1:1},e.timeScale=function(a,o){if(!arguments.length)return this._rts===-ft?0:this._rts;if(this._rts===a)return this;var c=this.parent&&this._ts?Tl(this.parent._time,this):this._tTime;return this._rts=+a||0,this._ts=this._ps||a===-ft?0:this._rts,this.totalTime(to(-Math.abs(this._delay),this.totalDuration(),c),o!==!1),Il(this),Hx(this)},e.paused=function(a){return arguments.length?(this._ps!==a&&(this._ps=a,a?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Ws(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==ft&&(this._tTime-=ft)))),this):this._ps},e.startTime=function(a){if(arguments.length){this._start=a;var o=this.parent||this._dp;return o&&(o._sort||!this.parent)&&Pi(o,this,a-this._delay),this}return this._start},e.endTime=function(a){return this._start+(Fn(a)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(a){var o=this.parent||this._dp;return o?a&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Tl(o.rawTime(a),this):this._tTime:this._tTime},e.revert=function(a){a===void 0&&(a=Ux);var o=cn;return cn=a,Xd(this)&&(this.timeline&&this.timeline.revert(a),this.totalTime(-.01,a.suppressEvents)),this.data!=="nested"&&a.kill!==!1&&this.kill(),cn=o,this},e.globalTime=function(a){for(var o=this,c=arguments.length?a:o.rawTime();o;)c=o._start+c/(Math.abs(o._ts)||1),o=o._dp;return!this.parent&&this._sat?this._sat.globalTime(a):c},e.repeat=function(a){return arguments.length?(this._repeat=a===1/0?-2:a,Um(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(a){if(arguments.length){var o=this._time;return this._rDelay=a,Um(this),o?this.time(o):this}return this._rDelay},e.yoyo=function(a){return arguments.length?(this._yoyo=a,this):this._yoyo},e.seek=function(a,o){return this.totalTime(si(this,a),Fn(o))},e.restart=function(a,o){return this.play().totalTime(a?-this._delay:0,Fn(o)),this._dur||(this._zTime=-ft),this},e.play=function(a,o){return a!=null&&this.seek(a,o),this.reversed(!1).paused(!1)},e.reverse=function(a,o){return a!=null&&this.seek(a||this.totalDuration(),o),this.reversed(!0).paused(!1)},e.pause=function(a,o){return a!=null&&this.seek(a,o),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(a){return arguments.length?(!!a!==this.reversed()&&this.timeScale(-this._rts||(a?-ft:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-ft,this},e.isActive=function(){var a=this.parent||this._dp,o=this._start,c;return!!(!a||this._ts&&this._initted&&a.isActive()&&(c=a.rawTime(!0))>=o&&c<this.endTime(!0)-ft)},e.eventCallback=function(a,o,c){var u=this.vars;return arguments.length>1?(o?(u[a]=o,c&&(u[a+"Params"]=c),a==="onUpdate"&&(this._onUpdate=o)):delete u[a],this):u[a]},e.then=function(a){var o=this;return new Promise(function(c){var u=Rt(a)?a:zv,p=function(){var g=o.then;o.then=null,Rt(u)&&(u=u(o))&&(u.then||u===o)&&(o.then=g),c(u),o.then=g};o._initted&&o.totalProgress()===1&&o._ts>=0||!o._tTime&&o._ts<0?p():o._prom=p})},e.kill=function(){Ma(this)},n})();Qn($a.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-ft,_prom:0,_ps:!1,_rts:1});var kn=(function(n){Tv(e,n);function e(a,o){var c;return a===void 0&&(a={}),c=n.call(this,a)||this,c.labels={},c.smoothChildTiming=!!a.smoothChildTiming,c.autoRemoveChildren=!!a.autoRemoveChildren,c._sort=Fn(a.sortChildren),Et&&Pi(a.parent||Et,Wi(c),o),a.reversed&&c.reverse(),a.paused&&c.paused(!0),a.scrollTrigger&&Wv(Wi(c),a.scrollTrigger),c}var r=e.prototype;return r.to=function(o,c,u){return Na(0,arguments,this),this},r.from=function(o,c,u){return Na(1,arguments,this),this},r.fromTo=function(o,c,u,p){return Na(2,arguments,this),this},r.set=function(o,c,u){return c.duration=0,c.parent=this,Oa(c).repeatDelay||(c.repeat=0),c.immediateRender=!!c.immediateRender,new Wt(o,c,si(this,u),1),this},r.call=function(o,c,u){return Pi(this,Wt.delayedCall(0,o,c),u)},r.staggerTo=function(o,c,u,p,h,g,v){return u.duration=c,u.stagger=u.stagger||p,u.onComplete=g,u.onCompleteParams=v,u.parent=this,new Wt(o,u,si(this,h)),this},r.staggerFrom=function(o,c,u,p,h,g,v){return u.runBackwards=1,Oa(u).immediateRender=Fn(u.immediateRender),this.staggerTo(o,c,u,p,h,g,v)},r.staggerFromTo=function(o,c,u,p,h,g,v,k){return p.startAt=u,Oa(p).immediateRender=Fn(p.immediateRender),this.staggerTo(o,c,p,h,g,v,k)},r.render=function(o,c,u){var p=this._time,h=this._dirty?this.totalDuration():this._tDur,g=this._dur,v=o<=0?0:jt(o),k=this._zTime<0!=o<0&&(this._initted||!g),T,P,M,D,R,N,H,A,W,U,Z,ne;if(this!==Et&&v>h&&o>=0&&(v=h),v!==this._tTime||u||k){if(p!==this._time&&g&&(v+=this._time-p,o+=this._time-p),T=v,W=this._start,A=this._ts,N=!A,k&&(g||(p=this._zTime),(o||!c)&&(this._zTime=o)),this._repeat){if(Z=this._yoyo,R=g+this._rDelay,this._repeat<-1&&o<0)return this.totalTime(R*100+o,c,u);if(T=jt(v%R),v===h?(D=this._repeat,T=g):(U=jt(v/R),D=~~U,D&&D===U&&(T=g,D--),T>g&&(T=g)),U=Vs(this._tTime,R),!p&&this._tTime&&U!==D&&this._tTime-U*R-this._dur<=0&&(U=D),Z&&D&1&&(T=g-T,ne=1),D!==U&&!this._lock){var ee=Z&&U&1,Q=ee===(Z&&D&1);if(D<U&&(ee=!ee),p=ee?0:v%g?g:v,this._lock=1,this.render(p||(ne?0:jt(D*R)),c,!g)._lock=0,this._tTime=v,!c&&this.parent&&Xn(this,"onRepeat"),this.vars.repeatRefresh&&!ne&&(this.invalidate()._lock=1),p&&p!==this._time||N!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(g=this._dur,h=this._tDur,Q&&(this._lock=2,p=ee?g:-1e-4,this.render(p,!0),this.vars.repeatRefresh&&!ne&&this.invalidate()),this._lock=0,!this._ts&&!N)return this;iy(this,ne)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(H=Gx(this,jt(p),jt(T)),H&&(v-=T-(T=H._start))),this._tTime=v,this._time=T,this._act=!A,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=o,p=0),!p&&v&&!c&&!U&&(Xn(this,"onStart"),this._tTime!==v))return this;if(T>=p&&o>=0)for(P=this._first;P;){if(M=P._next,(P._act||T>=P._start)&&P._ts&&H!==P){if(P.parent!==this)return this.render(o,c,u);if(P.render(P._ts>0?(T-P._start)*P._ts:(P._dirty?P.totalDuration():P._tDur)+(T-P._start)*P._ts,c,u),T!==this._time||!this._ts&&!N){H=0,M&&(v+=this._zTime=-ft);break}}P=M}else{P=this._last;for(var ce=o<0?o:T;P;){if(M=P._prev,(P._act||ce<=P._end)&&P._ts&&H!==P){if(P.parent!==this)return this.render(o,c,u);if(P.render(P._ts>0?(ce-P._start)*P._ts:(P._dirty?P.totalDuration():P._tDur)+(ce-P._start)*P._ts,c,u||cn&&Xd(P)),T!==this._time||!this._ts&&!N){H=0,M&&(v+=this._zTime=ce?-ft:ft);break}}P=M}}if(H&&!c&&(this.pause(),H.render(T>=p?0:-ft)._zTime=T>=p?1:-1,this._ts))return this._start=W,Il(this),this.render(o,c,u);this._onUpdate&&!c&&Xn(this,"onUpdate",!0),(v===h&&this._tTime>=this.totalDuration()||!v&&p)&&(W===this._start||Math.abs(A)!==Math.abs(this._ts))&&(this._lock||((o||!g)&&(v===h&&this._ts>0||!v&&this._ts<0)&&br(this,1),!c&&!(o<0&&!p)&&(v||p||!h)&&(Xn(this,v===h&&o>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(v<h&&this.timeScale()>0)&&this._prom())))}return this},r.add=function(o,c){var u=this;if(qi(c)||(c=si(this,c,o)),!(o instanceof $a)){if(yn(o))return o.forEach(function(p){return u.add(p,c)}),this;if(tn(o))return this.addLabel(o,c);if(Rt(o))o=Wt.delayedCall(0,o);else return this}return this!==o?Pi(this,o,c):this},r.getChildren=function(o,c,u,p){o===void 0&&(o=!0),c===void 0&&(c=!0),u===void 0&&(u=!0),p===void 0&&(p=-oi);for(var h=[],g=this._first;g;)g._start>=p&&(g instanceof Wt?c&&h.push(g):(u&&h.push(g),o&&h.push.apply(h,g.getChildren(!0,c,u)))),g=g._next;return h},r.getById=function(o){for(var c=this.getChildren(1,1,1),u=c.length;u--;)if(c[u].vars.id===o)return c[u]},r.remove=function(o){return tn(o)?this.removeLabel(o):Rt(o)?this.killTweensOf(o):(o.parent===this&&Nl(this,o),o===this._recent&&(this._recent=this._last),Gr(this))},r.totalTime=function(o,c){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=jt(Yn.time-(this._ts>0?o/this._ts:(this.totalDuration()-o)/-this._ts))),n.prototype.totalTime.call(this,o,c),this._forcing=0,this):this._tTime},r.addLabel=function(o,c){return this.labels[o]=si(this,c),this},r.removeLabel=function(o){return delete this.labels[o],this},r.addPause=function(o,c,u){var p=Wt.delayedCall(0,c||ja,u);return p.data="isPause",this._hasPause=1,Pi(this,p,si(this,o))},r.removePause=function(o){var c=this._first;for(o=si(this,o);c;)c._start===o&&c.data==="isPause"&&br(c),c=c._next},r.killTweensOf=function(o,c,u){for(var p=this.getTweensOf(o,u),h=p.length;h--;)mr!==p[h]&&p[h].kill(o,c);return this},r.getTweensOf=function(o,c){for(var u=[],p=li(o),h=this._first,g=qi(c),v;h;)h instanceof Wt?Wx(h._targets,p)&&(g?(!mr||h._initted&&h._ts)&&h.globalTime(0)<=c&&h.globalTime(h.totalDuration())>c:!c||h.isActive())&&u.push(h):(v=h.getTweensOf(p,c)).length&&u.push.apply(u,v),h=h._next;return u},r.tweenTo=function(o,c){c=c||{};var u=this,p=si(u,o),h=c,g=h.startAt,v=h.onStart,k=h.onStartParams,T=h.immediateRender,P,M=Wt.to(u,Qn({ease:c.ease||"none",lazy:!1,immediateRender:!1,time:p,overwrite:"auto",duration:c.duration||Math.abs((p-(g&&"time"in g?g.time:u._time))/u.timeScale())||ft,onStart:function(){if(u.pause(),!P){var R=c.duration||Math.abs((p-(g&&"time"in g?g.time:u._time))/u.timeScale());M._dur!==R&&Us(M,R,0,1).render(M._time,!0,!0),P=1}v&&v.apply(M,k||[])}},c));return T?M.render(0):M},r.tweenFromTo=function(o,c,u){return this.tweenTo(c,Qn({startAt:{time:si(this,o)}},u))},r.recent=function(){return this._recent},r.nextLabel=function(o){return o===void 0&&(o=this._time),Wm(this,si(this,o))},r.previousLabel=function(o){return o===void 0&&(o=this._time),Wm(this,si(this,o),1)},r.currentLabel=function(o){return arguments.length?this.seek(o,!0):this.previousLabel(this._time+ft)},r.shiftChildren=function(o,c,u){u===void 0&&(u=0);for(var p=this._first,h=this.labels,g;p;)p._start>=u&&(p._start+=o,p._end+=o),p=p._next;if(c)for(g in h)h[g]>=u&&(h[g]+=o);return Gr(this)},r.invalidate=function(o){var c=this._first;for(this._lock=0;c;)c.invalidate(o),c=c._next;return n.prototype.invalidate.call(this,o)},r.clear=function(o){o===void 0&&(o=!0);for(var c=this._first,u;c;)u=c._next,this.remove(c),c=u;return this._dp&&(this._time=this._tTime=this._pTime=0),o&&(this.labels={}),Gr(this)},r.totalDuration=function(o){var c=0,u=this,p=u._last,h=oi,g,v,k;if(arguments.length)return u.timeScale((u._repeat<0?u.duration():u.totalDuration())/(u.reversed()?-o:o));if(u._dirty){for(k=u.parent;p;)g=p._prev,p._dirty&&p.totalDuration(),v=p._start,v>h&&u._sort&&p._ts&&!u._lock?(u._lock=1,Pi(u,p,v-p._delay,1)._lock=0):h=v,v<0&&p._ts&&(c-=v,(!k&&!u._dp||k&&k.smoothChildTiming)&&(u._start+=v/u._ts,u._time-=v,u._tTime-=v),u.shiftChildren(-v,!1,-1/0),h=0),p._end>c&&p._ts&&(c=p._end),p=g;Us(u,u===Et&&u._time>c?u._time:c,1,1),u._dirty=0}return u._tDur},e.updateRoot=function(o){if(Et._ts&&(Iv(Et,Tl(o,Et)),Ov=Yn.frame),Yn.frame>=Bm){Bm+=Gn.autoSleep||120;var c=Et._first;if((!c||!c._ts)&&Gn.autoSleep&&Yn._listeners.length<2){for(;c&&!c._ts;)c=c._next;c||Yn.sleep()}}},e})($a);Qn(kn.prototype,{_lock:0,_hasPause:0,_forcing:0});var dS=function(e,r,a,o,c,u,p){var h=new Nn(this._pt,e,r,0,1,dy,null,c),g=0,v=0,k,T,P,M,D,R,N,H;for(h.b=a,h.e=o,a+="",o+="",(N=~o.indexOf("random("))&&(o=qa(o)),u&&(H=[a,o],u(H,e,r),a=H[0],o=H[1]),T=a.match(Lu)||[];k=Lu.exec(o);)M=k[0],D=o.substring(g,k.index),P?P=(P+1)%5:D.substr(-5)==="rgba("&&(P=1),M!==T[v++]&&(R=parseFloat(T[v-1])||0,h._pt={_next:h._pt,p:D||v===1?D:",",s:R,c:M.charAt(1)==="="?Fs(R,M)-R:parseFloat(M)-R,m:P&&P<4?Math.round:0},g=Lu.lastIndex);return h.c=g<o.length?o.substring(g,o.length):"",h.fp=p,(Lv.test(o)||N)&&(h.e=0),this._pt=h,h},Gd=function(e,r,a,o,c,u,p,h,g,v){Rt(o)&&(o=o(c||0,e,u));var k=e[r],T=a!=="get"?a:Rt(k)?g?e[r.indexOf("set")||!Rt(e["get"+r.substr(3)])?r:"get"+r.substr(3)](g):e[r]():k,P=Rt(k)?g?gS:cy:Qd,M;if(tn(o)&&(~o.indexOf("random(")&&(o=qa(o)),o.charAt(1)==="="&&(M=Fs(T,o)+(gn(T)||0),(M||M===0)&&(o=M))),!v||T!==o||ud)return!isNaN(T*o)&&o!==""?(M=new Nn(this._pt,e,r,+T||0,o-(T||0),typeof k=="boolean"?yS:uy,0,P),g&&(M.fp=g),p&&M.modifier(p,this,e),this._pt=M):(!k&&!(r in e)&&qd(r,o),dS.call(this,e,r,T,o,P,h||Gn.stringFilter,g))},fS=function(e,r,a,o,c){if(Rt(e)&&(e=Ia(e,c,r,a,o)),!Ai(e)||e.style&&e.nodeType||yn(e)||Pv(e))return tn(e)?Ia(e,c,r,a,o):e;var u={},p;for(p in e)u[p]=Ia(e[p],c,r,a,o);return u},ay=function(e,r,a,o,c,u){var p,h,g,v;if($n[e]&&(p=new $n[e]).init(c,p.rawVars?r[e]:fS(r[e],o,c,u,a),a,o,u)!==!1&&(a._pt=h=new Nn(a._pt,c,e,0,1,p.render,p,0,p.priority),a!==Ps))for(g=a._ptLookup[a._targets.indexOf(c)],v=p._props.length;v--;)g[p._props[v]]=h;return p},mr,ud,Kd=function n(e,r,a){var o=e.vars,c=o.ease,u=o.startAt,p=o.immediateRender,h=o.lazy,g=o.onUpdate,v=o.runBackwards,k=o.yoyoEase,T=o.keyframes,P=o.autoRevert,M=e._dur,D=e._startAt,R=e._targets,N=e.parent,H=N&&N.data==="nested"?N.vars.targets:R,A=e._overwrite==="auto"&&!Vd,W=e.timeline,U,Z,ne,ee,Q,ce,me,ve,ke,we,d,y,w;if(W&&(!T||!c)&&(c="none"),e._ease=Kr(c,Bs.ease),e._yEase=k?ny(Kr(k===!0?c:k,Bs.ease)):0,k&&e._yoyo&&!e._repeat&&(k=e._yEase,e._yEase=e._ease,e._ease=k),e._from=!W&&!!o.runBackwards,!W||T&&!o.stagger){if(ve=R[0]?Xr(R[0]).harness:0,y=ve&&o[ve.prop],U=Cl(o,Hd),D&&(D._zTime<0&&D.progress(1),r<0&&v&&p&&!P?D.render(-1,!0):D.revert(v&&M?ml:Vx),D._lazy=0),u){if(br(e._startAt=Wt.set(R,Qn({data:"isStart",overwrite:!1,parent:N,immediateRender:!0,lazy:!D&&Fn(h),startAt:null,delay:0,onUpdate:g&&function(){return Xn(e,"onUpdate")},stagger:0},u))),e._startAt._dp=0,e._startAt._sat=e,r<0&&(cn||!p&&!P)&&e._startAt.revert(ml),p&&M&&r<=0&&a<=0){r&&(e._zTime=r);return}}else if(v&&M&&!D){if(r&&(p=!1),ne=Qn({overwrite:!1,data:"isFromStart",lazy:p&&!D&&Fn(h),immediateRender:p,stagger:0,parent:N},U),y&&(ne[ve.prop]=y),br(e._startAt=Wt.set(R,ne)),e._startAt._dp=0,e._startAt._sat=e,r<0&&(cn?e._startAt.revert(ml):e._startAt.render(-1,!0)),e._zTime=r,!p)n(e._startAt,ft,ft);else if(!r)return}for(e._pt=e._ptCache=0,h=M&&Fn(h)||h&&!M,Z=0;Z<R.length;Z++){if(Q=R[Z],me=Q._gsap||Yd(R)[Z]._gsap,e._ptLookup[Z]=we={},rd[me.id]&&yr.length&&_l(),d=H===R?Z:H.indexOf(Q),ve&&(ke=new ve).init(Q,y||U,e,d,H)!==!1&&(e._pt=ee=new Nn(e._pt,Q,ke.name,0,1,ke.render,ke,0,ke.priority),ke._props.forEach(function(b){we[b]=ee}),ke.priority&&(ce=1)),!ve||y)for(ne in U)$n[ne]&&(ke=ay(ne,U,e,d,Q,H))?ke.priority&&(ce=1):we[ne]=ee=Gd.call(e,Q,ne,"get",U[ne],d,H,0,o.stringFilter);e._op&&e._op[Z]&&e.kill(Q,e._op[Z]),A&&e._pt&&(mr=e,Et.killTweensOf(Q,we,e.globalTime(r)),w=!e.parent,mr=0),e._pt&&h&&(rd[me.id]=1)}ce&&fy(e),e._onInit&&e._onInit(e)}e._onUpdate=g,e._initted=(!e._op||e._pt)&&!w,T&&r<=0&&W.render(oi,!0,!0)},pS=function(e,r,a,o,c,u,p,h){var g=(e._pt&&e._ptCache||(e._ptCache={}))[r],v,k,T,P;if(!g)for(g=e._ptCache[r]=[],T=e._ptLookup,P=e._targets.length;P--;){if(v=T[P][r],v&&v.d&&v.d._pt)for(v=v.d._pt;v&&v.p!==r&&v.fp!==r;)v=v._next;if(!v)return ud=1,e.vars[r]="+=0",Kd(e,p),ud=0,h?Wa(r+" not eligible for reset"):1;g.push(v)}for(P=g.length;P--;)k=g[P],v=k._pt||k,v.s=(o||o===0)&&!c?o:v.s+(o||0)+u*v.c,v.c=a-v.s,k.e&&(k.e=Bt(a)+gn(k.e)),k.b&&(k.b=v.s+gn(k.b))},hS=function(e,r){var a=e[0]?Xr(e[0]).harness:0,o=a&&a.aliases,c,u,p,h;if(!o)return r;c=zs({},r);for(u in o)if(u in c)for(h=o[u].split(","),p=h.length;p--;)c[h[p]]=c[u];return c},mS=function(e,r,a,o){var c=r.ease||o||"power1.inOut",u,p;if(yn(r))p=a[e]||(a[e]=[]),r.forEach(function(h,g){return p.push({t:g/(r.length-1)*100,v:h,e:c})});else for(u in r)p=a[u]||(a[u]=[]),u==="ease"||p.push({t:parseFloat(e),v:r[u],e:c})},Ia=function(e,r,a,o,c){return Rt(e)?e.call(r,a,o,c):tn(e)&&~e.indexOf("random(")?qa(e):e},oy=$d+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",ly={};On(oy+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return ly[n]=1});var Wt=(function(n){Tv(e,n);function e(a,o,c,u){var p;typeof o=="number"&&(c.duration=o,o=c,c=null),p=n.call(this,u?o:Oa(o))||this;var h=p.vars,g=h.duration,v=h.delay,k=h.immediateRender,T=h.stagger,P=h.overwrite,M=h.keyframes,D=h.defaults,R=h.scrollTrigger,N=h.yoyoEase,H=o.parent||Et,A=(yn(a)||Pv(a)?qi(a[0]):"length"in o)?[a]:li(a),W,U,Z,ne,ee,Q,ce,me;if(p._targets=A.length?Yd(A):Wa("GSAP target "+a+" not found. https://gsap.com",!Gn.nullTargetWarn)||[],p._ptLookup=[],p._overwrite=P,M||T||dl(g)||dl(v)){if(o=p.vars,W=p.timeline=new kn({data:"nested",defaults:D||{},targets:H&&H.data==="nested"?H.vars.targets:A}),W.kill(),W.parent=W._dp=Wi(p),W._start=0,T||dl(g)||dl(v)){if(ne=A.length,ce=T&&$v(T),Ai(T))for(ee in T)~oy.indexOf(ee)&&(me||(me={}),me[ee]=T[ee]);for(U=0;U<ne;U++)Z=Cl(o,ly),Z.stagger=0,N&&(Z.yoyoEase=N),me&&zs(Z,me),Q=A[U],Z.duration=+Ia(g,Wi(p),U,Q,A),Z.delay=(+Ia(v,Wi(p),U,Q,A)||0)-p._delay,!T&&ne===1&&Z.delay&&(p._delay=v=Z.delay,p._start+=v,Z.delay=0),W.to(Q,Z,ce?ce(U,Q,A):0),W._ease=Je.none;W.duration()?g=v=0:p.timeline=0}else if(M){Oa(Qn(W.vars.defaults,{ease:"none"})),W._ease=Kr(M.ease||o.ease||"none");var ve=0,ke,we,d;if(yn(M))M.forEach(function(y){return W.to(A,y,">")}),W.duration();else{Z={};for(ee in M)ee==="ease"||ee==="easeEach"||mS(ee,M[ee],Z,M.easeEach);for(ee in Z)for(ke=Z[ee].sort(function(y,w){return y.t-w.t}),ve=0,U=0;U<ke.length;U++)we=ke[U],d={ease:we.e,duration:(we.t-(U?ke[U-1].t:0))/100*g},d[ee]=we.v,W.to(A,d,ve),ve+=d.duration;W.duration()<g&&W.to({},{duration:g-W.duration()})}}g||p.duration(g=W.duration())}else p.timeline=0;return P===!0&&!Vd&&(mr=Wi(p),Et.killTweensOf(A),mr=0),Pi(H,Wi(p),c),o.reversed&&p.reverse(),o.paused&&p.paused(!0),(k||!g&&!M&&p._start===jt(H._time)&&Fn(k)&&$x(Wi(p))&&H.data!=="nested")&&(p._tTime=-ft,p.render(Math.max(0,-v)||0)),R&&Wv(Wi(p),R),p}var r=e.prototype;return r.render=function(o,c,u){var p=this._time,h=this._tDur,g=this._dur,v=o<0,k=o>h-ft&&!v?h:o<ft?0:o,T,P,M,D,R,N,H,A,W;if(!g)Xx(this,o,c,u);else if(k!==this._tTime||!o||u||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==v||this._lazy){if(T=k,A=this.timeline,this._repeat){if(D=g+this._rDelay,this._repeat<-1&&v)return this.totalTime(D*100+o,c,u);if(T=jt(k%D),k===h?(M=this._repeat,T=g):(R=jt(k/D),M=~~R,M&&M===R?(T=g,M--):T>g&&(T=g)),N=this._yoyo&&M&1,N&&(W=this._yEase,T=g-T),R=Vs(this._tTime,D),T===p&&!u&&this._initted&&M===R)return this._tTime=k,this;M!==R&&(A&&this._yEase&&iy(A,N),this.vars.repeatRefresh&&!N&&!this._lock&&T!==D&&this._initted&&(this._lock=u=1,this.render(jt(D*M),!0).invalidate()._lock=0))}if(!this._initted){if(jv(this,v?o:T,u,c,k))return this._tTime=0,this;if(p!==this._time&&!(u&&this.vars.repeatRefresh&&M!==R))return this;if(g!==this._dur)return this.render(o,c,u)}if(this._tTime=k,this._time=T,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=H=(W||this._ease)(T/g),this._from&&(this.ratio=H=1-H),!p&&k&&!c&&!R&&(Xn(this,"onStart"),this._tTime!==k))return this;for(P=this._pt;P;)P.r(H,P.d),P=P._next;A&&A.render(o<0?o:A._dur*A._ease(T/this._dur),c,u)||this._startAt&&(this._zTime=o),this._onUpdate&&!c&&(v&&sd(this,o,c,u),Xn(this,"onUpdate")),this._repeat&&M!==R&&this.vars.onRepeat&&!c&&this.parent&&Xn(this,"onRepeat"),(k===this._tDur||!k)&&this._tTime===k&&(v&&!this._onUpdate&&sd(this,o,!0,!0),(o||!g)&&(k===this._tDur&&this._ts>0||!k&&this._ts<0)&&br(this,1),!c&&!(v&&!p)&&(k||p||N)&&(Xn(this,k===h?"onComplete":"onReverseComplete",!0),this._prom&&!(k<h&&this.timeScale()>0)&&this._prom()))}return this},r.targets=function(){return this._targets},r.invalidate=function(o){return(!o||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(o),n.prototype.invalidate.call(this,o)},r.resetTo=function(o,c,u,p,h){Ha||Yn.wake(),this._ts||this.play();var g=Math.min(this._dur,(this._dp._time-this._start)*this._ts),v;return this._initted||Kd(this,g),v=this._ease(g/this._dur),pS(this,o,c,u,p,v,g,h)?this.resetTo(o,c,u,p,1):(Bl(this,0),this.parent||Vv(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},r.kill=function(o,c){if(c===void 0&&(c="all"),!o&&(!c||c==="all"))return this._lazy=this._pt=0,this.parent?Ma(this):this.scrollTrigger&&this.scrollTrigger.kill(!!cn),this;if(this.timeline){var u=this.timeline.totalDuration();return this.timeline.killTweensOf(o,c,mr&&mr.vars.overwrite!==!0)._first||Ma(this),this.parent&&u!==this.timeline.totalDuration()&&Us(this,this._dur*this.timeline._tDur/u,0,1),this}var p=this._targets,h=o?li(o):p,g=this._ptLookup,v=this._pt,k,T,P,M,D,R,N;if((!c||c==="all")&&qx(p,h))return c==="all"&&(this._pt=0),Ma(this);for(k=this._op=this._op||[],c!=="all"&&(tn(c)&&(D={},On(c,function(H){return D[H]=1}),c=D),c=hS(p,c)),N=p.length;N--;)if(~h.indexOf(p[N])){T=g[N],c==="all"?(k[N]=c,M=T,P={}):(P=k[N]=k[N]||{},M=c);for(D in M)R=T&&T[D],R&&((!("kill"in R.d)||R.d.kill(D)===!0)&&Nl(this,R,"_pt"),delete T[D]),P!=="all"&&(P[D]=1)}return this._initted&&!this._pt&&v&&Ma(this),this},e.to=function(o,c){return new e(o,c,arguments[2])},e.from=function(o,c){return Na(1,arguments)},e.delayedCall=function(o,c,u,p){return new e(c,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:o,onComplete:c,onReverseComplete:c,onCompleteParams:u,onReverseCompleteParams:u,callbackScope:p})},e.fromTo=function(o,c,u){return Na(2,arguments)},e.set=function(o,c){return c.duration=0,c.repeatDelay||(c.repeat=0),new e(o,c)},e.killTweensOf=function(o,c,u){return Et.killTweensOf(o,c,u)},e})($a);Qn(Wt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});On("staggerTo,staggerFrom,staggerFromTo",function(n){Wt[n]=function(){var e=new kn,r=od.call(arguments,0);return r.splice(n==="staggerFromTo"?5:4,0,0),e[n].apply(e,r)}});var Qd=function(e,r,a){return e[r]=a},cy=function(e,r,a){return e[r](a)},gS=function(e,r,a,o){return e[r](o.fp,a)},vS=function(e,r,a){return e.setAttribute(r,a)},Zd=function(e,r){return Rt(e[r])?cy:Ud(e[r])&&e.setAttribute?vS:Qd},uy=function(e,r){return r.set(r.t,r.p,Math.round((r.s+r.c*e)*1e6)/1e6,r)},yS=function(e,r){return r.set(r.t,r.p,!!(r.s+r.c*e),r)},dy=function(e,r){var a=r._pt,o="";if(!e&&r.b)o=r.b;else if(e===1&&r.e)o=r.e;else{for(;a;)o=a.p+(a.m?a.m(a.s+a.c*e):Math.round((a.s+a.c*e)*1e4)/1e4)+o,a=a._next;o+=r.c}r.set(r.t,r.p,o,r)},Jd=function(e,r){for(var a=r._pt;a;)a.r(e,a.d),a=a._next},wS=function(e,r,a,o){for(var c=this._pt,u;c;)u=c._next,c.p===o&&c.modifier(e,r,a),c=u},bS=function(e){for(var r=this._pt,a,o;r;)o=r._next,r.p===e&&!r.op||r.op===e?Nl(this,r,"_pt"):r.dep||(a=1),r=o;return!a},xS=function(e,r,a,o){o.mSet(e,r,o.m.call(o.tween,a,o.mt),o)},fy=function(e){for(var r=e._pt,a,o,c,u;r;){for(a=r._next,o=c;o&&o.pr>r.pr;)o=o._next;(r._prev=o?o._prev:u)?r._prev._next=r:c=r,(r._next=o)?o._prev=r:u=r,r=a}e._pt=c},Nn=(function(){function n(r,a,o,c,u,p,h,g,v){this.t=a,this.s=c,this.c=u,this.p=o,this.r=p||uy,this.d=h||this,this.set=g||Qd,this.pr=v||0,this._next=r,r&&(r._prev=this)}var e=n.prototype;return e.modifier=function(a,o,c){this.mSet=this.mSet||this.set,this.set=xS,this.m=a,this.mt=c,this.tween=o},n})();On($d+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return Hd[n]=1});Kn.TweenMax=Kn.TweenLite=Wt;Kn.TimelineLite=Kn.TimelineMax=kn;Et=new kn({sortChildren:!1,defaults:Bs,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Gn.stringFilter=ty;var Qr=[],vl={},SS=[],qm=0,kS=0,Ou=function(e){return(vl[e]||SS).map(function(r){return r()})},dd=function(){var e=Date.now(),r=[];e-qm>2&&(Ou("matchMediaInit"),Qr.forEach(function(a){var o=a.queries,c=a.conditions,u,p,h,g;for(p in o)u=Ei.matchMedia(o[p]).matches,u&&(h=1),u!==c[p]&&(c[p]=u,g=1);g&&(a.revert(),h&&r.push(a))}),Ou("matchMediaRevert"),r.forEach(function(a){return a.onMatch(a,function(o){return a.add(null,o)})}),qm=e,Ou("matchMedia"))},py=(function(){function n(r,a){this.selector=a&&ld(a),this.data=[],this._r=[],this.isReverted=!1,this.id=kS++,r&&this.add(r)}var e=n.prototype;return e.add=function(a,o,c){Rt(a)&&(c=o,o=a,a=Rt);var u=this,p=function(){var g=xt,v=u.selector,k;return g&&g!==u&&g.data.push(u),c&&(u.selector=ld(c)),xt=u,k=o.apply(u,arguments),Rt(k)&&u._r.push(k),xt=g,u.selector=v,u.isReverted=!1,k};return u.last=p,a===Rt?p(u,function(h){return u.add(null,h)}):a?u[a]=p:p},e.ignore=function(a){var o=xt;xt=null,a(this),xt=o},e.getTweens=function(){var a=[];return this.data.forEach(function(o){return o instanceof n?a.push.apply(a,o.getTweens()):o instanceof Wt&&!(o.parent&&o.parent.data==="nested")&&a.push(o)}),a},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(a,o){var c=this;if(a?(function(){for(var p=c.getTweens(),h=c.data.length,g;h--;)g=c.data[h],g.data==="isFlip"&&(g.revert(),g.getChildren(!0,!0,!1).forEach(function(v){return p.splice(p.indexOf(v),1)}));for(p.map(function(v){return{g:v._dur||v._delay||v._sat&&!v._sat.vars.immediateRender?v.globalTime(0):-1/0,t:v}}).sort(function(v,k){return k.g-v.g||-1/0}).forEach(function(v){return v.t.revert(a)}),h=c.data.length;h--;)g=c.data[h],g instanceof kn?g.data!=="nested"&&(g.scrollTrigger&&g.scrollTrigger.revert(),g.kill()):!(g instanceof Wt)&&g.revert&&g.revert(a);c._r.forEach(function(v){return v(a,c)}),c.isReverted=!0})():this.data.forEach(function(p){return p.kill&&p.kill()}),this.clear(),o)for(var u=Qr.length;u--;)Qr[u].id===this.id&&Qr.splice(u,1)},e.revert=function(a){this.kill(a||{})},n})(),_S=(function(){function n(r){this.contexts=[],this.scope=r,xt&&xt.data.push(this)}var e=n.prototype;return e.add=function(a,o,c){Ai(a)||(a={matches:a});var u=new py(0,c||this.scope),p=u.conditions={},h,g,v;xt&&!u.selector&&(u.selector=xt.selector),this.contexts.push(u),o=u.add("onMatch",o),u.queries=a;for(g in a)g==="all"?v=1:(h=Ei.matchMedia(a[g]),h&&(Qr.indexOf(u)<0&&Qr.push(u),(p[g]=h.matches)&&(v=1),h.addListener?h.addListener(dd):h.addEventListener("change",dd)));return v&&o(u,function(k){return u.add(null,k)}),this},e.revert=function(a){this.kill(a||{})},e.kill=function(a){this.contexts.forEach(function(o){return o.kill(a,!0)})},n})(),El={registerPlugin:function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];r.forEach(function(o){return Zv(o)})},timeline:function(e){return new kn(e)},getTweensOf:function(e,r){return Et.getTweensOf(e,r)},getProperty:function(e,r,a,o){tn(e)&&(e=li(e)[0]);var c=Xr(e||{}).get,u=a?zv:Bv;return a==="native"&&(a=""),e&&(r?u(($n[r]&&$n[r].get||c)(e,r,a,o)):function(p,h,g){return u(($n[p]&&$n[p].get||c)(e,p,h,g))})},quickSetter:function(e,r,a){if(e=li(e),e.length>1){var o=e.map(function(v){return Bn.quickSetter(v,r,a)}),c=o.length;return function(v){for(var k=c;k--;)o[k](v)}}e=e[0]||{};var u=$n[r],p=Xr(e),h=p.harness&&(p.harness.aliases||{})[r]||r,g=u?function(v){var k=new u;Ps._pt=0,k.init(e,a?v+a:v,Ps,0,[e]),k.render(1,k),Ps._pt&&Jd(1,Ps)}:p.set(e,h);return u?g:function(v){return g(e,h,a?v+a:v,p,1)}},quickTo:function(e,r,a){var o,c=Bn.to(e,Qn((o={},o[r]="+=0.1",o.paused=!0,o.stagger=0,o),a||{})),u=function(h,g,v){return c.resetTo(r,h,g,v)};return u.tween=c,u},isTweening:function(e){return Et.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=Kr(e.ease,Bs.ease)),zm(Bs,e||{})},config:function(e){return zm(Gn,e||{})},registerEffect:function(e){var r=e.name,a=e.effect,o=e.plugins,c=e.defaults,u=e.extendTimeline;(o||"").split(",").forEach(function(p){return p&&!$n[p]&&!Kn[p]&&Wa(r+" effect requires "+p+" plugin.")}),Mu[r]=function(p,h,g){return a(li(p),Qn(h||{},c),g)},u&&(kn.prototype[r]=function(p,h,g){return this.add(Mu[r](p,Ai(h)?h:(g=h)&&{},this),g)})},registerEase:function(e,r){Je[e]=Kr(r)},parseEase:function(e,r){return arguments.length?Kr(e,r):Je},getById:function(e){return Et.getById(e)},exportRoot:function(e,r){e===void 0&&(e={});var a=new kn(e),o,c;for(a.smoothChildTiming=Fn(e.smoothChildTiming),Et.remove(a),a._dp=0,a._time=a._tTime=Et._time,o=Et._first;o;)c=o._next,(r||!(!o._dur&&o instanceof Wt&&o.vars.onComplete===o._targets[0]))&&Pi(a,o,o._start-o._delay),o=c;return Pi(Et,a,0),a},context:function(e,r){return e?new py(e,r):xt},matchMedia:function(e){return new _S(e)},matchMediaRefresh:function(){return Qr.forEach(function(e){var r=e.conditions,a,o;for(o in r)r[o]&&(r[o]=!1,a=1);a&&e.revert()})||dd()},addEventListener:function(e,r){var a=vl[e]||(vl[e]=[]);~a.indexOf(r)||a.push(r)},removeEventListener:function(e,r){var a=vl[e],o=a&&a.indexOf(r);o>=0&&a.splice(o,1)},utils:{wrap:nS,wrapYoyo:iS,distribute:$v,random:Xv,snap:Yv,normalize:tS,getUnit:gn,clamp:Qx,splitColor:Jv,toArray:li,selector:ld,mapRange:Kv,pipe:Jx,unitize:eS,interpolate:rS,shuffle:Hv},install:Rv,effects:Mu,ticker:Yn,updateRoot:kn.updateRoot,plugins:$n,globalTimeline:Et,core:{PropTween:Nn,globals:Fv,Tween:Wt,Timeline:kn,Animation:$a,getCache:Xr,_removeLinkedListItem:Nl,reverting:function(){return cn},context:function(e){return e&&xt&&(xt.data.push(e),e._ctx=xt),xt},suppressOverwrites:function(e){return Vd=e}}};On("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return El[n]=Wt[n]});Yn.add(kn.updateRoot);Ps=El.to({},{duration:0});var CS=function(e,r){for(var a=e._pt;a&&a.p!==r&&a.op!==r&&a.fp!==r;)a=a._next;return a},TS=function(e,r){var a=e._targets,o,c,u;for(o in r)for(c=a.length;c--;)u=e._ptLookup[c][o],u&&(u=u.d)&&(u._pt&&(u=CS(u,o)),u&&u.modifier&&u.modifier(r[o],e,a[c],o))},Nu=function(e,r){return{name:e,headless:1,rawVars:1,init:function(o,c,u){u._onInit=function(p){var h,g;if(tn(c)&&(h={},On(c,function(v){return h[v]=1}),c=h),r){h={};for(g in c)h[g]=r(c[g]);c=h}TS(p,c)}}}},Bn=El.registerPlugin({name:"attr",init:function(e,r,a,o,c){var u,p,h;this.tween=a;for(u in r)h=e.getAttribute(u)||"",p=this.add(e,"setAttribute",(h||0)+"",r[u],o,c,0,0,u),p.op=u,p.b=h,this._props.push(u)},render:function(e,r){for(var a=r._pt;a;)cn?a.set(a.t,a.p,a.b,a):a.r(e,a.d),a=a._next}},{name:"endArray",headless:1,init:function(e,r){for(var a=r.length;a--;)this.add(e,a,e[a]||0,r[a],0,0,0,0,0,1)}},Nu("roundProps",cd),Nu("modifiers"),Nu("snap",Yv))||El;Wt.version=kn.version=Bn.version="3.13.0";Av=1;Wd()&&Ws();Je.Power0;Je.Power1;Je.Power2;Je.Power3;Je.Power4;Je.Linear;Je.Quad;Je.Cubic;Je.Quart;Je.Quint;Je.Strong;Je.Elastic;Je.Back;Je.SteppedEase;Je.Bounce;Je.Sine;Je.Expo;Je.Circ;var Hm,gr,Os,ef,Hr,$m,tf,ES=function(){return typeof window<"u"},Hi={},jr=180/Math.PI,Ns=Math.PI/180,Cs=Math.atan2,Ym=1e8,nf=/([A-Z])/g,PS=/(left|right|width|margin|padding|x)/i,DS=/[\s,\(]\S/,Di={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},fd=function(e,r){return r.set(r.t,r.p,Math.round((r.s+r.c*e)*1e4)/1e4+r.u,r)},LS=function(e,r){return r.set(r.t,r.p,e===1?r.e:Math.round((r.s+r.c*e)*1e4)/1e4+r.u,r)},MS=function(e,r){return r.set(r.t,r.p,e?Math.round((r.s+r.c*e)*1e4)/1e4+r.u:r.b,r)},AS=function(e,r){var a=r.s+r.c*e;r.set(r.t,r.p,~~(a+(a<0?-.5:.5))+r.u,r)},hy=function(e,r){return r.set(r.t,r.p,e?r.e:r.b,r)},my=function(e,r){return r.set(r.t,r.p,e!==1?r.b:r.e,r)},RS=function(e,r,a){return e.style[r]=a},FS=function(e,r,a){return e.style.setProperty(r,a)},OS=function(e,r,a){return e._gsap[r]=a},NS=function(e,r,a){return e._gsap.scaleX=e._gsap.scaleY=a},IS=function(e,r,a,o,c){var u=e._gsap;u.scaleX=u.scaleY=a,u.renderTransform(c,u)},BS=function(e,r,a,o,c){var u=e._gsap;u[r]=a,u.renderTransform(c,u)},Pt="transform",In=Pt+"Origin",zS=function n(e,r){var a=this,o=this.target,c=o.style,u=o._gsap;if(e in Hi&&c){if(this.tfm=this.tfm||{},e!=="transform")e=Di[e]||e,~e.indexOf(",")?e.split(",").forEach(function(p){return a.tfm[p]=ji(o,p)}):this.tfm[e]=u.x?u[e]:ji(o,e),e===In&&(this.tfm.zOrigin=u.zOrigin);else return Di.transform.split(",").forEach(function(p){return n.call(a,p,r)});if(this.props.indexOf(Pt)>=0)return;u.svg&&(this.svgo=o.getAttribute("data-svg-origin"),this.props.push(In,r,"")),e=Pt}(c||r)&&this.props.push(e,r,c[e])},gy=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},VS=function(){var e=this.props,r=this.target,a=r.style,o=r._gsap,c,u;for(c=0;c<e.length;c+=3)e[c+1]?e[c+1]===2?r[e[c]](e[c+2]):r[e[c]]=e[c+2]:e[c+2]?a[e[c]]=e[c+2]:a.removeProperty(e[c].substr(0,2)==="--"?e[c]:e[c].replace(nf,"-$1").toLowerCase());if(this.tfm){for(u in this.tfm)o[u]=this.tfm[u];o.svg&&(o.renderTransform(),r.setAttribute("data-svg-origin",this.svgo||"")),c=tf(),(!c||!c.isStart)&&!a[Pt]&&(gy(a),o.zOrigin&&a[In]&&(a[In]+=" "+o.zOrigin+"px",o.zOrigin=0,o.renderTransform()),o.uncache=1)}},vy=function(e,r){var a={target:e,props:[],revert:VS,save:zS};return e._gsap||Bn.core.getCache(e),r&&e.style&&e.nodeType&&r.split(",").forEach(function(o){return a.save(o)}),a},yy,pd=function(e,r){var a=gr.createElementNS?gr.createElementNS((r||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):gr.createElement(e);return a&&a.style?a:gr.createElement(e)},ci=function n(e,r,a){var o=getComputedStyle(e);return o[r]||o.getPropertyValue(r.replace(nf,"-$1").toLowerCase())||o.getPropertyValue(r)||!a&&n(e,js(r)||r,1)||""},Xm="O,Moz,ms,Ms,Webkit".split(","),js=function(e,r,a){var o=r||Hr,c=o.style,u=5;if(e in c&&!a)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);u--&&!(Xm[u]+e in c););return u<0?null:(u===3?"ms":u>=0?Xm[u]:"")+e},hd=function(){ES()&&window.document&&(Hm=window,gr=Hm.document,Os=gr.documentElement,Hr=pd("div")||{style:{}},pd("div"),Pt=js(Pt),In=Pt+"Origin",Hr.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",yy=!!js("perspective"),tf=Bn.core.reverting,ef=1)},Gm=function(e){var r=e.ownerSVGElement,a=pd("svg",r&&r.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),o=e.cloneNode(!0),c;o.style.display="block",a.appendChild(o),Os.appendChild(a);try{c=o.getBBox()}catch{}return a.removeChild(o),Os.removeChild(a),c},Km=function(e,r){for(var a=r.length;a--;)if(e.hasAttribute(r[a]))return e.getAttribute(r[a])},wy=function(e){var r,a;try{r=e.getBBox()}catch{r=Gm(e),a=1}return r&&(r.width||r.height)||a||(r=Gm(e)),r&&!r.width&&!r.x&&!r.y?{x:+Km(e,["x","cx","x1"])||0,y:+Km(e,["y","cy","y1"])||0,width:0,height:0}:r},by=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&wy(e))},es=function(e,r){if(r){var a=e.style,o;r in Hi&&r!==In&&(r=Pt),a.removeProperty?(o=r.substr(0,2),(o==="ms"||r.substr(0,6)==="webkit")&&(r="-"+r),a.removeProperty(o==="--"?r:r.replace(nf,"-$1").toLowerCase())):a.removeAttribute(r)}},vr=function(e,r,a,o,c,u){var p=new Nn(e._pt,r,a,0,1,u?my:hy);return e._pt=p,p.b=o,p.e=c,e._props.push(a),p},Qm={deg:1,rad:1,turn:1},US={grid:1,flex:1},xr=function n(e,r,a,o){var c=parseFloat(a)||0,u=(a+"").trim().substr((c+"").length)||"px",p=Hr.style,h=PS.test(r),g=e.tagName.toLowerCase()==="svg",v=(g?"client":"offset")+(h?"Width":"Height"),k=100,T=o==="px",P=o==="%",M,D,R,N;if(o===u||!c||Qm[o]||Qm[u])return c;if(u!=="px"&&!T&&(c=n(e,r,a,"px")),N=e.getCTM&&by(e),(P||u==="%")&&(Hi[r]||~r.indexOf("adius")))return M=N?e.getBBox()[h?"width":"height"]:e[v],Bt(P?c/M*k:c/100*M);if(p[h?"width":"height"]=k+(T?u:o),D=o!=="rem"&&~r.indexOf("adius")||o==="em"&&e.appendChild&&!g?e:e.parentNode,N&&(D=(e.ownerSVGElement||{}).parentNode),(!D||D===gr||!D.appendChild)&&(D=gr.body),R=D._gsap,R&&P&&R.width&&h&&R.time===Yn.time&&!R.uncache)return Bt(c/R.width*k);if(P&&(r==="height"||r==="width")){var H=e.style[r];e.style[r]=k+o,M=e[v],H?e.style[r]=H:es(e,r)}else(P||u==="%")&&!US[ci(D,"display")]&&(p.position=ci(e,"position")),D===e&&(p.position="static"),D.appendChild(Hr),M=Hr[v],D.removeChild(Hr),p.position="absolute";return h&&P&&(R=Xr(D),R.time=Yn.time,R.width=D[v]),Bt(T?M*c/k:M&&c?k/M*c:0)},ji=function(e,r,a,o){var c;return ef||hd(),r in Di&&r!=="transform"&&(r=Di[r],~r.indexOf(",")&&(r=r.split(",")[0])),Hi[r]&&r!=="transform"?(c=Xa(e,o),c=r!=="transformOrigin"?c[r]:c.svg?c.origin:Dl(ci(e,In))+" "+c.zOrigin+"px"):(c=e.style[r],(!c||c==="auto"||o||~(c+"").indexOf("calc("))&&(c=Pl[r]&&Pl[r](e,r,a)||ci(e,r)||Nv(e,r)||(r==="opacity"?1:0))),a&&!~(c+"").trim().indexOf(" ")?xr(e,r,c,a)+a:c},WS=function(e,r,a,o){if(!a||a==="none"){var c=js(r,e,1),u=c&&ci(e,c,1);u&&u!==a?(r=c,a=u):r==="borderColor"&&(a=ci(e,"borderTopColor"))}var p=new Nn(this._pt,e.style,r,0,1,dy),h=0,g=0,v,k,T,P,M,D,R,N,H,A,W,U;if(p.b=a,p.e=o,a+="",o+="",o.substring(0,6)==="var(--"&&(o=ci(e,o.substring(4,o.indexOf(")")))),o==="auto"&&(D=e.style[r],e.style[r]=o,o=ci(e,r)||o,D?e.style[r]=D:es(e,r)),v=[a,o],ty(v),a=v[0],o=v[1],T=a.match(Es)||[],U=o.match(Es)||[],U.length){for(;k=Es.exec(o);)R=k[0],H=o.substring(h,k.index),M?M=(M+1)%5:(H.substr(-5)==="rgba("||H.substr(-5)==="hsla(")&&(M=1),R!==(D=T[g++]||"")&&(P=parseFloat(D)||0,W=D.substr((P+"").length),R.charAt(1)==="="&&(R=Fs(P,R)+W),N=parseFloat(R),A=R.substr((N+"").length),h=Es.lastIndex-A.length,A||(A=A||Gn.units[r]||W,h===o.length&&(o+=A,p.e+=A)),W!==A&&(P=xr(e,r,D,A)||0),p._pt={_next:p._pt,p:H||g===1?H:",",s:P,c:N-P,m:M&&M<4||r==="zIndex"?Math.round:0});p.c=h<o.length?o.substring(h,o.length):""}else p.r=r==="display"&&o==="none"?my:hy;return Lv.test(o)&&(p.e=0),this._pt=p,p},Zm={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},jS=function(e){var r=e.split(" "),a=r[0],o=r[1]||"50%";return(a==="top"||a==="bottom"||o==="left"||o==="right")&&(e=a,a=o,o=e),r[0]=Zm[a]||a,r[1]=Zm[o]||o,r.join(" ")},qS=function(e,r){if(r.tween&&r.tween._time===r.tween._dur){var a=r.t,o=a.style,c=r.u,u=a._gsap,p,h,g;if(c==="all"||c===!0)o.cssText="",h=1;else for(c=c.split(","),g=c.length;--g>-1;)p=c[g],Hi[p]&&(h=1,p=p==="transformOrigin"?In:Pt),es(a,p);h&&(es(a,Pt),u&&(u.svg&&a.removeAttribute("transform"),o.scale=o.rotate=o.translate="none",Xa(a,1),u.uncache=1,gy(o)))}},Pl={clearProps:function(e,r,a,o,c){if(c.data!=="isFromStart"){var u=e._pt=new Nn(e._pt,r,a,0,0,qS);return u.u=o,u.pr=-10,u.tween=c,e._props.push(a),1}}},Ya=[1,0,0,1,0,0],xy={},Sy=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},Jm=function(e){var r=ci(e,Pt);return Sy(r)?Ya:r.substr(7).match(Dv).map(Bt)},rf=function(e,r){var a=e._gsap||Xr(e),o=e.style,c=Jm(e),u,p,h,g;return a.svg&&e.getAttribute("transform")?(h=e.transform.baseVal.consolidate().matrix,c=[h.a,h.b,h.c,h.d,h.e,h.f],c.join(",")==="1,0,0,1,0,0"?Ya:c):(c===Ya&&!e.offsetParent&&e!==Os&&!a.svg&&(h=o.display,o.display="block",u=e.parentNode,(!u||!e.offsetParent&&!e.getBoundingClientRect().width)&&(g=1,p=e.nextElementSibling,Os.appendChild(e)),c=Jm(e),h?o.display=h:es(e,"display"),g&&(p?u.insertBefore(e,p):u?u.appendChild(e):Os.removeChild(e))),r&&c.length>6?[c[0],c[1],c[4],c[5],c[12],c[13]]:c)},md=function(e,r,a,o,c,u){var p=e._gsap,h=c||rf(e,!0),g=p.xOrigin||0,v=p.yOrigin||0,k=p.xOffset||0,T=p.yOffset||0,P=h[0],M=h[1],D=h[2],R=h[3],N=h[4],H=h[5],A=r.split(" "),W=parseFloat(A[0])||0,U=parseFloat(A[1])||0,Z,ne,ee,Q;a?h!==Ya&&(ne=P*R-M*D)&&(ee=W*(R/ne)+U*(-D/ne)+(D*H-R*N)/ne,Q=W*(-M/ne)+U*(P/ne)-(P*H-M*N)/ne,W=ee,U=Q):(Z=wy(e),W=Z.x+(~A[0].indexOf("%")?W/100*Z.width:W),U=Z.y+(~(A[1]||A[0]).indexOf("%")?U/100*Z.height:U)),o||o!==!1&&p.smooth?(N=W-g,H=U-v,p.xOffset=k+(N*P+H*D)-N,p.yOffset=T+(N*M+H*R)-H):p.xOffset=p.yOffset=0,p.xOrigin=W,p.yOrigin=U,p.smooth=!!o,p.origin=r,p.originIsAbsolute=!!a,e.style[In]="0px 0px",u&&(vr(u,p,"xOrigin",g,W),vr(u,p,"yOrigin",v,U),vr(u,p,"xOffset",k,p.xOffset),vr(u,p,"yOffset",T,p.yOffset)),e.setAttribute("data-svg-origin",W+" "+U)},Xa=function(e,r){var a=e._gsap||new sy(e);if("x"in a&&!r&&!a.uncache)return a;var o=e.style,c=a.scaleX<0,u="px",p="deg",h=getComputedStyle(e),g=ci(e,In)||"0",v,k,T,P,M,D,R,N,H,A,W,U,Z,ne,ee,Q,ce,me,ve,ke,we,d,y,w,b,_,E,S,C,F,I,z;return v=k=T=D=R=N=H=A=W=0,P=M=1,a.svg=!!(e.getCTM&&by(e)),h.translate&&((h.translate!=="none"||h.scale!=="none"||h.rotate!=="none")&&(o[Pt]=(h.translate!=="none"?"translate3d("+(h.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(h.rotate!=="none"?"rotate("+h.rotate+") ":"")+(h.scale!=="none"?"scale("+h.scale.split(" ").join(",")+") ":"")+(h[Pt]!=="none"?h[Pt]:"")),o.scale=o.rotate=o.translate="none"),ne=rf(e,a.svg),a.svg&&(a.uncache?(b=e.getBBox(),g=a.xOrigin-b.x+"px "+(a.yOrigin-b.y)+"px",w=""):w=!r&&e.getAttribute("data-svg-origin"),md(e,w||g,!!w||a.originIsAbsolute,a.smooth!==!1,ne)),U=a.xOrigin||0,Z=a.yOrigin||0,ne!==Ya&&(me=ne[0],ve=ne[1],ke=ne[2],we=ne[3],v=d=ne[4],k=y=ne[5],ne.length===6?(P=Math.sqrt(me*me+ve*ve),M=Math.sqrt(we*we+ke*ke),D=me||ve?Cs(ve,me)*jr:0,H=ke||we?Cs(ke,we)*jr+D:0,H&&(M*=Math.abs(Math.cos(H*Ns))),a.svg&&(v-=U-(U*me+Z*ke),k-=Z-(U*ve+Z*we))):(z=ne[6],F=ne[7],E=ne[8],S=ne[9],C=ne[10],I=ne[11],v=ne[12],k=ne[13],T=ne[14],ee=Cs(z,C),R=ee*jr,ee&&(Q=Math.cos(-ee),ce=Math.sin(-ee),w=d*Q+E*ce,b=y*Q+S*ce,_=z*Q+C*ce,E=d*-ce+E*Q,S=y*-ce+S*Q,C=z*-ce+C*Q,I=F*-ce+I*Q,d=w,y=b,z=_),ee=Cs(-ke,C),N=ee*jr,ee&&(Q=Math.cos(-ee),ce=Math.sin(-ee),w=me*Q-E*ce,b=ve*Q-S*ce,_=ke*Q-C*ce,I=we*ce+I*Q,me=w,ve=b,ke=_),ee=Cs(ve,me),D=ee*jr,ee&&(Q=Math.cos(ee),ce=Math.sin(ee),w=me*Q+ve*ce,b=d*Q+y*ce,ve=ve*Q-me*ce,y=y*Q-d*ce,me=w,d=b),R&&Math.abs(R)+Math.abs(D)>359.9&&(R=D=0,N=180-N),P=Bt(Math.sqrt(me*me+ve*ve+ke*ke)),M=Bt(Math.sqrt(y*y+z*z)),ee=Cs(d,y),H=Math.abs(ee)>2e-4?ee*jr:0,W=I?1/(I<0?-I:I):0),a.svg&&(w=e.getAttribute("transform"),a.forceCSS=e.setAttribute("transform","")||!Sy(ci(e,Pt)),w&&e.setAttribute("transform",w))),Math.abs(H)>90&&Math.abs(H)<270&&(c?(P*=-1,H+=D<=0?180:-180,D+=D<=0?180:-180):(M*=-1,H+=H<=0?180:-180)),r=r||a.uncache,a.x=v-((a.xPercent=v&&(!r&&a.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-v)?-50:0)))?e.offsetWidth*a.xPercent/100:0)+u,a.y=k-((a.yPercent=k&&(!r&&a.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-k)?-50:0)))?e.offsetHeight*a.yPercent/100:0)+u,a.z=T+u,a.scaleX=Bt(P),a.scaleY=Bt(M),a.rotation=Bt(D)+p,a.rotationX=Bt(R)+p,a.rotationY=Bt(N)+p,a.skewX=H+p,a.skewY=A+p,a.transformPerspective=W+u,(a.zOrigin=parseFloat(g.split(" ")[2])||!r&&a.zOrigin||0)&&(o[In]=Dl(g)),a.xOffset=a.yOffset=0,a.force3D=Gn.force3D,a.renderTransform=a.svg?$S:yy?ky:HS,a.uncache=0,a},Dl=function(e){return(e=e.split(" "))[0]+" "+e[1]},Iu=function(e,r,a){var o=gn(r);return Bt(parseFloat(r)+parseFloat(xr(e,"x",a+"px",o)))+o},HS=function(e,r){r.z="0px",r.rotationY=r.rotationX="0deg",r.force3D=0,ky(e,r)},Vr="0deg",Pa="0px",Ur=") ",ky=function(e,r){var a=r||this,o=a.xPercent,c=a.yPercent,u=a.x,p=a.y,h=a.z,g=a.rotation,v=a.rotationY,k=a.rotationX,T=a.skewX,P=a.skewY,M=a.scaleX,D=a.scaleY,R=a.transformPerspective,N=a.force3D,H=a.target,A=a.zOrigin,W="",U=N==="auto"&&e&&e!==1||N===!0;if(A&&(k!==Vr||v!==Vr)){var Z=parseFloat(v)*Ns,ne=Math.sin(Z),ee=Math.cos(Z),Q;Z=parseFloat(k)*Ns,Q=Math.cos(Z),u=Iu(H,u,ne*Q*-A),p=Iu(H,p,-Math.sin(Z)*-A),h=Iu(H,h,ee*Q*-A+A)}R!==Pa&&(W+="perspective("+R+Ur),(o||c)&&(W+="translate("+o+"%, "+c+"%) "),(U||u!==Pa||p!==Pa||h!==Pa)&&(W+=h!==Pa||U?"translate3d("+u+", "+p+", "+h+") ":"translate("+u+", "+p+Ur),g!==Vr&&(W+="rotate("+g+Ur),v!==Vr&&(W+="rotateY("+v+Ur),k!==Vr&&(W+="rotateX("+k+Ur),(T!==Vr||P!==Vr)&&(W+="skew("+T+", "+P+Ur),(M!==1||D!==1)&&(W+="scale("+M+", "+D+Ur),H.style[Pt]=W||"translate(0, 0)"},$S=function(e,r){var a=r||this,o=a.xPercent,c=a.yPercent,u=a.x,p=a.y,h=a.rotation,g=a.skewX,v=a.skewY,k=a.scaleX,T=a.scaleY,P=a.target,M=a.xOrigin,D=a.yOrigin,R=a.xOffset,N=a.yOffset,H=a.forceCSS,A=parseFloat(u),W=parseFloat(p),U,Z,ne,ee,Q;h=parseFloat(h),g=parseFloat(g),v=parseFloat(v),v&&(v=parseFloat(v),g+=v,h+=v),h||g?(h*=Ns,g*=Ns,U=Math.cos(h)*k,Z=Math.sin(h)*k,ne=Math.sin(h-g)*-T,ee=Math.cos(h-g)*T,g&&(v*=Ns,Q=Math.tan(g-v),Q=Math.sqrt(1+Q*Q),ne*=Q,ee*=Q,v&&(Q=Math.tan(v),Q=Math.sqrt(1+Q*Q),U*=Q,Z*=Q)),U=Bt(U),Z=Bt(Z),ne=Bt(ne),ee=Bt(ee)):(U=k,ee=T,Z=ne=0),(A&&!~(u+"").indexOf("px")||W&&!~(p+"").indexOf("px"))&&(A=xr(P,"x",u,"px"),W=xr(P,"y",p,"px")),(M||D||R||N)&&(A=Bt(A+M-(M*U+D*ne)+R),W=Bt(W+D-(M*Z+D*ee)+N)),(o||c)&&(Q=P.getBBox(),A=Bt(A+o/100*Q.width),W=Bt(W+c/100*Q.height)),Q="matrix("+U+","+Z+","+ne+","+ee+","+A+","+W+")",P.setAttribute("transform",Q),H&&(P.style[Pt]=Q)},YS=function(e,r,a,o,c){var u=360,p=tn(c),h=parseFloat(c)*(p&&~c.indexOf("rad")?jr:1),g=h-o,v=o+g+"deg",k,T;return p&&(k=c.split("_")[1],k==="short"&&(g%=u,g!==g%(u/2)&&(g+=g<0?u:-u)),k==="cw"&&g<0?g=(g+u*Ym)%u-~~(g/u)*u:k==="ccw"&&g>0&&(g=(g-u*Ym)%u-~~(g/u)*u)),e._pt=T=new Nn(e._pt,r,a,o,g,LS),T.e=v,T.u="deg",e._props.push(a),T},eg=function(e,r){for(var a in r)e[a]=r[a];return e},XS=function(e,r,a){var o=eg({},a._gsap),c="perspective,force3D,transformOrigin,svgOrigin",u=a.style,p,h,g,v,k,T,P,M;o.svg?(g=a.getAttribute("transform"),a.setAttribute("transform",""),u[Pt]=r,p=Xa(a,1),es(a,Pt),a.setAttribute("transform",g)):(g=getComputedStyle(a)[Pt],u[Pt]=r,p=Xa(a,1),u[Pt]=g);for(h in Hi)g=o[h],v=p[h],g!==v&&c.indexOf(h)<0&&(P=gn(g),M=gn(v),k=P!==M?xr(a,h,g,M):parseFloat(g),T=parseFloat(v),e._pt=new Nn(e._pt,p,h,k,T-k,fd),e._pt.u=M||0,e._props.push(h));eg(p,o)};On("padding,margin,Width,Radius",function(n,e){var r="Top",a="Right",o="Bottom",c="Left",u=(e<3?[r,a,o,c]:[r+c,r+a,o+a,o+c]).map(function(p){return e<2?n+p:"border"+p+n});Pl[e>1?"border"+n:n]=function(p,h,g,v,k){var T,P;if(arguments.length<4)return T=u.map(function(M){return ji(p,M,g)}),P=T.join(" "),P.split(T[0]).length===5?T[0]:P;T=(v+"").split(" "),P={},u.forEach(function(M,D){return P[M]=T[D]=T[D]||T[(D-1)/2|0]}),p.init(h,P,k)}});var _y={name:"css",register:hd,targetTest:function(e){return e.style&&e.nodeType},init:function(e,r,a,o,c){var u=this._props,p=e.style,h=a.vars.startAt,g,v,k,T,P,M,D,R,N,H,A,W,U,Z,ne,ee;ef||hd(),this.styles=this.styles||vy(e),ee=this.styles.props,this.tween=a;for(D in r)if(D!=="autoRound"&&(v=r[D],!($n[D]&&ay(D,r,a,o,e,c)))){if(P=typeof v,M=Pl[D],P==="function"&&(v=v.call(a,o,e,c),P=typeof v),P==="string"&&~v.indexOf("random(")&&(v=qa(v)),M)M(this,e,D,v,a)&&(ne=1);else if(D.substr(0,2)==="--")g=(getComputedStyle(e).getPropertyValue(D)+"").trim(),v+="",wr.lastIndex=0,wr.test(g)||(R=gn(g),N=gn(v)),N?R!==N&&(g=xr(e,D,g,N)+N):R&&(v+=R),this.add(p,"setProperty",g,v,o,c,0,0,D),u.push(D),ee.push(D,0,p[D]);else if(P!=="undefined"){if(h&&D in h?(g=typeof h[D]=="function"?h[D].call(a,o,e,c):h[D],tn(g)&&~g.indexOf("random(")&&(g=qa(g)),gn(g+"")||g==="auto"||(g+=Gn.units[D]||gn(ji(e,D))||""),(g+"").charAt(1)==="="&&(g=ji(e,D))):g=ji(e,D),T=parseFloat(g),H=P==="string"&&v.charAt(1)==="="&&v.substr(0,2),H&&(v=v.substr(2)),k=parseFloat(v),D in Di&&(D==="autoAlpha"&&(T===1&&ji(e,"visibility")==="hidden"&&k&&(T=0),ee.push("visibility",0,p.visibility),vr(this,p,"visibility",T?"inherit":"hidden",k?"inherit":"hidden",!k)),D!=="scale"&&D!=="transform"&&(D=Di[D],~D.indexOf(",")&&(D=D.split(",")[0]))),A=D in Hi,A){if(this.styles.save(D),P==="string"&&v.substring(0,6)==="var(--"&&(v=ci(e,v.substring(4,v.indexOf(")"))),k=parseFloat(v)),W||(U=e._gsap,U.renderTransform&&!r.parseTransform||Xa(e,r.parseTransform),Z=r.smoothOrigin!==!1&&U.smooth,W=this._pt=new Nn(this._pt,p,Pt,0,1,U.renderTransform,U,0,-1),W.dep=1),D==="scale")this._pt=new Nn(this._pt,U,"scaleY",U.scaleY,(H?Fs(U.scaleY,H+k):k)-U.scaleY||0,fd),this._pt.u=0,u.push("scaleY",D),D+="X";else if(D==="transformOrigin"){ee.push(In,0,p[In]),v=jS(v),U.svg?md(e,v,0,Z,0,this):(N=parseFloat(v.split(" ")[2])||0,N!==U.zOrigin&&vr(this,U,"zOrigin",U.zOrigin,N),vr(this,p,D,Dl(g),Dl(v)));continue}else if(D==="svgOrigin"){md(e,v,1,Z,0,this);continue}else if(D in xy){YS(this,U,D,T,H?Fs(T,H+v):v);continue}else if(D==="smoothOrigin"){vr(this,U,"smooth",U.smooth,v);continue}else if(D==="force3D"){U[D]=v;continue}else if(D==="transform"){XS(this,v,e);continue}}else D in p||(D=js(D)||D);if(A||(k||k===0)&&(T||T===0)&&!DS.test(v)&&D in p)R=(g+"").substr((T+"").length),k||(k=0),N=gn(v)||(D in Gn.units?Gn.units[D]:R),R!==N&&(T=xr(e,D,g,N)),this._pt=new Nn(this._pt,A?U:p,D,T,(H?Fs(T,H+k):k)-T,!A&&(N==="px"||D==="zIndex")&&r.autoRound!==!1?AS:fd),this._pt.u=N||0,R!==N&&N!=="%"&&(this._pt.b=g,this._pt.r=MS);else if(D in p)WS.call(this,e,D,g,H?H+v:v);else if(D in e)this.add(e,D,g||e[D],H?H+v:v,o,c);else if(D!=="parseTransform"){qd(D,v);continue}A||(D in p?ee.push(D,0,p[D]):typeof e[D]=="function"?ee.push(D,2,e[D]()):ee.push(D,1,g||e[D])),u.push(D)}}ne&&fy(this)},render:function(e,r){if(r.tween._time||!tf())for(var a=r._pt;a;)a.r(e,a.d),a=a._next;else r.styles.revert()},get:ji,aliases:Di,getSetter:function(e,r,a){var o=Di[r];return o&&o.indexOf(",")<0&&(r=o),r in Hi&&r!==In&&(e._gsap.x||ji(e,"x"))?a&&$m===a?r==="scale"?NS:OS:($m=a||{})&&(r==="scale"?IS:BS):e.style&&!Ud(e.style[r])?RS:~r.indexOf("-")?FS:Zd(e,r)},core:{_removeProperty:es,_getMatrix:rf}};Bn.utils.checkPrefix=js;Bn.core.getStyleSaver=vy;(function(n,e,r,a){var o=On(n+","+e+","+r,function(c){Hi[c]=1});On(e,function(c){Gn.units[c]="deg",xy[c]=1}),Di[o[13]]=n+","+e,On(a,function(c){var u=c.split(":");Di[u[1]]=o[u[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");On("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){Gn.units[n]="px"});Bn.registerPlugin(_y);var ct=Bn.registerPlugin(_y)||Bn;ct.core.Tween;const GS=({position:n="right",colors:e=["#1a1a2e","#16213e","#0f3460"],items:r=[],socialItems:a=[],displaySocials:o=!0,displayItemNumbering:c=!0,menuButtonColor:u="#fff",openMenuButtonColor:p="#fff",accentColor:h="#ffffff",changeMenuColorOnOpen:g=!0,onMenuOpen:v,onMenuClose:k,onItemClick:T,languageToggle:P})=>{const[M,D]=se.useState(!1),R=se.useRef(!1),N=se.useRef(null),H=se.useRef(null),A=se.useRef([]),W=se.useRef(null),U=se.useRef(null),Z=se.useRef(null),ne=se.useRef(null),ee=se.useRef(null),[Q,ce]=se.useState(["Menu","Close"]),me=se.useRef(null),ve=se.useRef(null),ke=se.useRef(null),we=se.useRef(null),d=se.useRef(null),y=se.useRef(null),w=se.useRef(!1),b=se.useRef(null);se.useLayoutEffect(()=>{const V=ct.context(()=>{const X=N.current,G=H.current,j=W.current,Y=U.current,ie=Z.current,ae=ne.current;if(!X||!j||!Y||!ie||!ae)return;let le=[];G&&(le=Array.from(G.querySelectorAll(".sm-prelayer"))),A.current=le;const pe=n==="left"?-100:100;ct.set([X,...le],{xPercent:pe}),ct.set(j,{transformOrigin:"50% 50%",rotate:0}),ct.set(Y,{transformOrigin:"50% 50%",rotate:90}),ct.set(ie,{rotate:0,transformOrigin:"50% 50%"}),ct.set(ae,{yPercent:0}),y.current&&ct.set(y.current,{color:u})});return()=>V.revert()},[u,n]);const _=se.useCallback(()=>{const V=N.current,X=A.current;if(!V)return null;me.current?.kill(),ve.current&&(ve.current.kill(),ve.current=null),b.current?.kill();const G=Array.from(V.querySelectorAll(".sm-panel-itemLabel")),j=Array.from(V.querySelectorAll(".sm-panel-list[data-numbering] .sm-panel-item")),Y=V.querySelector(".sm-socials-title"),ie=Array.from(V.querySelectorAll(".sm-socials-link")),ae=X.map(Ie=>({el:Ie,start:Number(ct.getProperty(Ie,"xPercent"))})),le=Number(ct.getProperty(V,"xPercent"));G.length&&ct.set(G,{yPercent:140,rotate:10}),j.length&&ct.set(j,{"--sm-num-opacity":0}),Y&&ct.set(Y,{opacity:0}),ie.length&&ct.set(ie,{y:25,opacity:0});const pe=ct.timeline({paused:!0});ae.forEach((Ie,We)=>{pe.fromTo(Ie.el,{xPercent:Ie.start},{xPercent:0,duration:.5,ease:"power4.out"},We*.07)});const oe=(ae.length?(ae.length-1)*.07:0)+(ae.length?.08:0),be=.65;if(pe.fromTo(V,{xPercent:le},{xPercent:0,duration:be,ease:"power4.out"},oe),G.length){const We=oe+be*.15;pe.to(G,{yPercent:0,rotate:0,duration:1,ease:"power4.out",stagger:{each:.1,from:"start"}},We),j.length&&pe.to(j,{duration:.6,ease:"power2.out","--sm-num-opacity":1,stagger:{each:.08,from:"start"}},We+.1)}if(Y||ie.length){const Ie=oe+be*.4;Y&&pe.to(Y,{opacity:1,duration:.5,ease:"power2.out"},Ie),ie.length&&pe.to(ie,{y:0,opacity:1,duration:.55,ease:"power3.out",stagger:{each:.08,from:"start"},onComplete:()=>{ct.set(ie,{clearProps:"opacity"})}},Ie+.04)}return me.current=pe,pe},[]),E=se.useCallback(()=>{if(w.current)return;w.current=!0;const V=_();V?(V.eventCallback("onComplete",()=>{w.current=!1}),V.play(0)):w.current=!1},[_]),S=se.useCallback(()=>{me.current?.kill(),me.current=null,b.current?.kill();const V=N.current,X=A.current;if(!V)return;const G=[...X,V];ve.current?.kill();const j=n==="left"?-100:100;ve.current=ct.to(G,{xPercent:j,duration:.32,ease:"power3.in",overwrite:"auto",onComplete:()=>{const Y=Array.from(V.querySelectorAll(".sm-panel-itemLabel"));Y.length&&ct.set(Y,{yPercent:140,rotate:10});const ie=Array.from(V.querySelectorAll(".sm-panel-list[data-numbering] .sm-panel-item"));ie.length&&ct.set(ie,{"--sm-num-opacity":0});const ae=V.querySelector(".sm-socials-title"),le=Array.from(V.querySelectorAll(".sm-socials-link"));ae&&ct.set(ae,{opacity:0}),le.length&&ct.set(le,{y:25,opacity:0}),w.current=!1}})},[n]),C=se.useCallback(V=>{const X=Z.current;X&&(ke.current?.kill(),V?ke.current=ct.to(X,{rotate:225,duration:.8,ease:"power4.out",overwrite:"auto"}):ke.current=ct.to(X,{rotate:0,duration:.35,ease:"power3.inOut",overwrite:"auto"}))},[]),F=se.useCallback(V=>{const X=y.current;if(X)if(d.current?.kill(),g){const G=V?p:u;d.current=ct.to(X,{color:G,delay:.18,duration:.3,ease:"power2.out"})}else ct.set(X,{color:u})},[p,u,g]);se.useEffect(()=>{if(y.current)if(g){const V=R.current?p:u;ct.set(y.current,{color:V})}else ct.set(y.current,{color:u})},[g,u,p]);const I=se.useCallback(V=>{const X=ne.current;if(!X)return;we.current?.kill();const G=V?"Menu":"Close",j=V?"Close":"Menu",Y=3,ie=[G];let ae=G;for(let _e=0;_e<Y;_e++)ae=ae==="Menu"?"Close":"Menu",ie.push(ae);ae!==j&&ie.push(j),ie.push(j),ce(ie),ct.set(X,{yPercent:0});const le=ie.length,pe=(le-1)/le*100;we.current=ct.to(X,{yPercent:-pe,duration:.5+le*.07,ease:"power4.out"})},[]),z=se.useCallback(()=>{const V=!R.current;R.current=V,D(V),V?(document.body.style.overflow="hidden",v?.(),E()):(document.body.style.overflow="",k?.(),S()),C(V),F(V),I(V)},[E,S,C,F,I,v,k]),O=se.useCallback(()=>{R.current&&(R.current=!1,D(!1),document.body.style.overflow="",k?.(),S(),C(!1),F(!1),I(!1))},[S,C,F,I,k]);se.useEffect(()=>{const V=X=>{X.key==="Escape"&&R.current&&O()};return document.addEventListener("keydown",V),()=>document.removeEventListener("keydown",V)},[O]),se.useEffect(()=>{const V=X=>{if(!R.current)return;const G=N.current,j=y.current;G&&G.contains(X.target)||j&&j.contains(X.target)||O()};return document.addEventListener("mousedown",V),()=>document.removeEventListener("mousedown",V)},[O]);const q=se.useCallback((V,X)=>{setTimeout(()=>{O()},150),T&&T(V,X)},[O,T]);return xe.jsxs("div",{className:"staggered-menu-wrapper",style:h?{"--sm-accent":h}:void 0,"data-position":n,"data-open":M||void 0,children:[xe.jsx("div",{ref:H,className:"sm-prelayers","aria-hidden":"true",children:(()=>{let X=[...e&&e.length?e.slice(0,4):["#1a1a2e","#16213e"]];if(X.length>=3){const G=Math.floor(X.length/2);X.splice(G,1)}return X.map((G,j)=>xe.jsx("div",{className:"sm-prelayer",style:{background:G}},j))})()}),xe.jsxs("button",{ref:y,className:"sm-toggle","aria-label":M?"Close menu":"Open menu","aria-expanded":M,"aria-controls":"staggered-menu-panel",onClick:z,type:"button",children:[xe.jsx("span",{ref:ee,className:"sm-toggle-textWrap","aria-hidden":"true",children:xe.jsx("span",{ref:ne,className:"sm-toggle-textInner",children:Q.map((V,X)=>xe.jsx("span",{className:"sm-toggle-line",children:V},X))})}),xe.jsxs("span",{ref:Z,className:"sm-icon","aria-hidden":"true",children:[xe.jsx("span",{ref:W,className:"sm-icon-line"}),xe.jsx("span",{ref:U,className:"sm-icon-line sm-icon-line-v"})]})]}),xe.jsxs("aside",{id:"staggered-menu-panel",ref:N,className:"staggered-menu-panel","aria-hidden":!M,children:[P&&xe.jsx("div",{className:"sm-lang-section",children:P}),xe.jsxs("div",{className:"sm-panel-inner",children:[xe.jsx("ul",{className:"sm-panel-list",role:"list","data-numbering":c||void 0,children:r&&r.length?r.map((V,X)=>xe.jsx("li",{className:"sm-panel-itemWrap",children:xe.jsx("a",{className:"sm-panel-item",href:V.link,"aria-label":V.ariaLabel,"data-index":X+1,onClick:G=>q(V,G),children:xe.jsx("span",{className:"sm-panel-itemLabel",children:V.label})})},V.label+X)):xe.jsx("li",{className:"sm-panel-itemWrap","aria-hidden":"true",children:xe.jsx("span",{className:"sm-panel-item",children:xe.jsx("span",{className:"sm-panel-itemLabel",children:"No items"})})})}),o&&a&&a.length>0&&xe.jsxs("div",{className:"sm-socials","aria-label":"Social links",children:[xe.jsx("h3",{className:"sm-socials-title",children:"Connect"}),xe.jsx("ul",{className:"sm-socials-list",role:"list",children:a.map((V,X)=>xe.jsx("li",{className:"sm-socials-item",children:xe.jsxs("a",{href:V.link,target:"_blank",rel:"noopener noreferrer",className:"sm-socials-link",children:[V.icon&&xe.jsx("span",{className:"sm-socials-icon",children:V.icon}),xe.jsx("span",{className:"sm-socials-label",children:V.label})]})},V.label+X))})]})]})]}),M&&xe.jsx("div",{className:"sm-overlay",onClick:O,"aria-hidden":"true"})]})},KS=[{i18nKey:"nav.home",fallback:"Home",ariaLabel:"Go to home section",link:"#home"},{i18nKey:"nav.services",fallback:"Services",ariaLabel:"View our services",link:"#philosophy"},{i18nKey:"nav.portfolio",fallback:"Portfolio",ariaLabel:"See our work",link:"#portfolio"},{i18nKey:"nav.agreement",fallback:"Agreement",ariaLabel:"View development agreement",link:"#contract"},{i18nKey:"nav.connect",fallback:"Connect",ariaLabel:"Get in touch",link:"#contact"}],Ts=(n,e)=>{const r=localStorage.getItem("scarlo-lang")||"en";if(typeof window.t=="function"){const o=window.t(n);if(o&&o!==n)return o}const a=window.TRANSLATIONS;return a&&a[r]&&a[r][n]?a[r][n]:a&&a.en&&a.en[n]?a.en[n]:e},QS=()=>localStorage.getItem("scarlo-lang")||"en",ZS=n=>{localStorage.setItem("scarlo-lang",n),document.documentElement.lang=n,typeof window.setLang=="function"&&window.setLang(n)},JS=()=>KS.map(n=>({label:Ts(n.i18nKey,n.fallback),ariaLabel:n.ariaLabel,link:n.link})),tg=()=>xe.jsx("svg",{className:"sm-social-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:xe.jsx("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"})}),ek=[{label:"Personal",link:"https://www.linkedin.com/in/carlos-martin-050876314/",icon:xe.jsx(tg,{})},{label:"Scarlo",link:"https://www.linkedin.com/company/110879775/",icon:xe.jsx(tg,{})}],tk=(n,e)=>{e.preventDefault();const r=n.link;if(!r||r==="#")return;const a=document.querySelector(r);if(a){const o=document.querySelector(".navbar"),c=o?o.offsetHeight:0,u=a.offsetTop-c;window.scrollTo({top:u,behavior:"smooth"})}},nk=()=>{console.log("Staggered menu opened"),document.body.classList.add("staggered-menu-open")},ik=()=>{console.log("Staggered menu closed"),document.body.classList.remove("staggered-menu-open")},rk=()=>{document.querySelectorAll("[data-i18n]").forEach(e=>{const r=e.getAttribute("data-i18n"),a=Ts(r,null);if(a){if(e.classList.contains("rotating-text"))return;e.textContent=a}}),document.querySelectorAll("[data-i18n-html]").forEach(e=>{const r=e.getAttribute("data-i18n-html"),a=Ts(r,null);a&&(e.innerHTML=a)}),document.querySelectorAll("[data-i18n-placeholder]").forEach(e=>{const r=e.getAttribute("data-i18n-placeholder"),a=Ts(r,null);a&&(e.placeholder=a)});const n=document.getElementById("authStatusText");if(n){const e=n.textContent==="Sign Out"||n.textContent==="Cerrar Sesin";n.textContent=Ts(e?"nav.signOut":"nav.signIn","Sign In")}window.rotatingText&&window.rotatingText.switchLanguage&&window.rotatingText.switchLanguage()},sk=({lang:n,onSwitch:e})=>xe.jsxs("div",{className:"sm-lang-toggle",role:"radiogroup","aria-label":"Language",children:[xe.jsx("button",{className:`sm-lang-btn${n==="en"?" active":""}`,onClick:()=>e("en"),"aria-checked":n==="en",role:"radio",type:"button",children:"EN"}),xe.jsx("span",{className:"sm-lang-divider",children:"|"}),xe.jsx("button",{className:`sm-lang-btn${n==="es"?" active":""}`,onClick:()=>e("es"),"aria-checked":n==="es",role:"radio",type:"button",children:"ES"})]}),ak=()=>{const[n,e]=se.useState(QS),r=se.useCallback(o=>{ZS(o),e(o);const c=document.getElementById("langToggle");c&&c.querySelectorAll(".lang-btn").forEach(u=>{u.classList.toggle("active",u.getAttribute("data-lang")===o)}),rk()},[]);se.useEffect(()=>{const o=document.getElementById("langToggle");if(!o)return;const c=u=>{const p=u.target.closest(".lang-btn");if(!p)return;const h=p.getAttribute("data-lang");h&&e(h)};return o.addEventListener("click",c),()=>o.removeEventListener("click",c)},[]);const a=JS();return xe.jsx(GS,{position:"right",items:a,socialItems:ek,displaySocials:!0,displayItemNumbering:!0,menuButtonColor:"#fff",openMenuButtonColor:"#fff",changeMenuColorOnOpen:!0,colors:["#0a0a12","#12121a","#1a1a24"],accentColor:"rgba(255, 255, 255, 0.9)",onMenuOpen:nk,onMenuClose:ik,onItemClick:tk,languageToggle:xe.jsx(sk,{lang:n,onSwitch:r})})},ng=document.getElementById("staggered-menu-root");ng?zd.createRoot(ng).render(xe.jsx(bv.StrictMode,{children:xe.jsx(ak,{})})):console.error("StaggeredMenu mount point not found: #staggered-menu-root");const Cy=se.createContext({});function Ty(n){const e=se.useRef(null);return e.current===null&&(e.current=n()),e.current}const sf=typeof window<"u",ok=sf?se.useLayoutEffect:se.useEffect,af=se.createContext(null);function of(n,e){n.indexOf(e)===-1&&n.push(e)}function lf(n,e){const r=n.indexOf(e);r>-1&&n.splice(r,1)}const $i=(n,e,r)=>r>e?e:r<n?n:r;let cf=()=>{};const Yi={},Ey=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function Py(n){return typeof n=="object"&&n!==null}const Dy=n=>/^0[^.\s]+$/u.test(n);function uf(n){let e;return()=>(e===void 0&&(e=n()),e)}const di=n=>n,lk=(n,e)=>r=>e(n(r)),no=(...n)=>n.reduce(lk),Ga=(n,e,r)=>{const a=e-n;return a===0?1:(r-n)/a};class df{constructor(){this.subscriptions=[]}add(e){return of(this.subscriptions,e),()=>lf(this.subscriptions,e)}notify(e,r,a){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](e,r,a);else for(let c=0;c<o;c++){const u=this.subscriptions[c];u&&u(e,r,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Li=n=>n*1e3,ui=n=>n/1e3;function Ly(n,e){return e?n*(1e3/e):0}const My=(n,e,r)=>(((1-3*r+3*e)*n+(3*r-6*e))*n+3*e)*n,ck=1e-7,uk=12;function dk(n,e,r,a,o){let c,u,p=0;do u=e+(r-e)/2,c=My(u,a,o)-n,c>0?r=u:e=u;while(Math.abs(c)>ck&&++p<uk);return u}function io(n,e,r,a){if(n===e&&r===a)return di;const o=c=>dk(c,0,1,n,r);return c=>c===0||c===1?c:My(o(c),e,a)}const Ay=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,Ry=n=>e=>1-n(1-e),Fy=io(.33,1.53,.69,.99),ff=Ry(Fy),Oy=Ay(ff),Ny=n=>(n*=2)<1?.5*ff(n):.5*(2-Math.pow(2,-10*(n-1))),pf=n=>1-Math.sin(Math.acos(n)),Iy=Ry(pf),By=Ay(pf),fk=io(.42,0,1,1),pk=io(0,0,.58,1),zy=io(.42,0,.58,1),hk=n=>Array.isArray(n)&&typeof n[0]!="number",Vy=n=>Array.isArray(n)&&typeof n[0]=="number",mk={linear:di,easeIn:fk,easeInOut:zy,easeOut:pk,circIn:pf,circInOut:By,circOut:Iy,backIn:ff,backInOut:Oy,backOut:Fy,anticipate:Ny},gk=n=>typeof n=="string",ig=n=>{if(Vy(n)){cf(n.length===4);const[e,r,a,o]=n;return io(e,r,a,o)}else if(gk(n))return mk[n];return n},fl=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function vk(n,e){let r=new Set,a=new Set,o=!1,c=!1;const u=new WeakSet;let p={delta:0,timestamp:0,isProcessing:!1};function h(v){u.has(v)&&(g.schedule(v),n()),v(p)}const g={schedule:(v,k=!1,T=!1)=>{const M=T&&o?r:a;return k&&u.add(v),M.has(v)||M.add(v),v},cancel:v=>{a.delete(v),u.delete(v)},process:v=>{if(p=v,o){c=!0;return}o=!0,[r,a]=[a,r],r.forEach(h),r.clear(),o=!1,c&&(c=!1,g.process(v))}};return g}const yk=40;function Uy(n,e){let r=!1,a=!0;const o={delta:0,timestamp:0,isProcessing:!1},c=()=>r=!0,u=fl.reduce((A,W)=>(A[W]=vk(c),A),{}),{setup:p,read:h,resolveKeyframes:g,preUpdate:v,update:k,preRender:T,render:P,postRender:M}=u,D=()=>{const A=Yi.useManualTiming?o.timestamp:performance.now();r=!1,Yi.useManualTiming||(o.delta=a?1e3/60:Math.max(Math.min(A-o.timestamp,yk),1)),o.timestamp=A,o.isProcessing=!0,p.process(o),h.process(o),g.process(o),v.process(o),k.process(o),T.process(o),P.process(o),M.process(o),o.isProcessing=!1,r&&e&&(a=!1,n(D))},R=()=>{r=!0,a=!0,o.isProcessing||n(D)};return{schedule:fl.reduce((A,W)=>{const U=u[W];return A[W]=(Z,ne=!1,ee=!1)=>(r||R(),U.schedule(Z,ne,ee)),A},{}),cancel:A=>{for(let W=0;W<fl.length;W++)u[fl[W]].cancel(A)},state:o,steps:u}}const{schedule:St,cancel:Sr,state:ln,steps:Bu}=Uy(typeof requestAnimationFrame<"u"?requestAnimationFrame:di,!0);let yl;function wk(){yl=void 0}const Rn={now:()=>(yl===void 0&&Rn.set(ln.isProcessing||Yi.useManualTiming?ln.timestamp:performance.now()),yl),set:n=>{yl=n,queueMicrotask(wk)}},Wy=n=>e=>typeof e=="string"&&e.startsWith(n),hf=Wy("--"),bk=Wy("var(--"),mf=n=>bk(n)?xk.test(n.split("/*")[0].trim()):!1,xk=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Hs={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},Ka={...Hs,transform:n=>$i(0,1,n)},pl={...Hs,default:1},Ba=n=>Math.round(n*1e5)/1e5,gf=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Sk(n){return n==null}const kk=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,vf=(n,e)=>r=>!!(typeof r=="string"&&kk.test(r)&&r.startsWith(n)||e&&!Sk(r)&&Object.prototype.hasOwnProperty.call(r,e)),jy=(n,e,r)=>a=>{if(typeof a!="string")return a;const[o,c,u,p]=a.match(gf);return{[n]:parseFloat(o),[e]:parseFloat(c),[r]:parseFloat(u),alpha:p!==void 0?parseFloat(p):1}},_k=n=>$i(0,255,n),zu={...Hs,transform:n=>Math.round(_k(n))},$r={test:vf("rgb","red"),parse:jy("red","green","blue"),transform:({red:n,green:e,blue:r,alpha:a=1})=>"rgba("+zu.transform(n)+", "+zu.transform(e)+", "+zu.transform(r)+", "+Ba(Ka.transform(a))+")"};function Ck(n){let e="",r="",a="",o="";return n.length>5?(e=n.substring(1,3),r=n.substring(3,5),a=n.substring(5,7),o=n.substring(7,9)):(e=n.substring(1,2),r=n.substring(2,3),a=n.substring(3,4),o=n.substring(4,5),e+=e,r+=r,a+=a,o+=o),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(a,16),alpha:o?parseInt(o,16)/255:1}}const gd={test:vf("#"),parse:Ck,transform:$r.transform},ro=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),hr=ro("deg"),Mi=ro("%"),Ve=ro("px"),Tk=ro("vh"),Ek=ro("vw"),rg={...Mi,parse:n=>Mi.parse(n)/100,transform:n=>Mi.transform(n*100)},Ds={test:vf("hsl","hue"),parse:jy("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:r,alpha:a=1})=>"hsla("+Math.round(n)+", "+Mi.transform(Ba(e))+", "+Mi.transform(Ba(r))+", "+Ba(Ka.transform(a))+")"},Ut={test:n=>$r.test(n)||gd.test(n)||Ds.test(n),parse:n=>$r.test(n)?$r.parse(n):Ds.test(n)?Ds.parse(n):gd.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?$r.transform(n):Ds.transform(n),getAnimatableNone:n=>{const e=Ut.parse(n);return e.alpha=0,Ut.transform(e)}},Pk=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Dk(n){return isNaN(n)&&typeof n=="string"&&(n.match(gf)?.length||0)+(n.match(Pk)?.length||0)>0}const qy="number",Hy="color",Lk="var",Mk="var(",sg="${}",Ak=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Qa(n){const e=n.toString(),r=[],a={color:[],number:[],var:[]},o=[];let c=0;const p=e.replace(Ak,h=>(Ut.test(h)?(a.color.push(c),o.push(Hy),r.push(Ut.parse(h))):h.startsWith(Mk)?(a.var.push(c),o.push(Lk),r.push(h)):(a.number.push(c),o.push(qy),r.push(parseFloat(h))),++c,sg)).split(sg);return{values:r,split:p,indexes:a,types:o}}function $y(n){return Qa(n).values}function Yy(n){const{split:e,types:r}=Qa(n),a=e.length;return o=>{let c="";for(let u=0;u<a;u++)if(c+=e[u],o[u]!==void 0){const p=r[u];p===qy?c+=Ba(o[u]):p===Hy?c+=Ut.transform(o[u]):c+=o[u]}return c}}const Rk=n=>typeof n=="number"?0:Ut.test(n)?Ut.getAnimatableNone(n):n;function Fk(n){const e=$y(n);return Yy(n)(e.map(Rk))}const kr={test:Dk,parse:$y,createTransformer:Yy,getAnimatableNone:Fk};function Vu(n,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?n+(e-n)*6*r:r<1/2?e:r<2/3?n+(e-n)*(2/3-r)*6:n}function Ok({hue:n,saturation:e,lightness:r,alpha:a}){n/=360,e/=100,r/=100;let o=0,c=0,u=0;if(!e)o=c=u=r;else{const p=r<.5?r*(1+e):r+e-r*e,h=2*r-p;o=Vu(h,p,n+1/3),c=Vu(h,p,n),u=Vu(h,p,n-1/3)}return{red:Math.round(o*255),green:Math.round(c*255),blue:Math.round(u*255),alpha:a}}function Ll(n,e){return r=>r>0?e:n}const Dt=(n,e,r)=>n+(e-n)*r,Uu=(n,e,r)=>{const a=n*n,o=r*(e*e-a)+a;return o<0?0:Math.sqrt(o)},Nk=[gd,$r,Ds],Ik=n=>Nk.find(e=>e.test(n));function ag(n){const e=Ik(n);if(!e)return!1;let r=e.parse(n);return e===Ds&&(r=Ok(r)),r}const og=(n,e)=>{const r=ag(n),a=ag(e);if(!r||!a)return Ll(n,e);const o={...r};return c=>(o.red=Uu(r.red,a.red,c),o.green=Uu(r.green,a.green,c),o.blue=Uu(r.blue,a.blue,c),o.alpha=Dt(r.alpha,a.alpha,c),$r.transform(o))},vd=new Set(["none","hidden"]);function Bk(n,e){return vd.has(n)?r=>r<=0?n:e:r=>r>=1?e:n}function zk(n,e){return r=>Dt(n,e,r)}function yf(n){return typeof n=="number"?zk:typeof n=="string"?mf(n)?Ll:Ut.test(n)?og:Wk:Array.isArray(n)?Xy:typeof n=="object"?Ut.test(n)?og:Vk:Ll}function Xy(n,e){const r=[...n],a=r.length,o=n.map((c,u)=>yf(c)(c,e[u]));return c=>{for(let u=0;u<a;u++)r[u]=o[u](c);return r}}function Vk(n,e){const r={...n,...e},a={};for(const o in r)n[o]!==void 0&&e[o]!==void 0&&(a[o]=yf(n[o])(n[o],e[o]));return o=>{for(const c in a)r[c]=a[c](o);return r}}function Uk(n,e){const r=[],a={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const c=e.types[o],u=n.indexes[c][a[c]],p=n.values[u]??0;r[o]=p,a[c]++}return r}const Wk=(n,e)=>{const r=kr.createTransformer(e),a=Qa(n),o=Qa(e);return a.indexes.var.length===o.indexes.var.length&&a.indexes.color.length===o.indexes.color.length&&a.indexes.number.length>=o.indexes.number.length?vd.has(n)&&!o.values.length||vd.has(e)&&!a.values.length?Bk(n,e):no(Xy(Uk(a,o),o.values),r):Ll(n,e)};function Gy(n,e,r){return typeof n=="number"&&typeof e=="number"&&typeof r=="number"?Dt(n,e,r):yf(n)(n,e)}const jk=n=>{const e=({timestamp:r})=>n(r);return{start:(r=!0)=>St.update(e,r),stop:()=>Sr(e),now:()=>ln.isProcessing?ln.timestamp:Rn.now()}},Ky=(n,e,r=10)=>{let a="";const o=Math.max(Math.round(e/r),2);for(let c=0;c<o;c++)a+=Math.round(n(c/(o-1))*1e4)/1e4+", ";return`linear(${a.substring(0,a.length-2)})`},Ml=2e4;function wf(n){let e=0;const r=50;let a=n.next(e);for(;!a.done&&e<Ml;)e+=r,a=n.next(e);return e>=Ml?1/0:e}function qk(n,e=100,r){const a=r({...n,keyframes:[0,e]}),o=Math.min(wf(a),Ml);return{type:"keyframes",ease:c=>a.next(o*c).value/e,duration:ui(o)}}const Hk=5;function Qy(n,e,r){const a=Math.max(e-Hk,0);return Ly(r-n(a),e-a)}const At={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Wu=.001;function $k({duration:n=At.duration,bounce:e=At.bounce,velocity:r=At.velocity,mass:a=At.mass}){let o,c,u=1-e;u=$i(At.minDamping,At.maxDamping,u),n=$i(At.minDuration,At.maxDuration,ui(n)),u<1?(o=g=>{const v=g*u,k=v*n,T=v-r,P=yd(g,u),M=Math.exp(-k);return Wu-T/P*M},c=g=>{const k=g*u*n,T=k*r+r,P=Math.pow(u,2)*Math.pow(g,2)*n,M=Math.exp(-k),D=yd(Math.pow(g,2),u);return(-o(g)+Wu>0?-1:1)*((T-P)*M)/D}):(o=g=>{const v=Math.exp(-g*n),k=(g-r)*n+1;return-Wu+v*k},c=g=>{const v=Math.exp(-g*n),k=(r-g)*(n*n);return v*k});const p=5/n,h=Xk(o,c,p);if(n=Li(n),isNaN(h))return{stiffness:At.stiffness,damping:At.damping,duration:n};{const g=Math.pow(h,2)*a;return{stiffness:g,damping:u*2*Math.sqrt(a*g),duration:n}}}const Yk=12;function Xk(n,e,r){let a=r;for(let o=1;o<Yk;o++)a=a-n(a)/e(a);return a}function yd(n,e){return n*Math.sqrt(1-e*e)}const Gk=["duration","bounce"],Kk=["stiffness","damping","mass"];function lg(n,e){return e.some(r=>n[r]!==void 0)}function Qk(n){let e={velocity:At.velocity,stiffness:At.stiffness,damping:At.damping,mass:At.mass,isResolvedFromDuration:!1,...n};if(!lg(n,Kk)&&lg(n,Gk))if(n.visualDuration){const r=n.visualDuration,a=2*Math.PI/(r*1.2),o=a*a,c=2*$i(.05,1,1-(n.bounce||0))*Math.sqrt(o);e={...e,mass:At.mass,stiffness:o,damping:c}}else{const r=$k(n);e={...e,...r,mass:At.mass},e.isResolvedFromDuration=!0}return e}function Al(n=At.visualDuration,e=At.bounce){const r=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:a,restDelta:o}=r;const c=r.keyframes[0],u=r.keyframes[r.keyframes.length-1],p={done:!1,value:c},{stiffness:h,damping:g,mass:v,duration:k,velocity:T,isResolvedFromDuration:P}=Qk({...r,velocity:-ui(r.velocity||0)}),M=T||0,D=g/(2*Math.sqrt(h*v)),R=u-c,N=ui(Math.sqrt(h/v)),H=Math.abs(R)<5;a||(a=H?At.restSpeed.granular:At.restSpeed.default),o||(o=H?At.restDelta.granular:At.restDelta.default);let A;if(D<1){const U=yd(N,D);A=Z=>{const ne=Math.exp(-D*N*Z);return u-ne*((M+D*N*R)/U*Math.sin(U*Z)+R*Math.cos(U*Z))}}else if(D===1)A=U=>u-Math.exp(-N*U)*(R+(M+N*R)*U);else{const U=N*Math.sqrt(D*D-1);A=Z=>{const ne=Math.exp(-D*N*Z),ee=Math.min(U*Z,300);return u-ne*((M+D*N*R)*Math.sinh(ee)+U*R*Math.cosh(ee))/U}}const W={calculatedDuration:P&&k||null,next:U=>{const Z=A(U);if(P)p.done=U>=k;else{let ne=U===0?M:0;D<1&&(ne=U===0?Li(M):Qy(A,U,Z));const ee=Math.abs(ne)<=a,Q=Math.abs(u-Z)<=o;p.done=ee&&Q}return p.value=p.done?u:Z,p},toString:()=>{const U=Math.min(wf(W),Ml),Z=Ky(ne=>W.next(U*ne).value,U,30);return U+"ms "+Z},toTransition:()=>{}};return W}Al.applyToOptions=n=>{const e=qk(n,100,Al);return n.ease=e.ease,n.duration=Li(e.duration),n.type="keyframes",n};function wd({keyframes:n,velocity:e=0,power:r=.8,timeConstant:a=325,bounceDamping:o=10,bounceStiffness:c=500,modifyTarget:u,min:p,max:h,restDelta:g=.5,restSpeed:v}){const k=n[0],T={done:!1,value:k},P=ee=>p!==void 0&&ee<p||h!==void 0&&ee>h,M=ee=>p===void 0?h:h===void 0||Math.abs(p-ee)<Math.abs(h-ee)?p:h;let D=r*e;const R=k+D,N=u===void 0?R:u(R);N!==R&&(D=N-k);const H=ee=>-D*Math.exp(-ee/a),A=ee=>N+H(ee),W=ee=>{const Q=H(ee),ce=A(ee);T.done=Math.abs(Q)<=g,T.value=T.done?N:ce};let U,Z;const ne=ee=>{P(T.value)&&(U=ee,Z=Al({keyframes:[T.value,M(T.value)],velocity:Qy(A,ee,T.value),damping:o,stiffness:c,restDelta:g,restSpeed:v}))};return ne(0),{calculatedDuration:null,next:ee=>{let Q=!1;return!Z&&U===void 0&&(Q=!0,W(ee),ne(ee)),U!==void 0&&ee>=U?Z.next(ee-U):(!Q&&W(ee),T)}}}function Zk(n,e,r){const a=[],o=r||Yi.mix||Gy,c=n.length-1;for(let u=0;u<c;u++){let p=o(n[u],n[u+1]);if(e){const h=Array.isArray(e)?e[u]||di:e;p=no(h,p)}a.push(p)}return a}function Jk(n,e,{clamp:r=!0,ease:a,mixer:o}={}){const c=n.length;if(cf(c===e.length),c===1)return()=>e[0];if(c===2&&e[0]===e[1])return()=>e[1];const u=n[0]===n[1];n[0]>n[c-1]&&(n=[...n].reverse(),e=[...e].reverse());const p=Zk(e,a,o),h=p.length,g=v=>{if(u&&v<n[0])return e[0];let k=0;if(h>1)for(;k<n.length-2&&!(v<n[k+1]);k++);const T=Ga(n[k],n[k+1],v);return p[k](T)};return r?v=>g($i(n[0],n[c-1],v)):g}function e2(n,e){const r=n[n.length-1];for(let a=1;a<=e;a++){const o=Ga(0,e,a);n.push(Dt(r,1,o))}}function t2(n){const e=[0];return e2(e,n.length-1),e}function n2(n,e){return n.map(r=>r*e)}function i2(n,e){return n.map(()=>e||zy).splice(0,n.length-1)}function za({duration:n=300,keyframes:e,times:r,ease:a="easeInOut"}){const o=hk(a)?a.map(ig):ig(a),c={done:!1,value:e[0]},u=n2(r&&r.length===e.length?r:t2(e),n),p=Jk(u,e,{ease:Array.isArray(o)?o:i2(e,o)});return{calculatedDuration:n,next:h=>(c.value=p(h),c.done=h>=n,c)}}const r2=n=>n!==null;function bf(n,{repeat:e,repeatType:r="loop"},a,o=1){const c=n.filter(r2),p=o<0||e&&r!=="loop"&&e%2===1?0:c.length-1;return!p||a===void 0?c[p]:a}const s2={decay:wd,inertia:wd,tween:za,keyframes:za,spring:Al};function Zy(n){typeof n.type=="string"&&(n.type=s2[n.type])}class xf{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const a2=n=>n/100;class Sf extends xf{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==Rn.now()&&this.tick(Rn.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;Zy(e);const{type:r=za,repeat:a=0,repeatDelay:o=0,repeatType:c,velocity:u=0}=e;let{keyframes:p}=e;const h=r||za;h!==za&&typeof p[0]!="number"&&(this.mixKeyframes=no(a2,Gy(p[0],p[1])),p=[0,100]);const g=h({...e,keyframes:p});c==="mirror"&&(this.mirroredGenerator=h({...e,keyframes:[...p].reverse(),velocity:-u})),g.calculatedDuration===null&&(g.calculatedDuration=wf(g));const{calculatedDuration:v}=g;this.calculatedDuration=v,this.resolvedDuration=v+o,this.totalDuration=this.resolvedDuration*(a+1)-o,this.generator=g}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:a,totalDuration:o,mixKeyframes:c,mirroredGenerator:u,resolvedDuration:p,calculatedDuration:h}=this;if(this.startTime===null)return a.next(0);const{delay:g=0,keyframes:v,repeat:k,repeatType:T,repeatDelay:P,type:M,onUpdate:D,finalKeyframe:R}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-o/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const N=this.currentTime-g*(this.playbackSpeed>=0?1:-1),H=this.playbackSpeed>=0?N<0:N>o;this.currentTime=Math.max(N,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=o);let A=this.currentTime,W=a;if(k){const ee=Math.min(this.currentTime,o)/p;let Q=Math.floor(ee),ce=ee%1;!ce&&ee>=1&&(ce=1),ce===1&&Q--,Q=Math.min(Q,k+1),Q%2&&(T==="reverse"?(ce=1-ce,P&&(ce-=P/p)):T==="mirror"&&(W=u)),A=$i(0,1,ce)*p}const U=H?{done:!1,value:v[0]}:W.next(A);c&&(U.value=c(U.value));let{done:Z}=U;!H&&h!==null&&(Z=this.playbackSpeed>=0?this.currentTime>=o:this.currentTime<=0);const ne=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Z);return ne&&M!==wd&&(U.value=bf(v,this.options,R,this.speed)),D&&D(U.value),ne&&this.finish(),U}then(e,r){return this.finished.then(e,r)}get duration(){return ui(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+ui(e)}get time(){return ui(this.currentTime)}set time(e){e=Li(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Rn.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=ui(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=jk,startTime:r}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),this.options.onPlay?.();const a=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=a):this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime||(this.startTime=r??a),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Rn.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function o2(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const Yr=n=>n*180/Math.PI,bd=n=>{const e=Yr(Math.atan2(n[1],n[0]));return xd(e)},l2={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:bd,rotateZ:bd,skewX:n=>Yr(Math.atan(n[1])),skewY:n=>Yr(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},xd=n=>(n=n%360,n<0&&(n+=360),n),cg=bd,ug=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),dg=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),c2={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:ug,scaleY:dg,scale:n=>(ug(n)+dg(n))/2,rotateX:n=>xd(Yr(Math.atan2(n[6],n[5]))),rotateY:n=>xd(Yr(Math.atan2(-n[2],n[0]))),rotateZ:cg,rotate:cg,skewX:n=>Yr(Math.atan(n[4])),skewY:n=>Yr(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function Sd(n){return n.includes("scale")?1:0}function kd(n,e){if(!n||n==="none")return Sd(e);const r=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,o;if(r)a=c2,o=r;else{const p=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=l2,o=p}if(!o)return Sd(e);const c=a[e],u=o[1].split(",").map(d2);return typeof c=="function"?c(u):u[c]}const u2=(n,e)=>{const{transform:r="none"}=getComputedStyle(n);return kd(r,e)};function d2(n){return parseFloat(n.trim())}const $s=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ys=new Set($s),fg=n=>n===Hs||n===Ve,f2=new Set(["x","y","z"]),p2=$s.filter(n=>!f2.has(n));function h2(n){const e=[];return p2.forEach(r=>{const a=n.getValue(r);a!==void 0&&(e.push([r,a.get()]),a.set(r.startsWith("scale")?1:0))}),e}const Zr={width:({x:n},{paddingLeft:e="0",paddingRight:r="0"})=>n.max-n.min-parseFloat(e)-parseFloat(r),height:({y:n},{paddingTop:e="0",paddingBottom:r="0"})=>n.max-n.min-parseFloat(e)-parseFloat(r),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>kd(e,"x"),y:(n,{transform:e})=>kd(e,"y")};Zr.translateX=Zr.x;Zr.translateY=Zr.y;const Jr=new Set;let _d=!1,Cd=!1,Td=!1;function Jy(){if(Cd){const n=Array.from(Jr).filter(a=>a.needsMeasurement),e=new Set(n.map(a=>a.element)),r=new Map;e.forEach(a=>{const o=h2(a);o.length&&(r.set(a,o),a.render())}),n.forEach(a=>a.measureInitialState()),e.forEach(a=>{a.render();const o=r.get(a);o&&o.forEach(([c,u])=>{a.getValue(c)?.set(u)})}),n.forEach(a=>a.measureEndState()),n.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}Cd=!1,_d=!1,Jr.forEach(n=>n.complete(Td)),Jr.clear()}function e0(){Jr.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(Cd=!0)})}function m2(){Td=!0,e0(),Jy(),Td=!1}class kf{constructor(e,r,a,o,c,u=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=a,this.motionValue=o,this.element=c,this.isAsync=u}scheduleResolve(){this.state="scheduled",this.isAsync?(Jr.add(this),_d||(_d=!0,St.read(e0),St.resolveKeyframes(Jy))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:a,motionValue:o}=this;if(e[0]===null){const c=o?.get(),u=e[e.length-1];if(c!==void 0)e[0]=c;else if(a&&r){const p=a.readValue(r,u);p!=null&&(e[0]=p)}e[0]===void 0&&(e[0]=u),o&&c===void 0&&o.set(e[0])}o2(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Jr.delete(this)}cancel(){this.state==="scheduled"&&(Jr.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const g2=n=>n.startsWith("--");function v2(n,e,r){g2(e)?n.style.setProperty(e,r):n.style[e]=r}const y2=uf(()=>window.ScrollTimeline!==void 0),w2={};function b2(n,e){const r=uf(n);return()=>w2[e]??r()}const t0=b2(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Ra=([n,e,r,a])=>`cubic-bezier(${n}, ${e}, ${r}, ${a})`,pg={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Ra([0,.65,.55,1]),circOut:Ra([.55,0,1,.45]),backIn:Ra([.31,.01,.66,-.59]),backOut:Ra([.33,1.53,.69,.99])};function n0(n,e){if(n)return typeof n=="function"?t0()?Ky(n,e):"ease-out":Vy(n)?Ra(n):Array.isArray(n)?n.map(r=>n0(r,e)||pg.easeOut):pg[n]}function x2(n,e,r,{delay:a=0,duration:o=300,repeat:c=0,repeatType:u="loop",ease:p="easeOut",times:h}={},g=void 0){const v={[e]:r};h&&(v.offset=h);const k=n0(p,o);Array.isArray(k)&&(v.easing=k);const T={delay:a,duration:o,easing:Array.isArray(k)?"linear":k,fill:"both",iterations:c+1,direction:u==="reverse"?"alternate":"normal"};return g&&(T.pseudoElement=g),n.animate(v,T)}function i0(n){return typeof n=="function"&&"applyToOptions"in n}function S2({type:n,...e}){return i0(n)&&t0()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class k2 extends xf{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:a,keyframes:o,pseudoElement:c,allowFlatten:u=!1,finalKeyframe:p,onComplete:h}=e;this.isPseudoElement=!!c,this.allowFlatten=u,this.options=e,cf(typeof e.type!="string");const g=S2(e);this.animation=x2(r,a,o,g,c),g.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!c){const v=bf(o,this.options,p,this.speed);this.updateMotionValue?this.updateMotionValue(v):v2(r,a,v),this.animation.cancel()}h?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return ui(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+ui(e)}get time(){return ui(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Li(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&y2()?(this.animation.timeline=e,di):r(this)}}const r0={anticipate:Ny,backInOut:Oy,circInOut:By};function _2(n){return n in r0}function C2(n){typeof n.ease=="string"&&_2(n.ease)&&(n.ease=r0[n.ease])}const hg=10;class T2 extends k2{constructor(e){C2(e),Zy(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:a,onComplete:o,element:c,...u}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const p=new Sf({...u,autoplay:!1}),h=Li(this.finishedTime??this.time);r.setWithVelocity(p.sample(h-hg).value,p.sample(h).value,hg),p.stop()}}const mg=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(kr.test(n)||n==="0")&&!n.startsWith("url("));function E2(n){const e=n[0];if(n.length===1)return!0;for(let r=0;r<n.length;r++)if(n[r]!==e)return!0}function P2(n,e,r,a){const o=n[0];if(o===null)return!1;if(e==="display"||e==="visibility")return!0;const c=n[n.length-1],u=mg(o,e),p=mg(c,e);return!u||!p?!1:E2(n)||(r==="spring"||i0(r))&&a}function Ed(n){n.duration=0,n.type="keyframes"}const D2=new Set(["opacity","clipPath","filter","transform"]),L2=uf(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function M2(n){const{motionValue:e,name:r,repeatDelay:a,repeatType:o,damping:c,type:u}=n;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:h,transformTemplate:g}=e.owner.getProps();return L2()&&r&&D2.has(r)&&(r!=="transform"||!g)&&!h&&!a&&o!=="mirror"&&c!==0&&u!=="inertia"}const A2=40;class R2 extends xf{constructor({autoplay:e=!0,delay:r=0,type:a="keyframes",repeat:o=0,repeatDelay:c=0,repeatType:u="loop",keyframes:p,name:h,motionValue:g,element:v,...k}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Rn.now();const T={autoplay:e,delay:r,type:a,repeat:o,repeatDelay:c,repeatType:u,name:h,motionValue:g,element:v,...k},P=v?.KeyframeResolver||kf;this.keyframeResolver=new P(p,(M,D,R)=>this.onKeyframesResolved(M,D,T,!R),h,g,v),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,r,a,o){this.keyframeResolver=void 0;const{name:c,type:u,velocity:p,delay:h,isHandoff:g,onUpdate:v}=a;this.resolvedAt=Rn.now(),P2(e,c,u,p)||((Yi.instantAnimations||!h)&&v?.(bf(e,a,r)),e[0]=e[e.length-1],Ed(a),a.repeat=0);const T={startTime:o?this.resolvedAt?this.resolvedAt-this.createdAt>A2?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...a,keyframes:e},P=!g&&M2(T)?new T2({...T,element:T.motionValue.owner.current}):new Sf(T);P.finished.then(()=>this.notifyFinished()).catch(di),this.pendingTimeline&&(this.stopTimeline=P.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=P}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),m2()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const F2=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function O2(n){const e=F2.exec(n);if(!e)return[,];const[,r,a,o]=e;return[`--${r??a}`,o]}function s0(n,e,r=1){const[a,o]=O2(n);if(!a)return;const c=window.getComputedStyle(e).getPropertyValue(a);if(c){const u=c.trim();return Ey(u)?parseFloat(u):u}return mf(o)?s0(o,e,r+1):o}function _f(n,e){return n?.[e]??n?.default??n}const a0=new Set(["width","height","top","left","right","bottom",...$s]),N2={test:n=>n==="auto",parse:n=>n},o0=n=>e=>e.test(n),l0=[Hs,Ve,Mi,hr,Ek,Tk,N2],gg=n=>l0.find(o0(n));function I2(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||Dy(n):!0}const B2=new Set(["brightness","contrast","saturate","opacity"]);function z2(n){const[e,r]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[a]=r.match(gf)||[];if(!a)return n;const o=r.replace(a,"");let c=B2.has(e)?1:0;return a!==r&&(c*=100),e+"("+c+o+")"}const V2=/\b([a-z-]*)\(.*?\)/gu,Pd={...kr,getAnimatableNone:n=>{const e=n.match(V2);return e?e.map(z2).join(" "):n}},vg={...Hs,transform:Math.round},U2={rotate:hr,rotateX:hr,rotateY:hr,rotateZ:hr,scale:pl,scaleX:pl,scaleY:pl,scaleZ:pl,skew:hr,skewX:hr,skewY:hr,distance:Ve,translateX:Ve,translateY:Ve,translateZ:Ve,x:Ve,y:Ve,z:Ve,perspective:Ve,transformPerspective:Ve,opacity:Ka,originX:rg,originY:rg,originZ:Ve},Cf={borderWidth:Ve,borderTopWidth:Ve,borderRightWidth:Ve,borderBottomWidth:Ve,borderLeftWidth:Ve,borderRadius:Ve,radius:Ve,borderTopLeftRadius:Ve,borderTopRightRadius:Ve,borderBottomRightRadius:Ve,borderBottomLeftRadius:Ve,width:Ve,maxWidth:Ve,height:Ve,maxHeight:Ve,top:Ve,right:Ve,bottom:Ve,left:Ve,padding:Ve,paddingTop:Ve,paddingRight:Ve,paddingBottom:Ve,paddingLeft:Ve,margin:Ve,marginTop:Ve,marginRight:Ve,marginBottom:Ve,marginLeft:Ve,backgroundPositionX:Ve,backgroundPositionY:Ve,...U2,zIndex:vg,fillOpacity:Ka,strokeOpacity:Ka,numOctaves:vg},W2={...Cf,color:Ut,backgroundColor:Ut,outlineColor:Ut,fill:Ut,stroke:Ut,borderColor:Ut,borderTopColor:Ut,borderRightColor:Ut,borderBottomColor:Ut,borderLeftColor:Ut,filter:Pd,WebkitFilter:Pd},c0=n=>W2[n];function u0(n,e){let r=c0(n);return r!==Pd&&(r=kr),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const j2=new Set(["auto","none","0"]);function q2(n,e,r){let a=0,o;for(;a<n.length&&!o;){const c=n[a];typeof c=="string"&&!j2.has(c)&&Qa(c).values.length&&(o=n[a]),a++}if(o&&r)for(const c of e)n[c]=u0(r,o)}class H2 extends kf{constructor(e,r,a,o,c){super(e,r,a,o,c,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:a}=this;if(!r||!r.current)return;super.readKeyframes();for(let h=0;h<e.length;h++){let g=e[h];if(typeof g=="string"&&(g=g.trim(),mf(g))){const v=s0(g,r.current);v!==void 0&&(e[h]=v),h===e.length-1&&(this.finalKeyframe=g)}}if(this.resolveNoneKeyframes(),!a0.has(a)||e.length!==2)return;const[o,c]=e,u=gg(o),p=gg(c);if(u!==p)if(fg(u)&&fg(p))for(let h=0;h<e.length;h++){const g=e[h];typeof g=="string"&&(e[h]=parseFloat(g))}else Zr[a]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,a=[];for(let o=0;o<e.length;o++)(e[o]===null||I2(e[o]))&&a.push(o);a.length&&q2(e,a,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:a}=this;if(!e||!e.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Zr[a](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const o=r[r.length-1];o!==void 0&&e.getValue(a,o).jump(o,!1)}measureEndState(){const{element:e,name:r,unresolvedKeyframes:a}=this;if(!e||!e.current)return;const o=e.getValue(r);o&&o.jump(this.measuredOrigin,!1);const c=a.length-1,u=a[c];a[c]=Zr[r](e.measureViewportBox(),window.getComputedStyle(e.current)),u!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=u),this.removedTransforms?.length&&this.removedTransforms.forEach(([p,h])=>{e.getValue(p).set(h)}),this.resolveNoneKeyframes()}}function $2(n,e,r){if(n instanceof EventTarget)return[n];if(typeof n=="string"){let a=document;const o=r?.[n]??a.querySelectorAll(n);return o?Array.from(o):[]}return Array.from(n)}const d0=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function Y2(n){return Py(n)&&"offsetHeight"in n}const yg=30,X2=n=>!isNaN(parseFloat(n));class G2{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{const o=Rn.now();if(this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const c of this.dependents)c.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=Rn.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=X2(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new df);const a=this.events[e].add(r);return e==="change"?()=>{a(),St.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,a){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-a}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Rn.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>yg)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,yg);return Ly(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ts(n,e){return new G2(n,e)}const{schedule:Tf}=Uy(queueMicrotask,!1),xi={x:!1,y:!1};function f0(){return xi.x||xi.y}function K2(n){return n==="x"||n==="y"?xi[n]?null:(xi[n]=!0,()=>{xi[n]=!1}):xi.x||xi.y?null:(xi.x=xi.y=!0,()=>{xi.x=xi.y=!1})}function p0(n,e){const r=$2(n),a=new AbortController,o={passive:!0,...e,signal:a.signal};return[r,o,()=>a.abort()]}function wg(n){return!(n.pointerType==="touch"||f0())}function Q2(n,e,r={}){const[a,o,c]=p0(n,r),u=p=>{if(!wg(p))return;const{target:h}=p,g=e(h,p);if(typeof g!="function"||!h)return;const v=k=>{wg(k)&&(g(k),h.removeEventListener("pointerleave",v))};h.addEventListener("pointerleave",v,o)};return a.forEach(p=>{p.addEventListener("pointerenter",u,o)}),c}const h0=(n,e)=>e?n===e?!0:h0(n,e.parentElement):!1,Ef=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,Z2=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function J2(n){return Z2.has(n.tagName)||n.tabIndex!==-1}const wl=new WeakSet;function bg(n){return e=>{e.key==="Enter"&&n(e)}}function ju(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const e_=(n,e)=>{const r=n.currentTarget;if(!r)return;const a=bg(()=>{if(wl.has(r))return;ju(r,"down");const o=bg(()=>{ju(r,"up")}),c=()=>ju(r,"cancel");r.addEventListener("keyup",o,e),r.addEventListener("blur",c,e)});r.addEventListener("keydown",a,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",a),e)};function xg(n){return Ef(n)&&!f0()}function t_(n,e,r={}){const[a,o,c]=p0(n,r),u=p=>{const h=p.currentTarget;if(!xg(p))return;wl.add(h);const g=e(h,p),v=(P,M)=>{window.removeEventListener("pointerup",k),window.removeEventListener("pointercancel",T),wl.has(h)&&wl.delete(h),xg(P)&&typeof g=="function"&&g(P,{success:M})},k=P=>{v(P,h===window||h===document||r.useGlobalTarget||h0(h,P.target))},T=P=>{v(P,!1)};window.addEventListener("pointerup",k,o),window.addEventListener("pointercancel",T,o)};return a.forEach(p=>{(r.useGlobalTarget?window:p).addEventListener("pointerdown",u,o),Y2(p)&&(p.addEventListener("focus",g=>e_(g,o)),!J2(p)&&!p.hasAttribute("tabindex")&&(p.tabIndex=0))}),c}function m0(n){return Py(n)&&"ownerSVGElement"in n}function n_(n){return m0(n)&&n.tagName==="svg"}const vn=n=>!!(n&&n.getVelocity),i_=[...l0,Ut,kr],r_=n=>i_.find(o0(n)),Pf=se.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function s_(n=!0){const e=se.useContext(af);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:a,register:o}=e,c=se.useId();se.useEffect(()=>{if(n)return o(c)},[n]);const u=se.useCallback(()=>n&&a&&a(c),[c,a,n]);return!r&&a?[!1,u]:[!0]}const g0=se.createContext({strict:!1}),Sg={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},qs={};for(const n in Sg)qs[n]={isEnabled:e=>Sg[n].some(r=>!!e[r])};function a_(n){for(const e in n)qs[e]={...qs[e],...n[e]}}const o_=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Rl(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||o_.has(n)}let v0=n=>!Rl(n);function l_(n){typeof n=="function"&&(v0=e=>e.startsWith("on")?!Rl(e):n(e))}try{l_(require("@emotion/is-prop-valid").default)}catch{}function c_(n,e,r){const a={};for(const o in n)o==="values"&&typeof n.values=="object"||(v0(o)||r===!0&&Rl(o)||!e&&!Rl(o)||n.draggable&&o.startsWith("onDrag"))&&(a[o]=n[o]);return a}const zl=se.createContext({});function Vl(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function Za(n){return typeof n=="string"||Array.isArray(n)}const Df=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Lf=["initial",...Df];function Ul(n){return Vl(n.animate)||Lf.some(e=>Za(n[e]))}function y0(n){return!!(Ul(n)||n.variants)}function u_(n,e){if(Ul(n)){const{initial:r,animate:a}=n;return{initial:r===!1||Za(r)?r:void 0,animate:Za(a)?a:void 0}}return n.inherit!==!1?e:{}}function d_(n){const{initial:e,animate:r}=u_(n,se.useContext(zl));return se.useMemo(()=>({initial:e,animate:r}),[kg(e),kg(r)])}function kg(n){return Array.isArray(n)?n.join(" "):n}const Ja={};function f_(n){for(const e in n)Ja[e]=n[e],hf(e)&&(Ja[e].isCSSVariable=!0)}function w0(n,{layout:e,layoutId:r}){return Ys.has(n)||n.startsWith("origin")||(e||r!==void 0)&&(!!Ja[n]||n==="opacity")}const p_={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},h_=$s.length;function m_(n,e,r){let a="",o=!0;for(let c=0;c<h_;c++){const u=$s[c],p=n[u];if(p===void 0)continue;let h=!0;if(typeof p=="number"?h=p===(u.startsWith("scale")?1:0):h=parseFloat(p)===0,!h||r){const g=d0(p,Cf[u]);if(!h){o=!1;const v=p_[u]||u;a+=`${v}(${g}) `}r&&(e[u]=g)}}return a=a.trim(),r?a=r(e,o?"":a):o&&(a="none"),a}function Mf(n,e,r){const{style:a,vars:o,transformOrigin:c}=n;let u=!1,p=!1;for(const h in e){const g=e[h];if(Ys.has(h)){u=!0;continue}else if(hf(h)){o[h]=g;continue}else{const v=d0(g,Cf[h]);h.startsWith("origin")?(p=!0,c[h]=v):a[h]=v}}if(e.transform||(u||r?a.transform=m_(e,n.transform,r):a.transform&&(a.transform="none")),p){const{originX:h="50%",originY:g="50%",originZ:v=0}=c;a.transformOrigin=`${h} ${g} ${v}`}}const Af=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function b0(n,e,r){for(const a in e)!vn(e[a])&&!w0(a,r)&&(n[a]=e[a])}function g_({transformTemplate:n},e){return se.useMemo(()=>{const r=Af();return Mf(r,e,n),Object.assign({},r.vars,r.style)},[e])}function v_(n,e){const r=n.style||{},a={};return b0(a,r,n),Object.assign(a,g_(n,e)),a}function y_(n,e){const r={},a=v_(n,e);return n.drag&&n.dragListener!==!1&&(r.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(r.tabIndex=0),r.style=a,r}const w_={offset:"stroke-dashoffset",array:"stroke-dasharray"},b_={offset:"strokeDashoffset",array:"strokeDasharray"};function x_(n,e,r=1,a=0,o=!0){n.pathLength=1;const c=o?w_:b_;n[c.offset]=Ve.transform(-a);const u=Ve.transform(e),p=Ve.transform(r);n[c.array]=`${u} ${p}`}function x0(n,{attrX:e,attrY:r,attrScale:a,pathLength:o,pathSpacing:c=1,pathOffset:u=0,...p},h,g,v){if(Mf(n,p,g),h){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:k,style:T}=n;k.transform&&(T.transform=k.transform,delete k.transform),(T.transform||k.transformOrigin)&&(T.transformOrigin=k.transformOrigin??"50% 50%",delete k.transformOrigin),T.transform&&(T.transformBox=v?.transformBox??"fill-box",delete k.transformBox),e!==void 0&&(k.x=e),r!==void 0&&(k.y=r),a!==void 0&&(k.scale=a),o!==void 0&&x_(k,o,c,u,!1)}const S0=()=>({...Af(),attrs:{}}),k0=n=>typeof n=="string"&&n.toLowerCase()==="svg";function S_(n,e,r,a){const o=se.useMemo(()=>{const c=S0();return x0(c,e,k0(a),n.transformTemplate,n.style),{...c.attrs,style:{...c.style}}},[e]);if(n.style){const c={};b0(c,n.style,n),o.style={...c,...o.style}}return o}const k_=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Rf(n){return typeof n!="string"||n.includes("-")?!1:!!(k_.indexOf(n)>-1||/[A-Z]/u.test(n))}function __(n,e,r,{latestValues:a},o,c=!1){const p=(Rf(n)?S_:y_)(e,a,o,n),h=c_(e,typeof n=="string",c),g=n!==se.Fragment?{...h,...p,ref:r}:{},{children:v}=e,k=se.useMemo(()=>vn(v)?v.get():v,[v]);return se.createElement(n,{...g,children:k})}function _g(n){const e=[{},{}];return n?.values.forEach((r,a)=>{e[0][a]=r.get(),e[1][a]=r.getVelocity()}),e}function Ff(n,e,r,a){if(typeof e=="function"){const[o,c]=_g(a);e=e(r!==void 0?r:n.custom,o,c)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[o,c]=_g(a);e=e(r!==void 0?r:n.custom,o,c)}return e}function bl(n){return vn(n)?n.get():n}function C_({scrapeMotionValuesFromProps:n,createRenderState:e},r,a,o){return{latestValues:T_(r,a,o,n),renderState:e()}}function T_(n,e,r,a){const o={},c=a(n,{});for(const T in c)o[T]=bl(c[T]);let{initial:u,animate:p}=n;const h=Ul(n),g=y0(n);e&&g&&!h&&n.inherit!==!1&&(u===void 0&&(u=e.initial),p===void 0&&(p=e.animate));let v=r?r.initial===!1:!1;v=v||u===!1;const k=v?p:u;if(k&&typeof k!="boolean"&&!Vl(k)){const T=Array.isArray(k)?k:[k];for(let P=0;P<T.length;P++){const M=Ff(n,T[P]);if(M){const{transitionEnd:D,transition:R,...N}=M;for(const H in N){let A=N[H];if(Array.isArray(A)){const W=v?A.length-1:0;A=A[W]}A!==null&&(o[H]=A)}for(const H in D)o[H]=D[H]}}}return o}const _0=n=>(e,r)=>{const a=se.useContext(zl),o=se.useContext(af),c=()=>C_(n,e,a,o);return r?c():Ty(c)};function Of(n,e,r){const{style:a}=n,o={};for(const c in a)(vn(a[c])||e.style&&vn(e.style[c])||w0(c,n)||r?.getValue(c)?.liveStyle!==void 0)&&(o[c]=a[c]);return o}const E_=_0({scrapeMotionValuesFromProps:Of,createRenderState:Af});function C0(n,e,r){const a=Of(n,e,r);for(const o in n)if(vn(n[o])||vn(e[o])){const c=$s.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;a[c]=n[o]}return a}const P_=_0({scrapeMotionValuesFromProps:C0,createRenderState:S0}),D_=Symbol.for("motionComponentSymbol");function Ls(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function L_(n,e,r){return se.useCallback(a=>{a&&n.onMount&&n.onMount(a),e&&(a?e.mount(a):e.unmount()),r&&(typeof r=="function"?r(a):Ls(r)&&(r.current=a))},[e])}const Nf=n=>n.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),M_="framerAppearId",T0="data-"+Nf(M_),E0=se.createContext({});function A_(n,e,r,a,o){const{visualElement:c}=se.useContext(zl),u=se.useContext(g0),p=se.useContext(af),h=se.useContext(Pf).reducedMotion,g=se.useRef(null);a=a||u.renderer,!g.current&&a&&(g.current=a(n,{visualState:e,parent:c,props:r,presenceContext:p,blockInitialAnimation:p?p.initial===!1:!1,reducedMotionConfig:h}));const v=g.current,k=se.useContext(E0);v&&!v.projection&&o&&(v.type==="html"||v.type==="svg")&&R_(g.current,r,o,k);const T=se.useRef(!1);se.useInsertionEffect(()=>{v&&T.current&&v.update(r,p)});const P=r[T0],M=se.useRef(!!P&&!window.MotionHandoffIsComplete?.(P)&&window.MotionHasOptimisedAnimation?.(P));return ok(()=>{v&&(T.current=!0,window.MotionIsMounted=!0,v.updateFeatures(),v.scheduleRenderMicrotask(),M.current&&v.animationState&&v.animationState.animateChanges())}),se.useEffect(()=>{v&&(!M.current&&v.animationState&&v.animationState.animateChanges(),M.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(P)}),M.current=!1),v.enteringChildren=void 0)}),v}function R_(n,e,r,a){const{layoutId:o,layout:c,drag:u,dragConstraints:p,layoutScroll:h,layoutRoot:g,layoutCrossfade:v}=e;n.projection=new r(n.latestValues,e["data-framer-portal-id"]?void 0:P0(n.parent)),n.projection.setOptions({layoutId:o,layout:c,alwaysMeasureLayout:!!u||p&&Ls(p),visualElement:n,animationType:typeof c=="string"?c:"both",initialPromotionConfig:a,crossfade:v,layoutScroll:h,layoutRoot:g})}function P0(n){if(n)return n.options.allowProjection!==!1?n.projection:P0(n.parent)}function qu(n,{forwardMotionProps:e=!1}={},r,a){r&&a_(r);const o=Rf(n)?P_:E_;function c(p,h){let g;const v={...se.useContext(Pf),...p,layoutId:F_(p)},{isStatic:k}=v,T=d_(p),P=o(p,k);if(!k&&sf){O_();const M=N_(v);g=M.MeasureLayout,T.visualElement=A_(n,P,v,a,M.ProjectionNode)}return xe.jsxs(zl.Provider,{value:T,children:[g&&T.visualElement?xe.jsx(g,{visualElement:T.visualElement,...v}):null,__(n,p,L_(P,T.visualElement,h),P,k,e)]})}c.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const u=se.forwardRef(c);return u[D_]=n,u}function F_({layoutId:n}){const e=se.useContext(Cy).id;return e&&n!==void 0?e+"-"+n:n}function O_(n,e){se.useContext(g0).strict}function N_(n){const{drag:e,layout:r}=qs;if(!e&&!r)return{};const a={...e,...r};return{MeasureLayout:e?.isEnabled(n)||r?.isEnabled(n)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function I_(n,e){if(typeof Proxy>"u")return qu;const r=new Map,a=(c,u)=>qu(c,u,n,e),o=(c,u)=>a(c,u);return new Proxy(o,{get:(c,u)=>u==="create"?a:(r.has(u)||r.set(u,qu(u,void 0,n,e)),r.get(u))})}function D0({top:n,left:e,right:r,bottom:a}){return{x:{min:e,max:r},y:{min:n,max:a}}}function B_({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function z_(n,e){if(!e)return n;const r=e({x:n.left,y:n.top}),a=e({x:n.right,y:n.bottom});return{top:r.y,left:r.x,bottom:a.y,right:a.x}}function Hu(n){return n===void 0||n===1}function Dd({scale:n,scaleX:e,scaleY:r}){return!Hu(n)||!Hu(e)||!Hu(r)}function qr(n){return Dd(n)||L0(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function L0(n){return Cg(n.x)||Cg(n.y)}function Cg(n){return n&&n!=="0%"}function Fl(n,e,r){const a=n-r,o=e*a;return r+o}function Tg(n,e,r,a,o){return o!==void 0&&(n=Fl(n,o,a)),Fl(n,r,a)+e}function Ld(n,e=0,r=1,a,o){n.min=Tg(n.min,e,r,a,o),n.max=Tg(n.max,e,r,a,o)}function M0(n,{x:e,y:r}){Ld(n.x,e.translate,e.scale,e.originPoint),Ld(n.y,r.translate,r.scale,r.originPoint)}const Eg=.999999999999,Pg=1.0000000000001;function V_(n,e,r,a=!1){const o=r.length;if(!o)return;e.x=e.y=1;let c,u;for(let p=0;p<o;p++){c=r[p],u=c.projectionDelta;const{visualElement:h}=c.options;h&&h.props.style&&h.props.style.display==="contents"||(a&&c.options.layoutScroll&&c.scroll&&c!==c.root&&As(n,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),u&&(e.x*=u.x.scale,e.y*=u.y.scale,M0(n,u)),a&&qr(c.latestValues)&&As(n,c.latestValues))}e.x<Pg&&e.x>Eg&&(e.x=1),e.y<Pg&&e.y>Eg&&(e.y=1)}function Ms(n,e){n.min=n.min+e,n.max=n.max+e}function Dg(n,e,r,a,o=.5){const c=Dt(n.min,n.max,o);Ld(n,e,r,c,a)}function As(n,e){Dg(n.x,e.x,e.scaleX,e.scale,e.originX),Dg(n.y,e.y,e.scaleY,e.scale,e.originY)}function A0(n,e){return D0(z_(n.getBoundingClientRect(),e))}function U_(n,e,r){const a=A0(n,r),{scroll:o}=e;return o&&(Ms(a.x,o.offset.x),Ms(a.y,o.offset.y)),a}const Lg=()=>({translate:0,scale:1,origin:0,originPoint:0}),Rs=()=>({x:Lg(),y:Lg()}),Mg=()=>({min:0,max:0}),Gt=()=>({x:Mg(),y:Mg()}),Md={current:null},R0={current:!1};function W_(){if(R0.current=!0,!!sf)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>Md.current=n.matches;n.addEventListener("change",e),e()}else Md.current=!1}const j_=new WeakMap;function q_(n,e,r){for(const a in e){const o=e[a],c=r[a];if(vn(o))n.addValue(a,o);else if(vn(c))n.addValue(a,ts(o,{owner:n}));else if(c!==o)if(n.hasValue(a)){const u=n.getValue(a);u.liveStyle===!0?u.jump(o):u.hasAnimated||u.set(o)}else{const u=n.getStaticValue(a);n.addValue(a,ts(u!==void 0?u:o,{owner:n}))}}for(const a in r)e[a]===void 0&&n.removeValue(a);return e}const Ag=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class H_{scrapeMotionValuesFromProps(e,r,a){return{}}constructor({parent:e,props:r,presenceContext:a,reducedMotionConfig:o,blockInitialAnimation:c,visualState:u},p={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=kf,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const T=Rn.now();this.renderScheduledAt<T&&(this.renderScheduledAt=T,St.render(this.render,!1,!0))};const{latestValues:h,renderState:g}=u;this.latestValues=h,this.baseTarget={...h},this.initialValues=r.initial?{...h}:{},this.renderState=g,this.parent=e,this.props=r,this.presenceContext=a,this.depth=e?e.depth+1:0,this.reducedMotionConfig=o,this.options=p,this.blockInitialAnimation=!!c,this.isControllingVariants=Ul(r),this.isVariantNode=y0(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:v,...k}=this.scrapeMotionValuesFromProps(r,{},this);for(const T in k){const P=k[T];h[T]!==void 0&&vn(P)&&P.set(h[T])}}mount(e){this.current=e,j_.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,a)=>this.bindToMotionValue(a,r)),R0.current||W_(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Md.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Sr(this.notifyUpdate),Sr(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const a=Ys.has(e);a&&this.onBindTransform&&this.onBindTransform();const o=r.on("change",u=>{this.latestValues[e]=u,this.props.onUpdate&&St.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let c;window.MotionCheckAppearSync&&(c=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{o(),c&&c(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in qs){const r=qs[e];if(!r)continue;const{isEnabled:a,Feature:o}=r;if(!this.features[e]&&o&&a(this.props)&&(this.features[e]=new o(this)),this.features[e]){const c=this.features[e];c.isMounted?c.update():(c.mount(),c.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Gt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let a=0;a<Ag.length;a++){const o=Ag[a];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const c="on"+o,u=e[c];u&&(this.propEventSubscriptions[o]=this.on(o,u))}this.prevMotionValues=q_(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const a=this.values.get(e);r!==a&&(a&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let a=this.values.get(e);return a===void 0&&r!==void 0&&(a=ts(r===null?void 0:r,{owner:this}),this.addValue(e,a)),a}readValue(e,r){let a=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return a!=null&&(typeof a=="string"&&(Ey(a)||Dy(a))?a=parseFloat(a):!r_(a)&&kr.test(r)&&(a=u0(e,r)),this.setBaseTarget(e,vn(a)?a.get():a)),vn(a)?a.get():a}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){const{initial:r}=this.props;let a;if(typeof r=="string"||typeof r=="object"){const c=Ff(this.props,r,this.presenceContext?.custom);c&&(a=c[e])}if(r&&a!==void 0)return a;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!vn(o)?o:this.initialValues[e]!==void 0&&a===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new df),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){Tf.render(this.render)}}class F0 extends H_{constructor(){super(...arguments),this.KeyframeResolver=H2}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:a}){delete r[e],delete a[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;vn(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function O0(n,{style:e,vars:r},a,o){const c=n.style;let u;for(u in e)c[u]=e[u];o?.applyProjectionStyles(c,a);for(u in r)c.setProperty(u,r[u])}function $_(n){return window.getComputedStyle(n)}class Y_ extends F0{constructor(){super(...arguments),this.type="html",this.renderInstance=O0}readValueFromInstance(e,r){if(Ys.has(r))return this.projection?.isProjecting?Sd(r):u2(e,r);{const a=$_(e),o=(hf(r)?a.getPropertyValue(r):a[r])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(e,{transformPagePoint:r}){return A0(e,r)}build(e,r,a){Mf(e,r,a.transformTemplate)}scrapeMotionValuesFromProps(e,r,a){return Of(e,r,a)}}const N0=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function X_(n,e,r,a){O0(n,e,void 0,a);for(const o in e.attrs)n.setAttribute(N0.has(o)?o:Nf(o),e.attrs[o])}class G_ extends F0{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Gt}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(Ys.has(r)){const a=c0(r);return a&&a.default||0}return r=N0.has(r)?r:Nf(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,a){return C0(e,r,a)}build(e,r,a){x0(e,r,this.isSVGTag,a.transformTemplate,a.style)}renderInstance(e,r,a,o){X_(e,r,a,o)}mount(e){this.isSVGTag=k0(e.tagName),super.mount(e)}}const K_=(n,e)=>Rf(n)?new G_(e):new Y_(e,{allowProjection:n!==se.Fragment});function Is(n,e,r){const a=n.getProps();return Ff(a,e,r!==void 0?r:a.custom,n)}const Ad=n=>Array.isArray(n);function Q_(n,e,r){n.hasValue(e)?n.getValue(e).set(r):n.addValue(e,ts(r))}function Z_(n){return Ad(n)?n[n.length-1]||0:n}function J_(n,e){const r=Is(n,e);let{transitionEnd:a={},transition:o={},...c}=r||{};c={...c,...a};for(const u in c){const p=Z_(c[u]);Q_(n,u,p)}}function eC(n){return!!(vn(n)&&n.add)}function Rd(n,e){const r=n.getValue("willChange");if(eC(r))return r.add(e);if(!r&&Yi.WillChange){const a=new Yi.WillChange("auto");n.addValue("willChange",a),a.add(e)}}function I0(n){return n.props[T0]}const tC=n=>n!==null;function nC(n,{repeat:e,repeatType:r="loop"},a){const o=n.filter(tC),c=e&&r!=="loop"&&e%2===1?0:o.length-1;return o[c]}const iC={type:"spring",stiffness:500,damping:25,restSpeed:10},rC=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),sC={type:"keyframes",duration:.8},aC={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},oC=(n,{keyframes:e})=>e.length>2?sC:Ys.has(n)?n.startsWith("scale")?rC(e[1]):iC:aC;function lC({when:n,delay:e,delayChildren:r,staggerChildren:a,staggerDirection:o,repeat:c,repeatType:u,repeatDelay:p,from:h,elapsed:g,...v}){return!!Object.keys(v).length}const If=(n,e,r,a={},o,c)=>u=>{const p=_f(a,n)||{},h=p.delay||a.delay||0;let{elapsed:g=0}=a;g=g-Li(h);const v={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...p,delay:-g,onUpdate:T=>{e.set(T),p.onUpdate&&p.onUpdate(T)},onComplete:()=>{u(),p.onComplete&&p.onComplete()},name:n,motionValue:e,element:c?void 0:o};lC(p)||Object.assign(v,oC(n,v)),v.duration&&(v.duration=Li(v.duration)),v.repeatDelay&&(v.repeatDelay=Li(v.repeatDelay)),v.from!==void 0&&(v.keyframes[0]=v.from);let k=!1;if((v.type===!1||v.duration===0&&!v.repeatDelay)&&(Ed(v),v.delay===0&&(k=!0)),(Yi.instantAnimations||Yi.skipAnimations)&&(k=!0,Ed(v),v.delay=0),v.allowFlatten=!p.type&&!p.ease,k&&!c&&e.get()!==void 0){const T=nC(v.keyframes,p);if(T!==void 0){St.update(()=>{v.onUpdate(T),v.onComplete()});return}}return p.isSync?new Sf(v):new R2(v)};function cC({protectedKeys:n,needsAnimating:e},r){const a=n.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,a}function B0(n,e,{delay:r=0,transitionOverride:a,type:o}={}){let{transition:c=n.getDefaultTransition(),transitionEnd:u,...p}=e;a&&(c=a);const h=[],g=o&&n.animationState&&n.animationState.getState()[o];for(const v in p){const k=n.getValue(v,n.latestValues[v]??null),T=p[v];if(T===void 0||g&&cC(g,v))continue;const P={delay:r,..._f(c||{},v)},M=k.get();if(M!==void 0&&!k.isAnimating&&!Array.isArray(T)&&T===M&&!P.velocity)continue;let D=!1;if(window.MotionHandoffAnimation){const N=I0(n);if(N){const H=window.MotionHandoffAnimation(N,v,St);H!==null&&(P.startTime=H,D=!0)}}Rd(n,v),k.start(If(v,k,T,n.shouldReduceMotion&&a0.has(v)?{type:!1}:P,n,D));const R=k.animation;R&&h.push(R)}return u&&Promise.all(h).then(()=>{St.update(()=>{u&&J_(n,u)})}),h}function z0(n,e,r,a=0,o=1){const c=Array.from(n).sort((g,v)=>g.sortNodePosition(v)).indexOf(e),u=n.size,p=(u-1)*a;return typeof r=="function"?r(c,u):o===1?c*a:p-c*a}function Fd(n,e,r={}){const a=Is(n,e,r.type==="exit"?n.presenceContext?.custom:void 0);let{transition:o=n.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(o=r.transitionOverride);const c=a?()=>Promise.all(B0(n,a,r)):()=>Promise.resolve(),u=n.variantChildren&&n.variantChildren.size?(h=0)=>{const{delayChildren:g=0,staggerChildren:v,staggerDirection:k}=o;return uC(n,e,h,g,v,k,r)}:()=>Promise.resolve(),{when:p}=o;if(p){const[h,g]=p==="beforeChildren"?[c,u]:[u,c];return h().then(()=>g())}else return Promise.all([c(),u(r.delay)])}function uC(n,e,r=0,a=0,o=0,c=1,u){const p=[];for(const h of n.variantChildren)h.notify("AnimationStart",e),p.push(Fd(h,e,{...u,delay:r+(typeof a=="function"?0:a)+z0(n.variantChildren,h,a,o,c)}).then(()=>h.notify("AnimationComplete",e)));return Promise.all(p)}function dC(n,e,r={}){n.notify("AnimationStart",e);let a;if(Array.isArray(e)){const o=e.map(c=>Fd(n,c,r));a=Promise.all(o)}else if(typeof e=="string")a=Fd(n,e,r);else{const o=typeof e=="function"?Is(n,e,r.custom):e;a=Promise.all(B0(n,o,r))}return a.then(()=>{n.notify("AnimationComplete",e)})}function V0(n,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==n.length)return!1;for(let a=0;a<r;a++)if(e[a]!==n[a])return!1;return!0}const fC=Lf.length;function U0(n){if(!n)return;if(!n.isControllingVariants){const r=n.parent?U0(n.parent)||{}:{};return n.props.initial!==void 0&&(r.initial=n.props.initial),r}const e={};for(let r=0;r<fC;r++){const a=Lf[r],o=n.props[a];(Za(o)||o===!1)&&(e[a]=o)}return e}const pC=[...Df].reverse(),hC=Df.length;function mC(n){return e=>Promise.all(e.map(({animation:r,options:a})=>dC(n,r,a)))}function gC(n){let e=mC(n),r=Rg(),a=!0;const o=h=>(g,v)=>{const k=Is(n,v,h==="exit"?n.presenceContext?.custom:void 0);if(k){const{transition:T,transitionEnd:P,...M}=k;g={...g,...M,...P}}return g};function c(h){e=h(n)}function u(h){const{props:g}=n,v=U0(n.parent)||{},k=[],T=new Set;let P={},M=1/0;for(let R=0;R<hC;R++){const N=pC[R],H=r[N],A=g[N]!==void 0?g[N]:v[N],W=Za(A),U=N===h?H.isActive:null;U===!1&&(M=R);let Z=A===v[N]&&A!==g[N]&&W;if(Z&&a&&n.manuallyAnimateOnMount&&(Z=!1),H.protectedKeys={...P},!H.isActive&&U===null||!A&&!H.prevProp||Vl(A)||typeof A=="boolean")continue;const ne=vC(H.prevProp,A);let ee=ne||N===h&&H.isActive&&!Z&&W||R>M&&W,Q=!1;const ce=Array.isArray(A)?A:[A];let me=ce.reduce(o(N),{});U===!1&&(me={});const{prevResolvedValues:ve={}}=H,ke={...ve,...me},we=w=>{ee=!0,T.has(w)&&(Q=!0,T.delete(w)),H.needsAnimating[w]=!0;const b=n.getValue(w);b&&(b.liveStyle=!1)};for(const w in ke){const b=me[w],_=ve[w];if(P.hasOwnProperty(w))continue;let E=!1;Ad(b)&&Ad(_)?E=!V0(b,_):E=b!==_,E?b!=null?we(w):T.add(w):b!==void 0&&T.has(w)?we(w):H.protectedKeys[w]=!0}H.prevProp=A,H.prevResolvedValues=me,H.isActive&&(P={...P,...me}),a&&n.blockInitialAnimation&&(ee=!1);const d=Z&&ne;ee&&(!d||Q)&&k.push(...ce.map(w=>{const b={type:N};if(typeof w=="string"&&a&&!d&&n.manuallyAnimateOnMount&&n.parent){const{parent:_}=n,E=Is(_,w);if(_.enteringChildren&&E){const{delayChildren:S}=E.transition||{};b.delay=z0(_.enteringChildren,n,S)}}return{animation:w,options:b}}))}if(T.size){const R={};if(typeof g.initial!="boolean"){const N=Is(n,Array.isArray(g.initial)?g.initial[0]:g.initial);N&&N.transition&&(R.transition=N.transition)}T.forEach(N=>{const H=n.getBaseTarget(N),A=n.getValue(N);A&&(A.liveStyle=!0),R[N]=H??null}),k.push({animation:R})}let D=!!k.length;return a&&(g.initial===!1||g.initial===g.animate)&&!n.manuallyAnimateOnMount&&(D=!1),a=!1,D?e(k):Promise.resolve()}function p(h,g){if(r[h].isActive===g)return Promise.resolve();n.variantChildren?.forEach(k=>k.animationState?.setActive(h,g)),r[h].isActive=g;const v=u(h);for(const k in r)r[k].protectedKeys={};return v}return{animateChanges:u,setActive:p,setAnimateFunction:c,getState:()=>r,reset:()=>{r=Rg()}}}function vC(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!V0(e,n):!1}function Wr(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Rg(){return{animate:Wr(!0),whileInView:Wr(),whileHover:Wr(),whileTap:Wr(),whileDrag:Wr(),whileFocus:Wr(),exit:Wr()}}class Cr{constructor(e){this.isMounted=!1,this.node=e}update(){}}class yC extends Cr{constructor(e){super(e),e.animationState||(e.animationState=gC(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Vl(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let wC=0;class bC extends Cr{constructor(){super(...arguments),this.id=wC++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===a)return;const o=this.node.animationState.setActive("exit",!e);r&&!e&&o.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const xC={animation:{Feature:yC},exit:{Feature:bC}};function eo(n,e,r,a={passive:!0}){return n.addEventListener(e,r,a),()=>n.removeEventListener(e,r)}function so(n){return{point:{x:n.pageX,y:n.pageY}}}const SC=n=>e=>Ef(e)&&n(e,so(e));function Va(n,e,r,a){return eo(n,e,SC(r),a)}const W0=1e-4,kC=1-W0,_C=1+W0,j0=.01,CC=0-j0,TC=0+j0;function _n(n){return n.max-n.min}function EC(n,e,r){return Math.abs(n-e)<=r}function Fg(n,e,r,a=.5){n.origin=a,n.originPoint=Dt(e.min,e.max,n.origin),n.scale=_n(r)/_n(e),n.translate=Dt(r.min,r.max,n.origin)-n.originPoint,(n.scale>=kC&&n.scale<=_C||isNaN(n.scale))&&(n.scale=1),(n.translate>=CC&&n.translate<=TC||isNaN(n.translate))&&(n.translate=0)}function Ua(n,e,r,a){Fg(n.x,e.x,r.x,a?a.originX:void 0),Fg(n.y,e.y,r.y,a?a.originY:void 0)}function Og(n,e,r){n.min=r.min+e.min,n.max=n.min+_n(e)}function PC(n,e,r){Og(n.x,e.x,r.x),Og(n.y,e.y,r.y)}function Ng(n,e,r){n.min=e.min-r.min,n.max=n.min+_n(e)}function Ol(n,e,r){Ng(n.x,e.x,r.x),Ng(n.y,e.y,r.y)}function ai(n){return[n("x"),n("y")]}const q0=({current:n})=>n?n.ownerDocument.defaultView:null,Ig=(n,e)=>Math.abs(n-e);function DC(n,e){const r=Ig(n.x,e.x),a=Ig(n.y,e.y);return Math.sqrt(r**2+a**2)}class H0{constructor(e,r,{transformPagePoint:a,contextWindow:o=window,dragSnapToOrigin:c=!1,distanceThreshold:u=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=Yu(this.lastMoveEventInfo,this.history),P=this.startEvent!==null,M=DC(T.offset,{x:0,y:0})>=this.distanceThreshold;if(!P&&!M)return;const{point:D}=T,{timestamp:R}=ln;this.history.push({...D,timestamp:R});const{onStart:N,onMove:H}=this.handlers;P||(N&&N(this.lastMoveEvent,T),this.startEvent=this.lastMoveEvent),H&&H(this.lastMoveEvent,T)},this.handlePointerMove=(T,P)=>{this.lastMoveEvent=T,this.lastMoveEventInfo=$u(P,this.transformPagePoint),St.update(this.updatePoint,!0)},this.handlePointerUp=(T,P)=>{this.end();const{onEnd:M,onSessionEnd:D,resumeAnimation:R}=this.handlers;if(this.dragSnapToOrigin&&R&&R(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const N=Yu(T.type==="pointercancel"?this.lastMoveEventInfo:$u(P,this.transformPagePoint),this.history);this.startEvent&&M&&M(T,N),D&&D(T,N)},!Ef(e))return;this.dragSnapToOrigin=c,this.handlers=r,this.transformPagePoint=a,this.distanceThreshold=u,this.contextWindow=o||window;const p=so(e),h=$u(p,this.transformPagePoint),{point:g}=h,{timestamp:v}=ln;this.history=[{...g,timestamp:v}];const{onSessionStart:k}=r;k&&k(e,Yu(h,this.history)),this.removeListeners=no(Va(this.contextWindow,"pointermove",this.handlePointerMove),Va(this.contextWindow,"pointerup",this.handlePointerUp),Va(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Sr(this.updatePoint)}}function $u(n,e){return e?{point:e(n.point)}:n}function Bg(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Yu({point:n},e){return{point:n,delta:Bg(n,$0(e)),offset:Bg(n,LC(e)),velocity:MC(e,.1)}}function LC(n){return n[0]}function $0(n){return n[n.length-1]}function MC(n,e){if(n.length<2)return{x:0,y:0};let r=n.length-1,a=null;const o=$0(n);for(;r>=0&&(a=n[r],!(o.timestamp-a.timestamp>Li(e)));)r--;if(!a)return{x:0,y:0};const c=ui(o.timestamp-a.timestamp);if(c===0)return{x:0,y:0};const u={x:(o.x-a.x)/c,y:(o.y-a.y)/c};return u.x===1/0&&(u.x=0),u.y===1/0&&(u.y=0),u}function AC(n,{min:e,max:r},a){return e!==void 0&&n<e?n=a?Dt(e,n,a.min):Math.max(n,e):r!==void 0&&n>r&&(n=a?Dt(r,n,a.max):Math.min(n,r)),n}function zg(n,e,r){return{min:e!==void 0?n.min+e:void 0,max:r!==void 0?n.max+r-(n.max-n.min):void 0}}function RC(n,{top:e,left:r,bottom:a,right:o}){return{x:zg(n.x,r,o),y:zg(n.y,e,a)}}function Vg(n,e){let r=e.min-n.min,a=e.max-n.max;return e.max-e.min<n.max-n.min&&([r,a]=[a,r]),{min:r,max:a}}function FC(n,e){return{x:Vg(n.x,e.x),y:Vg(n.y,e.y)}}function OC(n,e){let r=.5;const a=_n(n),o=_n(e);return o>a?r=Ga(e.min,e.max-a,n.min):a>o&&(r=Ga(n.min,n.max-o,e.min)),$i(0,1,r)}function NC(n,e){const r={};return e.min!==void 0&&(r.min=e.min-n.min),e.max!==void 0&&(r.max=e.max-n.min),r}const Od=.35;function IC(n=Od){return n===!1?n=0:n===!0&&(n=Od),{x:Ug(n,"left","right"),y:Ug(n,"top","bottom")}}function Ug(n,e,r){return{min:Wg(n,e),max:Wg(n,r)}}function Wg(n,e){return typeof n=="number"?n:n[e]||0}const BC=new WeakMap;class zC{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Gt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:a}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const c=k=>{const{dragSnapToOrigin:T}=this.getProps();T?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(so(k).point)},u=(k,T)=>{const{drag:P,dragPropagation:M,onDragStart:D}=this.getProps();if(P&&!M&&(this.openDragLock&&this.openDragLock(),this.openDragLock=K2(P),!this.openDragLock))return;this.latestPointerEvent=k,this.latestPanInfo=T,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ai(N=>{let H=this.getAxisMotionValue(N).get()||0;if(Mi.test(H)){const{projection:A}=this.visualElement;if(A&&A.layout){const W=A.layout.layoutBox[N];W&&(H=_n(W)*(parseFloat(H)/100))}}this.originPoint[N]=H}),D&&St.postRender(()=>D(k,T)),Rd(this.visualElement,"transform");const{animationState:R}=this.visualElement;R&&R.setActive("whileDrag",!0)},p=(k,T)=>{this.latestPointerEvent=k,this.latestPanInfo=T;const{dragPropagation:P,dragDirectionLock:M,onDirectionLock:D,onDrag:R}=this.getProps();if(!P&&!this.openDragLock)return;const{offset:N}=T;if(M&&this.currentDirection===null){this.currentDirection=VC(N),this.currentDirection!==null&&D&&D(this.currentDirection);return}this.updateAxis("x",T.point,N),this.updateAxis("y",T.point,N),this.visualElement.render(),R&&R(k,T)},h=(k,T)=>{this.latestPointerEvent=k,this.latestPanInfo=T,this.stop(k,T),this.latestPointerEvent=null,this.latestPanInfo=null},g=()=>ai(k=>this.getAnimationState(k)==="paused"&&this.getAxisMotionValue(k).animation?.play()),{dragSnapToOrigin:v}=this.getProps();this.panSession=new H0(e,{onSessionStart:c,onStart:u,onMove:p,onSessionEnd:h,resumeAnimation:g},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:v,distanceThreshold:a,contextWindow:q0(this.visualElement)})}stop(e,r){const a=e||this.latestPointerEvent,o=r||this.latestPanInfo,c=this.isDragging;if(this.cancel(),!c||!o||!a)return;const{velocity:u}=o;this.startAnimation(u);const{onDragEnd:p}=this.getProps();p&&St.postRender(()=>p(a,o))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,a){const{drag:o}=this.getProps();if(!a||!hl(e,o,this.currentDirection))return;const c=this.getAxisMotionValue(e);let u=this.originPoint[e]+a[e];this.constraints&&this.constraints[e]&&(u=AC(u,this.constraints[e],this.elastic[e])),c.set(u)}resolveConstraints(){const{dragConstraints:e,dragElastic:r}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,o=this.constraints;e&&Ls(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&a?this.constraints=RC(a.layoutBox,e):this.constraints=!1,this.elastic=IC(r),o!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&ai(c=>{this.constraints!==!1&&this.getAxisMotionValue(c)&&(this.constraints[c]=NC(a.layoutBox[c],this.constraints[c]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!Ls(e))return!1;const a=e.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const c=U_(a,o.root,this.visualElement.getTransformPagePoint());let u=FC(o.layout.layoutBox,c);if(r){const p=r(B_(u));this.hasMutatedConstraints=!!p,p&&(u=D0(p))}return u}startAnimation(e){const{drag:r,dragMomentum:a,dragElastic:o,dragTransition:c,dragSnapToOrigin:u,onDragTransitionEnd:p}=this.getProps(),h=this.constraints||{},g=ai(v=>{if(!hl(v,r,this.currentDirection))return;let k=h&&h[v]||{};u&&(k={min:0,max:0});const T=o?200:1e6,P=o?40:1e7,M={type:"inertia",velocity:a?e[v]:0,bounceStiffness:T,bounceDamping:P,timeConstant:750,restDelta:1,restSpeed:10,...c,...k};return this.startAxisValueAnimation(v,M)});return Promise.all(g).then(p)}startAxisValueAnimation(e,r){const a=this.getAxisMotionValue(e);return Rd(this.visualElement,e),a.start(If(e,a,0,r,this.visualElement,!1))}stopAnimation(){ai(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ai(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,a=this.visualElement.getProps(),o=a[r];return o||this.visualElement.getValue(e,(a.initial?a.initial[e]:void 0)||0)}snapToCursor(e){ai(r=>{const{drag:a}=this.getProps();if(!hl(r,a,this.currentDirection))return;const{projection:o}=this.visualElement,c=this.getAxisMotionValue(r);if(o&&o.layout){const{min:u,max:p}=o.layout.layoutBox[r];c.set(e[r]-Dt(u,p,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:a}=this.visualElement;if(!Ls(r)||!a||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};ai(u=>{const p=this.getAxisMotionValue(u);if(p&&this.constraints!==!1){const h=p.get();o[u]=OC({min:h,max:h},this.constraints[u])}});const{transformTemplate:c}=this.visualElement.getProps();this.visualElement.current.style.transform=c?c({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),ai(u=>{if(!hl(u,e,null))return;const p=this.getAxisMotionValue(u),{min:h,max:g}=this.constraints[u];p.set(Dt(h,g,o[u]))})}addListeners(){if(!this.visualElement.current)return;BC.set(this.visualElement,this);const e=this.visualElement.current,r=Va(e,"pointerdown",h=>{const{drag:g,dragListener:v=!0}=this.getProps();g&&v&&this.start(h)}),a=()=>{const{dragConstraints:h}=this.getProps();Ls(h)&&h.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,c=o.addEventListener("measure",a);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),St.read(a);const u=eo(window,"resize",()=>this.scalePositionWithinConstraints()),p=o.addEventListener("didUpdate",(({delta:h,hasLayoutChanged:g})=>{this.isDragging&&g&&(ai(v=>{const k=this.getAxisMotionValue(v);k&&(this.originPoint[v]+=h[v].translate,k.set(k.get()+h[v].translate))}),this.visualElement.render())}));return()=>{u(),r(),c(),p&&p()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:a=!1,dragPropagation:o=!1,dragConstraints:c=!1,dragElastic:u=Od,dragMomentum:p=!0}=e;return{...e,drag:r,dragDirectionLock:a,dragPropagation:o,dragConstraints:c,dragElastic:u,dragMomentum:p}}}function hl(n,e,r){return(e===!0||e===n)&&(r===null||r===n)}function VC(n,e=10){let r=null;return Math.abs(n.y)>e?r="y":Math.abs(n.x)>e&&(r="x"),r}class UC extends Cr{constructor(e){super(e),this.removeGroupControls=di,this.removeListeners=di,this.controls=new zC(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||di}unmount(){this.removeGroupControls(),this.removeListeners()}}const jg=n=>(e,r)=>{n&&St.postRender(()=>n(e,r))};class WC extends Cr{constructor(){super(...arguments),this.removePointerDownListener=di}onPointerDown(e){this.session=new H0(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:q0(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:a,onPanEnd:o}=this.node.getProps();return{onSessionStart:jg(e),onStart:jg(r),onMove:a,onEnd:(c,u)=>{delete this.session,o&&St.postRender(()=>o(c,u))}}}mount(){this.removePointerDownListener=Va(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const xl={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function qg(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const Da={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Ve.test(n))n=parseFloat(n);else return n;const r=qg(n,e.target.x),a=qg(n,e.target.y);return`${r}% ${a}%`}},jC={correct:(n,{treeScale:e,projectionDelta:r})=>{const a=n,o=kr.parse(n);if(o.length>5)return a;const c=kr.createTransformer(n),u=typeof o[0]!="number"?1:0,p=r.x.scale*e.x,h=r.y.scale*e.y;o[0+u]/=p,o[1+u]/=h;const g=Dt(p,h,.5);return typeof o[2+u]=="number"&&(o[2+u]/=g),typeof o[3+u]=="number"&&(o[3+u]/=g),c(o)}};let Xu=!1;class qC extends se.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:a,layoutId:o}=this.props,{projection:c}=e;f_(HC),c&&(r.group&&r.group.add(c),a&&a.register&&o&&a.register(c),Xu&&c.root.didUpdate(),c.addEventListener("animationComplete",()=>{this.safeToRemove()}),c.setOptions({...c.options,onExitComplete:()=>this.safeToRemove()})),xl.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:a,drag:o,isPresent:c}=this.props,{projection:u}=a;return u&&(u.isPresent=c,Xu=!0,o||e.layoutDependency!==r||r===void 0||e.isPresent!==c?u.willUpdate():this.safeToRemove(),e.isPresent!==c&&(c?u.promote():u.relegate()||St.postRender(()=>{const p=u.getStack();(!p||!p.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Tf.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:a}=this.props,{projection:o}=e;Xu=!0,o&&(o.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(o),a&&a.deregister&&a.deregister(o))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Y0(n){const[e,r]=s_(),a=se.useContext(Cy);return xe.jsx(qC,{...n,layoutGroup:a,switchLayoutGroup:se.useContext(E0),isPresent:e,safeToRemove:r})}const HC={borderRadius:{...Da,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Da,borderTopRightRadius:Da,borderBottomLeftRadius:Da,borderBottomRightRadius:Da,boxShadow:jC};function $C(n,e,r){const a=vn(n)?n:ts(n);return a.start(If("",a,e,r)),a.animation}const YC=(n,e)=>n.depth-e.depth;class XC{constructor(){this.children=[],this.isDirty=!1}add(e){of(this.children,e),this.isDirty=!0}remove(e){lf(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(YC),this.isDirty=!1,this.children.forEach(e)}}function GC(n,e){const r=Rn.now(),a=({timestamp:o})=>{const c=o-r;c>=e&&(Sr(a),n(c-e))};return St.setup(a,!0),()=>Sr(a)}const X0=["TopLeft","TopRight","BottomLeft","BottomRight"],KC=X0.length,Hg=n=>typeof n=="string"?parseFloat(n):n,$g=n=>typeof n=="number"||Ve.test(n);function QC(n,e,r,a,o,c){o?(n.opacity=Dt(0,r.opacity??1,ZC(a)),n.opacityExit=Dt(e.opacity??1,0,JC(a))):c&&(n.opacity=Dt(e.opacity??1,r.opacity??1,a));for(let u=0;u<KC;u++){const p=`border${X0[u]}Radius`;let h=Yg(e,p),g=Yg(r,p);if(h===void 0&&g===void 0)continue;h||(h=0),g||(g=0),h===0||g===0||$g(h)===$g(g)?(n[p]=Math.max(Dt(Hg(h),Hg(g),a),0),(Mi.test(g)||Mi.test(h))&&(n[p]+="%")):n[p]=g}(e.rotate||r.rotate)&&(n.rotate=Dt(e.rotate||0,r.rotate||0,a))}function Yg(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const ZC=G0(0,.5,Iy),JC=G0(.5,.95,di);function G0(n,e,r){return a=>a<n?0:a>e?1:r(Ga(n,e,a))}function Xg(n,e){n.min=e.min,n.max=e.max}function bi(n,e){Xg(n.x,e.x),Xg(n.y,e.y)}function Gg(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}function Kg(n,e,r,a,o){return n-=e,n=Fl(n,1/r,a),o!==void 0&&(n=Fl(n,1/o,a)),n}function eT(n,e=0,r=1,a=.5,o,c=n,u=n){if(Mi.test(e)&&(e=parseFloat(e),e=Dt(u.min,u.max,e/100)-u.min),typeof e!="number")return;let p=Dt(c.min,c.max,a);n===c&&(p-=e),n.min=Kg(n.min,e,r,p,o),n.max=Kg(n.max,e,r,p,o)}function Qg(n,e,[r,a,o],c,u){eT(n,e[r],e[a],e[o],e.scale,c,u)}const tT=["x","scaleX","originX"],nT=["y","scaleY","originY"];function Zg(n,e,r,a){Qg(n.x,e,tT,r?r.x:void 0,a?a.x:void 0),Qg(n.y,e,nT,r?r.y:void 0,a?a.y:void 0)}function Jg(n){return n.translate===0&&n.scale===1}function K0(n){return Jg(n.x)&&Jg(n.y)}function ev(n,e){return n.min===e.min&&n.max===e.max}function iT(n,e){return ev(n.x,e.x)&&ev(n.y,e.y)}function tv(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function Q0(n,e){return tv(n.x,e.x)&&tv(n.y,e.y)}function nv(n){return _n(n.x)/_n(n.y)}function iv(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}class rT{constructor(){this.members=[]}add(e){of(this.members,e),e.scheduleRender()}remove(e){if(lf(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(o=>e===o);if(r===0)return!1;let a;for(let o=r;o>=0;o--){const c=this.members[o];if(c.isPresent!==!1){a=c;break}}return a?(this.promote(a),!0):!1}promote(e,r){const a=this.lead;if(e!==a&&(this.prevLead=a,this.lead=e,e.show(),a)){a.instance&&a.scheduleRender(),e.scheduleRender(),e.resumeFrom=a,r&&(e.resumeFrom.preserveOpacity=!0),a.snapshot&&(e.snapshot=a.snapshot,e.snapshot.latestValues=a.animationValues||a.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:o}=e.options;o===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:a}=e;r.onExitComplete&&r.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function sT(n,e,r){let a="";const o=n.x.translate/e.x,c=n.y.translate/e.y,u=r?.z||0;if((o||c||u)&&(a=`translate3d(${o}px, ${c}px, ${u}px) `),(e.x!==1||e.y!==1)&&(a+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:g,rotate:v,rotateX:k,rotateY:T,skewX:P,skewY:M}=r;g&&(a=`perspective(${g}px) ${a}`),v&&(a+=`rotate(${v}deg) `),k&&(a+=`rotateX(${k}deg) `),T&&(a+=`rotateY(${T}deg) `),P&&(a+=`skewX(${P}deg) `),M&&(a+=`skewY(${M}deg) `)}const p=n.x.scale*e.x,h=n.y.scale*e.y;return(p!==1||h!==1)&&(a+=`scale(${p}, ${h})`),a||"none"}const Gu=["","X","Y","Z"],aT=1e3;let oT=0;function Ku(n,e,r,a){const{latestValues:o}=e;o[n]&&(r[n]=o[n],e.setStaticValue(n,0),a&&(a[n]=0))}function Z0(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const r=I0(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:o,layoutId:c}=n.options;window.MotionCancelOptimisedAnimation(r,"transform",St,!(o||c))}const{parent:a}=n;a&&!a.hasCheckedOptimisedAppear&&Z0(a)}function J0({attachResizeListener:n,defaultParent:e,measureScroll:r,checkIsScrollRoot:a,resetTransform:o}){return class{constructor(u={},p=e?.()){this.id=oT++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(uT),this.nodes.forEach(hT),this.nodes.forEach(mT),this.nodes.forEach(dT)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=u,this.root=p?p.root||p:this,this.path=p?[...p.path,p]:[],this.parent=p,this.depth=p?p.depth+1:0;for(let h=0;h<this.path.length;h++)this.path[h].shouldResetTransform=!0;this.root===this&&(this.nodes=new XC)}addEventListener(u,p){return this.eventHandlers.has(u)||this.eventHandlers.set(u,new df),this.eventHandlers.get(u).add(p)}notifyListeners(u,...p){const h=this.eventHandlers.get(u);h&&h.notify(...p)}hasListeners(u){return this.eventHandlers.has(u)}mount(u){if(this.instance)return;this.isSVG=m0(u)&&!n_(u),this.instance=u;const{layoutId:p,layout:h,visualElement:g}=this.options;if(g&&!g.current&&g.mount(u),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(h||p)&&(this.isLayoutDirty=!0),n){let v,k=0;const T=()=>this.root.updateBlockedByResize=!1;St.read(()=>{k=window.innerWidth}),n(u,()=>{const P=window.innerWidth;P!==k&&(k=P,this.root.updateBlockedByResize=!0,v&&v(),v=GC(T,250),xl.hasAnimatedSinceResize&&(xl.hasAnimatedSinceResize=!1,this.nodes.forEach(av)))})}p&&this.root.registerSharedNode(p,this),this.options.animate!==!1&&g&&(p||h)&&this.addEventListener("didUpdate",({delta:v,hasLayoutChanged:k,hasRelativeLayoutChanged:T,layout:P})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const M=this.options.transition||g.getDefaultTransition()||bT,{onLayoutAnimationStart:D,onLayoutAnimationComplete:R}=g.getProps(),N=!this.targetLayout||!Q0(this.targetLayout,P),H=!k&&T;if(this.options.layoutRoot||this.resumeFrom||H||k&&(N||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const A={..._f(M,"layout"),onPlay:D,onComplete:R};(g.shouldReduceMotion||this.options.layoutRoot)&&(A.delay=0,A.type=!1),this.startAnimation(A),this.setAnimationOrigin(v,H)}else k||av(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=P})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const u=this.getStack();u&&u.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Sr(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(gT),this.animationId++)}getTransformTemplate(){const{visualElement:u}=this.options;return u&&u.getProps().transformTemplate}willUpdate(u=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Z0(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let v=0;v<this.path.length;v++){const k=this.path[v];k.shouldResetTransform=!0,k.updateScroll("snapshot"),k.options.layoutRoot&&k.willUpdate(!1)}const{layoutId:p,layout:h}=this.options;if(p===void 0&&!h)return;const g=this.getTransformTemplate();this.prevTransformTemplateValue=g?g(this.latestValues,""):void 0,this.updateSnapshot(),u&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(rv);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(sv);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(pT),this.nodes.forEach(lT),this.nodes.forEach(cT)):this.nodes.forEach(sv),this.clearAllSnapshots();const p=Rn.now();ln.delta=$i(0,1e3/60,p-ln.timestamp),ln.timestamp=p,ln.isProcessing=!0,Bu.update.process(ln),Bu.preRender.process(ln),Bu.render.process(ln),ln.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Tf.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(fT),this.sharedNodes.forEach(vT)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,St.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){St.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!_n(this.snapshot.measuredBox.x)&&!_n(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let h=0;h<this.path.length;h++)this.path[h].updateScroll();const u=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Gt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:p}=this.options;p&&p.notify("LayoutMeasure",this.layout.layoutBox,u?u.layoutBox:void 0)}updateScroll(u="measure"){let p=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===u&&(p=!1),p&&this.instance){const h=a(this.instance);this.scroll={animationId:this.root.animationId,phase:u,isRoot:h,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:h}}}resetTransform(){if(!o)return;const u=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,p=this.projectionDelta&&!K0(this.projectionDelta),h=this.getTransformTemplate(),g=h?h(this.latestValues,""):void 0,v=g!==this.prevTransformTemplateValue;u&&this.instance&&(p||qr(this.latestValues)||v)&&(o(this.instance,g),this.shouldResetTransform=!1,this.scheduleRender())}measure(u=!0){const p=this.measurePageBox();let h=this.removeElementScroll(p);return u&&(h=this.removeTransform(h)),xT(h),{animationId:this.root.animationId,measuredBox:p,layoutBox:h,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:u}=this.options;if(!u)return Gt();const p=u.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(ST))){const{scroll:g}=this.root;g&&(Ms(p.x,g.offset.x),Ms(p.y,g.offset.y))}return p}removeElementScroll(u){const p=Gt();if(bi(p,u),this.scroll?.wasRoot)return p;for(let h=0;h<this.path.length;h++){const g=this.path[h],{scroll:v,options:k}=g;g!==this.root&&v&&k.layoutScroll&&(v.wasRoot&&bi(p,u),Ms(p.x,v.offset.x),Ms(p.y,v.offset.y))}return p}applyTransform(u,p=!1){const h=Gt();bi(h,u);for(let g=0;g<this.path.length;g++){const v=this.path[g];!p&&v.options.layoutScroll&&v.scroll&&v!==v.root&&As(h,{x:-v.scroll.offset.x,y:-v.scroll.offset.y}),qr(v.latestValues)&&As(h,v.latestValues)}return qr(this.latestValues)&&As(h,this.latestValues),h}removeTransform(u){const p=Gt();bi(p,u);for(let h=0;h<this.path.length;h++){const g=this.path[h];if(!g.instance||!qr(g.latestValues))continue;Dd(g.latestValues)&&g.updateSnapshot();const v=Gt(),k=g.measurePageBox();bi(v,k),Zg(p,g.latestValues,g.snapshot?g.snapshot.layoutBox:void 0,v)}return qr(this.latestValues)&&Zg(p,this.latestValues),p}setTargetDelta(u){this.targetDelta=u,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(u){this.options={...this.options,...u,crossfade:u.crossfade!==void 0?u.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ln.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(u=!1){const p=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=p.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=p.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=p.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==p;if(!(u||h&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:v,layoutId:k}=this.options;if(!this.layout||!(v||k))return;this.resolvedRelativeTargetAt=ln.timestamp;const T=this.getClosestProjectingParent();T&&this.linkedParentVersion!==T.layoutVersion&&!T.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(T&&T.layout?this.createRelativeTarget(T,this.layout.layoutBox,T.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Gt(),this.targetWithTransforms=Gt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),PC(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):bi(this.target,this.layout.layoutBox),M0(this.target,this.targetDelta)):bi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,T&&!!T.resumingFrom==!!this.resumingFrom&&!T.options.layoutScroll&&T.target&&this.animationProgress!==1?this.createRelativeTarget(T,this.target,T.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||Dd(this.parent.latestValues)||L0(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(u,p,h){this.relativeParent=u,this.linkedParentVersion=u.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Gt(),this.relativeTargetOrigin=Gt(),Ol(this.relativeTargetOrigin,p,h),bi(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const u=this.getLead(),p=!!this.resumingFrom||this!==u;let h=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(h=!1),p&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===ln.timestamp&&(h=!1),h)return;const{layout:g,layoutId:v}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(g||v))return;bi(this.layoutCorrected,this.layout.layoutBox);const k=this.treeScale.x,T=this.treeScale.y;V_(this.layoutCorrected,this.treeScale,this.path,p),u.layout&&!u.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(u.target=u.layout.layoutBox,u.targetWithTransforms=Gt());const{target:P}=u;if(!P){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Gg(this.prevProjectionDelta.x,this.projectionDelta.x),Gg(this.prevProjectionDelta.y,this.projectionDelta.y)),Ua(this.projectionDelta,this.layoutCorrected,P,this.latestValues),(this.treeScale.x!==k||this.treeScale.y!==T||!iv(this.projectionDelta.x,this.prevProjectionDelta.x)||!iv(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",P))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(u=!0){if(this.options.visualElement?.scheduleRender(),u){const p=this.getStack();p&&p.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Rs(),this.projectionDelta=Rs(),this.projectionDeltaWithTransform=Rs()}setAnimationOrigin(u,p=!1){const h=this.snapshot,g=h?h.latestValues:{},v={...this.latestValues},k=Rs();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!p;const T=Gt(),P=h?h.source:void 0,M=this.layout?this.layout.source:void 0,D=P!==M,R=this.getStack(),N=!R||R.members.length<=1,H=!!(D&&!N&&this.options.crossfade===!0&&!this.path.some(wT));this.animationProgress=0;let A;this.mixTargetDelta=W=>{const U=W/1e3;ov(k.x,u.x,U),ov(k.y,u.y,U),this.setTargetDelta(k),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ol(T,this.layout.layoutBox,this.relativeParent.layout.layoutBox),yT(this.relativeTarget,this.relativeTargetOrigin,T,U),A&&iT(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=Gt()),bi(A,this.relativeTarget)),D&&(this.animationValues=v,QC(v,g,this.latestValues,U,H,N)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=U},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(u){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Sr(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=St.update(()=>{xl.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=ts(0)),this.currentAnimation=$C(this.motionValue,[0,1e3],{...u,velocity:0,isSync:!0,onUpdate:p=>{this.mixTargetDelta(p),u.onUpdate&&u.onUpdate(p)},onStop:()=>{},onComplete:()=>{u.onComplete&&u.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const u=this.getStack();u&&u.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(aT),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const u=this.getLead();let{targetWithTransforms:p,target:h,layout:g,latestValues:v}=u;if(!(!p||!h||!g)){if(this!==u&&this.layout&&g&&ew(this.options.animationType,this.layout.layoutBox,g.layoutBox)){h=this.target||Gt();const k=_n(this.layout.layoutBox.x);h.x.min=u.target.x.min,h.x.max=h.x.min+k;const T=_n(this.layout.layoutBox.y);h.y.min=u.target.y.min,h.y.max=h.y.min+T}bi(p,h),As(p,v),Ua(this.projectionDeltaWithTransform,this.layoutCorrected,p,v)}}registerSharedNode(u,p){this.sharedNodes.has(u)||this.sharedNodes.set(u,new rT),this.sharedNodes.get(u).add(p);const g=p.options.initialPromotionConfig;p.promote({transition:g?g.transition:void 0,preserveFollowOpacity:g&&g.shouldPreserveFollowOpacity?g.shouldPreserveFollowOpacity(p):void 0})}isLead(){const u=this.getStack();return u?u.lead===this:!0}getLead(){const{layoutId:u}=this.options;return u?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:u}=this.options;return u?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:u}=this.options;if(u)return this.root.sharedNodes.get(u)}promote({needsReset:u,transition:p,preserveFollowOpacity:h}={}){const g=this.getStack();g&&g.promote(this,h),u&&(this.projectionDelta=void 0,this.needsReset=!0),p&&this.setOptions({transition:p})}relegate(){const u=this.getStack();return u?u.relegate(this):!1}resetSkewAndRotation(){const{visualElement:u}=this.options;if(!u)return;let p=!1;const{latestValues:h}=u;if((h.z||h.rotate||h.rotateX||h.rotateY||h.rotateZ||h.skewX||h.skewY)&&(p=!0),!p)return;const g={};h.z&&Ku("z",u,g,this.animationValues);for(let v=0;v<Gu.length;v++)Ku(`rotate${Gu[v]}`,u,g,this.animationValues),Ku(`skew${Gu[v]}`,u,g,this.animationValues);u.render();for(const v in g)u.setStaticValue(v,g[v]),this.animationValues&&(this.animationValues[v]=g[v]);u.scheduleRender()}applyProjectionStyles(u,p){if(!this.instance||this.isSVG)return;if(!this.isVisible){u.visibility="hidden";return}const h=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,u.visibility="",u.opacity="",u.pointerEvents=bl(p?.pointerEvents)||"",u.transform=h?h(this.latestValues,""):"none";return}const g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){this.options.layoutId&&(u.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,u.pointerEvents=bl(p?.pointerEvents)||""),this.hasProjected&&!qr(this.latestValues)&&(u.transform=h?h({},""):"none",this.hasProjected=!1);return}u.visibility="";const v=g.animationValues||g.latestValues;this.applyTransformsToTarget();let k=sT(this.projectionDeltaWithTransform,this.treeScale,v);h&&(k=h(v,k)),u.transform=k;const{x:T,y:P}=this.projectionDelta;u.transformOrigin=`${T.origin*100}% ${P.origin*100}% 0`,g.animationValues?u.opacity=g===this?v.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:v.opacityExit:u.opacity=g===this?v.opacity!==void 0?v.opacity:"":v.opacityExit!==void 0?v.opacityExit:0;for(const M in Ja){if(v[M]===void 0)continue;const{correct:D,applyTo:R,isCSSVariable:N}=Ja[M],H=k==="none"?v[M]:D(v[M],g);if(R){const A=R.length;for(let W=0;W<A;W++)u[R[W]]=H}else N?this.options.visualElement.renderState.vars[M]=H:u[M]=H}this.options.layoutId&&(u.pointerEvents=g===this?bl(p?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(u=>u.currentAnimation?.stop()),this.root.nodes.forEach(rv),this.root.sharedNodes.clear()}}}function lT(n){n.updateLayout()}function cT(n){const e=n.resumeFrom?.snapshot||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:a}=n.layout,{animationType:o}=n.options,c=e.source!==n.layout.source;o==="size"?ai(v=>{const k=c?e.measuredBox[v]:e.layoutBox[v],T=_n(k);k.min=r[v].min,k.max=k.min+T}):ew(o,e.layoutBox,r)&&ai(v=>{const k=c?e.measuredBox[v]:e.layoutBox[v],T=_n(r[v]);k.max=k.min+T,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[v].max=n.relativeTarget[v].min+T)});const u=Rs();Ua(u,r,e.layoutBox);const p=Rs();c?Ua(p,n.applyTransform(a,!0),e.measuredBox):Ua(p,r,e.layoutBox);const h=!K0(u);let g=!1;if(!n.resumeFrom){const v=n.getClosestProjectingParent();if(v&&!v.resumeFrom){const{snapshot:k,layout:T}=v;if(k&&T){const P=Gt();Ol(P,e.layoutBox,k.layoutBox);const M=Gt();Ol(M,r,T.layoutBox),Q0(P,M)||(g=!0),v.options.layoutRoot&&(n.relativeTarget=M,n.relativeTargetOrigin=P,n.relativeParent=v)}}}n.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:p,layoutDelta:u,hasLayoutChanged:h,hasRelativeLayoutChanged:g})}else if(n.isLead()){const{onExitComplete:r}=n.options;r&&r()}n.options.transition=void 0}function uT(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function dT(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function fT(n){n.clearSnapshot()}function rv(n){n.clearMeasurements()}function sv(n){n.isLayoutDirty=!1}function pT(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function av(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function hT(n){n.resolveTargetDelta()}function mT(n){n.calcProjection()}function gT(n){n.resetSkewAndRotation()}function vT(n){n.removeLeadSnapshot()}function ov(n,e,r){n.translate=Dt(e.translate,0,r),n.scale=Dt(e.scale,1,r),n.origin=e.origin,n.originPoint=e.originPoint}function lv(n,e,r,a){n.min=Dt(e.min,r.min,a),n.max=Dt(e.max,r.max,a)}function yT(n,e,r,a){lv(n.x,e.x,r.x,a),lv(n.y,e.y,r.y,a)}function wT(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const bT={duration:.45,ease:[.4,0,.1,1]},cv=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),uv=cv("applewebkit/")&&!cv("chrome/")?Math.round:di;function dv(n){n.min=uv(n.min),n.max=uv(n.max)}function xT(n){dv(n.x),dv(n.y)}function ew(n,e,r){return n==="position"||n==="preserve-aspect"&&!EC(nv(e),nv(r),.2)}function ST(n){return n!==n.root&&n.scroll?.wasRoot}const kT=J0({attachResizeListener:(n,e)=>eo(n,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Qu={current:void 0},tw=J0({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!Qu.current){const n=new kT({});n.mount(window),n.setOptions({layoutScroll:!0}),Qu.current=n}return Qu.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),_T={pan:{Feature:WC},drag:{Feature:UC,ProjectionNode:tw,MeasureLayout:Y0}};function fv(n,e,r){const{props:a}=n;n.animationState&&a.whileHover&&n.animationState.setActive("whileHover",r==="Start");const o="onHover"+r,c=a[o];c&&St.postRender(()=>c(e,so(e)))}class CT extends Cr{mount(){const{current:e}=this.node;e&&(this.unmount=Q2(e,(r,a)=>(fv(this.node,a,"Start"),o=>fv(this.node,o,"End"))))}unmount(){}}class TT extends Cr{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=no(eo(this.node.current,"focus",()=>this.onFocus()),eo(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function pv(n,e,r){const{props:a}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&a.whileTap&&n.animationState.setActive("whileTap",r==="Start");const o="onTap"+(r==="End"?"":r),c=a[o];c&&St.postRender(()=>c(e,so(e)))}class ET extends Cr{mount(){const{current:e}=this.node;e&&(this.unmount=t_(e,(r,a)=>(pv(this.node,a,"Start"),(o,{success:c})=>pv(this.node,o,c?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Nd=new WeakMap,Zu=new WeakMap,PT=n=>{const e=Nd.get(n.target);e&&e(n)},DT=n=>{n.forEach(PT)};function LT({root:n,...e}){const r=n||document;Zu.has(r)||Zu.set(r,{});const a=Zu.get(r),o=JSON.stringify(e);return a[o]||(a[o]=new IntersectionObserver(DT,{root:n,...e})),a[o]}function MT(n,e,r){const a=LT(e);return Nd.set(n,r),a.observe(n),()=>{Nd.delete(n),a.unobserve(n)}}const AT={some:0,all:1};class RT extends Cr{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:a,amount:o="some",once:c}=e,u={root:r?r.current:void 0,rootMargin:a,threshold:typeof o=="number"?o:AT[o]},p=h=>{const{isIntersecting:g}=h;if(this.isInView===g||(this.isInView=g,c&&!g&&this.hasEnteredView))return;g&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",g);const{onViewportEnter:v,onViewportLeave:k}=this.node.getProps(),T=g?v:k;T&&T(h)};return MT(this.node.current,u,p)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(FT(e,r))&&this.startObserver()}unmount(){}}function FT({viewport:n={}},{viewport:e={}}={}){return r=>n[r]!==e[r]}const OT={inView:{Feature:RT},tap:{Feature:ET},focus:{Feature:TT},hover:{Feature:CT}},NT={layout:{ProjectionNode:tw,MeasureLayout:Y0}},IT={...xC,...OT,..._T,...NT},Id=I_(IT,K_);function BT(n){const e=Ty(()=>ts(n)),{isStatic:r}=se.useContext(Pf);if(r){const[,a]=se.useState(n);se.useEffect(()=>e.on("change",a),[])}return e}const hv=300,zT=n=>{const e=window.innerWidth;return e<=390?Math.min(25,n*.08):e<=540?Math.min(30,n*.1):Math.min(40,n*.12)},mv={type:"spring",mass:.8,stiffness:350,damping:30};function VT({items:n,baseWidth:e=300,autoplay:r=!1,autoplayDelay:a=3e3,pauseOnHover:o=!1,loop:c=!1,round:u=!1}){const h=(()=>{const A=window.innerWidth;return A<=390?16:A<=540?20:30})(),g=24,v=e-h*2,[k,T]=se.useState(0),P=BT(0),M=se.useRef(null),[D,R]=se.useState(!1),N=se.useMemo(()=>zT(v),[v]);se.useEffect(()=>{if(!r||o&&D)return;const A=setInterval(()=>{P.get()===0&&T(U=>U===n.length-1?c?0:U:U+1)},a);return()=>clearInterval(A)},[r,a,P,n.length,c,D,o]),se.useEffect(()=>{if(!o||!M.current)return;const A=M.current,W=()=>R(!0),U=()=>R(!1);return A.addEventListener("mouseenter",W),A.addEventListener("mouseleave",U),()=>{A.removeEventListener("mouseenter",W),A.removeEventListener("mouseleave",U)}},[o]);const H=(A,W)=>{const U=P.get(),Z=W.velocity.x,ne=U<=-N||Z<-hv,ee=U>=N||Z>hv;ne&&k<n.length-1?T(Q=>Q+1):ee&&k>0?T(Q=>Q-1):c&&(ne&&k===n.length-1?T(0):ee&&k===0&&T(n.length-1))};return xe.jsxs("div",{ref:M,className:`carousel-container ${u?"round":""}`,style:{width:`${e}px`,...u&&{height:`${e}px`,borderRadius:"50%"}},children:[xe.jsx(Id.div,{drag:"x",dragConstraints:{left:0,right:0},dragElastic:.2,dragTransition:{bounceStiffness:300,bounceDamping:20},style:{x:P,width:v},animate:{translateX:`-${k*(v+g)}px`},transition:mv,onDragEnd:H,className:"carousel-track",children:n.map((A,W)=>{const U=W===k;return xe.jsxs(Id.div,{className:`carousel-item ${u?"round":""}`,style:{width:v,height:u?v:"100%",...u&&{borderRadius:"50%"}},animate:{scale:U?1:.95,borderColor:U?"rgba(255, 255, 255, 0.2)":"rgba(255, 255, 255, 0.1)",backgroundColor:U?"rgba(255, 255, 255, 0.08)":"rgba(255, 255, 255, 0.05)",boxShadow:U?"0 0 0 1px rgba(255, 255, 255, 0.06), 0 0 30px rgba(255, 255, 255, 0.08), 0 0 60px rgba(255, 255, 255, 0.04)":"0 0 0 0px rgba(255, 255, 255, 0), 0 0 0px rgba(255, 255, 255, 0), 0 0 0px rgba(255, 255, 255, 0)"},transition:{...mv,boxShadow:{type:"spring",mass:3,stiffness:200,damping:50}},children:[xe.jsx("div",{className:`carousel-item-header ${u?"round":""}`,children:xe.jsx("span",{className:"carousel-icon-container",children:A.icon})}),xe.jsxs("div",{className:"carousel-item-content",children:[xe.jsx("div",{className:"carousel-item-title",children:A.title}),xe.jsx("p",{className:"carousel-item-description",children:A.description})]})]},W)})}),xe.jsx("div",{className:`carousel-indicators-container ${u?"round":""}`,children:xe.jsx("div",{className:"carousel-indicators",children:n.map((A,W)=>xe.jsx("button",{onClick:()=>T(W),className:`carousel-indicator ${W===k?"active":"inactive"}`},W))})})]})}const UT=20,WT=1,nw=1.26,jT=[.19,1,.22,1],gv=()=>{const n=window.innerWidth,e=nw;return n>=1024?500:n>=768?n*.65/e:n>=540?n*.75/e:n>=430?n*.85/e:n*.9/e},qT=[{title:"Fixed Scope, No Surprises",description:"Everything defined upfront in a clear SOW. No hidden fees, no unexpected charges.",id:1,icon:xe.jsxs("svg",{className:"carousel-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[xe.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),xe.jsx("polyline",{points:"14 2 14 8 20 8"})]})},{title:"Built on Modern Tech",description:"React, Next.js, Firebaseenterprise-level tools that keep your site fast and reliable.",id:2,icon:xe.jsxs("svg",{className:"carousel-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[xe.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),xe.jsx("path",{d:"M2 17l10 5 10-5M2 12l10 5 10-5"})]})},{title:"Pay as We Build",description:"Milestone-based payments. You only pay for completed workdesign approval, then delivery.",id:3,icon:xe.jsxs("svg",{className:"carousel-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[xe.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),xe.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})},{title:"30-Day Launch Warranty",description:"Your site will work as promised. Guaranteed functionality for 30 days post-deployment.",id:4,icon:xe.jsx("svg",{className:"carousel-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:xe.jsx("polyline",{points:"20 6 9 17 4 12"})})},{title:"Ongoing Support Available",description:"Launch is just the beginning. Maintenance plans keep your site running smoothly as you grow.",id:5,icon:xe.jsx("svg",{className:"carousel-icon",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:xe.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}];function HT(){const[n,e]=se.useState(gv());return se.useEffect(()=>{const r=()=>{e(gv())};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),xe.jsx(Id.div,{initial:{scale:WT},whileInView:{scale:nw},transition:{duration:UT,ease:jT,delay:.3},viewport:{once:!0,amount:.2},children:xe.jsx(VT,{items:qT,baseWidth:n,autoplay:!0,autoplayDelay:4e3,pauseOnHover:!0,loop:!0,round:!1})})}const vv=()=>{const n=document.getElementById("philosophy-carousel-root");n?(xv.createRoot(n).render(xe.jsx(HT,{})),console.log(" Philosophy Carousel mounted successfully")):console.error(" Philosophy carousel root element not found")};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",vv):vv();(function(){var n=function(d,y){return(y||document).querySelector(d)},e=function(d,y){for(var w=(y||document).querySelectorAll(d),b=[],_=0;_<w.length;_++)b.push(w[_]);return b},r=function(d,y){var w=0;return function(){var b=arguments,_=Date.now();_-w>=y&&(w=_,d.apply(this,b))}},a=function(d,y){var w;return function(){var b=arguments,_=this;clearTimeout(w),w=setTimeout(function(){d.apply(_,b)},y)}},o=null,c=function(){var d=new Image;d.crossOrigin="anonymous",d.onload=function(){try{var y=document.createElement("canvas");y.width=d.width,y.height=d.height;var w=y.getContext("2d");w.drawImage(d,0,0),o=y.toDataURL("image/png"),console.log("Logo cached for PDF generation")}catch(b){console.warn("Could not cache logo:",b)}},d.onerror=function(){console.warn("Could not load logo for caching")},d.src="/images/scarlo-logo.png"},u=function(){return o||"https://scarlo.dev/images/scarlo-logo.png"},p={"+1":{maxDigits:10,format:"US"},"+44":{maxDigits:10,format:"UK"},"+91":{maxDigits:10,format:"IN"},"+61":{maxDigits:9,format:"AU"},"+81":{maxDigits:10,format:"JP"},"+49":{maxDigits:11,format:"DE"},"+33":{maxDigits:9,format:"FR"},"+86":{maxDigits:11,format:"CN"},"+52":{maxDigits:10,format:"MX"},"+55":{maxDigits:11,format:"BR"}},h=function(d,y){if(!d)return"";y=y||"+1";var w=p[y]||p["+1"],b=d.replace(/\D/g,"");b.length>w.maxDigits&&(b=b.substring(0,w.maxDigits));var _="";return w.format==="US"?(b.length>0&&(_="("+b.substring(0,Math.min(3,b.length))),b.length>3&&(_+=") "+b.substring(3,Math.min(6,b.length))),b.length>6&&(_+="-"+b.substring(6,10))):(_=b,b.length>3&&(_=b.substring(0,3)+" "+b.substring(3)),b.length>6&&(_=b.substring(0,3)+" "+b.substring(3,6)+" "+b.substring(6)),b.length>9&&(_=b.substring(0,3)+" "+b.substring(3,6)+" "+b.substring(6,9)+" "+b.substring(9))),_},g=function(d){if(!d)return"";var y=d.replace(/\D/g,"");return y.length===10?"+1"+y:y.length===11&&y.startsWith("1")?"+"+y:d.startsWith("+")?d.replace(/[^\d+]/g,""):y.length>=10?"+1"+y.slice(-10):d},v=function(d){d&&d.addEventListener("input",function(){for(var y=d.selectionStart,w=d.value,b=w.slice(0,y).replace(/\D/g,"").length,_=w.replace(/\D/g,"").slice(0,10),E="",S=0;S<_.length;S++)S===0&&(E+="("),S===3&&(E+=") "),S===6&&(E+="-"),E+=_[S];d.value=E;for(var C=0,F=0,I=0;I<E.length;I++)if(/\d/.test(E[I])&&(F++,F===b)){C=I+1;break}b===0&&(C=E.length>0?1:0),d.setSelectionRange(C,C)})},k={isMobile:function(){return window.innerWidth<=1024||"ontouchstart"in window},isLowEndDevice:function(){var d=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return d?d.effectiveType==="slow-2g"||d.effectiveType==="2g":navigator.hardwareConcurrency&&navigator.hardwareConcurrency<4},isLaptopOrLarger:function(){return window.innerWidth>=1024}},T=function(){if(this.nav=n(".navbar"),!this.nav){console.warn("Navbar not found");return}this.hamburger=n(".hamburger"),this.menu=n(".nav-menu"),this.links=e(".nav-link"),this.sections=null,this.isScrolled=!1,this.scrollTicking=!1,this.activeLinkTicking=!1;var d=this;requestAnimationFrame(function(){d.init()})};T.prototype.init=function(){this.setupSmoothScroll(),this.setupMobileMenu(),this.setupLanguageToggle();var d=this;setTimeout(function(){d.setupScrollEffects(),d.setupActiveLinks()},100)},T.prototype.setupSmoothScroll=function(){for(var d=this,y=e('a[href^="#"]'),w=0;w<y.length;w++)(function(b){b.addEventListener("click",function(_){var E=b.getAttribute("href");if(!(!E||E==="#")){var S=n(E);if(S){_.preventDefault();var C=d.nav?d.nav.offsetHeight:0,F=S.offsetTop-C;window.scrollTo({top:F,behavior:"smooth"}),d.closeMobileMenu()}}})})(y[w])},T.prototype.setupMobileMenu=function(){var d=this;!this.hamburger||!this.menu||(this.hamburger.addEventListener("click",function(){d.toggleMobileMenu()}),document.addEventListener("keydown",function(y){y.key==="Escape"&&d.menu&&d.menu.classList.contains("active")&&d.closeMobileMenu()}),document.addEventListener("click",function(y){d.menu&&d.menu.classList.contains("active")&&!d.menu.contains(y.target)&&d.hamburger&&!d.hamburger.contains(y.target)&&d.closeMobileMenu()}))},T.prototype.toggleMobileMenu=function(){!this.menu||!this.hamburger||(this.menu.classList.toggle("active"),this.hamburger.classList.toggle("active"),document.body.style.overflow=this.menu.classList.contains("active")?"hidden":"")},T.prototype.closeMobileMenu=function(){!this.menu||!this.hamburger||(this.menu.classList.remove("active"),this.hamburger.classList.remove("active"),document.body.style.overflow="")},T.prototype.setupScrollEffects=function(){var d=this;if(this.nav){var y=100,w=20,b=function(){var S=window.pageYOffset||document.documentElement.scrollTop||0;!d.isScrolled&&S>y?(d.isScrolled=!0,d.nav.classList.add("scrolled")):d.isScrolled&&S<y-w&&(d.isScrolled=!1,d.nav.classList.remove("scrolled")),d.scrollTicking=!1},_=function(){d.scrollTicking||(d.scrollTicking=!0,requestAnimationFrame(b))};window.addEventListener("scroll",_,{passive:!0});var E=window.pageYOffset||document.documentElement.scrollTop||0;E>y&&(this.isScrolled=!0,this.nav.classList.add("scrolled"))}},T.prototype.setupActiveLinks=function(){var d=this;if(!(!this.links||this.links.length===0)&&(this.sections=e("section[id]"),!(!this.sections||this.sections.length===0))){var y=function(){var b=window.pageYOffset+window.innerHeight/2,_=document.documentElement.scrollHeight,E=window.innerHeight,S="";if(window.pageYOffset+E>=_-50)S="contact";else for(var C=0;C<d.sections.length;C++){var F=d.sections[C],I=F.offsetTop,z=F.offsetHeight;if(b>=I&&b<I+z){S=F.getAttribute("id");break}}for(var O=0;O<d.links.length;O++){var q=d.links[O];q.classList.remove("active"),q.getAttribute("href")==="#"+S&&q.classList.add("active")}d.activeLinkTicking=!1},w=function(){d.activeLinkTicking||(d.activeLinkTicking=!0,requestAnimationFrame(y))};window.addEventListener("scroll",w,{passive:!0}),setTimeout(y,200)}},T.prototype.setupLanguageToggle=function(){var d=document.getElementById("langToggle");if(d){var y=d.querySelectorAll(".lang-btn"),w=typeof getCurrentLang=="function"?getCurrentLang():"en";y.forEach(function(_){_.classList.toggle("active",_.getAttribute("data-lang")===w)}),this.applyLanguage(w);var b=this;y.forEach(function(_){_.addEventListener("click",function(){var E=this.getAttribute("data-lang");typeof setLang=="function"&&setLang(E),y.forEach(function(S){S.classList.remove("active")}),this.classList.add("active"),b.applyLanguage(E),window.rotatingText&&window.rotatingText.switchLanguage&&window.rotatingText.switchLanguage()})})}},T.prototype.applyLanguage=function(d){if(typeof t=="function"){var y=document.querySelectorAll("[data-i18n]");y.forEach(function(S){var C=S.getAttribute("data-i18n"),F=t(C);if(F&&F!==C){if(S.classList.contains("rotating-text"))return;S.textContent=F}});var w=document.querySelectorAll("[data-i18n-html]");w.forEach(function(S){var C=S.getAttribute("data-i18n-html"),F=t(C);F&&F!==C&&(S.innerHTML=F)});var b=document.querySelectorAll("[data-i18n-placeholder]");b.forEach(function(S){var C=S.getAttribute("data-i18n-placeholder"),F=t(C);F&&F!==C&&(S.placeholder=F)});var _=document.getElementById("authStatusText");if(_){var E=_.textContent==="Sign Out"||_.textContent==="Cerrar Sesin";_.textContent=E?t("nav.signOut"):t("nav.signIn")}}};var P=function(){if(this.wrapper=n(".rotating-text-wrapper"),!!this.wrapper){this.texts=e(".rotating-text"),this.currentIndex=0;var d=typeof getCurrentLang=="function"?getCurrentLang():"en";if(d!=="en"&&typeof t=="function"){var y=document.querySelector(".hero-title-visual .title-line:first-child");y&&(y.textContent=t("hero.titleLine1")),this.texts.forEach(function(w,b){var _=t("hero.r"+b);_&&(w.textContent=_)})}this.init()}};P.prototype.init=function(){var d=this;this.texts.forEach(function(y){var w=y.textContent,b="";Array.from(w).forEach(function(_){_===" "?b+='<span class="char-space"> </span>':b+='<span class="char">'+_+"</span>"}),y.innerHTML=b}),setTimeout(function(){d.rotate()},3e3)},P.prototype.rotate=function(){var d=this;setInterval(function(){d.texts[d.currentIndex].classList.remove("active"),d.currentIndex=(d.currentIndex+1)%d.texts.length,d.texts[d.currentIndex].classList.add("active")},7e3)},P.prototype.switchLanguage=function(){if(typeof t=="function"){var d=document.querySelector(".hero-title-visual .title-line:first-child");d&&(d.textContent=t("hero.titleLine1")),this.texts.forEach(function(y,w){var b=t("hero.r"+w);if(b){var _="";Array.from(b).forEach(function(E){E===" "?_+='<span class="char-space"> </span>':_+='<span class="char">'+E+"</span>"}),y.innerHTML=_}})}};var M=function(){this.init()};M.prototype.init=function(){var d=new IntersectionObserver(function(y){y.forEach(function(w){w.isIntersecting&&(w.target.classList.add("visible"),d.unobserve(w.target))})},{threshold:.15,rootMargin:"0px 0px -100px 0px"});e(".portfolio-item, .philosophy-card").forEach(function(y){d.observe(y)})};var D=function(){this.thumbnails=e(".portfolio-thumbnail"),this.isMobile=k.isMobile(),console.log("Portfolio Handler - Mobile mode:",this.isMobile),this.init()};D.prototype.init=function(){this.isMobile?(console.log("Mobile: Using thumbnail links only"),this.thumbnails.forEach(function(d){d.addEventListener("click",function(){var y=d.getAttribute("data-url");y&&window.open(y,"_blank")})})):(console.log("Desktop: Enabling iframe loading"),this.setupDesktopIframes())},D.prototype.setupDesktopIframes=function(){var d=this,y=new IntersectionObserver(function(w){w.forEach(function(b){b.isIntersecting&&(d.loadIframe(b.target),y.unobserve(b.target))})},{rootMargin:"500px",threshold:.01});this.thumbnails.forEach(function(w){y.observe(w)})},D.prototype.loadIframe=function(d){var y=d.getAttribute("data-url");if(!y){console.error("No URL found for thumbnail");return}console.log("Loading iframe:",y);var w=document.createElement("iframe");w.src=y,w.style.cssText="width: 100%; height: 100%; border: none; display: block;",w.setAttribute("loading","lazy"),w.setAttribute("allowfullscreen",""),w.addEventListener("load",function(){console.log("Iframe loaded:",y)}),w.addEventListener("error",function(){console.error("Iframe error:",y),d.innerHTML='<div class="thumbnail-overlay"><span>Failed to load preview</span></div>'});var b=d.parentElement;b.innerHTML="",b.appendChild(w)};var R=function(){this.form=n(".contact-form"),this.fields=e(".form-field input, .form-field textarea"),this.form&&this.init()};R.prototype.init=function(){var d=this;this.fields.forEach(function(y){y.setAttribute("placeholder"," ")}),this.form.addEventListener("submit",function(y){y.preventDefault();var w=n(".btn-submit"),b=n(".btn-text",w),_=b.textContent;w.disabled=!0,b.textContent=t("contact.btn.sending"),setTimeout(function(){b.textContent=t("contact.btn.sent"),w.style.background="linear-gradient(135deg, #10b981 0%, #059669 100%)",d.form.reset(),setTimeout(function(){b.textContent=_,w.style.background="",w.disabled=!1},3e3)},1500)})};var N=function(){if(this.authModal=n("#authModal"),this.contractModal=n("#contractModal"),this.currentUser=null,this.recaptchaVerifier=null,this.confirmationResult=null,this.currentPhoneNumber="",this.lastLoginError=null,!this.authModal||!this.contractModal){console.error("Auth or Contract modal not found");return}this.init()};N.prototype.init=function(){var d=this;typeof firebase<"u"&&firebase.auth?firebase.auth().onAuthStateChanged(function(O){d.handleAuthStateChange(O)}):console.error("Firebase is not loaded.");var y=n("#authActionBtn");y&&y.addEventListener("click",function(O){O.preventDefault(),d.currentUser?confirm(t("auth.confirm.signOut"))&&d.handleLogout():d.showAuthModal()}),e(".view-contract-trigger").forEach(function(O){O.addEventListener("click",function(q){q.preventDefault(),d.checkAuthAndShowContract()})});var w=n("#downloadTemplateBtn");w&&w.addEventListener("click",function(O){O.preventDefault(),d.checkAuthAndShowContract()});var b=n("#closeAuthBtn");b&&b.addEventListener("click",function(){d.closeAuthModal()});var _=n("#closeModalBtn");_&&_.addEventListener("click",function(){d.closeContractModal()});var E=n("#loginForm");E&&E.addEventListener("submit",function(O){O.preventDefault(),d.handleLogin()});var S=n(".auth-overlay",this.authModal);S&&S.addEventListener("click",function(){d.closeAuthModal()});var C=n(".modal-overlay",this.contractModal);C&&C.addEventListener("click",function(){d.closeContractModal()});var F=n("#loginContactDevBtn");F&&F.addEventListener("click",function(){d.openHelpModalWithContext()});var I=n("#phoneContactDevBtn");I&&I.addEventListener("click",function(){d.openHelpModalWithContext()});var z=n("#verifyContactDevBtn");z&&z.addEventListener("click",function(){d.openHelpModalWithContext()}),this.setupTabs(),this.initPhoneAuth()},N.prototype.checkAuthAndShowContract=function(){this.currentUser?this.showContractModal():this.showAuthModal()},N.prototype.handleAuthStateChange=function(d){var y=this;this.currentUser=d;var w=n("#authActionBtn"),b=n("#authStatusText");if(d){w&&w.classList.add("logged-in"),b&&(d.email?b.textContent=d.email.split("@")[0]:d.phoneNumber&&(b.textContent="***"+d.phoneNumber.slice(-4))),this.saveUserToFirestore(d);var _=(window.VITE_DEVELOPER_EMAIL||"").trim().toLowerCase(),E=d.email?d.email.trim().toLowerCase():"";if(E&&E===_){var S=new URLSearchParams(window.location.search),C=S.has("business")||S.has("phone")||S.has("email")||S.has("package");C&&setTimeout(function(){y.showContractModal()},300)}}else console.log("User signed out"),w&&w.classList.remove("logged-in"),b&&(b.textContent=t("auth.btn.signIn")),this.closeContractModal()},N.prototype.saveUserToFirestore=function(d){if(!d||!d.uid){console.log(" No user or uid, skipping save");return}var y=window.VITE_DEVELOPER_EMAIL||"";if(d.email&&d.email.toLowerCase()===y.toLowerCase()){console.log(" Developer email, skipping save");return}var w={uid:d.uid,email:d.email||null,phoneNumber:d.phoneNumber||null,displayName:d.displayName||null,lastLogin:firebase.firestore.FieldValue.serverTimestamp()};console.log(" Saving user data to Firestore:",w);var b=firebase.firestore().collection("users");b.doc(d.uid).set(w,{merge:!0}).then(function(){console.log(" User info saved to Firestore successfully")}).catch(function(_){console.error(" Error saving user to Firestore:",_)})},N.prototype.showAuthModal=function(){this.authModal&&(this.authModal.classList.add("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open"))},N.prototype.closeAuthModal=function(){this.authModal&&(this.authModal.classList.remove("show"),document.body.style.overflow="",document.body.classList.remove("modal-open"),this.resetPhoneAuthToStep1())},N.prototype.showContractModal=function(){this.contractModal&&(this.contractModal.classList.add("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open"),setTimeout(function(){window.dispatchEvent(new CustomEvent("contractModalOpened"))},150))},N.prototype.closeContractModal=function(){window.unsubscribeFromUsers&&window.unsubscribeFromUsers(),this.contractModal&&(this.contractModal.classList.remove("show"),document.body.style.overflow="",document.body.classList.remove("modal-open"))},N.prototype.resetContractModalState=function(){var d=document.getElementById("developerDashboard");d&&d.remove();var y=document.getElementById("dualSigningCompleted");y&&y.remove();var w=document.getElementById("closeModalBtn");w&&(w.style.display="",w.style.position="",w.style.top="",w.style.alignSelf="",w.style.marginRight="",w.style.marginTop="",w.style.marginBottom="",w.style.flexShrink="");var b=document.querySelector(".modal-header");b&&(b.style.display="");var _=document.getElementById("contractForm");_&&(_.style.display="",_.reset());var E=document.getElementById("clientSignatureBlock"),S=document.getElementById("developerSignatureBlock");E&&(E.style.display=""),S&&(S.style.display="");var C=document.getElementById("clientSignaturePad"),F=document.getElementById("devSignaturePad");if(C){var I=C.getContext("2d");I&&I.clearRect(0,0,C.width,C.height)}if(F){var I=F.getContext("2d");I&&I.clearRect(0,0,F.width,F.height)}},N.prototype.handleLogin=function(){var d=n("#loginEmail").value.trim(),y=n("#loginPassword").value,w=n("#loginError"),b=n("#loginHelpLink"),_=n('#loginForm button[type="submit"]');if(b&&(b.style.display="none"),!d||!y){this.showError(w,t("auth.err.fillFields"));return}_.disabled=!0,_.textContent=t("auth.btn.signingIn");var E=this;firebase.auth().signInWithEmailAndPassword(d,y).then(function(S){console.log("Login successful"),E.closeAuthModal(),n("#loginForm").reset(),setTimeout(function(){E.showContractModal()},300)}).catch(function(S){console.error("Login error:",S),E.showErrorWithHelpLink(w,b,E.getErrorMessage(S.code),{email:d,errorType:"account_access"})}).finally(function(){_.disabled=!1,_.textContent=t("auth.btn.signIn")})},N.prototype.handleLogout=function(){var d=this;firebase.auth().signOut().then(function(){console.log("Logged out successfully"),d.resetContractModalState(),d.closeContractModal()}).catch(function(y){console.error("Logout error:",y),alert(t("auth.err.signOut"))})},N.prototype.showError=function(d,y){d&&(d.textContent=y,d.classList.add("show"),setTimeout(function(){d.classList.remove("show")},5e3))},N.prototype.getErrorMessage=function(d){var y={"auth/configuration-not-found":t("auth.err.configNotFound"),"auth/invalid-email":t("auth.err.invalidEmail"),"auth/user-not-found":t("auth.err.userNotFound"),"auth/wrong-password":t("auth.err.wrongPassword"),"auth/too-many-requests":t("auth.err.tooManyRequests"),"auth/network-request-failed":t("auth.err.networkFailed"),"auth/user-disabled":t("auth.err.userDisabled"),"auth/invalid-credential":t("auth.err.invalidCredential"),"auth/invalid-phone-number":t("auth.err.invalidPhone"),"auth/missing-phone-number":t("auth.err.missingPhone"),"auth/quota-exceeded":t("auth.err.quotaExceeded"),"auth/captcha-check-failed":t("auth.err.captchaFailed"),"auth/invalid-verification-code":t("auth.err.invalidCode"),"auth/code-expired":t("auth.err.codeExpired"),"auth/missing-verification-code":t("auth.err.missingCode"),"auth/invalid-verification-id":t("auth.err.invalidVerificationId"),"auth/session-expired":t("auth.err.sessionExpired"),"auth/credential-already-in-use":t("auth.err.credentialInUse"),"auth/operation-not-allowed":t("auth.err.operationNotAllowed"),"auth/billing-not-enabled":t("auth.err.billingNotEnabled")};return y[d]||t("auth.err.default")},N.prototype.showErrorWithHelpLink=function(d,y,w,b){this.lastLoginError={message:w,email:b.email||"",phone:b.phone||"",errorType:b.errorType||"account_access"},y&&(y.style.display="none"),d&&(d.textContent=w,d.classList.add("show"),setTimeout(function(){d.classList.remove("show"),y&&(y.style.display="flex")},5e3))},N.prototype.openHelpModalWithContext=function(){var d=n("#helpModal"),y=n("#helpContact"),w=n("#helpContactLabel"),b=n("#helpIssue"),_=n("#helpDetails"),E=n("#contactTabs"),S=n("#helpSuccessMessage"),C=document.querySelectorAll("#helpRequestForm .form-group"),F=document.querySelector(".help-form-footer");!d||!this.lastLoginError||(d.classList.add("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open"),S&&S.classList.remove("show"),C.forEach(function(I){I.style.display="block"}),F&&(F.style.display="flex"),y&&(this.lastLoginError.email?(y.value=this.lastLoginError.email,y.type="email",y.placeholder="your@email.com",w&&(w.textContent=t("help.label.email")),E&&(E.style.display="none")):this.lastLoginError.phone&&(y.value=this.lastLoginError.phone,y.type="tel",y.placeholder="(555) 123-4567",w&&(w.textContent=t("help.label.phone")),E&&(E.style.display="none")),y.removeAttribute("readonly"),y.style.opacity="1"),b&&(b.value=this.lastLoginError.errorType),_&&(_.value=""))},N.prototype.setupTabs=function(){var d=this,y=e(".auth-tab",this.authModal),w=e(".auth-panel",this.authModal);y.forEach(function(b){b.addEventListener("click",function(){var _=this.getAttribute("data-tab");y.forEach(function(C){C.classList.remove("active")}),this.classList.add("active"),w.forEach(function(C){C.classList.remove("active")});var E=n("#"+_+"Panel",d.authModal);E&&E.classList.add("active");var S=e(".auth-help-link",d.authModal);S.forEach(function(C){C.style.display="none"}),_==="phone"&&d.resetPhoneAuthToStep1()})})},N.prototype.initPhoneAuth=function(){var d=this,y=n("#phoneForm"),w=n("#verifyCodeForm"),b=n("#backToPhoneBtn");y&&y.addEventListener("submit",function(S){S.preventDefault(),d.handlePhoneSubmit()}),w&&w.addEventListener("submit",function(S){S.preventDefault(),d.handleCodeVerification()}),b&&b.addEventListener("click",function(){d.resetPhoneAuthToStep1()});var _=n("#phoneNumber");_&&v(_);var E=n("#verificationCode");E&&E.addEventListener("input",function(S){S.target.value=S.target.value.replace(/\D/g,"").slice(0,6)})},N.prototype.initRecaptcha=function(){this.recaptchaVerifier||(this.recaptchaVerifier=new firebase.auth.RecaptchaVerifier("recaptcha-container",{size:"invisible"}))},N.prototype.handlePhoneSubmit=function(){var d=this,y=n("#countryCode"),w=n("#phoneNumber"),b=y?y.value:"+1",_=w?w.value.replace(/\D/g,""):"",E=n("#phoneError"),S=n("#phoneHelpLink"),C=n("#sendCodeBtn");if(E&&(E.classList.remove("show"),E.textContent=""),S&&(S.style.display="none"),!_||_.length<10){this.showError(E,t("auth.err.validPhone"));return}var F=b+_;this.currentPhoneNumber=F,this.isTestPhone=!1,this.setPhoneLoadingState(C,!0);var I=firebase.functions().httpsCallable("checkTestPhoneNumber");I({phoneNumber:F}).then(function(z){if(z.data.isTestPhone)console.log("Test phone number detected, skipping SMS"),d.isTestPhone=!0,d.confirmationResult=null,d.showVerificationStep(),d.setPhoneLoadingState(C,!1);else{var O=n("#phoneHelpLink");d.showErrorWithHelpLink(E,O,t("auth.err.phoneNotRegistered"),{phone:F,errorType:"account_access"}),d.setPhoneLoadingState(C,!1)}}).catch(function(z){console.error("Error checking test phone:",z);var O=n("#phoneHelpLink");d.showErrorWithHelpLink(E,O,t("auth.err.phoneVerifyFailed"),{phone:F,errorType:"account_access"}),d.setPhoneLoadingState(C,!1)})},N.prototype.proceedWithRealPhoneAuth=function(d,y,w){var b=this;this.initRecaptcha(),firebase.auth().signInWithPhoneNumber(d,this.recaptchaVerifier).then(function(_){console.log("SMS sent successfully"),b.confirmationResult=_,b.showVerificationStep()}).catch(function(_){console.error("SMS send error:",_),b.showError(y,b.getErrorMessage(_.code)),b.recaptchaVerifier=null}).finally(function(){b.setPhoneLoadingState(w,!1)})},N.prototype.handleCodeVerification=function(){var d=this,y=n("#verificationCode"),w=y?y.value.trim():"",b=n("#verifyError"),_=n("#verifyHelpLink"),E=n("#verifyCodeBtn");b&&(b.classList.remove("show"),b.textContent=""),_&&(_.style.display="none");var S=this.isTestPhone?4:6,C=6;if(!w||w.length<S||w.length>C){var F=this.isTestPhone?t("auth.err.codeDigits46"):t("auth.err.codeDigits6");this.showError(b,F);return}if(this.setPhoneLoadingState(E,!0),this.isTestPhone)this.verifyTestPhone(w,b,E);else{if(!this.confirmationResult){this.showErrorWithHelpLink(b,_,t("auth.err.invalidVerificationId"),{phone:this.currentPhoneNumber,errorType:"verification_code"}),this.setPhoneLoadingState(E,!1);return}this.confirmationResult.confirm(w).then(function(I){console.log("Phone auth successful:",I.user),d.closeAuthModal(),d.resetPhoneAuthState(),setTimeout(function(){d.showContractModal()},300)}).catch(function(I){console.error("Code verification error:",I);var z=n("#verifyHelpLink");d.showErrorWithHelpLink(b,z,d.getErrorMessage(I.code),{phone:d.currentPhoneNumber,errorType:"verification_code"})}).finally(function(){d.setPhoneLoadingState(E,!1)})}},N.prototype.verifyTestPhone=function(d,y,w){var b=this;console.log("Verifying test phone:",this.currentPhoneNumber);var _=firebase.functions().httpsCallable("verifyTestPhoneNumber");_({phoneNumber:this.currentPhoneNumber,verificationCode:d}).then(function(E){if(E.data.success&&E.data.customToken)return console.log("Test phone verification successful, signing in with custom token"),firebase.auth().signInWithCustomToken(E.data.customToken);throw new Error("Verification failed")}).then(function(E){console.log("Signed in with custom token:",E.user),b.closeAuthModal(),b.resetPhoneAuthState(),setTimeout(function(){b.showContractModal()},300)}).catch(function(E){console.error("Test phone verification error:",E);var S=E.message||t("auth.err.invalidCodeGeneric");E.code==="functions/invalid-argument"?S=t("auth.err.invalidPhoneOrCode"):E.code==="functions/internal"&&(S=t("auth.err.serverError"));var C=n("#verifyHelpLink");b.showErrorWithHelpLink(y,C,S,{phone:b.currentPhoneNumber,errorType:"verification_code"})}).finally(function(){b.setPhoneLoadingState(w,!1)})},N.prototype.showVerificationStep=function(){var d=n("#phoneForm"),y=n("#verifyCodeForm");d&&(d.style.display="none"),y&&(y.style.display="block");var w=n("#verificationCode");w&&setTimeout(function(){w.focus()},100)},N.prototype.resetPhoneAuthToStep1=function(){var d=n("#phoneForm"),y=n("#verifyCodeForm");d&&(d.style.display="block"),y&&(y.style.display="none");var w=n("#verificationCode");w&&(w.value="");var b=n("#phoneError"),_=n("#verifyError");b&&b.classList.remove("show"),_&&_.classList.remove("show");var E=n("#sendCodeBtn"),S=n("#verifyCodeBtn");this.setPhoneLoadingState(E,!1),this.setPhoneLoadingState(S,!1),this.recaptchaVerifier=null},N.prototype.resetPhoneAuthState=function(){this.confirmationResult=null,this.currentPhoneNumber="",this.isTestPhone=!1,this.resetPhoneAuthToStep1();var d=n("#phoneForm");d&&d.reset()},N.prototype.setPhoneLoadingState=function(d,y){d&&(y?(d.classList.add("loading"),d.disabled=!0):(d.classList.remove("loading"),d.disabled=!1))},N.prototype.formatPhoneDisplay=function(d){if(d.startsWith("+1")&&d.length===12){var y=d.slice(2);return"+1 ("+y.slice(0,3)+") "+y.slice(3,6)+"-"+y.slice(6)}return d};function H(d){if(!d)return null;var y=d.getContext("2d"),w=!1,b=!1,_=0,E=0;function S(){var q=d.getBoundingClientRect(),V=window.devicePixelRatio||1;if(q.width<=0||q.height<=0){console.log("Signature canvas not visible yet, will retry...",q.width,"x",q.height),setTimeout(function(){var X=d.getBoundingClientRect();X.width>0&&X.height>0&&S()},100);return}d.width=q.width*V,d.height=q.height*V,y.scale(V,V),y.strokeStyle="#ffffff",y.fillStyle="#ffffff",y.lineWidth=2.5,y.lineCap="round",y.lineJoin="round",console.log("Signature canvas sized:",q.width,"x",q.height)}function C(q){var V=d.getBoundingClientRect(),X,G;q.touches&&q.touches.length>0?(X=q.touches[0].clientX,G=q.touches[0].clientY):(X=q.clientX,G=q.clientY);var j=X-V.left,Y=G-V.top,ie=d.width/V.width,ae=d.height/V.height;return{x:j*(ie/(window.devicePixelRatio||1)),y:Y*(ae/(window.devicePixelRatio||1))}}function F(q){q.preventDefault(),q.stopPropagation(),w=!0,b=!0;var V=C(q);_=V.x,E=V.y,y.beginPath(),y.arc(V.x,V.y,y.lineWidth/2,0,Math.PI*2),y.fill(),console.log("Sig start:",V.x.toFixed(0),V.y.toFixed(0))}function I(q){if(w){q.preventDefault(),q.stopPropagation();var V=C(q);y.beginPath(),y.moveTo(_,E),y.lineTo(V.x,V.y),y.stroke(),_=V.x,E=V.y}}function z(q){q&&(q.preventDefault(),q.stopPropagation()),w=!1}function O(){var q=d.getBoundingClientRect();y.clearRect(0,0,q.width,q.height),b=!1,console.log("Signature cleared")}return d.addEventListener("mousedown",F),d.addEventListener("mousemove",I),d.addEventListener("mouseup",z),d.addEventListener("mouseleave",z),d.addEventListener("touchstart",F,{passive:!1}),d.addEventListener("touchmove",I,{passive:!1}),d.addEventListener("touchend",z,{passive:!1}),d.addEventListener("touchcancel",z,{passive:!1}),d.style.touchAction="none",S(),console.log("Signature pad created for:",d.id),{clear:O,isEmpty:function(){return!b},toDataURL:function(){return d.toDataURL("image/png")},resize:S}}var A=function(){if(this.form=n("#contractForm"),!this.form){console.log("Contract form not found");return}A.prototype.fetchHelpRequests=function(d){firebase.firestore().collection("help_requests").where("status","==","open").orderBy("timestamp","desc").get().then(function(y){var w=[];y.forEach(function(b){var _=b.data();_.id=b.id,w.push(_)}),d&&d(w)}).catch(function(y){console.error("Error fetching help requests:",y),d&&d([])})},A.prototype.getIssueTypeLabel=function(d){var y={contract_not_showing:"Contract Not Showing",problems_submitting:"Problems Submitting",signature_issues:"Signature Issues",account_access:"Account Access",other:"Other Issues"};return y[d]||d},A.prototype.resolveHelpRequest=function(d){var y=this;confirm(t("dash.help.confirmResolve"))&&firebase.firestore().collection("help_requests").doc(d).update({status:"resolved",resolved:!0,resolvedTimestamp:firebase.firestore.FieldValue.serverTimestamp()}).then(function(){console.log("Help request marked as resolved"),y.showDeveloperDashboard()}).catch(function(w){console.error("Error resolving help request:",w),alert(t("dash.help.err.resolve")+w.message)})},A.prototype.resolveAllHelpRequests=function(d){var y=this;if(d.length!==0&&confirm(t("dash.help.confirmResolvePrefix")+d.length+t("dash.help.confirmResolveSuffix"))){var w=firebase.firestore().batch(),b=firebase.firestore.FieldValue.serverTimestamp();d.forEach(function(_){var E=firebase.firestore().collection("help_requests").doc(_.id);w.update(E,{status:"resolved",resolved:!0,resolvedTimestamp:b})}),w.commit().then(function(){console.log("All help requests marked as resolved"),y.showDeveloperDashboard()}).catch(function(_){console.error("Error resolving all help requests:",_),alert(t("dash.help.err.resolveAll")+_.message)})}},this.devSignaturePad=null,this.clientSignaturePad=null,this.isDeveloper=!1,this.currentContract=null,this.currentUserEmail=null,this.DEVELOPER_EMAIL=(window.VITE_DEVELOPER_EMAIL||"").trim().toLowerCase(),this.signaturePadsInitialized=!1,this.formSetup=!1,console.log("ContractFormHandler created"),this.init()},W=function(){if(this.helpModal=n("#helpModal"),this.helpForm=n("#helpRequestForm"),this.currentUser=null,!this.helpModal||!this.helpForm){console.log("Help modal elements not found");return}this.init()};W.prototype.init=function(){var d=this;typeof firebase<"u"&&firebase.auth&&firebase.auth().onAuthStateChanged(function(E){if(d.currentUser=E,E){var S=n("#helpContact");S&&d.helpModal.classList.contains("show")&&(S.value=E.email||h(E.phoneNumber)||"")}});var y=n("#requestHelpBtn");y&&y.addEventListener("click",function(E){E.preventDefault(),d.showHelpModal()});var w=n("#closeHelpBtn");w&&w.addEventListener("click",function(){d.closeHelpModal()});var b=n("#cancelHelpBtn");b&&b.addEventListener("click",function(){d.closeHelpModal()});var _=n(".modal-overlay",this.helpModal);_&&_.addEventListener("click",function(){d.closeHelpModal()}),this.helpForm&&this.helpForm.addEventListener("submit",function(E){E.preventDefault(),d.submitHelpRequest()})},W.prototype.showHelpModal=function(){if(this.helpModal){this.helpModal.classList.add("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open");var d=n("#helpSuccessMessage");d&&d.classList.remove("show");var y=n(".help-form");y&&(y.style.display="block"),this.helpForm&&this.helpForm.reset();var w=n("#helpContact"),b=n("#helpContactLabel"),_=n("#helpContactHint"),E=n("#contactTabs");if(w&&this.currentUser){E&&(E.style.display="none");var S=this.currentUser.email,C=this.currentUser.phoneNumber;S?(w.value=this.currentUser.email,w.type="email",w.placeholder="your@email.com",b&&(b.textContent=t("help.label.email")),_&&(_.textContent=t("help.label.contactHint"))):C&&(w.value=h(this.currentUser.phoneNumber),w.type="tel",w.placeholder="(555) 123-4567",b&&(b.textContent=t("help.label.phone")),_&&(_.textContent=t("help.label.contactHint"))),w.setAttribute("readonly","readonly"),w.style.opacity="0.7"}else if(w){E&&(E.style.display="flex",this.setupContactTabs(w,b,_,E)),w.removeAttribute("readonly"),w.style.opacity="1",w.type="email",w.value="",w.placeholder="your@email.com",b&&(b.textContent=t("help.label.email"));var F=e(".contact-tab",E);F.forEach(function(I){I.classList.toggle("active",I.dataset.type==="email")})}}},W.prototype.setupContactTabs=function(d,y,w,b){var _=this,E=e(".contact-tab",b);E.forEach(function(S){var C=S.cloneNode(!0);S.parentNode.replaceChild(C,S)}),E=e(".contact-tab",b),E.forEach(function(S){S.addEventListener("click",function(){var C=this.dataset.type;E.forEach(function(F){F.classList.remove("active")}),this.classList.add("active"),d.value="",C==="email"?(d.type="email",d.placeholder="your@email.com",y&&(y.textContent=t("help.label.email")),w&&(w.textContent=t("help.label.contactHint")),_.removePhoneFormatting(d)):(d.type="tel",d.placeholder="(555) 123-4567",y&&(y.textContent=t("help.label.phone")),w&&(w.textContent=t("help.label.contactHint")),v(d)),d.focus()})})},W.prototype.removePhoneFormatting=function(d){var y=d.cloneNode(!0);d.parentNode.replaceChild(y,d)},W.prototype.closeHelpModal=function(){this.helpModal&&(this.helpModal.classList.remove("show"),document.body.style.overflow="",document.body.classList.remove("modal-open"))},W.prototype.submitHelpRequest=function(){var d=this,y=this.helpForm.querySelector('button[type="submit"]'),w=n("#helpSubmitText"),b=w?w.textContent:t("help.submitBtn");y&&(y.disabled=!0),w&&(w.textContent=t("help.btn.sending"));var _=n("#helpContact").value.trim(),E=n("#helpIssue").value,S=n("#helpDetails").value.trim();if(!_||!E||!S){alert(t("help.val.fillRequired")),y&&(y.disabled=!1),w&&(w.textContent=b);return}var C=this.currentUser&&this.currentUser.phoneNumber&&!this.currentUser.email,F=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,I=/^\+?[1-9]\d{6,14}$/;if(!C&&!F.test(_)){alert(t("help.val.validEmail")),y&&(y.disabled=!1),w&&(w.textContent=b);return}if(C&&!I.test(_.replace(/[\s\-\(\)]/g,""))){alert(t("help.val.validPhone")),y&&(y.disabled=!1),w&&(w.textContent=b);return}var z={userContact:C?g(_):_,contactType:C?"phone":"email",userEmail:C?"":_,userPhone:C?g(_):"",issueType:E,issueDetails:S,timestamp:firebase.firestore.FieldValue.serverTimestamp(),status:"open",resolved:!1,isAuthenticated:!!this.currentUser};this.currentUser&&(z.userId=this.currentUser.uid),console.log("Submitting help request:",z),firebase.firestore().collection("help_requests").add(z).then(function(O){console.log("Help request submitted with ID:",O.id),d.showSuccessMessage(),setTimeout(function(){d.closeHelpModal()},3e3)}).catch(function(O){console.error("Error submitting help request:",O),alert(t("help.err.submitPrefix")+O.message+t("help.err.submitSuffix")),y&&(y.disabled=!1),w&&(w.textContent=b)})},W.prototype.showSuccessMessage=function(){var d=e(".form-group");d.forEach(function(b){b.style.display="none"});var y=n(".help-form-footer");y&&(y.style.display="none");var w=n("#helpSuccessMessage");w&&(w.classList.add("show"),w.scrollIntoView({behavior:"smooth",block:"center"}))},A.prototype.init=function(){var d=this;console.log("Initializing contract form handler"),window.addEventListener("contractModalOpened",function(){console.log("Contract modal opened");var y=firebase.auth().currentUser;y&&(d.currentUserEmail=y.email?y.email.trim().toLowerCase():"",d.isDeveloper=d.currentUserEmail&&d.currentUserEmail===d.DEVELOPER_EMAIL,d.isDeveloper?d.setupDeveloperView():d.setupClientView()),setTimeout(function(){d.initializeSignaturePads()},100),d.initEntityTypeToggle()}),typeof firebase<"u"&&firebase.auth&&firebase.auth().onAuthStateChanged(function(y){y?(d.currentUserEmail=y.email?y.email.trim().toLowerCase():"",d.isDeveloper=d.currentUserEmail&&d.currentUserEmail===d.DEVELOPER_EMAIL,console.log("isDeveloper:",d.isDeveloper),d.setupForm()):(d.currentUserEmail=null,d.isDeveloper=!1)})},A.prototype.initializeSignaturePads=function(){var d=this;console.log("Initializing signature pads, isDeveloper:",this.isDeveloper);var y=document.getElementById("devSignaturePad"),w=document.getElementById("clientSignaturePad");this.isDeveloper?y&&(this.devSignaturePad=H(y),console.log("Dev signature pad created")):w&&(this.clientSignaturePad=H(w),console.log("Client signature pad created")),this.signaturePadsInitialized||(e(".clear-btn").forEach(function(b){b.addEventListener("click",function(_){_.preventDefault(),_.stopPropagation();var E=this.getAttribute("data-canvas");console.log("Clear clicked:",E),E==="devSignaturePad"&&d.devSignaturePad?d.devSignaturePad.clear():E==="clientSignaturePad"&&d.clientSignaturePad&&d.clientSignaturePad.clear()})}),this.signaturePadsInitialized=!0),console.log("Signature pads initialized")},A.prototype.initEntityTypeToggle=function(){console.log("Contract form initialized - client info will be populated from SOW")},A.prototype.populateClientInfoFromSOW=function(d){if(!d){console.log("No SOW data provided");return}console.log("Populating client info from SOW:",d.clientName);var y=n("#sowRequiredNotice"),w=n("#clientInfoPopulated"),b=n("#businessEntityInfo");y&&(y.style.display="none"),w&&(w.style.display="block");var _=n("#contractClientName"),E=n("#contractEntityType"),S=n("#contractStateOfFormation"),C=n("#contractRepName"),F=n("#contractRepTitle"),I=n("#contractClientContact");_&&(_.textContent=d.isBusinessEntity?d.businessName:d.clientName),d.isBusinessEntity&&b?(b.style.display="block",E&&(E.textContent=d.entityType||""),S&&(S.textContent=d.stateOfFormation||""),C&&(C.textContent=d.representativeName||""),F&&(F.textContent=d.representativeTitle||"")):b&&(b.style.display="none"),I&&(I.textContent=d.clientEmail||d.clientPhone||"");var z=n("#clientName"),O=n("#isBusinessEntity"),q=n("#businessName"),V=n("#entityType"),X=n("#stateOfFormation"),G=n("#repName"),j=n("#repTitle");z&&(z.value=d.isBusinessEntity?d.businessName:d.clientName),O&&(O.value=d.isBusinessEntity?"true":"false"),q&&(q.value=d.businessName||""),V&&(V.value=d.entityType||""),X&&(X.value=d.stateOfFormation||""),G&&(G.value=d.representativeName||""),j&&(j.value=d.representativeTitle||"")},A.prototype.setupForm=function(){var d=this;if(this.formSetup){console.log("Form already setup, updating view only"),this.isDeveloper?this.setupDeveloperView():this.setupClientView();return}this.isDeveloper?this.setupDeveloperView():this.setupClientView();var y=new Date().toISOString().split("T")[0],w=n("#devDate"),b=n("#clientDate");w&&(w.value=y),b&&(b.value=y);var _=n("#clientName"),E=n("#clientNameDisplay");_&&E&&_.addEventListener("input",function(){E.textContent=this.value||"Client Name"}),this.form.addEventListener("submit",function(F){return F.preventDefault(),F.stopPropagation(),console.log("Form submit prevented"),!1});var S=n("#submitBtn");S&&S.addEventListener("click",function(F){F.preventDefault(),F.stopPropagation(),console.log("Submit button clicked, isDeveloper:",d.isDeveloper),d.isDeveloper?d.handleDeveloperSubmit():d.handleClientSubmit()});var C=n("#downloadBtn");C&&C.addEventListener("click",function(F){F.preventDefault(),d.generatePDF()}),this.formSetup=!0},A.prototype.setupDeveloperView=function(){console.log("Setting up developer view");var d=n("#contractForm");d&&(d.style.display="none"),this.showDeveloperDashboard();var y=n("#devSignatureBlock");y&&(y.style.display="none");var w=n("#clientSignatureBlock");w&&(w.style.display="none");var b=n("#devPendingBlock");b&&(b.style.display="none");var _=n("#clientName");_&&(_.disabled=!0,_.removeAttribute("required"),_.setAttribute("readonly","readonly"));var E=n("#clientSignerName");E&&(E.disabled=!0,E.removeAttribute("required"));var S=n("#clientDate");S&&(S.disabled=!0,S.removeAttribute("required"));var C=n("#acknowledgment");C&&(C.disabled=!0,C.removeAttribute("required"),C.checked=!0);var F=n(".acknowledgment");F&&(F.style.display="none");var I=n("#submitBtn");I&&(I.style.display="none");var z=n("#downloadBtn");z&&(z.style.display="none")},A.prototype.showDeveloperDashboard=function(){console.log("Loading developer dashboard...");var d=n("#contractForm");d&&(d.style.display="none");var y=n(".modal-header");y&&(y.style.display="none");var w=n(".modal-close");w&&(w.style.display="none");var b=n("#developerDashboard");if(!b){b=document.createElement("div"),b.id="developerDashboard",b.className="developer-dashboard";var _=n(".modal-content");_&&_.insertBefore(b,_.firstChild)}b.innerHTML='<div class="dashboard-loading"><p>Loading contracts...</p></div>',b.style.display="block",this.fetchAllContracts()},A.prototype.renderHelpRequestsSection=function(d){var y=this,w=n("#helpTabContent"),b=n("#helpCountBadge");if(w){b&&(b.textContent=d.length);var _='<div class="help-tab-header"><h3> '+t("helpDash.title")+'</h3><div style="display: flex; align-items: center; gap: 10px;">';if(d.length>0&&(_+='<button class="btn-resolve-all" style="padding: 6px 12px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: 600;"> '+t("helpDash.btn.resolveAll")+"</button>"),_+="</div></div>",d.length>0){var E={};d.forEach(function(F){var I=F.issueType||"other";E[I]=(E[I]||0)+1});var S={contract_not_showing:"#6366f1",problems_submitting:"#f59e0b",signature_issues:"#ef4444",account_access:"#10b981",other:"#8b5cf6"};_+='<div class="help-chips">',Object.keys(E).forEach(function(F){var I=S[F]||"#6b7280";_+='<span class="help-chip" style="border-color: '+I+"40; color: "+I+';">'+y.getIssueTypeLabel(F)+'<span class="chip-count">'+E[F]+"</span></span>"}),_+="</div>"}if(d.length===0)_+='<div class="empty-state"><img src="/images/scarlo-logo.png" alt="Scarlo" class="empty-icon"><p>'+t("helpDash.empty")+"</p></div>";else{var S={contract_not_showing:"#6366f1",problems_submitting:"#f59e0b",signature_issues:"#ef4444",account_access:"#10b981",other:"#8b5cf6"};_+='<div class="help-list">',d.forEach(function(I){var z=I.timestamp?I.timestamp.toDate?I.timestamp.toDate().toLocaleDateString():new Date(I.timestamp).toLocaleDateString():"N/A",O=I.isAuthenticated?'<span class="auth-badge verified"> '+t("helpDash.badge.verified")+"</span>":'<span class="auth-badge anonymous"> '+t("helpDash.badge.anonymous")+"</span>",q=S[I.issueType]||"#f59e0b";_+='<div class="help-item" data-request-id="'+I.id+'" style="border-left-color: '+q+';"><div class="help-icon"></div><div class="help-details"><div class="help-header"><h4>'+(I.userEmail||I.userPhone||t("helpDash.fallback.user"))+"</h4>"+O+'<span class="help-badge">'+y.getIssueTypeLabel(I.issueType)+'</span></div><p class="help-message">'+(I.issueDetails||t("helpDash.fallback.message"))+'</p><div class="help-meta"><span class="meta-item"> '+z+'</span></div></div><div class="help-actions"><button class="btn-resolve-help" data-request-id="'+I.id+'" title="Mark as resolved"> '+t("helpDash.btn.resolve")+"</button></div></div>"}),_+="</div>"}_+="</div>",w.innerHTML=_,e(".btn-resolve-help").forEach(function(F){F.addEventListener("click",function(I){I.preventDefault();var z=this.getAttribute("data-request-id");y.resolveHelpRequest(z)})});var C=n(".btn-resolve-all");C&&C.addEventListener("click",function(F){F.preventDefault(),y.resolveAllHelpRequests(d)})}},A.prototype.fetchAllContracts=function(){var d=this,y=firebase.firestore().collection("contracts").where("status","==","pending_developer").get(),w=firebase.firestore().collection("contracts").where("status","==","completed").get(),b=new Promise(function(S){d.fetchHelpRequests(function(C){S(C)})}),_=firebase.firestore().collection("sow_documents").orderBy("createdAt","desc").get(),E=firebase.firestore().collection("coupons").orderBy("createdAt","desc").get();Promise.all([y,w,b,_,E]).then(function(S){var C=S[0],F=S[1],I=S[2],z=S[3],O=S[4],q=[];C.forEach(function(ae){var le=ae.data();le.id=ae.id,le.daysSinceSubmission=d.calculateDaysSince(le.timestamp),q.push(le)}),q.sort(function(ae,le){return le.daysSinceSubmission-ae.daysSinceSubmission});var V=[];F.forEach(function(ae){var le=ae.data();le.id=ae.id,le.daysSinceSubmission=d.calculateDaysSince(le.timestamp),V.push(le)}),V.sort(function(ae,le){var pe=ae.finalizedTimestamp?ae.finalizedTimestamp.toDate().getTime():0,_e=le.finalizedTimestamp?le.finalizedTimestamp.toDate().getTime():0;return _e-pe});var X=[],G=[];z.forEach(function(ae){var le=ae.data();le.id=ae.id,X.push(le),le.changeRequestId&&G.push(le.changeRequestId)});var j=[];O.forEach(function(ae){var le=ae.data();le.id=ae.id,j.push(le)}),d.coupons=j,d.renderDeveloperDashboard(q,V,X,j,I),d.renderHelpRequestsSection(I);var Y=document.getElementById("couponsTabContent");if(Y){var ie=document.getElementById("couponCountBadge");ie&&(ie.textContent=j.length),Y.innerHTML=d.renderCouponsTab(j),d.attachCouponEventListeners()}d.fetchClientLastLogins(X).then(function(){G.length>0?d.fetchChangeRequestsUnreadStatus(G,X):d.renderSOWTab(X)})}).catch(function(S){console.error("Error fetching contracts:",S);var C=n("#developerDashboard");C&&(C.innerHTML='<div class="dashboard-error"><p>Error loading contracts: '+S.message+"</p></div>")})},A.prototype.calculateDaysSince=function(d){if(!d)return 0;var y;d.toDate?y=d.toDate():d instanceof Date?y=d:y=new Date(d);var w=new Date,b=Math.abs(w-y),_=Math.floor(b/(1e3*60*60*24));return _},A.prototype.getUrgencyLevel=function(d){return d>=7?{level:"critical",label:"URGENT",color:"#ef4444",icon:""}:d>=3?{level:"high",label:"ACTION NEEDED",color:"#f59e0b",icon:""}:d>=1?{level:"medium",label:"NEW",color:"#3b82f6",icon:""}:{level:"low",label:"JUST IN",color:"#10b981",icon:""}},A.prototype.formatCurrency=function(d){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(d||0)},A.prototype.timeAgo=function(d){var y=Math.floor((new Date-d)/1e3);if(y<60)return"just now";var w=Math.floor(y/60);if(w<60)return w+"m ago";var b=Math.floor(w/60);if(b<24)return b+"h ago";var _=Math.floor(b/24);if(_<7)return _+"d ago";var E=Math.floor(_/7);return E<4?E+"w ago":d.toLocaleDateString("en-US",{month:"short",day:"numeric"})},A.prototype.computeDashboardMetrics=function(d,y,w,b,_){var E=this,S=new Date,C=S.getMonth(),F=S.getFullYear(),I=0,z=0,O={},q=0;w.forEach(function(oe){oe.payment&&oe.payment.total&&(I+=oe.payment.total);var be=E.calculatePaymentStatus(oe);z+=be.paidAmount;var Ie=oe.packageType||"unknown";O[Ie]=(O[Ie]||0)+1,oe.status!=="approved"&&q++});var V=d.length+y.length,X=V>0?Math.round(y.length/V*100):0,G=0;if(y.length>0){var j=0;y.forEach(function(oe){j+=oe.daysSinceSubmission||0}),G=Math.round(j/y.length)}var Y=d.filter(function(oe){return oe.daysSinceSubmission>=7}).length,ie=y.filter(function(oe){if(!oe.finalizedTimestamp)return!1;var be=oe.finalizedTimestamp.toDate?oe.finalizedTimestamp.toDate():new Date(oe.finalizedTimestamp);return be.getMonth()===C&&be.getFullYear()===F}).length,ae=b.filter(function(oe){return oe.active!==!1}).length,le=0;b.forEach(function(oe){le+=oe.usageCount||0});var pe={};_.forEach(function(oe){var be=oe.issueType||"other";pe[be]=(pe[be]||0)+1});var _e=[];return y.forEach(function(oe){if(oe.finalizedTimestamp){var be=oe.finalizedTimestamp.toDate?oe.finalizedTimestamp.toDate():new Date(oe.finalizedTimestamp);_e.push({type:"contract_signed",label:"Contract signed  "+(oe.clientName||"Unknown"),date:be,color:"#10b981"})}}),d.forEach(function(oe){if(oe.timestamp){var be=oe.timestamp.toDate?oe.timestamp.toDate():new Date(oe.timestamp);_e.push({type:"contract_received",label:"Contract received  "+(oe.clientName||"Unknown"),date:be,color:"#6366f1"})}}),w.forEach(function(oe){if(oe.createdAt){var be=oe.createdAt.toDate?oe.createdAt.toDate():new Date(oe.createdAt);_e.push({type:"sow_created",label:"SOW created  "+(oe.clientName||"Unknown"),date:be,color:"#f59e0b"})}}),_.forEach(function(oe){if(oe.timestamp){var be=oe.timestamp.toDate?oe.timestamp.toDate():new Date(oe.timestamp);_e.push({type:"help_request",label:"Help request  "+(oe.userEmail||oe.userPhone||"Anonymous"),date:be,color:"#ef4444"})}}),_e.sort(function(oe,be){return be.date-oe.date}),_e=_e.slice(0,5),{totalRevenue:I,paidRevenue:z,completionRate:X,avgResponseDays:G,activeProjects:q,totalContracts:V,urgentCount:Y,thisMonthCompleted:ie,activeCoupons:ae,totalCouponUsage:le,helpByType:pe,sowsByPackage:O,events:_e,pending:d.length,completed:y.length,sowCount:w.length,helpCount:_.length,couponCount:b.length}},A.prototype.renderDeveloperDashboard=function(d,y,w,b,_){var E=this,S=n("#developerDashboard");if(S){w=w||[],b=b||[],_=_||[];var C=E.computeDashboardMetrics(d,y,w,b,_),F=C.urgentCount,I="";I+=`<button class="dashboard-close" onclick="document.querySelector('.contract-modal').classList.remove('show'); document.body.classList.remove('modal-open'); document.body.style.overflow = '';"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>`;for(var z="",O=0;O<20;O++){var q=O<10?"0"+O:""+O;z+='<img id="dashLogo'+O+'"'+(O===0?' class="visible"':"")+' src="/images/morph-logo'+q+'.png" alt=""'+(O>0?' loading="lazy"':' alt="Scarlo Logo"')+">"}I+='<div class="dashboard-header"><div class="header-content"><div class="dash-logo-animated"><div class="dash-logo-ambient"></div><div class="dash-logo-stack">'+z+'</div></div></div><div class="header-date"><span class="current-date">'+new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})+"</span></div></div>",F>0?I+='<div class="alert-banner urgent"><div class="alert-icon"></div><div class="alert-content"><strong>'+F+(F!==1?t("dash.alert.contractPlural"):t("dash.alert.contractSingular"))+(F===1?t("dash.alert.needSingular"):t("dash.alert.needPlural"))+" immediate attention!</strong><p>"+(F!==1?t("dash.alert.clientPlural"):t("dash.alert.clientSingular"))+(F!==1?t("dash.alert.havePlural"):t("dash.alert.hasSingular"))+t("dash.alert.waiting7days")+"</p></div></div>":d.length===0&&y.length>0&&(I+='<div class="alert-banner success"><div class="alert-icon"></div><div class="alert-content"><strong>'+t("dash.alert.allCaughtUp")+"</strong><p>"+t("dash.alert.noPending")+"</p></div></div>"),I+='<div class="analytics-grid">',I+='<div class="analytics-card revenue-card"><div class="analytics-card-row"><span class="analytics-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></span><div class="analytics-value">'+E.formatCurrency(C.totalRevenue)+'</div><span class="analytics-trend">'+E.formatCurrency(C.paidRevenue)+" "+t("sowTab.stats.collected").toLowerCase()+'</span></div><div class="analytics-bottom"><span class="analytics-label">'+t("dash.analytics.totalRevenue")+'</span><div class="analytics-bar-track"><div class="analytics-bar-fill revenue-fill" style="width: '+(C.totalRevenue>0?Math.round(C.paidRevenue/C.totalRevenue*100):0)+'%;"></div></div></div></div>';var V=(2*Math.PI*20).toFixed(1),X=((1-C.completionRate/100)*2*Math.PI*20).toFixed(1);I+='<div class="analytics-card completion-card"><div class="analytics-card-row"><svg class="progress-ring" width="40" height="40" viewBox="0 0 44 44"><circle cx="22" cy="22" r="20" fill="none" stroke="rgba(255,255,255,0.06)" stroke-width="3"/><circle class="progress-ring-fill" cx="22" cy="22" r="20" fill="none" stroke="#10b981" stroke-width="3" stroke-dasharray="'+V+'" stroke-dashoffset="'+X+'" stroke-linecap="round" transform="rotate(-90 22 22)"/></svg><div class="analytics-value">'+C.completionRate+'<span class="analytics-unit">%</span></div><span class="analytics-trend">'+C.completed+" "+t("dash.analytics.of")+C.totalContracts+'</span></div><div class="analytics-bottom"><span class="analytics-label">'+t("dash.analytics.completionRate")+"</span></div></div>",I+='<div class="analytics-card response-card"><div class="analytics-card-row"><span class="analytics-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg></span><div class="analytics-value">'+C.avgResponseDays+'<span class="analytics-unit">'+t("dash.analytics.days")+'</span></div><span class="analytics-trend'+(C.urgentCount>0?" trend-warning":"")+'">'+(C.urgentCount>0?C.urgentCount+" "+t("dash.analytics.urgent"):t("dash.analytics.onTrack"))+'</span></div><div class="analytics-bottom"><span class="analytics-label">'+t("dash.analytics.avgResponse")+'</span><div class="analytics-bar-track"><div class="analytics-bar-fill response-fill" style="width: '+Math.min(100,Math.round(C.avgResponseDays/14*100))+'%;"></div></div></div></div>',I+='<div class="analytics-card projects-card"><div class="analytics-card-row"><span class="analytics-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg></span><div class="analytics-value">'+C.activeProjects+'</div><span class="analytics-trend">+'+C.thisMonthCompleted+" "+t("dash.analytics.thisMonth")+'</span></div><div class="analytics-bottom"><span class="analytics-label">'+t("dash.analytics.activeProjects")+'</span><div class="analytics-bar-track"><div class="analytics-bar-fill projects-fill" style="width: '+(C.sowCount>0?Math.round(C.activeProjects/C.sowCount*100):0)+'%;"></div></div></div></div>',I+="</div>",C.events.length>0&&(I+='<div class="activity-feed"><div class="activity-feed-header"><h3>'+t("dash.analytics.recentActivity")+'</h3></div><div class="activity-feed-list">',C.events.forEach(function(G,j){I+='<div class="activity-item" style="animation-delay: '+j*.06+'s;"><div class="activity-dot" style="background: '+G.color+"; box-shadow: 0 0 8px "+G.color+'40;"></div><div class="activity-info"><span class="activity-text">'+G.label+'</span><span class="activity-time">'+E.timeAgo(G.date)+"</span></div></div>"}),I+="</div></div>"),I+='<div class="dashboard-tabs"><div class="tab-buttons"><button class="tab-btn active" data-tab="contracts"><span class="tab-icon"></span><span class="tab-label">'+t("dash.tab.contracts")+'</span><span class="tab-badge">'+(d.length+y.length)+'</span></button><button class="tab-btn" data-tab="sow"><span class="tab-icon"></span><span class="tab-label">'+t("dash.tab.sowDocuments")+'</span><span class="tab-badge" id="sowCountBadge">0</span></button><button class="tab-btn" data-tab="coupons"><span class="tab-icon"></span><span class="tab-label">'+t("dash.tab.coupons")+'</span><span class="tab-badge" id="couponCountBadge">0</span></button><button class="tab-btn" data-tab="help"><span class="tab-icon"></span><span class="tab-label">'+t("dash.tab.helpRequests")+'</span><span class="tab-badge" id="helpCountBadge">0</span></button></div><div class="tab-content"><div class="tab-pane active" data-tab="contracts">'+E.renderContractsTab(d,y)+'</div><div class="tab-pane" data-tab="sow"><div id="sowTabContent"><div class="loading-state"><div class="spinner"></div><p>'+t("dash.loading.sow")+'</p></div></div></div><div class="tab-pane" data-tab="coupons"><div id="couponsTabContent"><div class="loading-state"><div class="spinner"></div><p>'+t("dash.loading.coupons")+'</p></div></div></div><div class="tab-pane" data-tab="help"><div id="helpTabContent"><div class="loading-state"><div class="spinner"></div><p>'+t("dash.loading.help")+"</p></div></div></div></div></div>",I+=`<div class="dashboard-footer"><button class="btn-close-dashboard" onclick="document.querySelector('.contract-modal').classList.remove('show'); document.body.classList.remove('modal-open');">`+t("dash.btn.closeDashboard")+"</button></div>",S.innerHTML=I,(function(){for(var G=20,j=120,Y=[],ie=0;ie<G;ie++){var ae=document.getElementById("dashLogo"+ie);ae&&Y.push(ae)}if(Y.length===0)return;var le=0,pe=1,_e=performance.now(),oe=null;function be(We){We-_e>=j&&(Y[le].classList.remove("visible"),le+=pe,le>=Y.length-1?(le=Y.length-1,pe=-1):le<=0&&(le=0,pe=1),Y[le].classList.add("visible"),_e=We),oe=requestAnimationFrame(be)}oe=requestAnimationFrame(be);var Ie=new MutationObserver(function(){document.getElementById("dashLogo0")||(cancelAnimationFrame(oe),Ie.disconnect())});Ie.observe(document.body,{childList:!0,subtree:!0})})(),e(".btn-sign-contract").forEach(function(G){G.addEventListener("click",function(j){j.preventDefault();var Y=this.getAttribute("data-contract-id");E.selectContractToSign(Y,d)})}),e(".btn-download").forEach(function(G){G.addEventListener("click",function(j){j.preventDefault();var Y=this.getAttribute("data-contract-id");E.viewCompletedContract(Y,y)})}),e(".tab-btn").forEach(function(G){G.addEventListener("click",function(){var j=this.getAttribute("data-tab");E.switchTab(j)})})}},A.prototype.renderContractsTab=function(d,y){var w=this,b="",_=y.length,E=d.length,S=_+E;return b+='<div class="pipeline-strip"><div class="pipeline-stage"><span class="pipeline-count">'+E+'</span><span class="pipeline-label">'+t("contracts.stage.pending")+'</span></div><div class="pipeline-arrow"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg></div><div class="pipeline-stage"><span class="pipeline-count">'+_+'</span><span class="pipeline-label">'+t("contracts.stage.completed")+'</span></div><div class="pipeline-bar-track"><div class="pipeline-bar-fill" style="width: '+(S>0?Math.round(_/S*100):0)+'%;"></div></div></div>',b+='<div class="dashboard-section action-section"><div class="section-header"><h3>'+t("contracts.section.actionRequired")+'</h3><span class="section-badge">'+d.length+t("contracts.badge.pending")+"</span></div>",d.length===0?b+='<div class="empty-state success-state"><img src="/images/scarlo-logo.png" alt="Scarlo" class="empty-icon"><p>'+t("contracts.empty.noPending")+"</p></div>":(b+='<div class="action-list">',d.forEach(function(C){var F=w.getUrgencyLevel(C.daysSinceSubmission),I=C.timestamp?C.timestamp.toDate?C.timestamp.toDate().toLocaleDateString():new Date(C.timestamp).toLocaleDateString():"N/A";b+='<div class="action-item" data-contract-id="'+C.id+'"><div class="client-avatar" style="border-color: '+F.color+';"><span>'+(C.clientName||"U").charAt(0).toUpperCase()+'</span></div><div class="action-priority-bar" style="background: '+F.color+';"></div><div class="action-details"><div class="action-client"><h4>'+(C.clientName||"Unknown Client")+'</h4><span class="urgency-tag" style="background: '+F.color+"22; color: "+F.color+';">'+F.icon+" "+F.label+'</span></div><div class="action-meta-grid"><div class="meta-cell"><span class="meta-key">'+t("contracts.meta.email")+'</span><span class="meta-val">'+(C.clientEmail||"N/A")+'</span></div><div class="meta-cell"><span class="meta-key">'+t("contracts.meta.received")+'</span><span class="meta-val">'+I+'</span></div><div class="meta-cell"><span class="meta-key">'+t("contracts.meta.waiting")+'</span><span class="meta-val '+(C.daysSinceSubmission>=7?"meta-urgent":"")+'">'+C.daysSinceSubmission+" "+(C.daysSinceSubmission!==1?t("contracts.meta.dayPlural"):t("contracts.meta.daySingular"))+'</span></div><div class="meta-cell"><span class="meta-key">'+t("contracts.meta.phone")+'</span><span class="meta-val">'+(C.clientPhone?h(C.clientPhone):"N/A")+'</span></div></div></div><div class="action-cta"><button class="btn-sign-contract" data-contract-id="'+C.id+'"><span class="btn-icon"></span><span class="btn-text">'+t("contracts.btn.sign")+"</span></button></div></div>"}),b+="</div>"),b+="</div>",b+='<div class="dashboard-section history-section"><div class="section-header"><h3>'+t("contracts.section.completed")+'</h3><span class="section-badge success">'+y.length+t("contracts.badge.total")+"</span></div>",y.length===0?b+='<div class="empty-state"><img src="/images/scarlo-logo.png" alt="Scarlo" class="empty-icon"><p>'+t("contracts.empty.noCompleted")+"</p></div>":(b+='<div class="history-table">',y.forEach(function(C){var F=C.finalizedTimestamp?C.finalizedTimestamp.toDate?C.finalizedTimestamp.toDate().toLocaleDateString():new Date(C.finalizedTimestamp).toLocaleDateString():"N/A";b+='<div class="history-row" data-contract-id="'+C.id+'"><div class="history-status"><span class="status-check">&#10003;</span></div><div class="history-name">'+(C.clientName||"Unknown Client")+'</div><div class="history-date">'+F+'</div><div class="history-action"><button class="btn-download" data-contract-id="'+C.id+'" title="Download PDF"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg> '+t("contracts.btn.pdf")+"</button></div></div>"}),b+="</div>"),b+="</div>",b},A.prototype.switchTab=function(d){e(".tab-btn").forEach(function(y){y.classList.remove("active"),y.getAttribute("data-tab")===d&&y.classList.add("active")}),e(".tab-pane").forEach(function(y){y.classList.remove("active"),y.getAttribute("data-tab")===d&&y.classList.add("active")})},A.prototype.loadCoupons=function(){var d=this,y=document.getElementById("couponsTabContent");y&&firebase.firestore().collection("coupons").orderBy("createdAt","desc").get().then(function(w){var b=[];w.forEach(function(E){var S=E.data();S.id=E.id,b.push(S)});var _=document.getElementById("couponCountBadge");_&&(_.textContent=b.length),d.coupons=b,y.innerHTML=d.renderCouponsTab(b),d.attachCouponEventListeners()}).catch(function(w){console.error("Error loading coupons:",w),y.innerHTML='<div class="error-state"><p>Error loading coupons: '+w.message+"</p></div>"})},A.prototype.createWelcomeCoupon=function(){var d={code:"WELCOME10",description:"Welcome discount for new clients - 10% off your first project",discountType:"percentage",discountValue:10,minPurchase:0,usageLimit:0,usageCount:0,expirationDate:null,tierRestrictions:[],oneTimeUse:!1,active:!0,createdAt:firebase.firestore.FieldValue.serverTimestamp()};return firebase.firestore().collection("coupons").add(d).then(function(y){console.log("WELCOME10 coupon created with ID:",y.id)}).catch(function(y){console.error("Error creating WELCOME10 coupon:",y)})},A.prototype.renderCouponsTab=function(d){var y=this,w="";if(w+='<div class="coupons-header"><div class="coupons-title"></div><button class="btn-create-coupon" id="btnCreateCoupon"><span class="btn-icon">+</span><span class="btn-text">'+t("couponTab.btn.create")+"</span></button></div>",w+='<div id="couponCreatorForm" class="coupon-creator-form" style="display: none;"><div class="coupon-form-header"><h4 id="couponFormTitle">'+t("couponTab.form.title")+'</h4><button class="btn-close-form" id="btnCloseCouponForm"></button></div><div class="coupon-form-body"><div class="form-row"><div class="form-group"><label>'+t("couponTab.form.codeLabel")+'</label><input type="text" id="couponCode" placeholder="'+t("couponTab.form.codePlaceholder")+'" class="coupon-input" style="text-transform: uppercase;"><small>'+t("couponTab.form.codeHelper")+'</small></div><div class="form-group"><label>'+t("couponTab.form.typeLabel")+'</label><select id="couponType" class="coupon-select"><option value="percentage">'+t("couponTab.form.typePercent")+'</option><option value="fixed">'+t("couponTab.form.typeFixed")+'</option></select></div></div><div class="form-row"><div class="form-group"><label>'+t("couponTab.form.valueLabel")+'</label><input type="number" id="couponValue" placeholder="'+t("couponTab.form.valuePlaceholder")+'" class="coupon-input" min="0" step="0.01"><small id="couponValueHint">'+t("couponTab.form.valueHelper")+'</small></div><div class="form-group"><label>'+t("couponTab.form.usageLabel")+'</label><input type="number" id="couponUsageLimit" placeholder="'+t("couponTab.form.usagePlaceholder")+'" class="coupon-input" min="0"><small>'+t("couponTab.form.usageHelper")+'</small></div></div><div class="form-row"><div class="form-group"><label>'+t("couponTab.form.minPurchaseLabel")+'</label><input type="number" id="couponMinPurchase" placeholder="0" class="coupon-input" min="0" step="0.01"><small>'+t("couponTab.form.minPurchaseHelper")+'</small></div><div class="form-group"><label>'+t("couponTab.form.expirationLabel")+'</label><input type="date" id="couponExpiration" class="coupon-input"><small>'+t("couponTab.form.expirationHelper")+'</small></div></div><div class="form-row"><div class="form-group full-width"><label>'+t("couponTab.form.tierLabel")+'</label><div class="tier-checkboxes"><label class="tier-checkbox"><input type="checkbox" value="essential" checked> '+t("couponTab.form.tierEssential")+'</label><label class="tier-checkbox"><input type="checkbox" value="starter" checked> '+t("couponTab.form.tierStarter")+'</label><label class="tier-checkbox"><input type="checkbox" value="growth" checked> '+t("couponTab.form.tierGrowth")+'</label><label class="tier-checkbox"><input type="checkbox" value="professional" checked> '+t("couponTab.form.tierProfessional")+'</label><label class="tier-checkbox"><input type="checkbox" value="enterprise" checked> '+t("couponTab.form.tierEnterprise")+'</label><label class="tier-checkbox"><input type="checkbox" value="custom" checked> '+t("couponTab.form.tierCustom")+"</label></div><small>"+t("couponTab.form.tierHelper")+'</small></div></div><div class="form-row"><div class="form-group full-width"><label>'+t("couponTab.form.descLabel")+'</label><input type="text" id="couponDescription" placeholder="'+t("couponTab.form.descPlaceholder")+'" class="coupon-input"></div></div><div class="form-row"><div class="form-group"><label class="checkbox-label"><input type="checkbox" id="couponActive" checked><span>'+t("couponTab.form.activeLabel")+'</span></label></div></div><input type="hidden" id="couponEditId" value=""><div class="form-actions"><button class="btn-cancel" id="btnCancelCoupon">'+t("couponTab.form.cancelBtn")+'</button><button class="btn-save-coupon" id="btnSaveCoupon">'+t("couponTab.form.saveBtn")+"</button></div></div></div>",d.length===0)w+='<div class="empty-state"><div class="empty-icon"></div><h4>'+t("couponTab.empty.title")+"</h4><p>"+t("couponTab.empty.text")+"</p></div>";else{w+='<div class="coupons-list">';var b=d.filter(function(E){return E.active!==!1}),_=d.filter(function(E){return E.active===!1});b.length>0&&(w+='<div class="coupons-section"><h4 class="section-label">'+t("couponTab.section.active")+" ("+b.length+")</h4>",b.forEach(function(E){w+=y.renderCouponCard(E)}),w+="</div>"),_.length>0&&(w+='<div class="coupons-section inactive-section"><h4 class="section-label">'+t("couponTab.section.inactive")+" ("+_.length+")</h4>",_.forEach(function(E){w+=y.renderCouponCard(E)}),w+="</div>"),w+="</div>"}return w},A.prototype.renderCouponCard=function(d){var y=d.expirationDate&&new Date(d.expirationDate)<new Date,w=d.usageLimit&&d.usageCount>=d.usageLimit,b=!d.active||y||w?"coupon-inactive":"coupon-active",_=d.discountType==="percentage"?d.discountValue+"% OFF":"$"+parseFloat(d.discountValue||0).toFixed(0)+" OFF",E="";d.active?y?E='<span class="status-badge expired">Expired</span>':w?E='<span class="status-badge used-up">Limit Reached</span>':E='<span class="status-badge active">Active</span>':E='<span class="status-badge inactive">Disabled</span>';var S='<div class="coupon-card '+b+'" data-coupon-id="'+d.id+'"><div class="coupon-card-header"><div class="coupon-code-display"><span class="coupon-code">'+d.code+'</span><button class="btn-copy-code" data-code="'+d.code+'" title="Copy code"></button></div>'+E+'</div><div class="coupon-card-body"><div class="coupon-discount">'+_+'</div><div class="coupon-details">';if(d.description&&(S+='<div class="detail-row"><span class="detail-label">Description:</span> '+d.description+"</div>"),d.minPurchase&&d.minPurchase>0&&(S+='<div class="detail-row"><span class="detail-label">Min. Purchase:</span> $'+parseFloat(d.minPurchase).toFixed(0)+"</div>"),d.usageLimit?S+='<div class="detail-row"><span class="detail-label">Usage:</span> '+(d.usageCount||0)+" / "+d.usageLimit+"</div>":S+='<div class="detail-row"><span class="detail-label">Usage:</span> '+(d.usageCount||0)+" (unlimited)</div>",d.expirationDate){var C=new Date(d.expirationDate).toLocaleDateString();S+='<div class="detail-row"><span class="detail-label">Expires:</span> '+C+"</div>"}return d.allowedTiers&&d.allowedTiers.length<5&&(S+='<div class="detail-row"><span class="detail-label">Tiers:</span> '+d.allowedTiers.join(", ")+"</div>"),S+='</div></div><div class="coupon-card-footer"><button class="btn-edit-coupon" data-coupon-id="'+d.id+'">Edit</button><button class="btn-delete-coupon" data-coupon-id="'+d.id+'">Delete</button></div></div>',S},A.prototype.attachCouponEventListeners=function(){var d=this,y=document.getElementById("btnCreateCoupon");y&&y.addEventListener("click",function(){d.showCouponForm()});var w=document.getElementById("btnCloseCouponForm");w&&w.addEventListener("click",function(){d.hideCouponForm()});var b=document.getElementById("btnCancelCoupon");b&&b.addEventListener("click",function(){d.hideCouponForm()});var _=document.getElementById("btnSaveCoupon");_&&_.addEventListener("click",function(){d.saveCoupon()});var E=document.getElementById("couponType");E&&E.addEventListener("change",function(){var C=document.getElementById("couponValueHint");this.value==="percentage"?C.textContent=t("coupon.hint.percentage"):C.textContent=t("coupon.hint.dollar")});var S=document.getElementById("couponCode");S&&S.addEventListener("input",function(){this.value=this.value.toUpperCase().replace(/[^A-Z0-9]/g,"")}),e(".btn-edit-coupon").forEach(function(C){C.addEventListener("click",function(){var F=this.getAttribute("data-coupon-id");d.editCoupon(F)})}),e(".btn-delete-coupon").forEach(function(C){C.addEventListener("click",function(){var F=this.getAttribute("data-coupon-id");d.deleteCoupon(F)})}),e(".btn-copy-code").forEach(function(C){C.addEventListener("click",function(){var F=this.getAttribute("data-code");navigator.clipboard.writeText(F).then(function(){alert("Coupon code copied: "+F)})})})},A.prototype.showCouponForm=function(d){var y=document.getElementById("couponCreatorForm"),w=document.getElementById("couponFormTitle");y&&(document.getElementById("couponCode").value="",document.getElementById("couponType").value="percentage",document.getElementById("couponValue").value="",document.getElementById("couponUsageLimit").value="",document.getElementById("couponMinPurchase").value="",document.getElementById("couponExpiration").value="",document.getElementById("couponDescription").value="",document.getElementById("couponActive").checked=!0,document.getElementById("couponEditId").value="",e('.tier-checkboxes input[type="checkbox"]').forEach(function(b){b.checked=!0}),d?(w.textContent=t("coupon.title.edit"),document.getElementById("couponCode").value=d.code||"",document.getElementById("couponType").value=d.discountType||"percentage",document.getElementById("couponValue").value=d.discountValue||"",document.getElementById("couponUsageLimit").value=d.usageLimit||"",document.getElementById("couponMinPurchase").value=d.minPurchase||"",document.getElementById("couponExpiration").value=d.expirationDate||"",document.getElementById("couponDescription").value=d.description||"",document.getElementById("couponActive").checked=d.active!==!1,document.getElementById("couponEditId").value=d.id,d.allowedTiers&&e('.tier-checkboxes input[type="checkbox"]').forEach(function(b){b.checked=d.allowedTiers.indexOf(b.value)!==-1})):w.textContent=t("coupon.title.create"),y.style.display="block",document.getElementById("couponCode").focus())},A.prototype.hideCouponForm=function(){var d=document.getElementById("couponCreatorForm");d&&(d.style.display="none")},A.prototype.saveCoupon=function(){var d=this,y=document.getElementById("couponEditId").value,w=document.getElementById("couponCode").value.trim().toUpperCase(),b=document.getElementById("couponType").value,_=parseFloat(document.getElementById("couponValue").value),E=document.getElementById("couponUsageLimit").value?parseInt(document.getElementById("couponUsageLimit").value):null,S=parseFloat(document.getElementById("couponMinPurchase").value)||0,C=document.getElementById("couponExpiration").value||null,F=document.getElementById("couponDescription").value.trim(),I=document.getElementById("couponActive").checked,z=[];if(e('.tier-checkboxes input[type="checkbox"]:checked').forEach(function(V){z.push(V.value)}),!w){alert(t("coupon.val.enterCode"));return}if(isNaN(_)||_<=0){alert(t("coupon.val.validDiscount"));return}if(b==="percentage"&&_>100){alert(t("coupon.val.percentMax"));return}if(z.length===0){alert(t("coupon.val.selectTier"));return}var O={code:w,discountType:b,discountValue:_,usageLimit:E,minPurchase:S,expirationDate:C,description:F,active:I,allowedTiers:z,updatedAt:firebase.firestore.FieldValue.serverTimestamp()},q;y?q=firebase.firestore().collection("coupons").doc(y).update(O):(O.createdAt=firebase.firestore.FieldValue.serverTimestamp(),O.usageCount=0,q=firebase.firestore().collection("coupons").where("code","==",w).get().then(function(V){if(!V.empty)throw new Error("A coupon with this code already exists");return firebase.firestore().collection("coupons").add(O)})),q.then(function(){alert(t("coupon.msg.saveSuccess")),d.hideCouponForm(),d.loadCoupons()}).catch(function(V){console.error("Error saving coupon:",V),alert(t("coupon.err.save")+V.message)})},A.prototype.editCoupon=function(d){var y=this.coupons.find(function(w){return w.id===d});y&&this.showCouponForm(y)},A.prototype.deleteCoupon=function(d){var y=this,w=this.coupons.find(function(b){return b.id===d});w&&confirm(t("coupon.confirm.deletePrefix")+w.code+t("coupon.confirm.deleteSuffix"))&&firebase.firestore().collection("coupons").doc(d).delete().then(function(){alert(t("coupon.msg.deleteSuccess")),y.loadCoupons()}).catch(function(b){console.error("Error deleting coupon:",b),alert(t("coupon.err.delete")+b.message)})},A.prototype.validateCoupon=function(d,y,w){var b=this.coupons?this.coupons.find(function(E){return E.code===d.toUpperCase()&&E.active!==!1}):null;if(!b)return{valid:!1,error:t("coupon.val.invalidCode")};if(b.expirationDate&&new Date(b.expirationDate)<new Date)return{valid:!1,error:t("coupon.val.expired")};if(b.usageLimit&&b.usageCount>=b.usageLimit)return{valid:!1,error:t("coupon.val.usageLimit")};if(b.minPurchase&&w<b.minPurchase)return{valid:!1,error:t("coupon.val.minPurchasePrefix")+b.minPurchase.toFixed(0)+t("coupon.val.minPurchaseSuffix")};if(b.allowedTiers&&b.allowedTiers.length>0&&y&&b.allowedTiers.indexOf(y)===-1)return{valid:!1,error:t("coupon.val.tierInvalidPrefix")+y+t("coupon.val.tierInvalidSuffix")};var _=0;return b.discountType==="percentage"?_=w*(b.discountValue/100):_=Math.min(b.discountValue,w),{valid:!0,coupon:b,discount:_,discountDisplay:b.discountType==="percentage"?b.discountValue+"%":"$"+b.discountValue.toFixed(0)}},A.prototype.fetchClientLastLogins=function(d){if(!d||d.length===0)return Promise.resolve();var y={};d.forEach(function(C){C.clientEmail&&(y[C.clientEmail.toLowerCase()]=C.clientEmail)});var w=Object.values(y);if(w.length===0)return Promise.resolve();for(var b=[],_=0;_<w.length;_+=10)b.push(w.slice(_,_+10));var E={},S=b.map(function(C){return firebase.firestore().collection("users").where("email","in",C).get().then(function(F){console.log(" Found",F.size,"users for lastLogin lookup"),F.forEach(function(I){var z=I.data();z.email&&(E[z.email.toLowerCase()]=z.lastLogin)})})});return Promise.all(S).then(function(){d.forEach(function(C){C.clientEmail&&(C.clientLastLogin=E[C.clientEmail.toLowerCase()]||null)})})},A.prototype.loadSOWDocuments=function(){var d=this;firebase.firestore().collection("sow_documents").orderBy("createdAt","desc").get().then(function(y){var w=[],b=[];return y.forEach(function(_){var E=_.data();E.id=_.id,w.push(E),E.changeRequestId&&b.push(E.changeRequestId)}),d.fetchClientLastLogins(w).then(function(){b.length>0?d.fetchChangeRequestsUnreadStatus(b,w):d.renderSOWTab(w)})}).catch(function(y){console.error("Error loading SOWs:",y);var w=n("#sowTabContent");w&&(w.innerHTML='<div class="error-state"><p>Error loading SOW documents</p><button class="btn-create-sow" onclick="location.reload()">Retry</button></div>')})},A.prototype.fetchChangeRequestsUnreadStatus=function(d,y){for(var w=this,b=w.isDeveloper?"developer":"client",_=w.isDeveloper?"developerLastViewed":"clientLastViewed",E=[],S=0;S<d.length;S+=10)E.push(d.slice(S,S+10));var C={},F=E.map(function(I){return firebase.firestore().collection("change_requests").where(firebase.firestore.FieldPath.documentId(),"in",I).get().then(function(z){z.forEach(function(O){var q=O.data();q.id=O.id;var V=!1;if(q.lastMessageBy&&q.lastMessageBy!==b&&q.lastMessageAt){var X=q[_];(!X||q.lastMessageAt.toMillis()>X.toMillis())&&(V=!0)}q.hasUnreadMessages=V,C[O.id]=q})})});Promise.all(F).then(function(){y.forEach(function(I){I.changeRequestId&&C[I.changeRequestId]&&(I.changeRequestData=C[I.changeRequestId])}),w.renderSOWTab(y)}).catch(function(I){console.error("Error fetching change requests:",I),w.renderSOWTab(y)})},A.prototype.renderSOWTab=function(d){var y=this,w=n("#sowTabContent"),b=n("#sowCountBadge");if(w){b&&(b.textContent=d.length);var _='<div class="sow-tab-header"><button class="btn-create-sow" onclick="window.contractFormHandler.showSOWCreator()"><span class="btn-icon">+</span> '+t("sowTab.btn.createSow")+"</button></div>";if(d.length===0)_+='<div class="empty-state"><img src="/images/scarlo-logo.png" alt="Scarlo" class="empty-icon"><h4>'+t("sowTab.empty.title")+"</h4><p>"+t("sowTab.empty.text")+'</p><button class="btn-create-sow" onclick="window.contractFormHandler.showSOWCreator()" style="margin-top: 20px;"><span class="btn-icon">+</span> '+t("sowTab.btn.createSow")+"</button></div>";else{var E=0,S=0,C={};d.forEach(function(O){O.payment&&O.payment.total&&(E+=O.payment.total);var q=y.calculatePaymentStatus(O);S+=q.paidAmount;var V=O.packageType||"unknown";C[V]=(C[V]||0)+1});var F=d.length>0?E/d.length:0;_+='<div class="sow-revenue-bar"><div class="sow-revenue-stat"><span class="revenue-val">'+y.formatCurrency(E)+'</span><span class="revenue-label">'+t("sowTab.stats.totalRevenue")+'</span></div><div class="sow-revenue-stat"><span class="revenue-val">'+y.formatCurrency(F)+'</span><span class="revenue-label">'+t("sowTab.stats.avgProject")+'</span></div><div class="sow-revenue-stat"><span class="revenue-val">'+y.formatCurrency(S)+'</span><span class="revenue-label">'+t("sowTab.stats.collected")+"</span></div></div>";var I={essential:"#6366f1",starter:"#8b5cf6",growth:"#10b981",professional:"#f59e0b",enterprise:"#ef4444",custom:"#ec4899"};_+='<div class="package-distribution"><div class="package-bar">';var z=Object.keys(C);z.forEach(function(O){var q=(C[O]/d.length*100).toFixed(1);_+='<div class="package-segment" style="width: '+q+"%; background: "+(I[O]||"#6b7280")+';" title="'+O+": "+C[O]+'"></div>'}),_+='</div><div class="package-legend">',z.forEach(function(O){_+='<span class="legend-item"><span class="legend-dot" style="background: '+(I[O]||"#6b7280")+';"></span>'+O.charAt(0).toUpperCase()+O.slice(1)+" ("+C[O]+")</span>"}),_+="</div></div>",_+='<div class="sow-list">',d.forEach(function(O){var q=O.createdAt?O.createdAt.toDate?O.createdAt.toDate().toLocaleDateString():new Date(O.createdAt).toLocaleDateString():"N/A",V={essential:t("sowTab.pkg.essential"),starter:t("sowTab.pkg.tier1"),growth:t("sowTab.pkg.tier2"),professional:t("sowTab.pkg.tier3"),enterprise:t("sowTab.pkg.tier4"),custom:t("sowTab.pkg.custom")},X={draft:{bg:"#374151",color:"#9ca3af",icon:""},sent:{bg:"#1e40af",color:"#60a5fa",icon:""},approved:{bg:"#065f46",color:"#34d399",icon:""}},G=O.status||"draft",j=X[G]||X.draft,Y=G.toUpperCase();G==="pending_developer"||G==="sent"?O.clientSignature&&!O.devSignature?Y=" "+t("sowTab.status.awaitingDev"):O.clientSignature||(Y=" "+t("sowTab.status.awaitingClient")):G==="approved"&&O.clientSignature&&O.devSignature&&(Y=" "+t("sowTab.status.fullySigned"));var ie="sowData_"+O.id.replace(/[^a-zA-Z0-9]/g,"_");window[ie]=O;var ae="";if(O.hasChangeRequest&&O.changeRequestStatus){var le={pending:{bg:"rgba(251, 191, 36, 0.2)",color:"#fbbf24",text:" "+t("sowTab.cr.requested")},approved:{bg:"rgba(16, 185, 129, 0.2)",color:"#10b981",text:" "+t("sowTab.cr.approved")},rejected:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444",text:" "+t("sowTab.cr.rejected")},change_order:{bg:"rgba(99, 102, 241, 0.2)",color:"#6366f1",text:" "+t("sowTab.cr.order")}},pe=le[O.changeRequestStatus]||le.pending,_e="";O.changeRequestData&&O.changeRequestData.hasUnreadMessages&&(_e='<span class="unread-badge">'+t("sowTab.badge.new")+"</span>"),ae='<div style="font-size: 0.75rem; color: '+pe.color+"; background: "+pe.bg+`; padding: 4px 8px; border-radius: 4px; white-space: nowrap; cursor: pointer; display: flex; align-items: center;" onclick="window.contractFormHandler.viewChangeRequest('`+O.changeRequestId+`')">`+pe.text+_e+"</div>"}_+='<div class="sow-item" data-sow-id="'+O.id+'"><div class="sow-item-header"><div class="sow-client-info"><h4>'+(O.clientName||"Unknown Client")+'</h4><p class="sow-package">'+(V[O.packageType]||O.packageType)+'</p><p style="margin: 0.25rem 0 0; font-size: 0.7rem; color: #6b7280; opacity: 0.8;">Last sign in: '+(O.clientLastLogin?O.clientLastLogin.toDate?O.clientLastLogin.toDate().toLocaleString([],{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):new Date(O.clientLastLogin).toLocaleString([],{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):"Never")+'</p></div><div style="display: flex; flex-direction: column; align-items: flex-end; gap: 8px;"><span class="sow-status" style="background: '+j.bg+"; color: "+j.color+';">'+j.icon+" "+Y+"</span>"+(O.linkedContract?'<div style="font-size: 0.75rem; color: #10b981; background: rgba(16, 185, 129, 0.15); padding: 4px 8px; border-radius: 4px; white-space: nowrap;"> '+t("sowTab.badge.linkedContract")+"</div>":"")+ae+'<div class="sow-signatures"><span class="sig-icon '+(O.devSignature?"signed":"pending")+'">'+(O.devSignature?"&#10003;":"&#9202;")+" "+t("sowTab.sig.dev")+'</span><span class="sig-icon '+(O.clientSignature?"signed":"pending")+'">'+(O.clientSignature?"&#10003;":"&#9202;")+" "+t("sowTab.sig.client")+'</span></div></div></div><div class="sow-item-details"><div class="sow-detail-grid"><div class="sow-detail-row"><span class="detail-label">'+(O.clientEmail?" "+t("sowTab.detail.email"):" "+t("sowTab.detail.phone"))+'</span><span class="detail-value">'+(O.clientEmail||(O.clientPhone?h(O.clientPhone):"N/A"))+'</span></div><div class="sow-detail-row"><span class="detail-label"> '+t("sowTab.detail.total")+'</span><span class="detail-value">'+y.formatCurrency(O.payment&&O.payment.total?O.payment.total:0)+'</span></div><div class="sow-detail-row"><span class="detail-label"> '+t("sowTab.detail.timeline")+'</span><span class="detail-value">'+(O.estimatedWeeks||"TBD")+" "+(O.devDurationUnit||t("sowTab.detail.weeks"))+'</span></div><div class="sow-detail-row"><span class="detail-label"> '+t("sowTab.detail.created")+'</span><span class="detail-value">'+q+"</span></div></div></div>"+(O.hasChangeRequest&&O.changeRequestStatus==="pending"?'<div class="change-request-card" style="background: rgba(251, 191, 36, 0.1); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 8px; padding: 0.75rem; margin-bottom: 0.75rem;"><div><p style="margin: 0; font-weight: 600; color: #fbbf24; font-size: 0.9rem; display: flex; align-items: center;"> '+t("sowTab.cr.clientRequested")+(O.changeRequestData&&O.changeRequestData.hasUnreadMessages?'<span class="unread-badge">'+t("sowTab.badge.new")+"</span>":"")+'</p><p style="margin: 0.25rem 0 0; font-size: 0.8rem; opacity: 0.8;">'+t("sowTab.cr.reviewText")+"</p></div></div>":"")+'<div class="sow-item-actions">'+(!O.clientSignature||!O.devSignature?`<button class="sow-action-icon" onclick="window.contractFormHandler.showSOWSigningModal('`+O.id+`')" title="`+t("sowTab.btn.signSow")+'"></button>':"")+(O.hasChangeRequest&&O.changeRequestId?`<button class="sow-action-icon has-badge" onclick="window.contractFormHandler.viewChangeRequest('`+O.changeRequestId+`')" title="`+t("sowTab.btn.viewChangeRequest")+'">'+(O.changeRequestData&&O.changeRequestData.hasUnreadMessages?'<span class="action-badge"></span>':"")+"</button>":"")+`<button class="sow-action-icon" onclick="window.contractFormHandler.showPaymentManager('`+O.id+`')" title="`+t("sowTab.btn.managePayments")+'"></button><button class="sow-action-icon" onclick="window.contractFormHandler.editSOW(window.'+ie+')" title="'+t("sowTab.btn.editSow")+'"></button><button class="sow-action-icon" onclick="window.contractFormHandler.generateSOWPDF(window.'+ie+')" title="'+t("sowTab.btn.downloadPdf")+`"></button><button class="sow-action-icon delete" onclick="window.contractFormHandler.deleteSOW('`+O.id+`')" title="`+t("sowTab.btn.deleteSow")+'"></button></div></div>'}),_+="</div>"}_+='<div id="sowCreatorContainer" style="display: none;"></div>',w.innerHTML=_,console.log(" SOW tab rendered with",d.length,"items"),Z()}},A.prototype.viewSOWDetails=function(d){alert("SOW Details for: "+d.clientName+`

Package: `+d.packageType+`
Total: $`+(d.payment?d.payment.total.toFixed(0):"0")+`
Timeline: `+(d.estimatedWeeks||"TBD")+` weeks
Features: `+(d.features?d.features.length:0)+" selected")},A.prototype.generateSOWPDFFromData=function(d){var y=n("#sowClientName"),w=n("#sowClientEmail"),b=n("#sowPackage"),_=n("#sowWeeks"),E=n("#sowNotes"),S=n("#sowMaintenance");y&&(y.value=d.clientName||""),w&&(w.value=d.clientEmail||""),b&&(b.value=d.packageType||""),_&&(_.value=d.estimatedWeeks||""),E&&(E.value=d.notes||""),S&&(S.value=d.maintenancePlan||"none"),this.generateSOWPDF()},A.prototype.deleteSOW=function(d){if(confirm(t("sow.confirm.delete"))){var y=this;firebase.firestore().collection("sow_documents").doc(d).delete().then(function(){console.log("SOW deleted successfully"),alert(t("sow.msg.deleteSuccess")),y.loadSOWDocuments()}).catch(function(w){console.error("Error deleting SOW:",w),alert(t("sow.err.delete")+w.message)})}},A.prototype.showPaymentManager=function(d){var y=this;firebase.firestore().collection("sow_documents").doc(d).get().then(function(w){if(!w.exists){alert(t("sow.err.notFound"));return}var b=w.data();b.id=w.id,y.renderPaymentManagerModal(b)}).catch(function(w){console.error("Error loading SOW:",w),alert(t("sow.err.load")+w.message)})},A.prototype.renderPaymentManagerModal=function(d){var y=this,w=document.getElementById("paymentManagerModal");w&&w.remove();var b=y.calculatePaymentStatus(d),_="";b.payments.forEach(function(I,z){var O=I.paid?"paid":"pending",q=I.paid?"checked":"";_+='<div class="admin-payment-row '+O+'" data-index="'+z+'"><div class="payment-row-checkbox"><input type="checkbox" id="payment_'+z+'" '+q+' class="payment-checkbox" data-index="'+z+'"><label for="payment_'+z+'"></label></div><div class="payment-row-info"><span class="payment-row-name">'+I.name+'</span><span class="payment-row-amount">$'+I.amount.toFixed(2)+'</span></div><div class="payment-row-meta">',I.dueDate&&(_+='<span class="payment-row-due">'+t("payMgr.label.due")+I.dueDate+"</span>"),_+='<span class="payment-row-status '+O+'">'+(I.paid?" "+t("payMgr.status.paid")+(I.paidDate?t("payMgr.status.paidOn")+I.paidDate:""):" "+t("payMgr.status.pending"))+"</span></div></div>"});var E=b.totalCount>0?Math.round(b.paidCount/b.totalCount*100):0,S='<div id="paymentManagerModal" class="payment-manager-modal"><div class="payment-manager-overlay" onclick="window.contractFormHandler.closePaymentManager()"></div><div class="payment-manager-content"><div class="payment-manager-header"><h2> '+t("payMgr.title")+'</h2><button class="payment-manager-close" onclick="window.contractFormHandler.closePaymentManager()">&times;</button></div><div class="payment-manager-client"><h3>'+(d.clientName||t("payMgr.fallback.client"))+"</h3><p>"+(d.packageType||"N/A")+"  "+t("payMgr.label.total")+" $"+(d.payment?d.payment.total.toFixed(2):"0")+'</p></div><div class="payment-manager-summary"><div class="summary-progress"><div class="summary-progress-bar"><div class="summary-progress-fill" style="width: '+E+'%;"></div></div><span class="summary-progress-text">'+b.paidCount+t("payMgr.summary.of")+b.totalCount+t("payMgr.summary.completed")+'</span></div><div class="summary-amounts"><div class="summary-amount paid"><span class="amount-label">'+t("payMgr.summary.paid")+'</span><span class="amount-value">$'+b.paidAmount.toFixed(2)+'</span></div><div class="summary-amount owed"><span class="amount-label">'+t("payMgr.summary.owed")+'</span><span class="amount-value">$'+b.owedAmount.toFixed(2)+'</span></div></div></div><div class="payment-manager-list"><h4>'+t("payMgr.section.schedule")+'</h4><p class="payment-manager-hint">'+t("payMgr.helper.checkBox")+'</p><div class="payment-grid">'+_+'</div></div><div class="payment-manager-actions"><button class="btn btn-secondary" onclick="window.contractFormHandler.closePaymentManager()">'+t("payMgr.btn.cancel")+`</button><button class="btn btn-primary" onclick="window.contractFormHandler.savePaymentStatus('`+d.id+`')">`+t("payMgr.btn.save")+"</button></div></div></div>";document.body.insertAdjacentHTML("beforeend",S),y.currentPaymentSOW=d;var C=document.querySelectorAll(".admin-payment-row");C.forEach(function(I){I.style.cursor="pointer",I.addEventListener("click",function(z){if(z.target.type!=="checkbox"){var O=I.querySelector(".payment-checkbox");O&&(O.checked=!O.checked,O.dispatchEvent(new Event("change",{bubbles:!0})))}})});var F=document.querySelectorAll(".payment-checkbox");F.forEach(function(I){I.addEventListener("change",function(){var z=I.closest(".admin-payment-row");parseInt(I.dataset.index),I.checked?(z.classList.add("paid"),z.classList.remove("pending")):(z.classList.remove("paid"),z.classList.add("pending"));var O=0,q=0,V=0,X=b.payments.length;b.payments.forEach(function(pe,_e){var oe=document.querySelector('.payment-checkbox[data-index="'+_e+'"]');V+=pe.amount,oe&&oe.checked&&(O+=pe.amount,q++)});var G=V-O,j=X>0?Math.round(q/X*100):0,Y=document.querySelector(".summary-amount.paid .amount-value"),ie=document.querySelector(".summary-amount.owed .amount-value"),ae=document.querySelector(".summary-progress-fill"),le=document.querySelector(".summary-progress-text");Y&&(Y.textContent="$"+O.toFixed(2)),ie&&(ie.textContent="$"+G.toFixed(2)),ae&&(ae.style.width=j+"%"),le&&(le.textContent=q+t("dash.payment.of")+X+t("dash.payment.completed"))})})},A.prototype.closePaymentManager=function(){var d=document.getElementById("paymentManagerModal");d&&d.remove(),this.currentPaymentSOW=null},A.prototype.savePaymentStatus=function(d){var y=this,w=y.currentPaymentSOW;if(!w||!w.payment){alert(t("sow.err.dataNotFound"));return}var b=w.payment,_=b.tracking||{},E=b.deferred&&b.deferred.enabled,S=document.querySelectorAll("#paymentManagerModal .payment-checkbox"),C=new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});if(E&&b.deferred.customSchedule&&b.deferred.customSchedule.length>0){var F=_.deferredPayments||[];S.forEach(function(z,O){var q=z.checked,V=F[O]||{};F[O]={paid:q,paidDate:q?V.paidDate||C:null}}),_.deferredPayments=F}else{var I=["deposit","milestone1","final"];S.forEach(function(z,O){var q=I[O];if(q){var V=z.checked,X=_[q+"PaidDate"];_[q+"Paid"]=V,_[q+"PaidDate"]=V?X||C:null}})}firebase.firestore().collection("sow_documents").doc(d).update({"payment.tracking":_,updatedAt:firebase.firestore.FieldValue.serverTimestamp()}).then(function(){console.log("Payment status updated successfully"),alert(t("dash.payment.msg.saveSuccess")),y.closePaymentManager(),y.loadSOWDocuments()}).catch(function(z){console.error("Error saving payment status:",z),alert(t("dash.payment.err.save")+z.message)})},A.prototype.showChangeRequestModal=function(d){this.currentChangeRequestSOW=d;var y=[{id:"package",label:t("changeModal.section.packageTier"),desc:t("changeModal.section.packageTierDesc")},{id:"features",label:t("changeModal.section.features"),desc:t("changeModal.section.featuresDesc")},{id:"timeline",label:t("changeModal.section.timeline"),desc:t("changeModal.section.timelineDesc")},{id:"payment",label:t("changeModal.section.payment"),desc:t("changeModal.section.paymentDesc")},{id:"maintenance",label:t("changeModal.section.maintenance"),desc:t("changeModal.section.maintenanceDesc")},{id:"other",label:t("changeModal.section.other"),desc:t("changeModal.section.otherDesc")}],w=y.map(function(E){return'<label class="change-section-option"><input type="checkbox" name="changeSections" value="'+E.id+'" /><div class="section-option-content"><span class="section-option-label">'+E.label+'</span><span class="section-option-desc">'+E.desc+"</span></div></label>"}).join(""),b='<div id="changeRequestModal" class="modal-overlay" style="display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); z-index: 10000; justify-content: center; align-items: center; padding: 1rem;"><div class="modal-content change-request-modal-content" style="max-width: 720px; width: 100%; padding: 0; background: linear-gradient(165deg, rgba(30, 30, 30, 0.95) 0%, rgba(18, 18, 18, 0.98) 100%); border: 1px solid rgba(228, 216, 196, 0.15); border-radius: 20px; box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6), 0 0 40px rgba(228, 216, 196, 0.03), inset 0 1px 0 rgba(255, 255, 255, 0.05); overflow: hidden;"><div class="modal-header" style="position: relative; padding: 1rem 1.5rem; border-bottom: 1px solid rgba(228, 216, 196, 0.1); background: linear-gradient(180deg, rgba(228, 216, 196, 0.03) 0%, transparent 100%);"><h2 style="margin: 0; font-size: 1.25rem; color: #fff; font-weight: 600; letter-spacing: -0.02em;">'+t("changeModal.title")+'</h2><button type="button" class="modal-close" onclick="window.contractFormHandler.closeChangeRequestModal()" style="position: absolute; top: 0.75rem; right: 1rem; background: rgba(255, 255, 255, 0.06); border: 1px solid rgba(255, 255, 255, 0.08); width: 32px; height: 32px; border-radius: 50%; color: rgba(255,255,255,0.7); font-size: 1.25rem; cursor: pointer; display: flex; align-items: center; justify-content: center; line-height: 1; transition: all 0.2s ease;"></button></div><div class="modal-body" style="color: #fff; padding: 1.25rem 1.5rem; max-height: 65vh; overflow-y: auto;"><div class="change-request-info" style="background: linear-gradient(135deg, rgba(228, 216, 196, 0.08) 0%, rgba(228, 216, 196, 0.03) 100%); border: 1px solid rgba(228, 216, 196, 0.15); border-radius: 10px; padding: 0.75rem 1rem; margin-bottom: 1rem; display: flex; gap: 2rem; align-items: center;"><p style="margin: 0; font-size: 0.85rem; color: rgba(255,255,255,0.9);"><span style="color: rgba(228, 216, 196, 0.7); font-weight: 500;">'+t("changeModal.label.sow")+'</span> <strong style="color: #E4D8C4; margin-left: 0.5rem;">'+(d.packageType||"N/A")+' Package</strong></p><p style="margin: 0; font-size: 0.85rem; color: rgba(255,255,255,0.9);"><span style="color: rgba(228, 216, 196, 0.7); font-weight: 500;">'+t("changeModal.label.currentTotal")+'</span> <strong style="color: #E4D8C4; margin-left: 0.5rem;">$'+(d.payment?d.payment.total.toFixed(0):"0")+'</strong></p></div><div class="form-group" style="margin: 0;"><label class="form-label" style="display: block; margin-bottom: 0.6rem; font-weight: 500; font-size: 0.9rem; color: rgba(255,255,255,0.9);">'+t("changeModal.label.whichSections")+'</label><div class="change-sections-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem;">'+w+'</div></div><div class="form-group" style="margin: 1rem 0 0;"><label class="form-label" style="display: block; margin-bottom: 0.4rem; font-weight: 500; font-size: 0.9rem; color: rgba(255,255,255,0.9);">'+t("changeModal.label.describeChanges")+'</label><textarea id="changeRequestDescription" class="form-input" rows="3" placeholder="'+t("changeModal.placeholder.describe")+'" style="width: 100%; resize: vertical; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; padding: 0.75rem; color: #fff; font-size: 0.9rem; transition: all 0.2s ease; outline: none;"></textarea></div><div class="form-group" style="margin: 0.75rem 0 0;"><label class="form-label" style="display: block; margin-bottom: 0.4rem; font-weight: 500; font-size: 0.9rem; color: rgba(255,255,255,0.9);">'+t("changeModal.label.priority")+'</label><select id="changeRequestPriority" class="form-input" style="width: 100%; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; padding: 0.75rem; color: #fff; font-size: 0.9rem; cursor: pointer; transition: all 0.2s ease; outline: none;"><option value="normal" style="background: #1a1a1a; color: #fff;">'+t("changeModal.priority.normal")+'</option><option value="high" style="background: #1a1a1a; color: #fff;">'+t("changeModal.priority.high")+'</option><option value="urgent" style="background: #1a1a1a; color: #fff;">'+t("changeModal.priority.urgent")+'</option></select></div></div><div class="modal-footer" style="display: flex; gap: 0.75rem; justify-content: flex-end; padding: 1rem 1.5rem; background: rgba(0,0,0,0.2); border-top: 1px solid rgba(255,255,255,0.05);"><button type="button" class="btn btn-secondary" onclick="window.contractFormHandler.closeChangeRequestModal()" style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); padding: 0.6rem 1.25rem; border-radius: 10px; cursor: pointer; font-weight: 500; font-size: 0.85rem; transition: all 0.2s ease;">'+t("changeModal.btn.cancel")+'</button><button type="button" class="btn btn-primary" onclick="window.contractFormHandler.submitChangeRequest()" style="background: linear-gradient(135deg, rgba(228, 216, 196, 0.9) 0%, rgba(228, 216, 196, 0.7) 100%); border: none; color: #121212; padding: 0.6rem 1.25rem; border-radius: 10px; cursor: pointer; font-weight: 600; font-size: 0.85rem; transition: all 0.2s ease;">'+t("changeModal.btn.submit")+"</button></div></div></div>";if(!document.getElementById("changeRequestStyles")){var _=document.createElement("style");_.id="changeRequestStyles",_.textContent='#changeRequestModal .modal-content { height: auto; max-height: 90vh; }#changeRequestModal .modal-footer { margin-top: 0; }.change-section-option { display: flex; align-items: flex-start; gap: 0.6rem; padding: 0.6rem 0.75rem; background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.06); border-radius: 10px; cursor: pointer; transition: all 0.25s ease; position: relative; overflow: hidden; }.change-section-option::before { content: ""; position: absolute; inset: 0; background: linear-gradient(135deg, rgba(228, 216, 196, 0.06) 0%, transparent 100%); opacity: 0; transition: opacity 0.25s ease; border-radius: 12px; pointer-events: none; }.change-section-option:hover { background: rgba(228, 216, 196, 0.05); border-color: rgba(228, 216, 196, 0.2); }.change-section-option:hover::before { opacity: 1; }.change-section-option input[type="checkbox"] { margin-top: 2px; accent-color: #E4D8C4; width: 16px; height: 16px; flex-shrink: 0; }.change-section-option input[type="checkbox"]:checked + .section-option-content .section-option-label { color: #E4D8C4; }.change-section-option:has(input:checked) { border-color: rgba(228, 216, 196, 0.3); background: rgba(228, 216, 196, 0.06); }.section-option-content { display: flex; flex-direction: column; gap: 2px; }.section-option-label { font-weight: 600; font-size: 0.85rem; color: rgba(255,255,255,0.95); transition: color 0.2s ease; }.section-option-desc { font-size: 0.75rem; color: rgba(255,255,255,0.4); line-height: 1.3; }.change-request-modal-content .modal-body::-webkit-scrollbar { width: 4px; }.change-request-modal-content .modal-body::-webkit-scrollbar-track { background: transparent; }.change-request-modal-content .modal-body::-webkit-scrollbar-thumb { background: rgba(228, 216, 196, 0.15); border-radius: 4px; }.change-request-modal-content .modal-body::-webkit-scrollbar-thumb:hover { background: rgba(228, 216, 196, 0.3); }.change-request-modal-content textarea:focus, .change-request-modal-content select:focus { border-color: rgba(228, 216, 196, 0.3); box-shadow: 0 0 0 3px rgba(228, 216, 196, 0.05); }.change-request-modal-content .btn-secondary:hover { background: rgba(255,255,255,0.1) !important; border-color: rgba(255,255,255,0.2) !important; }.change-request-modal-content .btn-primary:hover { opacity: 0.9; transform: translateY(-1px); box-shadow: 0 4px 16px rgba(228, 216, 196, 0.2); }@media (max-width: 600px) { .change-sections-grid { grid-template-columns: 1fr !important; } .change-request-info { flex-direction: column; gap: 0.5rem !important; } }.change-request-badge { display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }.change-request-badge.pending { background: rgba(251, 191, 36, 0.2); color: #fbbf24; }.change-request-badge.approved { background: rgba(16, 185, 129, 0.2); color: #10b981; }.change-request-badge.rejected { background: rgba(239, 68, 68, 0.2); color: #ef4444; }.change-request-badge.change-order { background: rgba(99, 102, 241, 0.2); color: #6366f1; }.change-request-badge.completed { background: rgba(16, 185, 129, 0.2); color: #10b981; }.change-request-card { background: rgba(251, 191, 36, 0.1); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 12px; padding: 1rem; margin-top: 1rem; }.change-request-card.approved { background: rgba(16, 185, 129, 0.1); border-color: rgba(16, 185, 129, 0.3); }.change-request-card.rejected { background: rgba(239, 68, 68, 0.1); border-color: rgba(239, 68, 68, 0.3); }.btn-change-request { cursor: pointer !important; pointer-events: auto !important; }.btn-change-request:hover { background: linear-gradient(135deg, rgba(228, 216, 196, 0.3) 0%, rgba(228, 216, 196, 0.15) 100%) !important; border-color: rgba(228, 216, 196, 0.5) !important; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(228, 216, 196, 0.15); }',document.head.appendChild(_)}document.body.insertAdjacentHTML("beforeend",b)},A.prototype.closeChangeRequestModal=function(){var d=document.getElementById("changeRequestModal");d&&d.remove(),this.currentChangeRequestSOW=null},A.prototype.showPricingComparisonModal=function(){var d=document.getElementById("pricingComparisonModal");d&&d.remove();var y=document.createElement("div");y.id="pricingComparisonModal",y.className="pricing-comparison-modal-overlay",y.innerHTML='<div class="pricing-comparison-modal"><div class="pricing-comparison-modal-header"><h3>2025 Web Development Pricing Guide</h3><button class="pricing-comparison-modal-close" id="closePricingModal">&times;</button></div><div class="pricing-comparison-modal-body"><iframe src="/pricing/index.html" title="Industry Pricing Comparison"></iframe></div></div>',document.body.appendChild(y),requestAnimationFrame(function(){y.classList.add("active")});var w=document.getElementById("closePricingModal");w&&w.addEventListener("click",function(){y.classList.remove("active"),setTimeout(function(){y.remove()},300)}),y.addEventListener("click",function(_){_.target===y&&(y.classList.remove("active"),setTimeout(function(){y.remove()},300))});var b=function(_){_.key==="Escape"&&(y.classList.remove("active"),setTimeout(function(){y.remove()},300),document.removeEventListener("keydown",b))};document.addEventListener("keydown",b)},A.prototype.submitChangeRequest=function(){var d=this,y=this.currentChangeRequestSOW;if(!y){alert(t("sow.err.dataNotFound"));return}var w=[];if(document.querySelectorAll('input[name="changeSections"]:checked').forEach(function(C){w.push(C.value)}),w.length===0){alert(t("change.val.selectSection"));return}var b=document.getElementById("changeRequestDescription").value.trim();if(!b){alert(t("change.val.describeChanges"));return}var _=document.getElementById("changeRequestPriority").value,E={sowId:y.id,sowData:{clientName:y.clientName,clientEmail:y.clientEmail,clientPhone:y.clientPhone,packageType:y.packageType,payment:y.payment,estimatedWeeks:y.estimatedWeeks},sections:w,description:b,priority:_,status:"pending",clientEmail:y.clientEmail,clientPhone:y.clientPhone||"",clientName:y.clientName,createdAt:firebase.firestore.FieldValue.serverTimestamp(),updatedAt:firebase.firestore.FieldValue.serverTimestamp()},S=null;firebase.firestore().collection("change_requests").add(E).then(function(C){return console.log("Change request submitted:",C.id),S=C.id,firebase.firestore().collection("sow_documents").doc(y.id).update({hasChangeRequest:!0,changeRequestId:C.id,changeRequestStatus:"pending"})}).then(function(){var C=document.getElementById("changeRequestBtn-"+y.id);C&&(C.className="sow-action-btn",C.style.background="linear-gradient(135deg, #f59e0b, #d97706)",C.style.color="white",C.style.border="none",C.innerHTML=t("change.btn.viewRequest"),C.onclick=function(){window.contractFormHandler.viewChangeRequest(S)});var F="sowData_"+y.id.replace(/[^a-zA-Z0-9]/g,"_");window[F]&&(window[F].hasChangeRequest=!0,window[F].changeRequestId=S,window[F].changeRequestStatus="pending"),d.closeChangeRequestModal(),alert(t("change.msg.submitSuccess"))}).catch(function(C){console.error("Error submitting change request:",C),alert(t("change.err.submit")+C.message)})},A.prototype.viewChangeRequest=function(d){var y=this;firebase.firestore().collection("change_requests").doc(d).get().then(function(w){if(!w.exists){alert(t("change.err.notFound"));return}var b=w.data();return b.id=w.id,firebase.firestore().collection("sow_documents").doc(b.sowId).get().then(function(_){_.exists&&(b.sowData=_.data(),b.sowData.id=_.id),y.showChangeRequestDetailModal(b)})}).catch(function(w){console.error("Error loading change request:",w),alert(t("change.err.load")+w.message)})},A.prototype.showChangeRequestDetailModal=function(d){var y=this;this.currentChangeRequest=d;var w={package:t("changeOrder.section.package"),features:t("changeOrder.section.features"),timeline:t("changeOrder.section.timeline"),payment:t("changeOrder.section.payment"),maintenance:t("changeOrder.section.maintenance"),other:t("changeOrder.section.other")},b={normal:{bg:"rgba(107, 114, 128, 0.2)",color:"#9ca3af",label:t("changeOrder.priority.normal")},high:{bg:"rgba(251, 191, 36, 0.2)",color:"#fbbf24",label:t("changeOrder.priority.high")},urgent:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444",label:t("changeOrder.priority.urgent")}},_={pending:{bg:"rgba(251, 191, 36, 0.2)",color:"#fbbf24",label:t("changeOrder.status.pending")},approved:{bg:"rgba(16, 185, 129, 0.2)",color:"#10b981",label:t("changeOrder.status.approved")},rejected:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444",label:t("changeOrder.status.rejected")},change_order:{bg:"rgba(99, 102, 241, 0.2)",color:"#6366f1",label:t("changeOrder.status.change_order")},completed:{bg:"rgba(16, 185, 129, 0.2)",color:"#10b981",label:t("changeOrder.status.completed")}},E=d.sections.map(function(X){return'<span style="background: rgba(99, 102, 241, 0.15); color: #a5b4fc; padding: 4px 10px; border-radius: 4px; font-size: 0.85rem;">'+(w[X]||X)+"</span>"}).join(" "),S=b[d.priority]||b.normal,C=_[d.status]||_.pending,F=d.createdAt?new Date(d.createdAt.toDate()).toLocaleString():"N/A",I=y.renderConversationThread(d.messages||[]),z="";y.isDeveloper&&d.status==="pending"?z=`<div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;"><button class="btn btn-primary" style="padding: 0.5rem 1rem; font-size: 0.85rem;" onclick="window.contractFormHandler.approveChangeRequest('`+d.id+`')"> Approve</button><button class="btn" style="padding: 0.5rem 1rem; font-size: 0.85rem; background: rgba(239, 68, 68, 0.2); color: #ef4444;" onclick="window.contractFormHandler.rejectChangeRequest('`+d.id+`')"> Reject</button><button class="btn" style="padding: 0.5rem 1rem; font-size: 0.85rem; background: rgba(99, 102, 241, 0.2); color: #6366f1;" onclick="window.contractFormHandler.createChangeOrderFromRequest('`+d.id+`')"> Change Order</button></div>`:y.isDeveloper&&(d.status==="approved"||d.status==="change_order")&&(z=`<div style="display: flex; gap: 0.5rem; justify-content: center;"><button class="btn btn-primary" style="padding: 0.5rem 1rem; font-size: 0.85rem;" onclick="window.contractFormHandler.editSOWFromChangeRequest('`+d.sowId+`')"> Edit SOW</button></div>`);var O=`<div id="changeRequestDetailModal" class="modal-overlay-fixed"><div class="modal-content" style="max-width: 700px;"><div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1);"><h2 style="margin: 0; font-size: 1.25rem; display: flex; align-items: center; gap: 0.5rem;"><img src="/images/morph-logo14.png" alt="Logo" style="height: 2rem; width: auto;"> Change Request Details</h2><button style="background: rgba(255,255,255,0.1); border: none; color: #fff; width: 36px; height: 36px; border-radius: 50%; font-size: 1.5rem; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.2)'" onmouseout="this.style.background='rgba(255,255,255,0.1)'" onclick="window.contractFormHandler.closeChangeRequestDetailModal()">&times;</button></div><div class="modal-body" style="max-height: 70vh; overflow-y: auto; padding: .8rem;"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;"><div><h3 style="margin: 0;">`+d.clientName+'</h3><p style="margin: 0.25rem 0 0; opacity: 0.7; font-size: 0.9rem;">'+d.clientEmail+'</p></div><span style="background: '+C.bg+"; color: "+C.color+'; padding: 6px 12px; border-radius: 20px; font-weight: 600; font-size: 0.85rem;">'+C.label+'</span></div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;"><div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px;"><p style="margin: 0; font-size: 0.8rem; opacity: 0.7;">PACKAGE</p><p style="margin: 0.25rem 0 0; font-weight: 600;">'+(d.sowData.packageType||"N/A")+'</p></div><div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px;"><p style="margin: 0; font-size: 0.8rem; opacity: 0.7;">CURRENT TOTAL</p><p style="margin: 0.25rem 0 0; font-weight: 600;">$'+(d.sowData.payment?d.sowData.payment.total.toFixed(0):"0")+'</p></div></div><div style="margin-bottom: 1.5rem;"><p style="margin: 0 0 0.5rem; font-weight: 600;">Sections to Modify:</p><div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">'+E+'</div></div><div style="margin-bottom: 1.5rem;"><p style="margin: 0 0 0.5rem; font-weight: 600;">Description:</p><div style="background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 8px; white-space: pre-wrap;">'+d.description+'</div></div><div style="display: flex; gap: 2rem; margin-bottom: 1.5rem;"><div><p style="margin: 0; font-size: 0.8rem; opacity: 0.7;">PRIORITY</p><span style="background: '+S.bg+"; color: "+S.color+'; padding: 4px 10px; border-radius: 4px; font-size: 0.85rem;">'+S.label+'</span></div><div><p style="margin: 0; font-size: 0.8rem; opacity: 0.7;">SUBMITTED</p><p style="margin: 0.25rem 0 0;">'+F+'</p></div></div><div class="conversation-section"><h4> Conversation</h4><div id="conversationThread" class="conversation-thread">'+I+`</div><div class="conversation-input-wrapper"><textarea id="conversationInput" class="conversation-input" placeholder="Type your message..." rows="1"></textarea><button class="conversation-send-btn" onclick="window.contractFormHandler.sendChangeRequestMessage('`+d.id+`')">Send</button></div></div></div><div class="modal-footer" style="padding: 0rem; border-top: 0px solid rgba(255, 255, 255, 0);">`+z+"</div></div></div>";document.body.insertAdjacentHTML("beforeend",O);var q=document.getElementById("conversationThread");q&&(q.scrollTop=q.scrollHeight);var V=document.getElementById("conversationInput");V&&V.addEventListener("input",function(){this.style.height="auto",this.style.overflowY="hidden",this.scrollHeight>150?(this.style.height="150px",this.style.overflowY="auto"):this.style.height=this.scrollHeight+"px"}),y.updateChangeRequestLastViewed(d.id),y.conversationUnsubscribe=firebase.firestore().collection("change_requests").doc(d.id).onSnapshot(function(X){if(X.exists){var G=X.data(),j=G.messages||[],Y=document.getElementById("conversationThread");Y&&(Y.innerHTML=y.renderConversationThread(j),Y.scrollTop=Y.scrollHeight),y.currentChangeRequest.messages=j}},function(X){console.error("Error listening to conversation:",X)})},A.prototype.closeChangeRequestDetailModal=function(){this.conversationUnsubscribe&&(this.conversationUnsubscribe(),this.conversationUnsubscribe=null),this.currentChangeRequest=null;var d=document.getElementById("changeRequestDetailModal");d&&d.remove()},A.prototype.renderConversationThread=function(d){var y=this;return!d||d.length===0?'<div class="conversation-empty">No messages yet. Start the conversation!</div>':d.map(function(w){var b="";w.timestamp&&(w.timestamp.toDate?b=new Date(w.timestamp.toDate()).toLocaleString():b=new Date(w.timestamp).toLocaleString());var _=y.isDeveloper&&w.sender==="developer"||!y.isDeveloper&&w.sender==="client",E=_?"self":"other";return'<div class="conversation-message '+E+'"><div class="message-sender">'+(w.senderName||w.sender)+'</div><div class="message-text">'+w.text+'</div><div class="message-time">'+b+"</div></div>"}).join("")},A.prototype.sendChangeRequestMessage=function(d){var y=this,w=document.getElementById("conversationInput"),b=w.value.trim();if(b){var _=y.isDeveloper?"developer":"client",E=y.isDeveloper?"Carlos (Developer)":y.currentChangeRequest.clientName||"Client",S={sender:_,senderName:E,text:b,timestamp:new Date().toISOString()},C=document.querySelector(".conversation-send-btn");C&&(C.disabled=!0,C.textContent=t("change.btn.sending")),firebase.firestore().collection("change_requests").doc(d).update({messages:firebase.firestore.FieldValue.arrayUnion(S),lastMessageAt:firebase.firestore.FieldValue.serverTimestamp(),lastMessageBy:_}).then(function(){w.value="";var F=document.getElementById("conversationThread");if(F){var I=F.querySelector(".conversation-empty");I&&I.remove();var z='<div class="conversation-message self"><div class="message-sender">'+E+'</div><div class="message-text">'+b+'</div><div class="message-time">'+t("change.time.justNow")+"</div></div>";F.insertAdjacentHTML("beforeend",z),F.scrollTop=F.scrollHeight}C&&(C.disabled=!1,C.textContent=t("change.btn.send"))}).catch(function(F){console.error("Error sending message:",F),alert(t("change.err.sendFailed")),C&&(C.disabled=!1,C.textContent=t("change.btn.send"))})}},A.prototype.updateChangeRequestLastViewed=function(d){var y=this,w=y.isDeveloper?"developerLastViewed":"clientLastViewed";firebase.firestore().collection("change_requests").doc(d).update({[w]:firebase.firestore.FieldValue.serverTimestamp()}).catch(function(b){console.error("Error updating last viewed:",b)})},A.prototype.approveChangeRequest=function(d){var y=this;if(confirm(t("change.confirm.approve"))){var w={sender:"developer",senderName:"Carlos (Developer)",text:t("change.msg.approveSystem"),timestamp:new Date().toISOString()};firebase.firestore().collection("change_requests").doc(d).update({status:"approved",updatedAt:firebase.firestore.FieldValue.serverTimestamp(),messages:firebase.firestore.FieldValue.arrayUnion(w),lastMessageAt:firebase.firestore.FieldValue.serverTimestamp(),lastMessageBy:"developer"}).then(function(){return firebase.firestore().collection("change_requests").doc(d).get()}).then(function(b){var _=b.data();return firebase.firestore().collection("sow_documents").doc(_.sowId).update({changeRequestStatus:"approved"})}).then(function(){y.closeChangeRequestDetailModal(),alert(t("change.msg.approved")),y.loadSOWDocuments()}).catch(function(b){console.error("Error approving change request:",b),alert(t("contract.err.prefix")+b.message)})}},A.prototype.rejectChangeRequest=function(d){var y=this;if(confirm(t("change.confirm.reject"))){var w={sender:"developer",senderName:"Carlos (Developer)",text:t("change.msg.rejectSystem"),timestamp:new Date().toISOString()};firebase.firestore().collection("change_requests").doc(d).update({status:"rejected",updatedAt:firebase.firestore.FieldValue.serverTimestamp(),messages:firebase.firestore.FieldValue.arrayUnion(w),lastMessageAt:firebase.firestore.FieldValue.serverTimestamp(),lastMessageBy:"developer"}).then(function(){return firebase.firestore().collection("change_requests").doc(d).get()}).then(function(b){var _=b.data();return firebase.firestore().collection("sow_documents").doc(_.sowId).update({changeRequestStatus:"rejected",hasChangeRequest:!1})}).then(function(){y.closeChangeRequestDetailModal(),alert(t("change.msg.rejected")),y.loadSOWDocuments()}).catch(function(b){console.error("Error rejecting change request:",b),alert(t("contract.err.prefix")+b.message)})}},A.prototype.createChangeOrderFromRequest=function(d){var y=this;firebase.firestore().collection("change_requests").doc(d).get().then(function(w){if(!w.exists){alert(t("change.err.notFound"));return}var b=w.data();b.id=w.id;var _=document.getElementById("changeRequestDetailModal");return _&&_.remove(),firebase.firestore().collection("change_requests").doc(d).update({status:"change_order",updatedAt:firebase.firestore.FieldValue.serverTimestamp()}).then(function(){return firebase.firestore().collection("sow_documents").doc(b.sowId).update({changeRequestStatus:"change_order",hasChangeOrder:!0})}).then(function(){return firebase.firestore().collection("sow_documents").doc(b.sowId).get()}).then(function(E){if(E.exists){var S=E.data();S.id=E.id,S.editingFromChangeRequest={id:d,description:b.description,sections:b.sections,clientName:b.clientName},y.editSOW(S)}else alert(t("sow.err.notFound"))})}).catch(function(w){console.error("Error creating change order:",w),alert(t("contract.err.prefix")+w.message)})},A.prototype.showChangeOrderModal=function(d){var y={package:t("changeOrder.section.package"),features:t("changeOrder.section.features"),timeline:t("changeOrder.section.timeline"),payment:t("changeOrder.section.payment"),maintenance:t("changeOrder.section.maintenance"),other:t("changeOrder.section.other")},w=d.sections.map(function(_){return y[_]||_}).join(", "),b='<div id="changeOrderModal" class="modal-overlay-fixed"><div class="modal-content" style="max-width: 600px;"><div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1);"><h2 style="margin: 0; font-size: 1.25rem;">'+t("changeOrder.createTitle")+`</h2><button style="background: rgba(255,255,255,0.1); border: none; color: #fff; width: 36px; height: 36px; border-radius: 50%; font-size: 1.5rem; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.2)'" onmouseout="this.style.background='rgba(255,255,255,0.1)'" onclick="document.getElementById('changeOrderModal').remove()">&times;</button></div><div class="modal-body" style="padding: 1.5rem;"><div style="background: rgba(99, 102, 241, 0.1); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;"><p style="margin: 0; font-size: 0.9rem;"><strong>`+t("changeOrder.label.client")+"</strong> "+d.clientName+'</p><p style="margin: 0.5rem 0 0; font-size: 0.9rem;"><strong>'+t("changeOrder.label.sections")+"</strong> "+w+'</p><p style="margin: 0.5rem 0 0; font-size: 0.9rem;"><strong>'+t("changeOrder.label.request")+"</strong> "+d.description.substring(0,100)+(d.description.length>100?"...":"")+'</p></div><div class="form-group"><label class="form-label">'+t("changeOrder.label.description")+'</label><textarea id="changeOrderDescription" class="form-input" rows="4" placeholder="'+t("changeOrder.descPlaceholder")+'" style="width: 100%; resize: vertical;">'+d.description+`</textarea></div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;"><div class="form-group"><label class="form-label">Price Adjustment ($):</label><input type="number" id="changeOrderPrice" class="form-input" value="0" step="50" style="width: 100%;" /><p style="font-size: 0.8rem; opacity: 0.7; margin-top: 0.25rem;">Use negative for discounts</p></div><div class="form-group"><label class="form-label">Timeline Adjustment (weeks):</label><input type="number" id="changeOrderTimeline" class="form-input" value="0" step="1" style="width: 100%;" /><p style="font-size: 0.8rem; opacity: 0.7; margin-top: 0.25rem;">Use negative to reduce</p></div></div><div class="form-group" style="margin-top: 1rem;"><label class="form-label">Notes for Client:</label><textarea id="changeOrderNotes" class="form-input" rows="2" placeholder="Any additional notes..." style="width: 100%; resize: vertical;"></textarea></div></div><div class="modal-footer" style="display: flex; gap: 1rem; justify-content: flex-end; padding: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1);"><button class="btn btn-secondary" onclick="document.getElementById('changeOrderModal').remove()">`+t("changeOrder.btn.cancel")+`</button><button class="btn btn-primary" onclick="window.contractFormHandler.saveChangeOrder('`+d.id+"', '"+d.sowId+`')">`+t("changeOrder.btn.create")+"</button></div></div></div>";document.body.insertAdjacentHTML("beforeend",b)},A.prototype.saveChangeOrder=function(d,y){var w=this,b=document.getElementById("changeOrderDescription").value.trim(),_=parseFloat(document.getElementById("changeOrderPrice").value)||0,E=parseInt(document.getElementById("changeOrderTimeline").value)||0,S=document.getElementById("changeOrderNotes").value.trim();if(!b){alert(t("changeOrder.val.description"));return}firebase.firestore().collection("sow_documents").doc(y).get().then(function(C){if(!C.exists)throw new Error("SOW not found");var F=C.data(),I=F.payment?F.payment.total:0,z=F.estimatedWeeks||0,O={sowId:y,changeRequestId:d,clientName:F.clientName,clientEmail:F.clientEmail,description:b,priceAdjustment:_,timelineAdjustment:E,notes:S,previousTotal:I,newTotal:I+_,previousTimeline:z,newTimeline:z+E,status:"pending_approval",createdAt:firebase.firestore.FieldValue.serverTimestamp(),createdBy:firebase.auth().currentUser.email};return firebase.firestore().collection("change_orders").add(O)}).then(function(C){return firebase.firestore().collection("change_requests").doc(d).update({status:"change_order",changeOrderId:C.id,updatedAt:firebase.firestore.FieldValue.serverTimestamp()})}).then(function(){return firebase.firestore().collection("sow_documents").doc(y).update({changeRequestStatus:"change_order",hasChangeOrder:!0})}).then(function(){document.getElementById("changeOrderModal").remove(),alert(t("changeOrder.msg.success")),w.loadSOWDocuments()}).catch(function(C){console.error("Error creating change order:",C),alert(t("contract.err.prefix")+C.message)})},A.prototype.editSOWFromChangeRequest=function(d){var y=this,w=document.getElementById("changeRequestDetailModal");w&&w.remove(),firebase.firestore().collection("sow_documents").doc(d).get().then(function(b){if(b.exists){var _=b.data();_.id=b.id,y.editSOW(_)}}).catch(function(b){console.error("Error loading SOW:",b),alert(t("sow.err.load")+b.message)})},A.prototype.showSOWCreator=function(){var d=n("#sowCreatorContainer");if(d){var y='<div class="sow-creator-form"><div class="sow-form-header"><h4 style="display: flex; align-items: center; gap: 0.5rem;"><img src="/images/morph-logo14.png" alt="Logo" style="height: 2rem; width: auto;"> '+t("sowCreator.title")+'</h4><button class="btn-close-sow"></button></div><div class="sow-form-section client-info-section"><h5><span class="section-icon"></span> '+t("sowCreator.section.clientInfo")+'</h5><div class="sow-user-search-container"><label class="sow-search-label">'+t("sowCreator.quickSelect")+'</label><div class="sow-search-wrapper"><input type="text" id="sowUserSearch" placeholder="'+t("sowCreator.searchPlaceholder")+'" class="sow-input sow-search-input" autocomplete="off" /><div class="sow-search-icon"></div><div id="sowUserDropdown" class="sow-user-dropdown" style="display: none;"></div></div><div class="sow-search-actions"><p class="sow-search-hint">'+t("sowCreator.manualEntry")+'</p><button type="button" id="btnAddUser" class="btn-add-user">'+t("sowCreator.btn.addUser")+'</button></div><div id="addUserForm" class="add-user-form" style="display: none;"><div class="add-user-form-inner"><input type="text" id="addUserName" placeholder="'+t("sowCreator.label.displayName")+'" class="sow-input" /><div class="add-user-auth-section"><div class="add-user-auth-row"><input type="email" id="addUserEmail" placeholder="'+t("sowCreator.label.email")+'" class="sow-input" oninput="window.toggleAuthFields()" /><input type="password" id="addUserPassword" placeholder="'+t("sowCreator.label.password")+'" class="sow-input" style="display: none;" /></div><div class="add-user-auth-divider"><span>'+t("sowCreator.label.or")+'</span></div><div class="add-user-auth-row"><div class="phone-input-wrapper sow-phone-wrapper"><select id="addUserPhoneCountryCode" class="country-code-select sow-country-code"><option value="+1" selected>US +1</option><option value="+1">CA +1</option><option value="+44">UK +44</option><option value="+91">IN +91</option><option value="+61">AU +61</option><option value="+81">JP +81</option><option value="+49">DE +49</option><option value="+33">FR +33</option><option value="+86">CN +86</option><option value="+52">MX +52</option><option value="+55">BR +55</option></select><input type="tel" id="addUserPhone" placeholder="'+t("sowCreator.label.phone")+'" class="sow-input" oninput="window.toggleAuthFields()" /></div><input type="text" id="addUserCode" placeholder="'+t("sowCreator.label.verificationCode")+'" class="sow-input" style="display: none;" maxlength="6" /></div></div><div class="add-user-buttons"><button type="button" id="btnSaveUser" class="btn-save-user">'+t("sowCreator.btn.saveUser")+'</button><button type="button" id="btnCancelAddUser" class="btn-cancel-add-user">'+t("sowCreator.btn.cancel")+'</button></div></div></div></div><div class="toggles-row"><div class="client-id-toggle"><span class="toggle-label" id="emailToggleLabel">'+t("sowCreator.toggle.email")+'</span><label class="toggle-switch"><input type="checkbox" id="clientIdTypeToggle" /><span class="toggle-slider"></span></label><span class="toggle-label" id="phoneToggleLabel">'+t("sowCreator.toggle.phone")+'</span></div><div class="entity-type-toggle"><span class="toggle-label active" id="sowIndividualLabel">'+t("sowCreator.toggle.individual")+'</span><label class="toggle-switch"><input type="checkbox" id="sowEntityTypeToggle" /><span class="toggle-slider"></span></label><span class="toggle-label" id="sowBusinessLabel">'+t("sowCreator.toggle.business")+'</span></div></div><div id="sowIndividualFields"><div class="sow-input-group client-inputs-row"><input type="text" id="sowClientName" placeholder="'+t("sowCreator.label.clientName")+'" class="sow-input" required /><div id="sowClientEmailWrapper" class="sow-input-wrapper-single"><input type="email" id="sowClientEmail" placeholder="'+t("sowCreator.label.clientEmail")+'" class="sow-input" /></div><div id="sowClientPhoneWrapper" class="phone-input-wrapper sow-phone-wrapper" style="display: none;"><select id="sowClientPhoneCountryCode" class="country-code-select sow-country-code"><option value="+1" selected>US +1</option><option value="+1">CA +1</option><option value="+44">UK +44</option><option value="+91">IN +91</option><option value="+61">AU +61</option><option value="+81">JP +81</option><option value="+49">DE +49</option><option value="+33">FR +33</option><option value="+86">CN +86</option><option value="+52">MX +52</option><option value="+55">BR +55</option></select><input type="tel" id="sowClientPhone" placeholder="'+t("sowCreator.label.clientPhone")+'" class="sow-input" /></div></div></div><div id="sowBusinessFields" style="display: none;"><div class="sow-input-group"><input type="text" id="sowBusinessName" placeholder="'+t("sowCreator.label.businessName")+'" class="sow-input" /><select id="sowEntityType" class="sow-select" style="flex: 1;"><option value="">'+t("sowCreator.label.entityType")+'</option><option value="LLC">'+t("sowCreator.entity.llc")+'</option><option value="Corporation">'+t("sowCreator.entity.corp")+'</option><option value="Partnership">'+t("sowCreator.entity.partnership")+'</option><option value="Sole Proprietorship">'+t("sowCreator.entity.sole")+'</option></select></div><div class="sow-input-group"><input type="text" id="sowStateOfFormation" placeholder="'+t("sowCreator.label.stateFormation")+'" class="sow-input" /><div id="sowBusinessEmailWrapper" class="sow-input-wrapper-single"><input type="email" id="sowBusinessEmail" placeholder="'+t("sowCreator.label.businessEmail")+'" class="sow-input" /></div><div id="sowBusinessPhoneWrapper" class="phone-input-wrapper sow-phone-wrapper" style="display: none;"><select id="sowBusinessPhoneCountryCode" class="country-code-select sow-country-code"><option value="+1" selected>US +1</option><option value="+1">CA +1</option><option value="+44">UK +44</option><option value="+91">IN +91</option><option value="+61">AU +61</option><option value="+81">JP +81</option><option value="+49">DE +49</option><option value="+33">FR +33</option><option value="+86">CN +86</option><option value="+52">MX +52</option><option value="+55">BR +55</option></select><input type="tel" id="sowBusinessPhone" placeholder="'+t("sowCreator.label.businessPhone")+'" class="sow-input" /></div></div><div class="sow-input-group"><input type="text" id="sowRepName" placeholder="'+t("sowCreator.label.repName")+'" class="sow-input" /><input type="text" id="sowRepTitle" placeholder="'+t("sowCreator.label.repTitle")+'" class="sow-input" /></div></div></div><div class="sow-form-section"><h5><span class="section-icon"></span> '+t("sowCreator.section.package")+'</h5><select id="sowPackage" class="sow-select" onchange="setTimeout(syncDeferredWithTotal, 50)"><option value="">'+t("sowCreator.pkg.select")+'</option><option value="essential">'+t("sowCreator.pkg.essential")+'</option><option value="starter">'+t("sowCreator.pkg.tier1")+'</option><option value="growth">'+t("sowCreator.pkg.tier2")+'</option><option value="professional">'+t("sowCreator.pkg.tier3")+'</option><option value="enterprise">'+t("sowCreator.pkg.tier4")+'</option><option value="custom">'+t("sowCreator.pkg.custom")+'</option></select><div id="customPricingSection" style="display: none; margin-top: 15px;"><input type="number" id="sowCustomPrice" placeholder="Enter custom total price" class="sow-input" step="0.01" min="0" oninput="setTimeout(syncDeferredWithTotal, 50)" /></div></div><div class="sow-form-section"><h5><span class="section-icon"></span> '+t("sowCreator.section.timeline")+'</h5><label class="sow-checkbox retroactive-toggle" style="margin-bottom: 10px; padding: 8px 12px; background: rgba(245, 158, 11, 0.1); border-radius: 6px; border: 1px solid rgba(245, 158, 11, 0.3);"><input type="checkbox" id="sowRetroactive" onchange="toggleRetroactiveFields()" /><span style="color: #f59e0b; font-weight: 500;">'+t("sowCreator.timeline.retroactive")+'</span><span style="font-size: 0.8em; color: #888; margin-left: 8px;">'+t("sowCreator.timeline.retroactiveDesc")+'</span></label><div class="sow-input-group"><input type="number" id="sowWeeks" placeholder="'+t("sowCreator.timeline.estWeeks")+'" class="sow-input" min="1" max="52" required /><input type="date" id="sowStartDate" class="sow-input" title="'+t("sowCreator.timeline.targetDate")+'" /></div><div id="retroactiveDurationFields" style="display: none; margin-top: 10px; padding: 10px; background: rgba(245, 158, 11, 0.05); border-radius: 6px; border: 1px dashed rgba(245, 158, 11, 0.3);"><label style="font-size: 0.85em; color: #f59e0b; margin-bottom: 5px; display: block;">'+t("sowCreator.timeline.devDuration")+'</label><div class="sow-input-group"><input type="number" id="sowDevDuration" placeholder="'+t("sowCreator.timeline.duration")+'" class="sow-input" min="1" max="52" style="flex: 1;" /><select id="sowDevDurationUnit" class="sow-input" style="flex: 1;"><option value="weeks">'+t("sowCreator.timeline.weeks")+'</option><option value="months">'+t("sowCreator.timeline.months")+'</option></select></div><label style="font-size: 0.85em; color: #f59e0b; margin-bottom: 5px; margin-top: 10px; display: block;">'+t("sowCreator.timeline.estFinalRevision")+'</label><input type="date" id="sowRetroactiveEndDate" class="sow-input" title="'+t("sowCreator.timeline.estFinalRevisionDate")+'" /></div></div><div class="sow-form-section"><h5><span class="section-icon"></span> '+t("sowCreator.section.features")+'</h5><div class="sow-checkboxes"><div class="feature-group"><p class="feature-group-title">'+t("sowCreator.features.standard")+'</p><label class="sow-checkbox"><input type="checkbox" value="responsive_design" /> '+t("sowCreator.features.crossDevice")+'</label><label class="sow-checkbox"><input type="checkbox" value="custom_ui" /> '+t("sowCreator.features.brandDesign")+'</label><label class="sow-checkbox"><input type="checkbox" value="animations" /> '+t("sowCreator.features.scrollInteractions")+'</label><label class="sow-checkbox"><input type="checkbox" value="seo_optimization" /> '+t("sowCreator.features.seoSetup")+'</label><label class="sow-checkbox"><input type="checkbox" value="analytics" /> '+t("sowCreator.features.ga4")+'</label><label class="sow-checkbox"><input type="checkbox" value="contact_forms" /> '+t("sowCreator.features.contactForms")+'</label></div><div class="feature-group"><p class="feature-group-title">'+t("sowCreator.features.premium")+'</p><label class="sow-checkbox"><input type="checkbox" value="firebase_auth" /> '+t("sowCreator.features.authSystem")+' <span class="third-party-note">'+t("sowCreator.features.firebaseCosts")+'</span></label><label class="sow-checkbox"><input type="checkbox" value="firebase_db" /> '+t("sowCreator.features.database")+' <span class="third-party-note">'+t("sowCreator.features.firebaseCosts")+'</span></label><label class="sow-checkbox"><input type="checkbox" value="user_profiles" /> '+t("sowCreator.features.clientPortal")+'</label><label class="sow-checkbox"><input type="checkbox" value="file_storage" /> '+t("sowCreator.features.mediaUpload")+' <span class="third-party-note">'+t("sowCreator.features.firebaseCosts")+'</span></label><label class="sow-checkbox"><input type="checkbox" value="api_integration" /> '+t("sowCreator.features.thirdParty")+'</label><label class="sow-checkbox"><input type="checkbox" value="email_integration" /> '+t("sowCreator.features.emailNotif")+' <span class="third-party-note">'+t("sowCreator.features.sendgridCosts")+'</span></label><label class="sow-checkbox"><input type="checkbox" value="music_media" /> '+t("sowCreator.features.audioVideo")+'</label><label class="sow-checkbox"><input type="checkbox" value="booking_basic" /> '+t("sowCreator.features.scheduling")+'</label><label class="sow-checkbox"><input type="checkbox" value="newsletter" /> '+t("sowCreator.features.newsletter")+'</label><label class="sow-checkbox"><input type="checkbox" value="social_feed" /> '+t("sowCreator.features.socialMedia")+'</label></div><div class="feature-group"><p class="feature-group-title">'+t("sowCreator.features.enterprise")+'</p><label class="sow-checkbox"><input type="checkbox" value="user_roles" /> '+t("sowCreator.features.rbac")+'</label><label class="sow-checkbox"><input type="checkbox" value="cms_integration" /> '+t("sowCreator.features.cms")+'</label><label class="sow-checkbox"><input type="checkbox" value="booking_system" /> '+t("sowCreator.features.advBooking")+'</label><label class="sow-checkbox"><input type="checkbox" value="blog" /> '+t("sowCreator.features.blog")+'</label><label class="sow-checkbox"><input type="checkbox" value="gallery" /> '+t("sowCreator.features.gallery")+'</label><label class="sow-checkbox"><input type="checkbox" value="notifications" /> '+t("sowCreator.features.inAppNotif")+'</label></div><div class="feature-group"><p class="feature-group-title">'+t("sowCreator.features.ecommerce")+'</p><div class="ecommerce-radio-group"><label class="sow-radio"><input type="radio" name="ecommerce_option" value="none" checked /> '+t("sowCreator.features.noEcommerce")+'</label><label class="sow-radio"><input type="radio" name="ecommerce_option" value="basic_cart" /> '+t("sowCreator.features.basicEcommerce")+' <span class="third-party-note">'+t("sowCreator.features.stripeCosts")+'</span></label><label class="sow-radio"><input type="radio" name="ecommerce_option" value="full_store" /> '+t("sowCreator.features.fullEcommerce")+' <span class="third-party-note">'+t("sowCreator.features.stripeCosts")+'</span></label></div></div></div></div><div class="sow-form-section"><h5><span class="section-icon"></span> '+t("sowCreator.section.additionalReqs")+'</h5><textarea id="sowNotes" placeholder="'+t("sowCreator.additionalReqs.placeholder")+'" class="sow-textarea" rows="4"></textarea></div><div class="sow-form-section"><h5><span class="section-icon"></span> '+t("sowCreator.section.maintenance")+'</h5><select id="sowMaintenance" class="sow-select" required><option value="">'+t("sowCreator.maint.select")+'</option><option value="none">'+t("sowCreator.maint.none")+'</option><option value="basic" selected>'+t("sowCreator.maint.basic")+'</option><option value="professional">'+t("sowCreator.maint.professional")+'</option><option value="premium">'+t("sowCreator.maint.premium")+'</option></select></div><div class="sow-form-section" id="deferredPaymentSection"><h5><span class="section-icon"></span> '+t("sowCreator.section.deferred")+'</h5><label class="sow-checkbox deferred-toggle" style="margin-bottom: 10px; padding: 8px 12px; background: rgba(99, 102, 241, 0.1); border-radius: 6px; border: 1px solid rgba(99, 102, 241, 0.3);"><input type="checkbox" id="sowDeferredPayment" onchange="toggleDeferredPaymentFields()" /><span style="color: #6366f1; font-weight: 500;">'+t("sowCreator.deferred.enable")+'</span><span style="font-size: 0.8em; color: #888; margin-left: 8px;">'+t("sowCreator.deferred.enableDesc")+'</span></label><div id="deferredPaymentFields" style="display: none; margin-top: 10px; padding: 15px; background: rgba(99, 102, 241, 0.05); border-radius: 8px; border: 1px dashed rgba(99, 102, 241, 0.3);"><div class="deferred-split-type"><label style="font-size: 0.9em; color: #94a3b8; margin-bottom: 8px; display: block;">'+t("sowCreator.deferred.paymentType")+'</label><div class="deferred-radio-group" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;"><label class="sow-radio deferred-type-card" style="display: flex; flex-direction: column; align-items: center; gap: 6px; padding: 12px 8px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;"><input type="radio" name="deferred_split" value="lump_sum" checked onchange="toggleDeferredSplitType()" style="display: none;" /><span style="font-size: 1.5em;"></span><span style="font-weight: 500; font-size: 0.85em;">'+t("sowCreator.deferred.lumpSum")+'</span><span style="font-size: 0.7em; color: #94a3b8; text-align: center;">'+t("sowCreator.deferred.lumpSumDesc")+'</span></label><label class="sow-radio deferred-type-card" style="display: flex; flex-direction: column; align-items: center; gap: 6px; padding: 12px 8px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;"><input type="radio" name="deferred_split" value="recurring" onchange="toggleDeferredSplitType()" style="display: none;" /><span style="font-size: 1.5em;"></span><span style="font-weight: 500; font-size: 0.85em;">'+t("sowCreator.deferred.paymentPlan")+'</span><span style="font-size: 0.7em; color: #94a3b8; text-align: center;">'+t("sowCreator.deferred.paymentPlanDesc")+'</span></label><label class="sow-radio deferred-type-card" style="display: flex; flex-direction: column; align-items: center; gap: 6px; padding: 12px 8px; background: rgba(255, 255, 255, 0.03); border-radius: 8px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s;"><input type="radio" name="deferred_split" value="custom" onchange="toggleDeferredSplitType()" style="display: none;" /><span style="font-size: 1.5em;"></span><span style="font-weight: 500; font-size: 0.85em;">'+t("sowCreator.deferred.custom")+'</span><span style="font-size: 0.7em; color: #94a3b8; text-align: center;">'+t("sowCreator.deferred.customDesc")+'</span></label></div></div><div id="lumpSumFields" style="margin-top: 15px;"><div class="sow-input-group" style="display: flex; gap: 10px;"><div style="flex: 1;"><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+t("sowCreator.deferred.amountToDefer")+'</label><input type="number" id="sowDeferredAmount" placeholder="'+t("sowCreator.deferred.amountLabel")+'" class="sow-input" min="0" step="0.01" onchange="calculateLateFee()" oninput="calculateLateFee()" /></div><div style="flex: 1;"><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+t("sowCreator.deferred.dueDate")+'</label><input type="date" id="sowDeferredDueDate" class="sow-input" /></div></div></div><div id="recurringFields" style="display: none; margin-top: 15px;"><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;"><div><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+t("sowCreator.deferred.totalAmount")+'</label><input type="number" id="sowRecurringTotalAmount" placeholder="'+t("sowCreator.deferred.totalLabel")+'" class="sow-input" min="0" step="0.01" onchange="updateRecurringSchedule()" oninput="updateRecurringSchedule()" /></div><div><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+t("sowCreator.deferred.firstPayment")+'</label><input type="date" id="sowRecurringStartDate" class="sow-input" onchange="updateRecurringSchedule()" /></div></div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;"><div><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+t("sowCreator.deferred.frequency")+'</label><select id="sowRecurringFrequency" class="sow-select" onchange="updateRecurringSchedule()" style="width: 100%; padding: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: #fff;"><option value="weekly">'+t("sowCreator.deferred.weekly")+'</option><option value="biweekly" selected>'+t("sowCreator.deferred.biweekly")+'</option><option value="semimonthly">'+t("sowCreator.deferred.semimonthly")+'</option><option value="monthly">'+t("sowCreator.deferred.monthly")+'</option><option value="bimonthly">'+t("sowCreator.deferred.bimonthly")+'</option></select></div><div><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+t("sowCreator.deferred.calculateBy")+'</label><select id="sowRecurringCalcMode" class="sow-select" onchange="toggleRecurringCalcMode(); updateRecurringSchedule();" style="width: 100%; padding: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; color: #fff;"><option value="amount">'+t("sowCreator.deferred.fixedAmount")+'</option><option value="count">'+t("sowCreator.deferred.numPayments")+'</option></select></div></div><div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 15px;"><div id="recurringAmountField"><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+t("sowCreator.deferred.amountPerPayment")+'</label><input type="number" id="sowRecurringPaymentAmount" placeholder="'+t("sowCreator.deferred.amountPerPaymentPlaceholder")+'" class="sow-input" min="1" step="0.01" onchange="updateRecurringSchedule()" oninput="updateRecurringSchedule()" /></div><div id="recurringCountField" style="display: none;"><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+t("sowCreator.deferred.numPayments")+'</label><input type="number" id="sowRecurringPaymentCount" placeholder="'+t("sowCreator.deferred.numPaymentsPlaceholder")+'" class="sow-input" min="2" max="52" onchange="updateRecurringSchedule()" oninput="updateRecurringSchedule()" /></div><div id="recurringCalcResult" style="display: flex; align-items: flex-end;"><div style="padding: 10px 14px; background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 6px; width: 100%;"><span style="font-size: 0.75em; color: #10b981; display: block;">'+t("sowCreator.deferred.calculated")+'</span><span id="recurringCalcDisplay" style="font-size: 1.1em; font-weight: 600; color: #10b981;">--</span></div></div></div><div id="recurringSchedulePreview" style="display: none; background: rgba(99, 102, 241, 0.05); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 8px; padding: 12px; max-height: 200px; overflow-y: auto;"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;"><span style="font-size: 0.85em; font-weight: 500; color: #6366f1;">'+t("sowCreator.deferred.schedulePreview")+'</span><span id="recurringScheduleSummary" style="font-size: 0.75em; color: #94a3b8;"></span></div><div id="recurringScheduleList" style="display: grid; gap: 6px;"></div></div></div><div id="customSplitFields" style="display: none; margin-top: 15px;"><label style="font-size: 0.85em; color: #6366f1; margin-bottom: 5px; display: block;">'+t("sowCreator.deferred.customSchedule")+'</label><div id="customPaymentsList" class="custom-payments-list"></div><button type="button" class="btn-add-payment" onclick="addCustomPaymentRow()" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 8px 16px; background: rgba(99, 102, 241, 0.15); border: 1px dashed rgba(99, 102, 241, 0.4); border-radius: 6px; color: #818cf8; cursor: pointer; font-size: 0.9em;"><span>'+t("sowCreator.deferred.addPayment")+'</span></button></div><div class="late-fee-section" style="margin-top: 15px; padding: 12px; background: rgba(245, 158, 11, 0.08); border-radius: 6px; border: 1px solid rgba(245, 158, 11, 0.2);"><div style="display: flex; justify-content: space-between; align-items: center;"><div><span style="color: #f59e0b; font-weight: 500;">'+t("sowCreator.deferred.lateFee")+'</span><span id="lateFeeDisplay" style="color: #fff; margin-left: 8px;">$0</span><span style="font-size: 0.75em; color: #94a3b8; margin-left: 6px;">'+t("sowCreator.deferred.lateFeeDesc")+'</span></div><label class="sow-checkbox" style="margin: 0; display: flex; align-items: center; gap: 6px;"><input type="checkbox" id="sowWaiveLateFee" onchange="calculateLateFee()" /><span style="font-size: 0.85em; color: #f59e0b;">'+t("sowCreator.deferred.waiveLateFee")+'</span></label></div><div style="margin-top: 8px;"><span style="color: #94a3b8; font-size: 0.85em;">'+t("sowCreator.deferred.totalDeferred")+'</span><span id="totalDeferredDisplay" style="color: #10b981; font-weight: 600; margin-left: 8px;">$0</span></div></div><div class="deferred-options" style="margin-top: 15px;"><label class="sow-checkbox" style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;"><input type="checkbox" id="sowAllowPartialPayments" checked /><span>'+t("sowCreator.deferred.allowPartial")+'</span></label><label class="sow-checkbox" style="display: flex; align-items: center; gap: 8px;"><input type="checkbox" id="sowMaintenanceDuringDeferral" checked /><span>'+t("sowCreator.deferred.maintDuringDeferral")+'</span></label></div></div></div><div class="sow-form-section coupon-section"><h5><span class="section-icon"></span> '+t("sowCreator.section.discount")+'</h5><div class="coupon-input-group"><select id="sowCouponSelect" class="sow-select coupon-select" onchange="setTimeout(syncDeferredWithTotal, 50)"><option value="">'+t("sowCreator.discount.noDiscount")+'</option></select><div id="couponValidationMessage" class="coupon-validation-message"></div></div></div><div class="sow-form-section pricing-summary"><h5><span class="section-icon"></span> '+t("sowCreator.section.pricing")+'</h5><div class="pricing-itemized-container"><div id="pricingItemizedList" class="pricing-itemized-list"></div></div><div class="pricing-breakdown"><div class="pricing-divider"></div><div class="pricing-row total-row"><span><strong>'+t("sowCreator.pricing.projectTotal")+'</strong></span><span id="sowTotalPrice" class="price-value total-value">$0.00</span></div><div class="pricing-row deposit-row"><span>'+t("sowCreator.pricing.deposit")+'</span><span id="sowDepositCalc" class="price-value">$0.00</span></div><div class="pricing-row"><span>'+t("sowCreator.pricing.milestone")+'</span><span id="sowMilestone1Calc" class="price-value">$0.00</span></div><div class="pricing-row"><span>'+t("sowCreator.pricing.finalPayment")+'</span><span id="sowFinalCalc" class="price-value">$0.00</span></div><div class="pricing-divider"></div><div class="pricing-row maintenance-row" id="maintenanceRow"><span>'+t("sowCreator.pricing.monthlyMaint")+'</span><span id="sowMaintenanceCalc" class="price-value">$167/month</span></div></div></div><div class="sow-form-actions"><button class="btn-cancel-sow btn-secondary">'+t("sowCreator.btn.cancelSow")+'</button><button class="btn-save-sow btn-primary"><span class="btn-icon"></span> '+t("sowCreator.btn.saveSow")+'</button><button class="btn-generate-sow-pdf btn-primary"><span class="btn-icon"></span> '+t("sowCreator.btn.generatePdf")+"</button></div></div>";d.innerHTML=y,d.style.display="block";var w=this,b={essential:{min:1e3,max:3e3,default:2e3},starter:{min:3e3,max:6e3,default:4500},growth:{min:6e3,max:12e3,default:9e3},professional:{min:12e3,max:25e3,default:18500},enterprise:{min:25e3,max:5e4,default:37500}},_={none:0,basic:167,professional:335,premium:670},E={responsive_design:{default:200,thirdParty:!1},custom_ui:{default:450,thirdParty:!1},animations:{default:275,thirdParty:!1},seo_optimization:{default:200,thirdParty:!1},analytics:{default:175,thirdParty:!1},contact_forms:{default:250,thirdParty:!1},firebase_auth:{default:350,thirdParty:!0,note:"Firebase costs"},firebase_db:{default:425,thirdParty:!0,note:"Firebase costs"},user_profiles:{default:550,thirdParty:!1},file_storage:{default:300,thirdParty:!0,note:"Firebase costs"},api_integration:{default:450,thirdParty:!1},email_integration:{default:325,thirdParty:!0,note:"SendGrid costs"},newsletter:{default:200,thirdParty:!1,addon:!0},user_roles:{default:450,thirdParty:!1},notifications:{default:400,thirdParty:!1},booking_basic:{default:450,thirdParty:!1,addon:!0},booking_system:{default:1100,thirdParty:!1,addon:!0},blog:{default:400,thirdParty:!1,addon:!0},cms_integration:{default:600,thirdParty:!1,addon:!0},gallery:{default:325,thirdParty:!1,addon:!0},music_media:{default:275,thirdParty:!1,addon:!0},social_feed:{default:250,thirdParty:!1,addon:!0}},S={none:{price:0,label:t("ecommerce.none")},basic_cart:{price:5500,label:t("ecommerce.basicCart"),thirdParty:!0,note:"Stripe fees"},full_store:{price:14e3,label:t("ecommerce.fullStore"),thirdParty:!0,note:"Stripe fees"}},C={essential:["responsive_design","contact_forms"],starter:["responsive_design","custom_ui","animations","seo_optimization","analytics","contact_forms"],growth:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","contact_forms"],professional:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","firebase_db","user_profiles","file_storage","api_integration","contact_forms","email_integration","newsletter"],enterprise:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","firebase_db","user_profiles","user_roles","file_storage","api_integration","contact_forms","email_integration","notifications","newsletter"],custom:[]},F=function(){w.updateSOWPricing(b,_,E,S,C)},I=n("#sowPackage"),z=n("#customPricingSection"),O=n("#sowCustomPrice");I&&I.addEventListener("change",function(){this.value==="custom"?(z.style.display="block",w.autoCheckPackageFeatures("custom",C)):(z.style.display="none",w.autoCheckPackageFeatures(this.value,C)),F()}),O&&O.addEventListener("input",function(){F()});var q=n("#sowMaintenance");q&&q.addEventListener("change",function(){F()});var V=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]');V.forEach(function(ue){ue.addEventListener("change",function(){F()})});var X=document.querySelectorAll('input[name="ecommerce_option"]');X.forEach(function(ue){ue.addEventListener("change",function(){F()})}),window.toggleRetroactiveFields=function(){var ue=n("#sowRetroactive"),fe=n("#retroactiveDurationFields"),Oe=n("#sowWeeks"),Re=Oe?Oe.parentElement:null;ue&&ue.checked?(fe&&(fe.style.display="block"),Re&&(Re.style.display="none")):(fe&&(fe.style.display="none"),Re&&(Re.style.display="flex"));var Te=document.querySelector(".deposit-row"),Me=n("#sowMilestone1Calc"),Se=n("#sowFinalCalc");ue&&ue.checked?(Te&&(Te.style.display="none"),Me&&Me.parentElement&&(Me.parentElement.style.display="none"),Se&&Se.parentElement&&(Se.parentElement.style.display="none")):(Te&&(Te.style.display="flex"),Me&&Me.parentElement&&(Me.parentElement.style.display="flex"),Se&&Se.parentElement&&(Se.parentElement.style.display="flex"))},window.toggleDeferredPaymentFields=function(){var ue=n("#sowDeferredPayment"),fe=n("#deferredPaymentFields");if(ue&&ue.checked){fe&&(fe.style.display="block");var Oe=n("#sowTotalPrice");if(Oe){var Re=parseFloat(Oe.textContent.replace(/[^0-9.-]/g,""))||0,Te=n("#sowDeferredAmount"),Me=n("#sowRecurringTotalAmount");Te&&!Te.value&&(Te.value=Re),Me&&!Me.value&&(Me.value=Re)}var Se=document.querySelectorAll(".deferred-type-card");Se.forEach(function(it){var Ge=it.querySelector('input[type="radio"]');Ge&&Ge.checked?(it.style.borderColor="#6366f1",it.style.background="rgba(99, 102, 241, 0.15)"):(it.style.borderColor="transparent",it.style.background="rgba(255, 255, 255, 0.03)")}),calculateLateFee()}else fe&&(fe.style.display="none")},window.toggleDeferredSplitType=function(){var ue=document.querySelector('input[name="deferred_split"]:checked'),fe=n("#lumpSumFields"),Oe=n("#recurringFields"),Re=n("#customSplitFields"),Te=document.querySelectorAll(".deferred-type-card");if(Te.forEach(function(rt){var dn=rt.querySelector('input[type="radio"]');dn&&dn.checked?(rt.style.borderColor="#6366f1",rt.style.background="rgba(99, 102, 241, 0.15)"):(rt.style.borderColor="transparent",rt.style.background="rgba(255, 255, 255, 0.03)")}),fe&&(fe.style.display="none"),Oe&&(Oe.style.display="none"),Re&&(Re.style.display="none"),ue){if(ue.value==="lump_sum")fe&&(fe.style.display="block");else if(ue.value==="recurring"){Oe&&(Oe.style.display="block");var Me=n("#sowTotalPrice"),Se=n("#sowRecurringTotalAmount");if(Me&&Se&&!Se.value){var it=parseFloat(Me.textContent.replace(/[^0-9.-]/g,""))||0;Se.value=it}updateRecurringSchedule()}else if(ue.value==="custom"){Re&&(Re.style.display="block");var Ge=n("#customPaymentsList");Ge&&Ge.children.length===0&&addCustomPaymentRow()}}calculateLateFee()},window.toggleRecurringCalcMode=function(){var ue=n("#sowRecurringCalcMode"),fe=n("#recurringAmountField"),Oe=n("#recurringCountField");ue&&ue.value==="count"?(fe&&(fe.style.display="none"),Oe&&(Oe.style.display="block")):(fe&&(fe.style.display="block"),Oe&&(Oe.style.display="none"))},window.generateRecurringSchedule=function(ue,fe,Oe,Re,Te){var Me=[];if(!ue||ue<=0||!fe)return Me;var Se=new Date(fe),it=ue,Ge,rt;if(Re==="amount"){if(Ge=parseFloat(Te)||0,Ge<=0)return Me;rt=Math.ceil(ue/Ge)}else{if(rt=parseInt(Te)||0,rt<=0)return Me;Ge=Math.ceil(ue/rt)}rt>52&&(rt=52);for(var dn=0;dn<rt;dn++){var pi=Math.min(Ge,it);if(pi<=0)break;switch(Me.push({amount:pi,dueDate:Se.toISOString().split("T")[0]}),it-=pi,Oe){case"weekly":Se.setDate(Se.getDate()+7);break;case"biweekly":Se.setDate(Se.getDate()+14);break;case"semimonthly":Se.getDate()<15?Se.setDate(15):(Se.setMonth(Se.getMonth()+1),Se.setDate(1));break;case"monthly":Se.setMonth(Se.getMonth()+1);break;case"bimonthly":Se.setMonth(Se.getMonth()+2);break;default:Se.setDate(Se.getDate()+14)}}return Me},window.updateRecurringSchedule=function(){var ue=parseFloat(n("#sowRecurringTotalAmount")?n("#sowRecurringTotalAmount").value:0)||0,fe=n("#sowRecurringStartDate")?n("#sowRecurringStartDate").value:null,Oe=n("#sowRecurringFrequency")?n("#sowRecurringFrequency").value:"biweekly",Re=n("#sowRecurringCalcMode")?n("#sowRecurringCalcMode").value:"amount",Te=Re==="amount"?n("#sowRecurringPaymentAmount")?n("#sowRecurringPaymentAmount").value:0:n("#sowRecurringPaymentCount")?n("#sowRecurringPaymentCount").value:0,Me=n("#recurringCalcDisplay"),Se=n("#recurringSchedulePreview"),it=n("#recurringScheduleList"),Ge=n("#recurringScheduleSummary");if(!ue||!fe||!Te){Me&&(Me.textContent="--"),Se&&(Se.style.display="none"),calculateLateFee();return}var rt=generateRecurringSchedule(ue,fe,Oe,Re,Te);if(rt.length===0){Me&&(Me.textContent="--"),Se&&(Se.style.display="none"),calculateLateFee();return}if(Re==="amount")Me&&(Me.textContent=rt.length+" payments");else{var dn=rt.length>0?rt[0].amount:0;Me&&(Me.textContent="$"+dn.toLocaleString()+"/payment")}var pi={weekly:"Weekly",biweekly:"Bi-Weekly",semimonthly:"Semi-Monthly",monthly:"Monthly",bimonthly:"Bi-Monthly"};if(Ge){var Tr=rt[rt.length-1].dueDate;Ge.textContent=pi[Oe]+"  Final payment: "+new Date(Tr).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}if(Se&&(Se.style.display="block"),it){var je="";rt.forEach(function(vt,Er){var Un=new Date(vt.dueDate).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"});je+='<div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 10px; background: rgba(255,255,255,0.03); border-radius: 4px;"><span style="font-size: 0.8em; color: #94a3b8;">#'+(Er+1)+'</span><span style="font-size: 0.85em; color: #e2e8f0;">'+Un+'</span><span style="font-size: 0.9em; font-weight: 600; color: #10b981;">$'+vt.amount.toLocaleString()+"</span></div>"}),it.innerHTML=je}calculateLateFee()},window.syncDeferredWithTotal=function(){var ue=n("#sowDeferredPayment"),fe=n("#deferredPaymentFields"),Oe=ue&&ue.checked||fe&&fe.style.display==="block";if(Oe){var Re=document.querySelector('input[name="deferred_split"]:checked');if(!(Re&&Re.value==="custom")){var Te=n("#sowTotalPrice");if(Te){var Me=parseFloat(Te.textContent.replace(/[^0-9.-]/g,""))||0;if(Re&&Re.value==="recurring"){var Se=n("#sowRecurringTotalAmount");Se&&Me>0&&(Se.value=Me,updateRecurringSchedule())}else{var it=n("#sowDeferredAmount");it&&Me>0&&(it.value=Me,calculateLateFee())}}}}};var G=function(){var ue=n("#sowTotalPrice");if(ue){var fe=new MutationObserver(function(Oe){Oe.forEach(function(Re){(Re.type==="childList"||Re.type==="characterData")&&syncDeferredWithTotal()})});fe.observe(ue,{childList:!0,characterData:!0,subtree:!0})}};setTimeout(G,500),window.calculateLateFee=function(){var ue=document.querySelector('input[name="deferred_split"]:checked'),fe=n("#sowWaiveLateFee"),Oe=fe&&fe.checked,Re=0;if(ue&&ue.value==="custom"){var Te=document.querySelectorAll(".custom-payment-amount");Te.forEach(function(dn){Re+=parseFloat(dn.value)||0})}else if(ue&&ue.value==="recurring"){var Me=n("#sowRecurringTotalAmount");Re=parseFloat(Me?Me.value:0)||0}else{var Se=n("#sowDeferredAmount");Re=parseFloat(Se?Se.value:0)||0}var it=Oe?0:Re*.1,Ge=n("#lateFeeDisplay"),rt=n("#totalDeferredDisplay");Ge&&(Ge.textContent="$"+it.toFixed(0),Ge.style.textDecoration=Oe?"line-through":"none"),rt&&(rt.textContent="$"+Re.toFixed(0))},window.addCustomPaymentRow=function(){var ue=n("#customPaymentsList");if(ue){var fe=document.createElement("div");fe.className="custom-payment-row",fe.style.cssText="display: flex; gap: 10px; margin-bottom: 10px; align-items: center;",fe.innerHTML='<input type="number" class="sow-input custom-payment-amount" placeholder="Amount $" style="flex: 1;" onchange="calculateLateFee()" oninput="calculateLateFee()" /><input type="date" class="sow-input custom-payment-date" style="flex: 1;" /><button type="button" onclick="removeCustomPaymentRow(this)" style="padding: 8px 12px; background: rgba(239, 68, 68, 0.2); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 6px; color: #ef4444; cursor: pointer; font-size: 1em;"></button>',ue.appendChild(fe)}},window.removeCustomPaymentRow=function(ue){var fe=ue.parentElement;fe.remove(),calculateLateFee()};var j=n("#sowCouponSelect");if(j&&w.coupons){var Y=w.coupons.filter(function(ue){var fe=ue.expirationDate&&new Date(ue.expirationDate)<new Date,Oe=ue.usageLimit&&ue.usageCount>=ue.usageLimit;return ue.active!==!1&&!fe&&!Oe});Y.forEach(function(ue){var fe=ue.discountType==="percentage"?ue.discountValue+"% off":"$"+(ue.discountValue||0).toFixed(0)+" off",Oe=document.createElement("option");Oe.value=ue.code,Oe.textContent=ue.code+"  "+fe,ue.description&&(Oe.textContent+=" ("+ue.description+")"),j.appendChild(Oe)}),j.addEventListener("change",function(){F()})}var ie=n("#sowWeeks"),ae=n("#sowStartDate");ie&&ie.addEventListener("input",function(){var ue=parseInt(this.value);if(ue&&ue>0&&ae){var fe=new Date;fe.setDate(fe.getDate()+ue*7),ae.value=fe.toISOString().split("T")[0]}}),ae&&ae.addEventListener("change",function(){var ue=new Date(this.value),fe=new Date;if(fe.setHours(0,0,0,0),ue&&ue>fe&&ie){var Oe=ue-fe,Re=Oe/(1e3*60*60*24),Te=Math.round(Re/7);ie.value=Math.max(1,Math.min(52,Te))}});var le=n(".btn-close-sow");le&&le.addEventListener("click",function(){d.style.display="none"});var pe=n(".btn-cancel-sow");pe&&pe.addEventListener("click",function(){d.style.display="none"});var _e=n("#clientIdTypeToggle"),oe=n("#sowClientEmail"),be=n("#sowClientPhone"),Ie=n("#sowClientEmailWrapper"),We=n("#sowClientPhoneWrapper"),qe=n("#emailToggleLabel"),tt=n("#phoneToggleLabel");_e&&(_e.addEventListener("change",function(){this.checked?(Ie&&(Ie.style.display="none"),oe&&(oe.value=""),We&&(We.style.display="flex"),qe.classList.remove("active"),tt.classList.add("active")):(We&&(We.style.display="none"),be&&(be.value=""),Ie&&(Ie.style.display="block"),tt.classList.remove("active"),qe.classList.add("active"))}),qe.classList.add("active"));var Ke=n("#sowEntityTypeToggle"),at=n("#sowIndividualFields"),Ye=n("#sowBusinessFields"),ot=n("#sowIndividualLabel"),Ft=n("#sowBusinessLabel"),zt=n("#sowBusinessEmail"),De=n("#sowBusinessPhone"),Pe=n("#sowBusinessEmailWrapper"),kt=n("#sowBusinessPhoneWrapper");Ke&&(Ke.addEventListener("change",function(){this.checked?(at&&(at.style.display="none"),Ye&&(Ye.style.display="block"),ot&&ot.classList.remove("active"),Ft&&Ft.classList.add("active"),_e&&_e.checked?(Pe&&(Pe.style.display="none"),kt&&(kt.style.display="flex")):(Pe&&(Pe.style.display="block"),kt&&(kt.style.display="none"))):(Ye&&(Ye.style.display="none"),at&&(at.style.display="block"),Ft&&Ft.classList.remove("active"),ot&&ot.classList.add("active"))}),ot&&ot.classList.add("active")),_e&&_e.addEventListener("change",function(){Ke&&Ke.checked&&(this.checked?(Pe&&(Pe.style.display="none"),zt&&(zt.value=""),kt&&(kt.style.display="flex")):(kt&&(kt.style.display="none"),De&&(De.value=""),Pe&&(Pe.style.display="block")))}),De&&(De.setAttribute("maxlength","17"),De.addEventListener("input",function(){var ue=h(this.value);ue!==this.value&&(this.value=ue)})),be&&(be.setAttribute("maxlength","17"),be.addEventListener("input",function(){var ue=h(this.value);ue!==this.value&&(this.value=ue)}));var He=n("#sowUserSearch"),gt=n("#sowUserDropdown"),qt=[],Lt=null,Qe=null,Ze=null,ut=null,Ht=function(){console.log(" Starting realtime subscription for users without SOW..."),He&&(He.placeholder=t("dash.search.loading"),He.disabled=!0);var ue=function(){if(!(!Ze||!ut)){var fe=new Set,Oe=new Set;ut.forEach(function(Re){var Te=Re.data();Te.clientEmail&&fe.add(Te.clientEmail.toLowerCase().trim()),Te.clientPhone&&Oe.add(g(Te.clientPhone))}),qt=[],Ze.forEach(function(Re){var Te=Re.data(),Me=Te.email?Te.email.toLowerCase().trim():null,Se=Te.phoneNumber?g(Te.phoneNumber):null,it=Me&&fe.has(Me),Ge=Se&&Oe.has(Se);!it&&!Ge&&qt.push({uid:Te.uid,email:Te.email||null,phoneNumber:Te.phoneNumber||null,displayName:Te.displayName||null})}),He&&(He.placeholder=t("dash.search.placeholder"),He.disabled=!1),console.log("Realtime: Loaded "+qt.length+" users without SOW"),gt&&gt.style.display==="block"&&pt(He?He.value:"")}};console.log(" Subscribing to users collection..."),Lt=firebase.firestore().collection("users").onSnapshot(function(fe){console.log(" Users snapshot received:",fe.size,"users"),Ze=fe,ue()},function(fe){console.error(" Error listening to users:",fe),He&&(He.placeholder=t("dash.search.unavailable"),He.disabled=!1)}),console.log(" Subscribing to sow_documents collection..."),Qe=firebase.firestore().collection("sow_documents").onSnapshot(function(fe){console.log(" SOW documents snapshot received:",fe.size,"documents"),ut=fe,ue()},function(fe){console.error(" Error listening to SOWs:",fe)})},Kt=function(){Lt&&(Lt(),Lt=null),Qe&&(Qe(),Qe=null),Ze=null,ut=null},Ot=function(){var ue=n("#addUserEmail"),fe=n("#addUserPassword"),Oe=n("#addUserPhone"),Re=n("#addUserCode"),Te=n("#addUserPhoneCountryCode");if(ue&&fe){var Me=ue.value&&ue.value.trim().length>0;fe.style.display=Me?"block":"none",Me?fe.required=!0:(fe.required=!1,fe.value="")}if(Oe&&Re){var Se=Te?Te.value:"+1",it=p[Se]||p["+1"],Ge=Oe.value.replace(/\D/g,"").length,rt=Oe.value&&Ge>=it.maxDigits;Re.style.display=rt?"block":"none",rt?Re.required=!0:(Re.required=!1,Re.value="")}};window.toggleAuthFields=Ot;var zn=function(ue,fe,Oe,Re,Te){var Me=fe&&fe.trim(),Se=Re&&Re.trim();if(!Me&&!Se)return alert(t("dash.user.val.emailOrPhone")),Promise.reject("No email or phone provided");if(Me&&(!Oe||Oe.length<6))return alert(t("dash.user.val.passwordLength")),Promise.reject("Password too short");if(Se&&(!Te||!/^\d{4,6}$/.test(Te)))return alert(t("dash.user.val.codeFormat")),Promise.reject("Invalid verification code");console.log("Adding user via Cloud Function...");var it=firebase.functions().httpsCallable("addAuthUser");return it({displayName:ue?ue.trim():null,email:Me?fe.trim():null,password:Me?Oe:null,phoneNumber:Se?Re.trim():null,verificationCode:Se?Te:null}).then(function(Ge){return console.log("User added successfully:",Ge.data),Ge.data}).catch(function(Ge){throw console.error("Error adding user:",Ge),Ge})};window.unsubscribeFromUsers=Kt;var pt=function(ue){var fe;if(!ue||ue.length===0)fe=qt;else{var Oe=ue.toLowerCase();fe=qt.filter(function(Te){var Me=Te.displayName&&Te.displayName.toLowerCase().includes(Oe),Se=Te.email&&Te.email.toLowerCase().includes(Oe),it=Te.phoneNumber&&Te.phoneNumber.includes(Oe);return Me||Se||it})}if(fe.length===0){gt.innerHTML='<div class="sow-dropdown-empty">'+t("sowCreator.noUsersFound")+"</div>",gt.style.display="block";return}var Re=fe.slice(0,10).map(function(Te){var Me=Te.displayName||"Unknown",Se=Te.email||(Te.phoneNumber?h(Te.phoneNumber):"")||"",it=!!Te.email,Ge=!!Te.phoneNumber;return'<div class="sow-dropdown-item" data-email="'+(Te.email||"")+'" data-phone="'+(Te.phoneNumber||"")+'" data-name="'+(Te.displayName||"")+'"><span class="sow-dropdown-name">'+Me+'</span><span class="sow-dropdown-contact">'+Se+'</span><span class="sow-dropdown-badges">'+(it?'<span class="badge-email">'+t("sowCreator.badge.email")+"</span>":"")+(Ge?'<span class="badge-phone">'+t("sowCreator.badge.phone")+"</span>":"")+"</span></div>"}).join("");gt.innerHTML=Re,gt.style.display="block"},Ri=function(ue){var fe=ue.getAttribute("data-email"),Oe=ue.getAttribute("data-phone"),Re=ue.getAttribute("data-name"),Te=n("#sowClientName");if(Te&&Re&&(Te.value=Re),fe)_e.checked=!1,Ie&&(Ie.style.display="block"),We&&(We.style.display="none"),oe&&(oe.value=fe),be&&(be.value=""),qe.classList.add("active"),tt.classList.remove("active");else if(Oe){if(_e.checked=!0,We&&(We.style.display="flex"),Ie&&(Ie.style.display="none"),be){var Me=n("#sowClientPhoneCountryCode")?n("#sowClientPhoneCountryCode").value:"+1";be.value=h(Oe,Me)}oe&&(oe.value=""),tt.classList.add("active"),qe.classList.remove("active")}He.value="",gt.style.display="none"};He&&(He.addEventListener("input",function(){pt(this.value)}),He.addEventListener("focus",function(){pt(this.value)})),gt&&gt.addEventListener("click",function(ue){var fe=ue.target.closest(".sow-dropdown-item");fe&&Ri(fe)}),document.addEventListener("click",function(ue){gt&&!ue.target.closest(".sow-search-wrapper")&&(gt.style.display="none")}),Ht();var Vn=n("#btnAddUser"),fi=n("#addUserForm"),nn=n("#btnSaveUser"),_t=n("#btnCancelAddUser"),un=n("#addUserName"),$t=n("#addUserEmail"),rn=n("#addUserPassword"),wn=n("#addUserPhone"),sn=n("#addUserCode");Vn&&Vn.addEventListener("click",function(){fi.style.display="block",Vn.style.display="none",$t.focus()}),_t&&_t.addEventListener("click",function(){fi.style.display="none",Vn.style.display="inline-block",un.value="",$t.value="",rn.value="",wn.value="",sn.value="",rn.style.display="none",sn.style.display="none"}),nn&&nn.addEventListener("click",function(){var ue=un.value.trim(),fe=$t.value.trim(),Oe=rn.value,Re=wn.value.trim(),Te=sn.value.trim();nn.disabled=!0,nn.textContent=t("dash.user.btn.saving"),zn(ue,fe,Oe,Re,Te).then(function(Me){un.value="",$t.value="",rn.value="",wn.value="",sn.value="",rn.style.display="none",sn.style.display="none",fi.style.display="none",Vn.style.display="inline-block",nn.disabled=!1,nn.textContent=t("dash.user.btn.save"),alert(t("dash.user.msg.success"))}).catch(function(Me){nn.disabled=!1,nn.textContent=t("dash.user.btn.save"),Me!=="No email or phone provided"&&Me!=="Password too short"&&Me!=="Invalid verification code"&&alert(t("dash.user.err.add")+(Me.message||Me))})});var Qt=n("#addUserPhoneCountryCode");if(wn){var Cn=function(){var ue=Qt?Qt.value:"+1",fe=h(wn.value,ue);fe!==wn.value&&(wn.value=fe)};wn.addEventListener("input",Cn),Qt&&Qt.addEventListener("change",Cn)}var bn=n("#sowClientPhone"),Ce=n("#sowClientPhoneCountryCode");if(bn){var Nt=function(){var ue=Ce?Ce.value:"+1",fe=h(bn.value,ue);fe!==bn.value&&(bn.value=fe)};bn.addEventListener("input",Nt),Ce&&Ce.addEventListener("change",Nt)}var nt=n("#sowBusinessPhone"),ht=n("#sowBusinessPhoneCountryCode");if(nt){var Tn=function(){var ue=ht?ht.value:"+1",fe=h(nt.value,ue);fe!==nt.value&&(nt.value=fe)};nt.addEventListener("input",Tn),ht&&ht.addEventListener("change",Tn)}var Xi=n(".btn-save-sow");Xi&&Xi.addEventListener("click",function(){w.saveSOW()});var Xe=n(".btn-generate-sow-pdf");Xe&&Xe.addEventListener("click",function(){w.generateSOWPDF()}),U()}};function U(){var d=new URLSearchParams(window.location.search),y=d.get("business"),w=d.get("phone"),b=d.get("email"),_=d.get("package"),E=d.get("features"),S=d.get("ecommerce"),C=d.get("maintenance"),F=["essential","starter","growth","professional","enterprise","custom"],I=["responsive_design","custom_ui","animations","seo_optimization","analytics","contact_forms","firebase_auth","firebase_db","user_profiles","file_storage","api_integration","email_integration","music_media","booking_basic","newsletter","social_feed","user_roles","cms_integration","booking_system","blog","gallery","notifications"],z=["none","basic_cart","full_store"],O=["none","basic","professional","premium"];if(y){var q=document.getElementById("sowBusinessName"),V=document.getElementById("sowClientName");q&&(q.value=y),V&&(V.value=y)}if(w){var X=document.getElementById("sowClientPhone"),G=document.getElementById("sowBusinessPhone"),j=document.getElementById("addUserPhone");X&&(X.value=w),G&&(G.value=w),j&&(j.value=w)}if(b){var Y=document.getElementById("sowClientEmail"),ie=document.getElementById("sowBusinessEmail"),ae=document.getElementById("addUserEmail");Y&&(Y.value=b),ie&&(ie.value=b),ae&&(ae.value=b)}if(b||w){var le=document.getElementById("addUserForm");le&&(le.style.display="block");var pe=document.getElementById("clientIdTypeToggle"),_e=document.getElementById("sowClientEmailWrapper"),oe=document.getElementById("sowClientPhoneWrapper"),be=document.getElementById("emailToggleLabel"),Ie=document.getElementById("phoneToggleLabel");w&&!b?(pe&&(pe.checked=!0),_e&&(_e.style.display="none"),oe&&(oe.style.display="flex"),be&&be.classList.remove("active"),Ie&&Ie.classList.add("active")):b&&(pe&&(pe.checked=!1),oe&&(oe.style.display="none"),_e&&(_e.style.display="block"),Ie&&Ie.classList.remove("active"),be&&be.classList.add("active"))}if(_&&F.indexOf(_)!==-1){var We=document.getElementById("sowPackage");if(We){We.value=_;var qe=new Event("change",{bubbles:!0});We.dispatchEvent(qe)}}if(E){var tt=E.split(",").map(function(Ye){return Ye.trim().toLowerCase()});tt.forEach(function(Ye){if(I.indexOf(Ye)!==-1){var ot=document.querySelector('.sow-checkboxes input[type="checkbox"][value="'+Ye+'"]');if(ot){ot.checked=!0;var Ft=new Event("change",{bubbles:!0});ot.dispatchEvent(Ft)}}})}if(S&&z.indexOf(S)!==-1){var Ke=document.querySelector('input[name="ecommerce_option"][value="'+S+'"]');if(Ke){Ke.checked=!0;var qe=new Event("change",{bubbles:!0});Ke.dispatchEvent(qe)}}if(C&&O.indexOf(C)!==-1){var at=document.getElementById("sowMaintenance");if(at){at.value=C;var qe=new Event("change",{bubbles:!0});at.dispatchEvent(qe)}}}function Z(){var d=new URLSearchParams(window.location.search),y=d.has("business")||d.has("phone")||d.has("email")||d.has("package");y&&window.contractFormHandler&&typeof window.contractFormHandler.showSOWCreator=="function"&&(typeof window.contractFormHandler.switchTab=="function"&&window.contractFormHandler.switchTab("sow"),setTimeout(function(){window.contractFormHandler.showSOWCreator()},100))}A.prototype.calculateFeatureBasedPricing=function(d,y,w,b){var _=n("#sowPackage"),E=n("#sowCustomPrice"),S=_?_.value:"",C={basePrice:0,packageType:S,addOns:[],discounts:[],ecommerceOption:"none",ecommercePrice:0,total:0};if(!S)return C;S==="custom"?C.basePrice=parseFloat(E.value)||0:d[S]&&(C.basePrice=d[S].default);var F=b[S]||[],I=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]');I.forEach(function(V){var X=V.value,G=V.checked,j=F.indexOf(X)!==-1,Y=y[X];if(Y){var ie=V.parentElement.textContent.trim(),ae=V.parentElement.querySelector(".third-party-note");ae&&(ie=ie.replace(ae.textContent,"").trim()),G&&!j?C.addOns.push({key:X,label:ie,price:S==="custom"?0:Y.default,thirdParty:Y.thirdParty,note:Y.note||""}):!G&&j&&S!=="custom"&&C.discounts.push({key:X,label:ie,price:Math.round(Y.default*.5)})}});var z=document.querySelector('input[name="ecommerce_option"]:checked');z&&(C.ecommerceOption=z.value,w[C.ecommerceOption]&&(C.ecommercePrice=w[C.ecommerceOption].price,C.ecommercePrice>0&&C.addOns.push({key:"ecommerce_"+C.ecommerceOption,label:w[C.ecommerceOption].label,price:S==="custom"?0:C.ecommercePrice,thirdParty:w[C.ecommerceOption].thirdParty,note:w[C.ecommerceOption].note||""})));var O=C.addOns.reduce(function(V,X){return V+X.price},0),q=C.discounts.reduce(function(V,X){return V+X.price},0);return C.total=Math.max(0,C.basePrice+O-q),C},A.prototype.renderItemizedPricing=function(d,y,w){var b=document.getElementById("pricingItemizedList");if(!b){console.warn("pricingItemizedList container not found");return}var _={responsive_design:t("feature.responsive_design"),custom_ui:t("feature.custom_ui"),animations:t("feature.animations"),seo_optimization:t("feature.seo_optimization"),analytics:t("feature.analytics"),contact_forms:t("feature.contact_forms"),firebase_auth:t("feature.firebase_auth"),firebase_db:t("feature.firebase_db"),user_profiles:t("feature.user_profiles"),file_storage:t("feature.file_storage"),api_integration:t("feature.api_integration"),email_integration:t("feature.email_integration"),newsletter:t("feature.newsletter"),user_roles:t("feature.user_roles"),notifications:t("feature.notifications"),booking_basic:t("feature.booking_basic"),booking_system:t("feature.booking_system"),blog:t("feature.blog"),cms_integration:t("feature.cms_integration"),gallery:t("feature.gallery"),music_media:t("feature.music_media"),social_feed:t("feature.social_feed")},E={essential:t("pkg.essential"),starter:t("pkg.starter"),growth:t("pkg.growth"),professional:t("pkg.professional"),enterprise:t("pkg.enterprise"),custom:t("pkg.custom")},S="",C=d.packageType;if(!C){S='<div class="pricing-empty-state">'+t("pricing.selectPackage")+"</div>",b.innerHTML=S;return}var F=E[C]||C.charAt(0).toUpperCase()+C.slice(1)+" Package";S+='<div class="pricing-package-header"><span class="package-name">'+F+'</span><span class="package-price">$'+d.basePrice.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</span></div>";var I=w?w[C]||[]:[];I.length>0&&C!=="custom"&&(S+='<div class="pricing-section-header">'+t("pricing.includedInPackage")+"</div>",S+='<div class="pricing-included-features">',I.forEach(function(G){var j=_[G]||G.replace(/_/g," ").replace(/\b\w/g,function(Y){return Y.toUpperCase()});S+='<div class="pricing-feature-item included"><span class="feature-check"></span><span class="feature-name">'+j+"</span></div>"}),S+="</div>");var z=d.addOns.filter(function(G){return G.key.indexOf("ecommerce_")!==0}),O=d.addOns.find(function(G){return G.key.indexOf("ecommerce_")===0});if(z.length>0&&(S+='<div class="pricing-section-header">'+(C==="custom"?t("pricing.includedFeatures"):t("pricing.addOns"))+"</div>",z.forEach(function(G){var j=_[G.key]||G.label,Y=G.price===0?'<span class="included-badge">'+t("pricing.included")+"</span>":"+$"+G.price.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});S+='<div class="pricing-line-item add-on"><span class="item-label">'+j+(G.thirdParty?' <span class="third-party-note">+ '+G.note+"</span>":"")+'</span><span class="item-price">'+Y+"</span></div>"})),O){z.length===0&&(S+='<div class="pricing-section-header">'+(C==="custom"?t("pricing.includedFeatures"):t("pricing.addOns"))+"</div>");var q=O.price===0?'<span class="included-badge">'+t("pricing.included")+"</span>":"+$"+O.price.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});S+='<div class="pricing-line-item add-on ecommerce-item"><span class="item-label">'+O.label+(O.thirdParty?' <span class="third-party-note">+ '+O.note+"</span>":"")+'</span><span class="item-price">'+q+"</span></div>"}if(d.discounts.length>0&&(S+='<div class="pricing-section-header">'+t("pricing.removedFeatures")+"</div>",d.discounts.forEach(function(G){var j=_[G.key]||G.label;S+='<div class="pricing-line-item discount"><span class="item-label">'+j+'</span><span class="item-price discount-value">-$'+G.price.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</span></div>"})),d.coupon&&d.couponDiscount>0){var V=d.coupon,X=V.code;V.discountType==="percentage"?X+=" ("+V.discountValue+t("pricing.percentOff")+")":X+=" ($"+V.discountValue.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+t("pricing.dollarOff")+")",S+='<div class="pricing-section-header coupon-header">'+t("pricing.discountApplied")+"</div>",S+='<div class="pricing-line-item coupon-discount"><span class="item-label"><span class="coupon-icon"></span> '+X+'</span><span class="item-price coupon-value">-$'+d.couponDiscount.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</span></div>"}b.innerHTML=S},A.prototype.autoCheckPackageFeatures=function(d,y){var w=y[d]||[],b=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]');b.forEach(function(E){var S=E.value,C=w.indexOf(S)!==-1;E.checked=C;var F=E.parentElement;C?F.classList.add("feature-included"):F.classList.remove("feature-included")});var _=document.querySelector('input[name="ecommerce_option"][value="none"]');_&&(_.checked=!0)},A.prototype.updateSOWPricing=function(d,y,w,b,_){var E=n("#sowMaintenance"),S=n("#sowCouponSelect"),C=n("#couponValidationMessage"),F=this.calculateFeatureBasedPricing(d,w,b,_),I=S?S.value:"";F.coupon=null,F.couponDiscount=0;var z=F.basePrice;if(I&&this.coupons){var O=F.packageType==="custom"?F.basePrice:F.total,q=this.validateCoupon(I,F.packageType,O);q.valid?(F.coupon=q.coupon,F.couponDiscount=q.discount,F.total=Math.max(0,F.total-q.discount),F.basePrice=z,C&&(C.className="coupon-validation-message success",C.innerHTML=t("coupon.msg.discountAppliedPrefix")+q.discountDisplay+t("coupon.msg.discountAppliedSuffix"))):C&&(C.className="coupon-validation-message error",C.innerHTML=" "+q.error)}else C&&(C.className="coupon-validation-message",C.innerHTML="");this.renderItemizedPricing(F,d,_);var V=F.total,X=V*.5,G=V*.25,j=V*.25,Y=y[E.value]||0,ie=n("#sowTotalPrice"),ae=n("#sowDepositCalc"),le=n("#sowMilestone1Calc"),pe=n("#sowFinalCalc"),_e=n("#sowMaintenanceCalc"),oe=n("#maintenanceRow");ie&&(ie.textContent="$"+V.toFixed(0)),ae&&(ae.textContent="$"+X.toFixed(0)),le&&(le.textContent="$"+G.toFixed(0)),pe&&(pe.textContent="$"+j.toFixed(0)),oe&&(oe.style.display="flex"),E.value&&E.value!==""?_e&&(_e.textContent="$"+Y+"/month"):_e&&(_e.textContent="Select plan");var be=n("#sowDeferredPayment"),Ie=n("#deferredPaymentFields"),We=be&&be.checked||Ie&&Ie.style.display==="block";if(We){var qe=document.querySelector('input[name="deferred_split"]:checked');if(!qe||qe.value!=="custom"){var tt=n("#sowDeferredAmount");tt&&(tt.value=V)}calculateLateFee()}this.currentPricingData=F},A.prototype.saveSOW=function(){var d=n("#sowEntityTypeToggle")&&n("#sowEntityTypeToggle").checked,y=n("#sowClientName").value.trim(),w=n("#sowClientEmail").value.trim(),b=n("#sowClientPhone").value.trim(),_=n("#sowBusinessName")?n("#sowBusinessName").value.trim():"",E=n("#sowEntityType")?n("#sowEntityType").value:"",S=n("#sowStateOfFormation")?n("#sowStateOfFormation").value.trim():"",C=n("#sowRepName")?n("#sowRepName").value.trim():"",F=n("#sowRepTitle")?n("#sowRepTitle").value.trim():"",I=n("#sowBusinessEmail")?n("#sowBusinessEmail").value.trim():"",z=n("#sowBusinessPhone")?n("#sowBusinessPhone").value.trim():"",O=n("#sowPackage").value,q=n("#sowWeeks").value,V=n("#sowStartDate").value,X=n("#sowNotes").value.trim(),G=n("#sowMaintenance").value,j=n("#sowRetroactive")&&n("#sowRetroactive").checked,Y=n("#sowDevDuration")?n("#sowDevDuration").value:"",ie=n("#sowRetroactiveEndDate")?n("#sowRetroactiveEndDate").value:"",ae="";if(b){var le=b.replace(/\D/g,"");le.length===10?ae="+1"+le:le.length===11&&le.startsWith("1")?ae="+"+le:ae=b}var pe="";if(z){var _e=z.replace(/\D/g,"");_e.length===10?pe="+1"+_e:_e.length===11&&_e.startsWith("1")?pe="+"+_e:pe=z}var oe=[];if(d){if(_||oe.push("Business Legal Name"),E||oe.push("Entity Type"),C||oe.push("Representative Name"),F||oe.push("Representative Title"),O||oe.push("Package Tier"),j?Y||oe.push("Development Duration"):q||oe.push("Estimated Weeks"),oe.length>0){alert(t("sow.val.fillRequired")+oe.join(`
- `));return}if(!I&&!pe){alert(t("sow.val.businessEmailOrPhone"));return}}else{if(y||oe.push("Client Name"),O||oe.push("Package Tier"),j?Y||oe.push("Development Duration"):q||oe.push("Estimated Weeks"),oe.length>0){alert(t("sow.val.fillRequired")+oe.join(`
- `));return}if(!w&&!ae){alert(t("sow.val.clientEmailOrPhone"));return}}var be=[],Ie=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]:checked');Ie.forEach(function(Qe){var Ze=Qe.parentElement.textContent.trim(),ut=Qe.parentElement.querySelector(".third-party-note");ut&&(Ze=Ze.replace(ut.textContent,"").trim()),be.push(Ze)});var We=document.querySelector('input[name="ecommerce_option"]:checked'),qe=We?We.value:"none",tt=this.currentPricingData||{basePrice:0,addOns:[],discounts:[],ecommerceOption:qe,ecommercePrice:0,total:0},Ke=tt.total,at=n("#sowCouponSelect"),Ye=at?at.value:"",ot=n("#sowDevDurationUnit")?n("#sowDevDurationUnit").value:"weeks",Ft=Y&&parseInt(Y)||null,zt=n("#sowDeferredPayment")&&n("#sowDeferredPayment").checked,De={enabled:zt,splitType:"lump_sum",dueDate:null,deferredAmount:0,lateFee:0,lateFeeWaived:!1,allowPartialPayments:!0,maintenanceDuringDeferral:!0,customSchedule:[],frequency:null,startDate:null,calculationMode:null,amountPerPayment:null,numberOfPayments:null,acknowledgmentSigned:!1,acknowledgmentDate:null};if(zt){var Pe=document.querySelector('input[name="deferred_split"]:checked');if(De.splitType=Pe?Pe.value:"lump_sum",De.lateFeeWaived=n("#sowWaiveLateFee")&&n("#sowWaiveLateFee").checked,De.allowPartialPayments=n("#sowAllowPartialPayments")?n("#sowAllowPartialPayments").checked:!0,De.maintenanceDuringDeferral=n("#sowMaintenanceDuringDeferral")?n("#sowMaintenanceDuringDeferral").checked:!0,De.splitType==="custom"){var kt=[],He=document.querySelectorAll(".custom-payment-row");He.forEach(function(Qe){var Ze=Qe.querySelector(".custom-payment-amount"),ut=Qe.querySelector(".custom-payment-date"),Ht=parseFloat(Ze?Ze.value:0)||0,Kt=ut?ut.value:null;Ht>0&&kt.push({amount:Ht,dueDate:Kt})}),De.customSchedule=kt,De.deferredAmount=kt.reduce(function(Qe,Ze){return Qe+Ze.amount},0)}else if(De.splitType==="recurring"){De.deferredAmount=parseFloat(n("#sowRecurringTotalAmount")?n("#sowRecurringTotalAmount").value:0)||0,De.startDate=n("#sowRecurringStartDate")?n("#sowRecurringStartDate").value:null,De.frequency=n("#sowRecurringFrequency")?n("#sowRecurringFrequency").value:"biweekly",De.calculationMode=n("#sowRecurringCalcMode")?n("#sowRecurringCalcMode").value:"amount",De.calculationMode==="amount"?De.amountPerPayment=parseFloat(n("#sowRecurringPaymentAmount")?n("#sowRecurringPaymentAmount").value:0)||0:De.numberOfPayments=parseInt(n("#sowRecurringPaymentCount")?n("#sowRecurringPaymentCount").value:0)||0;var gt=De.calculationMode==="amount"?De.amountPerPayment:De.numberOfPayments;De.customSchedule=generateRecurringSchedule(De.deferredAmount,De.startDate,De.frequency,De.calculationMode,gt)}else De.deferredAmount=parseFloat(n("#sowDeferredAmount")?n("#sowDeferredAmount").value:0)||0,De.dueDate=n("#sowDeferredDueDate")?n("#sowDeferredDueDate").value:null;if(De.lateFee=De.lateFeeWaived?0:De.deferredAmount*.1,De.deferredAmount<=0){alert(t("sow.val.deferredAmount"));return}if(De.splitType==="lump_sum"&&!De.dueDate){alert(t("sow.val.deferredDueDate"));return}if(De.splitType==="custom"&&De.customSchedule.length===0){alert(t("sow.val.customSchedule"));return}if(De.splitType==="recurring"){if(!De.startDate){alert(t("sow.val.firstPaymentDate"));return}if(De.calculationMode==="amount"&&(!De.amountPerPayment||De.amountPerPayment<=0)){alert(t("sow.val.paymentAmount"));return}if(De.calculationMode==="count"&&(!De.numberOfPayments||De.numberOfPayments<2)){alert(t("sow.val.paymentCount"));return}if(De.customSchedule.length===0){alert(t("sow.val.scheduleError"));return}}if(De.deferredAmount>Ke){alert(t("sow.val.deferredExceedsTotal"));return}}var qt={clientName:d?_:y,clientEmail:d?I||"":w||"",clientPhone:d?g(pe)||"":g(ae)||"",packageType:O,estimatedWeeks:j?Ft||null:parseInt(q),startDate:j?ie||null:V||null,features:be,notes:X,maintenancePlan:G,isRetroactive:j,devDuration:Ft,devDurationUnit:ot,retroactiveEndDate:j&&ie||null,couponCode:Ye||null,isBusinessEntity:d,businessName:d?_:"",entityType:d?E:"",stateOfFormation:d?S:"",representativeName:d?C:"",representativeTitle:d?F:"",payment:{total:Ke,deposit:Ke*.5,milestone1:Ke*.25,final:Ke*.25,breakdown:{basePrice:tt.basePrice,addOns:tt.addOns,discounts:tt.discounts,ecommerceOption:tt.ecommerceOption,ecommercePrice:tt.ecommercePrice,couponCode:Ye||null,couponDiscount:tt.couponDiscount||0},deferred:De,tracking:{depositPaid:!1,depositPaidDate:null,milestone1Paid:!1,milestone1PaidDate:null,finalPaid:!1,finalPaidDate:null,deferredPayments:[]}},createdBy:firebase.auth().currentUser.email,createdAt:firebase.firestore.FieldValue.serverTimestamp(),status:"draft"},Lt=this;firebase.firestore().collection("sow_documents").add(qt).then(function(Qe){console.log("SOW saved with ID:",Qe.id),alert(t("sow.msg.saveSuccess")),n("#sowCreatorContainer").style.display="none",Lt.loadSOWDocuments()}).catch(function(Qe){console.error("Error saving SOW:",Qe),alert(t("sow.err.save")+Qe.message)})},A.prototype.showSOWSigningModal=function(d){var y=this;console.log("Opening SOW for signing:",d),firebase.firestore().collection("sow_documents").doc(d).get().then(function(w){if(!w.exists){alert(t("sow.err.notFound"));return}var b=w.data();if(b.id=w.id,b.clientSignature&&b.devSignature){alert(t("sow.msg.alreadySigned")),y.generateSOWPDF(b);return}y.renderSOWSigningModal(b)}).catch(function(w){console.error("Error loading SOW:",w),alert(t("sow.err.load")+w.message)})},A.prototype.renderSOWSigningModal=function(d){var y=this,w=firebase.auth().currentUser,b=w.email?w.email.toLowerCase():"",_=w.phoneNumber||"",E=b===this.DEVELOPER_EMAIL,S=b&&d.clientEmail&&b===d.clientEmail.toLowerCase()||_&&d.clientPhone&&_===d.clientPhone;if(!E&&!S){alert(t("sow.msg.noPermission"));return}var C=document.createElement("div");C.id="sowSigningModal",C.className="contract-modal show";var F='<div class="modal-overlay"></div><div class="modal-content"><button class="modal-close" id="closeSOWSigningModal"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button><div class="modal-header"><h1> '+t("sowSign.title")+'</h1><p class="modal-subtitle">'+d.clientName+" | "+d.packageType.toUpperCase()+'</p></div><div class="contract-form" "><div class="contract-section-inner"><h2>'+t("sowSign.summary")+"</h2><p><strong>"+t("sowSign.label.client")+"</strong> "+d.clientName+"</p><p><strong>"+t("sowSign.label.package")+"</strong> "+d.packageType+"</p><p><strong>"+t("sowSign.label.totalCost")+"</strong> $"+(d.payment?d.payment.total.toFixed(0):"0")+"</p><p><strong>"+t("sowSign.label.timeline")+"</strong> "+(d.estimatedWeeks||"TBD")+" "+t("sowTab.detail.weeks")+"</p><p><strong>"+t("sowSign.label.features")+"</strong> "+(d.features?d.features.length:0)+" "+t("sowSign.label.selected")+'</p></div><div class="signatures"><div class="signature-grid">';F+='<div class="signature-block" id="sowClientSignatureBlock"><h3>'+t("sowSign.clientSig")+d.clientName+"</h3>",d.clientSignature?F+='<div class="pending-notice"><p><strong> '+t("sowSign.clientSigned")+"</strong></p><p>"+t("sowSign.signedOn")+(d.clientSignedDate||"N/A")+'</p></div><div class="signature-pad-container"><canvas id="sowClientSigPad" class="signature-pad"></canvas></div>':S?F+='<div class="form-row"><div class="form-group"><label>'+t("sowSign.nameLabel")+'</label><input type="text" id="sowClientSignerName" value="'+d.clientName+'" required /></div><div class="form-group"><label>'+t("sowSign.dateLabel")+'</label><input type="date" id="sowClientSignDate" required /></div></div><div class="form-group"><label>'+t("sowSign.signatureLabel")+'</label><div class="signature-pad-container"><canvas id="sowClientSigPad" class="signature-pad"></canvas><button class="clear-btn" data-canvas="sowClientSigPad">'+t("sowSign.btn.clear")+"</button></div></div>":F+='<div class="pending-notice"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg><p><strong>'+t("sowSign.awaitingClient")+"</strong></p><p>"+t("sowSign.awaitingClientText")+"</p></div>",F+="</div>",F+='<div class="signature-block" id="sowDevSignatureBlock"><h3>'+t("sowSign.devSig")+"</h3>",d.devSignature?F+='<div class="pending-notice"><p><strong> '+t("sowSign.devSigned")+"</strong></p><p>"+t("sowSign.signedOn")+(d.devSignedDate||"N/A")+'</p></div><div class="signature-pad-container"><canvas id="sowDevSigPad" class="signature-pad"></canvas></div>':E?F+='<div class="form-row"><div class="form-group"><label>'+t("sowSign.devNameLabel")+'</label><input type="text" id="sowDevSignerName" value="Carlos Martin" required /></div><div class="form-group"><label>'+t("sowSign.devDateLabel")+'</label><input type="date" id="sowDevSignDate" required /></div></div><div class="form-group"><label>'+t("sowSign.devSignatureLabel")+'</label><div class="signature-pad-container"><canvas id="sowDevSigPad" class="signature-pad"></canvas><button class="clear-btn" data-canvas="sowDevSigPad">'+t("sowSign.btn.clear")+"</button></div></div>":F+='<div class="pending-notice"><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg><p><strong>'+t("sowSign.awaitingDev")+"</strong></p><p>"+t("sowSign.awaitingDevText")+"</p></div>",F+="</div>",F+="</div></div>",F+='<div class="action-buttons">',d.clientSignature&&d.devSignature?F+='<button class="btn btn-primary" id="downloadSOWBtn"><span> '+t("sowSign.btn.downloadSigned")+"</span></button>":S&&!d.clientSignature?F+='<button class="btn btn-primary" id="submitSOWClientSig"><span> '+t("sowSign.btn.submitSignature")+"</span></button>":E&&!d.devSignature&&d.clientSignature&&(F+='<button class="btn btn-primary" id="submitSOWDevSig"><span> '+t("sowSign.btn.signSow")+"</span></button>"),F+="</div></div></div>",C.innerHTML=F,document.body.appendChild(C),document.body.classList.add("modal-open"),setTimeout(function(){y.initSOWSignaturePads(d,E,S)},100)},A.prototype.initSOWSignaturePads=function(d,y,w){var b=this,_=document.getElementById("sowClientSigPad"),E=document.getElementById("sowDevSigPad"),S=null,C=null;if(_){if(d.clientSignature)this.drawSignatureOnCanvas(_,d.clientSignature);else if(w){S=H(_);var F=document.getElementById("sowClientSignDate");F&&(F.value=new Date().toISOString().split("T")[0])}}if(E){if(d.devSignature)this.drawSignatureOnCanvas(E,d.devSignature);else if(y){C=H(E);var I=document.getElementById("sowDevSignDate");I&&(I.value=new Date().toISOString().split("T")[0])}}var z=document.querySelectorAll(".clear-btn");z.forEach(function(G){G.addEventListener("click",function(j){j.preventDefault();var Y=this.getAttribute("data-canvas");Y==="sowClientSigPad"&&S?S.clear():Y==="sowDevSigPad"&&C&&C.clear()})});var O=document.getElementById("closeSOWSigningModal");O&&O.addEventListener("click",function(){var G=document.getElementById("sowSigningModal");G&&G.remove(),document.body.classList.remove("modal-open")});var q=document.getElementById("submitSOWClientSig");q&&q.addEventListener("click",function(G){G.preventDefault(),b.submitSOWClientSignature(d.id,S)});var V=document.getElementById("submitSOWDevSig");V&&V.addEventListener("click",function(G){G.preventDefault(),b.submitSOWDeveloperSignature(d.id,C)});var X=document.getElementById("downloadSOWBtn");X&&X.addEventListener("click",function(G){G.preventDefault(),b.generateSOWPDF(d)})},A.prototype.submitSOWClientSignature=function(d,y){if(!y||y.isEmpty()){alert(t("sow.val.signature"));return}var w=document.getElementById("sowClientSignerName").value.trim(),b=document.getElementById("sowClientSignDate").value;if(!w||!b){alert(t("sow.val.fillAllFields"));return}var _=document.getElementById("submitSOWClientSig");_&&(_.disabled=!0,_.innerHTML="<span>"+t("sow.btn.submitting")+"</span>");var E={clientSignature:y.toDataURL(),clientSignerName:w,clientSignedDate:b,clientSignedTimestamp:firebase.firestore.FieldValue.serverTimestamp(),status:"pending_developer"};firebase.firestore().collection("sow_documents").doc(d).update(E).then(function(){console.log(" Client signed SOW"),alert(t("sow.msg.clientSignSuccess"));var S=document.getElementById("sowSigningModal");S&&S.remove(),document.body.classList.remove("modal-open")}).catch(function(S){console.error("Error signing SOW:",S),alert(t("sow.err.sign")+S.message),_&&(_.disabled=!1,_.innerHTML="<span>"+t("sow.btn.submitSignature")+"</span>")})},A.prototype.submitSOWDeveloperSignature=function(d,y){var w=this;if(!y||y.isEmpty()){alert(t("sow.val.signature"));return}var b=document.getElementById("sowDevSignerName").value.trim(),_=document.getElementById("sowDevSignDate").value;if(!b||!_){alert(t("sow.val.fillAllFields"));return}var E=document.getElementById("submitSOWDevSig");E&&(E.disabled=!0,E.innerHTML="<span>"+t("sow.btn.signing")+"</span>");var S={devSignature:y.toDataURL(),devSignerName:b,devSignedDate:_,devSignedTimestamp:firebase.firestore.FieldValue.serverTimestamp(),status:"approved"};firebase.firestore().collection("sow_documents").doc(d).update(S).then(function(){console.log(" Developer signed SOW"),alert(t("sow.msg.fullySigned"));var C=document.getElementById("sowSigningModal");C&&C.remove(),document.body.classList.remove("modal-open"),w.isDeveloper&&w.showDeveloperDashboard()}).catch(function(C){console.error("Error signing SOW:",C),alert(t("sow.err.sign")+C.message),E&&(E.disabled=!1,E.innerHTML="<span>"+t("sow.btn.signSow")+"</span>")})},A.prototype.generateSOWPDF=function(d){var y,w,b,_,E,S,C,F,I,z,O,q,V,X,G;if(d)y=d.clientName||"Client Name",w=d.clientEmail||d.clientPhone||"N/A",b=d.packageType||"professional",_=d.estimatedWeeks||"TBD",E=d.startDate||null,S=d.notes||"",C=d.maintenancePlan||"none",F=d.features||[],I=d.id||"DRAFT",z=d.clientSignature||"",O=d.clientSignerName||y,q=d.clientSignedDate||"",V=d.devSignature||"",X=d.devSignerName||"Carlos Martin",G=d.devSignedDate||"";else{var j=n("#sowEntityTypeToggle"),Y=j&&j.checked,ie=n("#sowClientName"),ae=n("#sowClientEmail"),le=n("#sowClientPhone"),pe=n("#sowBusinessName"),_e=n("#sowBusinessEmail"),oe=n("#sowBusinessPhone"),be=n("#sowPackage"),Ie=n("#sowWeeks"),We=n("#sowStartDate"),qe=n("#sowNotes"),tt=n("#sowMaintenance");if(!be){alert(t("sow.val.selectPackage"));return}if(Y){y=pe?pe.value.trim():"";var Ke=_e?_e.value.trim():"",at=oe?oe.value.trim():"";w=Ke||at||"N/A"}else{y=ie?ie.value.trim():"";var Ye=ae?ae.value.trim():"",ot=le?le.value.trim():"";w=Ye||ot||"N/A"}if(!y){alert(Y?t("sow.val.fillBusinessName"):t("sow.val.fillClientName"));return}b=be.value||"professional",_=Ie?Ie.value:"TBD",E=We?We.value:null,S=qe?qe.value.trim():"",C=tt?tt.value:"none",I="DRAFT",z="",O=Y&&n("#sowRepName")?n("#sowRepName").value.trim():y,q="",V="",X="Carlos Martin",G="",F=[],e('.sow-checkboxes input[type="checkbox"]:checked').forEach(function(je){var vt=je.parentElement.textContent.trim();F.push(vt)})}var Ft=w,zt=!1,De=null,Pe="weeks";if(d&&d.isRetroactive!==void 0)zt=d.isRetroactive,De=d.devDuration||null,Pe=d.devDurationUnit||"weeks";else{var kt=n("#sowRetroactive");zt=kt&&kt.checked,De=n("#sowDevDuration")&&parseInt(n("#sowDevDuration").value)||null,Pe=n("#sowDevDurationUnit")?n("#sowDevDurationUnit").value:"weeks"}var He=!1,gt="",qt="",Lt="",Qe="",Ze="";if(d)He=d.isBusinessEntity||!1,gt=d.businessName||"",qt=d.entityType||"",Lt=d.stateOfFormation||"",Qe=d.representativeName||"",Ze=d.representativeTitle||"";else{var ut=n("#sowEntityTypeToggle");He=ut&&ut.checked,He&&(gt=n("#sowBusinessName")?n("#sowBusinessName").value.trim():"",qt=n("#sowEntityType")?n("#sowEntityType").value:"",Lt=n("#sowStateOfFormation")?n("#sowStateOfFormation").value.trim():"",Qe=n("#sowRepName")?n("#sowRepName").value.trim():"",Ze=n("#sowRepTitle")?n("#sowRepTitle").value.trim():"")}if(!y||!b){alert((He?"Business Name":"Client Name")+" and Package Tier are required to generate PDF");return}var Ht={essential:{name:t("pkgDef.essential.name"),priceRange:t("pkgDef.essential.priceRange"),defaultPrice:2e3,timeline:t("pkgDef.essential.timeline"),description:t("pkgDef.essential.desc"),includes:[t("pkgDef.essential.i1"),t("pkgDef.essential.i2"),t("pkgDef.essential.i3"),t("pkgDef.essential.i4"),t("pkgDef.essential.i5"),t("pkgDef.essential.i6"),t("pkgDef.essential.i7")],notIncluded:[t("pkgDef.essential.ni1"),t("pkgDef.essential.ni2"),t("pkgDef.essential.ni3"),t("pkgDef.essential.ni4"),t("pkgDef.essential.ni5")]},starter:{name:t("pkgDef.starter.name"),priceRange:t("pkgDef.starter.priceRange"),defaultPrice:4500,timeline:t("pkgDef.starter.timeline"),description:t("pkgDef.starter.desc"),includes:[t("pkgDef.starter.i1"),t("pkgDef.starter.i2"),t("pkgDef.starter.i3"),t("pkgDef.starter.i4"),t("pkgDef.starter.i5"),t("pkgDef.starter.i6"),t("pkgDef.starter.i7"),t("pkgDef.starter.i8"),t("pkgDef.starter.i9"),t("pkgDef.starter.i10")],notIncluded:[t("pkgDef.starter.ni1"),t("pkgDef.starter.ni2"),t("pkgDef.starter.ni3"),t("pkgDef.starter.ni4")]},growth:{name:t("pkgDef.growth.name"),priceRange:t("pkgDef.growth.priceRange"),defaultPrice:9e3,timeline:t("pkgDef.growth.timeline"),description:t("pkgDef.growth.desc"),includes:[t("pkgDef.growth.i1"),t("pkgDef.growth.i2"),t("pkgDef.growth.i3"),t("pkgDef.growth.i4"),t("pkgDef.growth.i5"),t("pkgDef.growth.i6"),t("pkgDef.growth.i7"),t("pkgDef.growth.i8")],notIncluded:[t("pkgDef.growth.ni1"),t("pkgDef.growth.ni2"),t("pkgDef.growth.ni3"),t("pkgDef.growth.ni4")]},professional:{name:t("pkgDef.professional.name"),priceRange:t("pkgDef.professional.priceRange"),defaultPrice:18500,timeline:t("pkgDef.professional.timeline"),description:t("pkgDef.professional.desc"),includes:[t("pkgDef.professional.i1"),t("pkgDef.professional.i2"),t("pkgDef.professional.i3"),t("pkgDef.professional.i4"),t("pkgDef.professional.i5"),t("pkgDef.professional.i6"),t("pkgDef.professional.i7"),t("pkgDef.professional.i8"),t("pkgDef.professional.i9"),t("pkgDef.professional.i10"),t("pkgDef.professional.i11")],notIncluded:[t("pkgDef.professional.ni1"),t("pkgDef.professional.ni2"),t("pkgDef.professional.ni3"),t("pkgDef.professional.ni4")]},enterprise:{name:t("pkgDef.enterprise.name"),priceRange:t("pkgDef.enterprise.priceRange"),defaultPrice:37500,timeline:t("pkgDef.enterprise.timeline"),description:t("pkgDef.enterprise.desc"),includes:[t("pkgDef.enterprise.i1"),t("pkgDef.enterprise.i2"),t("pkgDef.enterprise.i3"),t("pkgDef.enterprise.i4"),t("pkgDef.enterprise.i5"),t("pkgDef.enterprise.i6"),t("pkgDef.enterprise.i7"),t("pkgDef.enterprise.i8"),t("pkgDef.enterprise.i9"),t("pkgDef.enterprise.i10"),t("pkgDef.enterprise.i11"),t("pkgDef.enterprise.i12"),t("pkgDef.enterprise.i13")],notIncluded:[t("pkgDef.enterprise.ni1"),t("pkgDef.enterprise.ni2"),t("pkgDef.enterprise.ni3")]},custom:{name:t("pkgDef.custom.name"),priceRange:t("pkgDef.custom.priceRange"),defaultPrice:0,timeline:t("pkgDef.custom.timeline"),description:t("pkgDef.custom.desc"),includes:[t("pkgDef.custom.i1")],notIncluded:[]}},Kt={none:{name:t("maint.none.name"),price:"$0/month",description:t("maint.none.desc"),includes:[]},basic:{name:t("maint.basic.name"),price:t("maint.basic.price"),description:t("maint.basic.desc"),includes:[t("maint.basic.i1"),t("maint.basic.i2"),t("maint.basic.i3"),t("maint.basic.i4"),t("maint.basic.i5"),t("maint.basic.i6")]},professional:{name:t("maint.professional.name"),price:t("maint.professional.price"),description:t("maint.professional.desc"),includes:[t("maint.professional.i1"),t("maint.professional.i2"),t("maint.professional.i3"),t("maint.professional.i4"),t("maint.professional.i5"),t("maint.professional.i6"),t("maint.professional.i7"),t("maint.professional.i8")]},premium:{name:t("maint.premium.name"),price:t("maint.premium.price"),description:t("maint.premium.desc"),includes:[t("maint.premium.i1"),t("maint.premium.i2"),t("maint.premium.i3"),t("maint.premium.i4"),t("maint.premium.i5"),t("maint.premium.i6"),t("maint.premium.i7"),t("maint.premium.i8"),t("maint.premium.i9"),t("maint.premium.i10")]}},Ot=Ht[b]||Ht.custom,zn=Kt[C]||Kt.none,pt=0;if(d&&d.payment&&d.payment.total)pt=d.payment.total;else if(b==="custom"&&d&&d.customPrice)pt=parseFloat(d.customPrice)||0;else if(b==="custom"){var Ri=n("#sowCustomPrice");pt=Ri&&parseFloat(Ri.value)||0}else pt=Ot.defaultPrice;var Vn=pt*.5,fi=pt*.25,nn=pt*.25,_t=d&&d.payment&&d.payment.breakdown?d.payment.breakdown:null,un=_t?_t.basePrice:pt,$t=_t?_t.addOns:[],rn=_t?_t.discounts:[];_t&&_t.ecommerceOption,_t&&_t.ecommercePrice;var wn=_t?_t.couponCode:null,sn=_t?_t.couponDiscount:0,Qt=typeof getCurrentLang=="function"&&getCurrentLang()==="es"?"es-MX":"en-US",Cn=new Date().toLocaleDateString(Qt,{year:"numeric",month:"long",day:"numeric"}),bn=E?new Date(E).toLocaleDateString(Qt,{year:"numeric",month:"long",day:"numeric"}):t("pdf.sow.toBeDeterm"),Ce='<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=1024"><title>Statement of Work - '+y+'</title><link rel="icon" type="image/png" href="https://scarlo.dev/favicons/favicon-96x96.png"><style>* { margin: 0; padding: 0; box-sizing: border-box; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; text-size-adjust: 100%; }body { font-family: "Times New Roman", Times, serif; font-size: 10pt; line-height: 1.35; color: #000; background: #fff; padding: 0.5in 0.75in; }.sow-container { max-width: 900px; margin: 0 auto; }h1 { font-size: 18pt; text-align: center; margin-bottom: 8px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }h2 { font-size: 10pt; margin-top: 12px; margin-bottom: 6px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #000; padding-bottom: 2px; }h3 { font-size: 10pt; margin-top: 8px; margin-bottom: 4px; font-weight: bold; }p { margin-bottom: 6px; text-align: justify; }ul, ol { margin-left: 20px; margin-bottom: 6px; }li { margin-bottom: 2px; }.header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #000; }.subtitle { font-size: 11pt; margin-top: 6px; font-style: italic; }.meta-date { font-size: 9pt; margin-top: 6px; font-style: italic; }.info-box { padding: 8px 12px; border: 1px solid #000; border-left: 3px solid #000; margin: 8px 0; page-break-inside: avoid; break-inside: avoid; }.info-box h3 { margin-top: 0; }.info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 4px 20px; margin-top: 6px; }.info-item { font-size: 9pt; word-wrap: break-word; overflow-wrap: break-word; }.section { margin-bottom: 10px; }.deferred-terms { page-break-inside: avoid; break-inside: avoid; }.section-compact { page-break-inside: avoid; break-inside: avoid; }.package-box { border: 1px solid #000; padding: 8px 12px; margin: 8px 0; page-break-inside: avoid; break-inside: avoid; }.package-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; padding-bottom: 6px; border-bottom: 1px solid #000; }.package-name { font-size: 11pt; font-weight: bold; }.package-price { font-size: 10pt; font-weight: bold; }.feature-list { columns: 2; column-gap: 20px; font-size: 9pt; }.feature-list li { break-inside: avoid; margin-bottom: 1px; }.not-included { border-left: 3px solid #000; }.not-included h3 { font-style: italic; }.payment-table { width: 100%; border-collapse: collapse; margin: 8px 0; font-size: 9pt; page-break-inside: avoid; break-inside: avoid; }.payment-table th, .payment-table td { border: 1px solid #000; padding: 5px 8px; text-align: left; }.payment-table th { font-weight: bold; background: #f5f5f5; }.payment-table .total-row { font-weight: bold; font-size: 10pt; border-top: 2px solid #000; }.timeline-box { border: 1px solid #000; padding: 8px 12px; margin: 8px 0; page-break-inside: avoid; break-inside: avoid; }.timeline-header { font-weight: bold; margin-bottom: 8px; font-size: 10pt; border-bottom: 1px solid #000; padding-bottom: 4px; }.milestone { margin-bottom: 6px; padding-left: 8px; border-left: 2px solid #000; }.milestone:last-child { margin-bottom: 0; }.milestone-title { font-weight: bold; font-size: 9pt; }.milestone-desc { font-size: 9pt; }.assumptions-box { border: 1px solid #000; border-left: 3px solid #000; padding: 8px 12px; margin: 8px 0; }.assumptions-box h3 { margin-top: 0; font-size: 9pt; }.assumptions-box li { font-size: 9pt; }.legal-notice { border: 1px solid #000; padding: 8px 12px; margin: 10px 0; font-size: 9pt; }.signature-section { margin-top: 20px; page-break-before: always; }.signature-grid { display: flex; justify-content: space-between; gap: 30px; margin-top: 15px; }.signature-block { flex: 1; }.signature-block h3 { font-size: 9pt; margin-bottom: 6px; }.signature-line { border-bottom: 1px solid #000; height: 50px; margin: 6px 0; display: flex; align-items: flex-end; justify-content: center; }.signature-line img { max-height: 45px; max-width: 100%; filter: invert(1) grayscale(1); }.signature-label { font-size: 8pt; font-style: italic; margin-top: 3px; }.signature-name { font-weight: bold; margin-top: 6px; font-size: 9pt; }.signature-date { font-size: 9pt; margin-top: 3px; }.footer { margin-top: 20px; text-align: center; font-size: 8pt; border-top: 1px solid #000; padding-top: 10px; }.sow-id { font-size: 7pt; margin-top: 4px; font-style: italic; }.highlight { font-weight: bold; }.maintenance-box { border: 1px solid #000; padding: 8px 12px; margin: 8px 0; page-break-inside: avoid; break-inside: avoid; }.maintenance-header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 6px; border-bottom: 1px solid #000; margin-bottom: 6px; }.maintenance-name { font-weight: bold; font-size: 10pt; }.maintenance-price { font-weight: bold; }.logo { max-width: 180px; max-height: 60px; margin-bottom: 15px; }@media print { body { padding: 0; margin: 0; } .sow-container { max-width: 100%; } .info-box, .package-box, .timeline-box, .maintenance-box, .payment-table, .legal-notice, .deferred-terms { page-break-inside: avoid !important; break-inside: avoid !important; } h2, h3 { page-break-after: avoid !important; } }@page { margin: 0.5in 0.6in; size: letter; }</style></head><body><div class="sow-container"><div class="header"><img src="'+u()+'" alt="Scarlo Logo" class="logo" /><h1>'+t("pdf.sow.title")+'</h1><div class="subtitle">'+t("pdf.sow.subtitle")+'</div><div class="meta-date">'+t("pdf.sow.generated")+" "+Cn+'</div></div><div class="legal-notice"><strong>'+t("pdf.sow.incorporation")+"</strong> "+t("pdf.sow.incorporationText")+" "+y+t("pdf.sow.incorporationText2")+'</div><div class="section"><h2>'+t("pdf.sow.clientInfo")+'</h2><div class="info-box"><div class="info-grid">'+(He?'<div class="info-item"><strong>'+t("pdf.sow.businessName")+"</strong> "+gt+'</div><div class="info-item"><strong>'+t("pdf.sow.entityType")+"</strong> "+qt+(Lt?" ("+Lt+")":"")+'</div><div class="info-item"><strong>'+t("pdf.sow.representative")+"</strong> "+Qe+", "+Ze+"</div>":'<div class="info-item"><strong>'+t("pdf.sow.clientName")+"</strong> "+y+"</div>")+'<div class="info-item"><strong>'+t("pdf.sow.contact")+"</strong> "+Ft+'</div><div class="info-item"><strong>'+t("pdf.sow.packageSelected")+"</strong> "+Ot.name+"</div>"+(zt?'<div class="info-item"><strong>'+t("pdf.sow.devDuration")+"</strong> "+(De||_)+" "+Pe+"</div>":'<div class="info-item"><strong>'+t("pdf.sow.estimatedTimeline")+"</strong> "+_+" "+t("sow.weeks")+"</div>")+'<div class="info-item"><strong>'+t("pdf.sow.estimatedFinalRevision")+"</strong> "+bn+'</div><div class="info-item"><strong>'+t("pdf.sow.sowReference")+"</strong> "+I+'</div></div></div></div><div class="section"><h2>'+t("pdf.sow.projectOverview")+'</h2><div class="package-box"><div class="package-header"><span class="package-name">'+Ot.name+'</span><span class="package-price">'+Ot.priceRange+'</span></div><p style="font-size: 9pt; margin-bottom: 10px;">'+Ot.description+'</p><h3 style="font-size: 9pt; margin-top: 10px;">'+t("pdf.sow.includedInPackage")+'</h3><ul class="feature-list">';b==="custom"&&$t&&$t.length>0?$t.forEach(function(je){var vt=je.key?translateAddonByKey(je.key,je.label):translateStoredFeature(je.label);Ce+="<li>"+vt+"</li>"}):Ot.includes.forEach(function(je){Ce+="<li>"+je+"</li>"}),Ce+="</ul></div></div>";var Nt=$t&&b!=="custom"?$t.filter(function(je){return je.price>0}):[];Nt.length>0&&(Ce+='<div class="section"><h2>3. '+t("pdf.sow.additionalFeatures").replace(/^\d+\.\s*/,"")+'</h2><div class="info-box"><ul class="feature-list">',Nt.forEach(function(je){var vt=je.key?translateAddonByKey(je.key,je.label):translateStoredFeature(je.label);Ce+="<li>"+vt+"</li>"}),Ce+="</ul></div></div>"),S&&S.trim()&&(Ce+='<div class="section"><h2>'+(Nt.length>0?"4":"3")+". "+t("pdf.sow.specialRequirements")+'</h2><div class="info-box"><p style="font-size: 9pt; margin-bottom: 0;">'+S+"</p></div></div>");var nt=3+(Nt.length>0?1:0)+(S&&S.trim()?1:0);zt||(Ce+='<div class="section"><h2>'+nt+". "+t("pdf.sow.projectTimeline")+'</h2><div class="timeline-box"><div class="timeline-header">'+t("pdf.sow.estimatedDuration")+" "+_+" "+t("pdf.sow.weeks")+'</div><div class="milestone"><div class="milestone-title">'+t("pdf.sow.phase1Title")+'</div><div class="milestone-desc">'+t("pdf.sow.phase1Desc")+'</div></div><div class="milestone"><div class="milestone-title">'+t("pdf.sow.phase2Title")+'</div><div class="milestone-desc">'+t("pdf.sow.phase2Desc")+" <strong>"+t("pdf.sow.phase2Payment")+'</strong></div></div><div class="milestone"><div class="milestone-title">'+t("pdf.sow.phase3Title")+Math.max(4,parseInt(_)-2||4)+')</div><div class="milestone-desc">'+t("pdf.sow.phase3Desc")+'</div></div><div class="milestone"><div class="milestone-title">'+t("pdf.sow.phase4Title")+'</div><div class="milestone-desc">'+t("pdf.sow.phase4Desc")+" <strong>"+t("pdf.sow.phase4Payment")+'</strong></div></div></div><p style="font-size: 9pt; font-style: italic; margin-top: 6px;">'+t("pdf.sow.timelineNote")+"</p></div>",nt++),Ce+='<div class="section"><h2>'+nt+". "+t("pdf.sow.pricingSummary")+'</h2><table class="payment-table" style="width: 100%;"><tbody>',Ce+='<tr><td style="width: 70%;"><strong>'+Ot.name+'</strong></td><td style="width: 30%; text-align: right;"><strong>$'+un.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr>",$t&&$t.length>0&&$t.forEach(function(je){var vt=je.key?translateAddonByKey(je.key,je.label):translateStoredFeature(je.label),Er=je.price===0?'<span style="color: #2e7d32; font-style: italic;">'+t("pdf.sow.included")+"</span>":'<span style="color: #2e7d32;">+$'+je.price.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</span>";Ce+="<tr><td>"+vt+'</td><td style="text-align: right;">'+Er+"</td></tr>"}),rn&&rn.length>0&&rn.forEach(function(je){var vt=je.key?translateAddonByKey(je.key,je.label):translateStoredFeature(je.label);Ce+="<tr><td>"+vt+' <span style="font-size: 8pt; color: #666;">'+t("pdf.sow.removed")+'</span></td><td style="text-align: right; color: #c62828;">-$'+je.price.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</td></tr>"}),wn&&sn>0&&(Ce+="<tr><td>"+t("pdf.sow.coupon")+" "+wn+'</td><td style="text-align: right; color: #c62828;">-$'+sn.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</td></tr>"),Ce+='<tr style="border-top: 2px solid #333;"><td><strong>'+t("pdf.sow.total")+'</strong></td><td style="text-align: right;"><strong>$'+pt.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr></tbody></table></div>",nt++;var ht={essential:{local:"$1,500 - $4,000",localHigh:4e3},starter:{local:"$4,000 - $8,000",localHigh:8e3},growth:{local:"$8,000 - $15,000",localHigh:15e3},professional:{local:"$15,000 - $35,000",localHigh:35e3},enterprise:{local:"$35,000 - $80,000",localHigh:8e4}},Tn;b==="custom"?pt<=3e3?Tn=ht.essential:pt<=6e3?Tn=ht.starter:pt<=12e3?Tn=ht.growth:pt<=25e3?Tn=ht.professional:Tn=ht.enterprise:Tn=ht[b]||ht.starter;var Xi=Math.max(0,Tn.localHigh-pt);if(Ce+='<div class="section" style="page-break-inside: avoid;"><h2>'+nt+". "+t("pdf.sow.valueSummary")+'</h2><div style="border: 2px solid #000; padding: 12px 15px; margin: 8px 0;"><div style="display: flex; justify-content: space-between; align-items: center; padding-bottom: 10px; border-bottom: 1px solid #ccc; margin-bottom: 10px;"><div style="font-size: 9pt;"><div style="color: #666; margin-bottom: 2px;">'+t("pdf.sow.marketRatesIntro")+'</div><div style="font-size: 11pt; font-weight: bold;">'+Tn.local+'</div></div><div style="text-align: right;"><div style="color: #666; font-size: 9pt; margin-bottom: 2px;">'+t("pdf.sow.yourQuote")+'</div><div style="font-size: 14pt; font-weight: bold;">$'+pt.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</div></div></div>"+(Xi>500?'<div style="background: #f0f7f0; padding: 8px 12px; margin-bottom: 10px; text-align: center; border-left: 3px solid #2e7d32;"><span style="font-size: 9pt; color: #666;">'+t("pdf.sow.potentialSavings")+' </span><strong style="font-size: 11pt; color: #2e7d32;">'+t("pdf.sow.upTo")+" $"+Xi.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></div>":"")+'<div style="font-size: 9pt;"><div style="margin-bottom: 4px;"><strong style="color: #2e7d32;"></strong> <strong>'+t("pdf.sow.valueProp1")+"</strong> "+t("pdf.sow.valueProp1Desc")+'</div><div style="margin-bottom: 4px;"><strong style="color: #2e7d32;"></strong> <strong>'+t("pdf.sow.valueProp2")+"</strong> "+t("pdf.sow.valueProp2Desc")+'</div><div><strong style="color: #2e7d32;"></strong> <strong>'+t("pdf.sow.valueProp3")+"</strong> "+t("pdf.sow.valueProp3Desc")+'</div></div></div><p style="font-size: 7pt; color: #888; margin-top: 4px; margin-bottom: 0;">'+t("pdf.sow.marketNote")+' <a href="https://scarlo.dev/pricing" target="_blank" style="color: #2e7d32; text-decoration: underline;">scarlo.dev/pricing</a></p></div>',nt++,zt?Ce+='<div class="section"><h2>'+nt+". "+t("pdf.sow.paymentSummary")+'</h2><div class="info-box" style="text-align: center; padding: 15px;"><div style="font-size: 10pt; color: #666; margin-bottom: 5px;">'+t("pdf.sow.totalProjectCost")+'</div><div style="font-size: 16pt; font-weight: bold;">$'+pt.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+'</div></div><p style="font-size: 9pt; font-style: italic;">'+t("pdf.sow.paymentTermsNote")+"</p></div>":Ce+='<div class="section"><h2>'+nt+". "+t("pdf.sow.paymentStructure")+'</h2><table class="payment-table"><thead><tr><th style="width: 25%;">'+t("pdf.sow.payment")+'</th><th style="width: 45%;">'+t("pdf.sow.description")+'</th><th style="width: 15%;">'+t("pdf.sow.percentage")+'</th><th style="width: 15%;">'+t("pdf.sow.amount")+"</th></tr></thead><tbody><tr><td><strong>"+t("pdf.sow.deposit")+"</strong></td><td>"+t("pdf.sow.beforeWorkBegins")+"</td><td>50%</td><td><strong>$"+Vn.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr><tr><td><strong>"+t("pdf.sow.milestone")+"</strong></td><td>"+t("pdf.sow.uponDesignApproval")+"</td><td>25%</td><td><strong>$"+fi.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr><tr><td><strong>"+t("pdf.sow.final")+"</strong></td><td>"+t("pdf.sow.priorToDeployment")+"</td><td>25%</td><td><strong>$"+nn.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+'</strong></td></tr><tr class="total-row"><td colspan="2"><strong>'+t("pdf.sow.totalProjectCostLabel")+"</strong></td><td><strong>100%</strong></td><td><strong>$"+pt.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+'</strong></td></tr></tbody></table><p style="font-size: 9pt; font-style: italic;">'+t("pdf.sow.latePaymentsNote")+"</p></div>",nt++,d.payment&&d.payment.deferred&&d.payment.deferred.enabled){var Xe=d.payment.deferred;Ce+='<div class="section"><h2>'+nt+". "+t("pdf.sow.deferredPaymentAgreement")+'</h2><div style="background: #fff8e6; border: 2px solid #f59e0b; padding: 10px; margin-bottom: 10px;"><p style="font-size: 9pt; margin: 0 0 5px; color: #92400e; font-weight: bold;">'+t("pdf.sow.deferredPaymentTerms")+'</p><p style="font-size: 8pt; margin: 0; color: #78350f;">'+t("pdf.sow.deferredPaymentIntro")+'</p></div><table class="payment-table"><thead><tr><th style="width: 50%;">'+t("pdf.sow.description")+'</th><th style="width: 25%;">'+t("pdf.sow.dueDate")+'</th><th style="width: 25%;">'+t("pdf.sow.amount")+"</th></tr></thead><tbody>";var ue={weekly:t("freq.weekly"),biweekly:t("freq.biweekly"),semimonthly:t("freq.semimonthly"),monthly:t("freq.monthly"),bimonthly:t("freq.bimonthly")};if((Xe.splitType==="custom"||Xe.splitType==="recurring")&&Xe.customSchedule&&Xe.customSchedule.length>0){if(Xe.splitType==="recurring"&&Xe.frequency){var fe=ue[Xe.frequency]||Xe.frequency;Ce+='<tr style="background: #e0f2fe;"><td colspan="3" style="font-size: 8pt; color: #0369a1; padding: 6px 8px;"><strong>'+t("pdf.sow.paymentPlan")+"</strong> "+Xe.customSchedule.length+" "+fe.toLowerCase()+" "+t("pdf.sow.paymentsOf")+" $"+(Xe.customSchedule[0].amount||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</td></tr>"}Xe.customSchedule.forEach(function(je,vt){var Er=je.dueDate?new Date(je.dueDate).toLocaleDateString(Qt,{year:"numeric",month:"long",day:"numeric"}):t("common.tbd");Ce+="<tr><td>"+t("pdf.sow.paymentNum")+" "+(vt+1)+"</td><td>"+Er+"</td><td><strong>$"+(je.amount||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr>"})}else{var Oe=Xe.dueDate?new Date(Xe.dueDate).toLocaleDateString(Qt,{year:"numeric",month:"long",day:"numeric"}):t("common.tbd");Ce+="<tr><td>"+t("pdf.sow.deferredLumpSum")+"</td><td>"+Oe+"</td><td><strong>$"+(Xe.deferredAmount||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr>"}Ce+='<tr class="total-row"><td colspan="2"><strong>'+t("pdf.sow.totalDeferredAmount")+"</strong></td><td><strong>$"+(Xe.deferredAmount||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong></td></tr>";var Re=Xe.lateFeeWaived||Xe.feeWaived,Te=Xe.deferredAmount*.1;Ce+='<tr style="background: #fef3c7;"><td>'+t("pdf.sow.lateFee10")+(Re?' <em style="color:#666;">('+t("pdf.sow.waived")+")</em>":"")+'</td><td style="font-size: 8pt; color: #92400e;">'+t("pdf.sow.ifPaymentLate")+"</td><td>"+(Re?"<s>$"+Te.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</s> $0":"<strong>$"+Te.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"</strong>")+"</td></tr></tbody></table>";var Me=Xe.splitType==="recurring"||Xe.splitType==="custom"&&Xe.customSchedule&&Xe.customSchedule.length>1,Se=Re?t("pdf.sow.term.lateFeeWaived"):Me?t("pdf.sow.term.lateFeeRecurring"):t("pdf.sow.term.lateFeeLump1")+"$"+Te.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+t("pdf.sow.term.lateFeeLump2");Ce+='<div class="deferred-terms"><h3 style="font-size: 9pt; margin-top: 10px; margin-bottom: 5px;">'+t("pdf.sow.termsAndConditions")+'</h3><ol style="font-size: 8pt; margin: 5px 0; padding-left: 18px; line-height: 1.3;"><li><strong>'+t("pdf.sow.term.dueDateTitle")+"</strong> "+t("pdf.sow.term.dueDateText")+"</li><li><strong>"+t("pdf.sow.term.lateFeeTitle")+"</strong> "+Se+"</li><li><strong>"+t("pdf.sow.term.interestTitle")+"</strong> "+t("pdf.sow.term.interestText")+"</li><li><strong>"+t("pdf.sow.term.suspensionTitle")+"</strong> "+t("pdf.sow.term.suspensionText")+"</li><li><strong>"+t("pdf.sow.term.collectionTitle")+"</strong> "+t("pdf.sow.term.collectionText")+"</li><li><strong>"+t("pdf.sow.term.ipRightsTitle")+"</strong> "+t("pdf.sow.term.ipRightsText")+"</li><li><strong>"+t("pdf.sow.term.defaultTitle")+"</strong> "+t("pdf.sow.term.defaultText")+"</li>",Xe.allowPartialPayments&&(Ce+="<li><strong>"+t("pdf.sow.term.partialTitle")+"</strong> "+t("pdf.sow.term.partialText")+"</li>"),Xe.maintenanceDuringDeferral?Ce+="<li><strong>"+t("pdf.sow.term.maintTitle")+"</strong> "+t("pdf.sow.term.maintDuringText")+"</li>":Ce+="<li><strong>"+t("pdf.sow.term.maintTitle")+"</strong> "+t("pdf.sow.term.maintDeferredText")+"</li>",Ce+="<li><strong>"+t("pdf.sow.term.noticeTitle")+"</strong> "+t("pdf.sow.term.noticeText")+"</li></ol></div></div>",nt++}if(Ce+='<div class="section"><h2>'+nt+". "+t("pdf.sow.ongoingMaintenance")+'</h2><div class="maintenance-box"><div class="maintenance-header"><span class="maintenance-name">'+zn.name+'</span><span class="maintenance-price">'+zn.price+'</span></div><p style="font-size: 9pt; margin: 10px 0;">'+zn.description+"</p>",C==="none"&&(Ce+='<div style="background: #fff3cd; border: 2px solid #856404; padding: 12px; margin: 10px 0; border-radius: 4px;"><p style="font-size: 9pt; margin: 0; color: #856404; font-weight: bold;">'+t("pdf.sow.importantNotice")+'</p><p style="font-size: 9pt; margin: 5px 0 0; color: #856404;">'+t("pdf.sow.noMaintenanceWarning")+"</p></div>"),zn.includes&&zn.includes.length>0&&(Ce+='<h3 style="font-size: 9pt; margin-top: 10px;">'+t("pdf.sow.maintenanceIncludes")+"</h3><ul>",zn.includes.forEach(function(je){Ce+="<li>"+je+"</li>"}),Ce+="</ul>"),Ce+="</div>",C==="none"?Ce+='<p style="font-size: 8pt; font-style: italic;">'+t("pdf.sow.maintFooterNone")+"</p>":Ce+='<p style="font-size: 8pt; font-style: italic;">'+t("pdf.sow.maintFooterActive")+"</p>",Ce+="</div>",nt++,Ce+='<div class="section"><h2>'+nt+". "+t("pdf.sow.assumptionsDeps")+'</h2><div class="assumptions-box"><ul><li><strong>'+t("pdf.sow.assume.contentTitle")+"</strong> "+t("pdf.sow.assume.contentText")+"</li><li><strong>"+t("pdf.sow.assume.feedbackTitle")+"</strong> "+t("pdf.sow.assume.feedbackText")+"</li><li><strong>"+t("pdf.sow.assume.contactTitle")+"</strong> "+t("pdf.sow.assume.contactText")+"</li><li><strong>"+t("pdf.sow.assume.thirdPartyTitle")+"</strong> "+t("pdf.sow.assume.thirdPartyText")+"</li><li><strong>"+t("pdf.sow.assume.domainTitle")+"</strong> "+t("pdf.sow.assume.domainText")+"</li><li><strong>"+t("pdf.sow.assume.rightsTitle")+"</strong> "+t("pdf.sow.assume.rightsText")+"</li><li><strong>"+t("pdf.sow.assume.scopeTitle")+"</strong> "+t("pdf.sow.assume.scopeText")+'</li></ul><p style="font-size: 8pt; margin-bottom: 0; margin-top: 6px;">'+t("pdf.sow.assume.footer")+"</p></div></div>",nt++,Ce+='<div class="section"><h2>'+nt+". "+t("pdf.sow.acceptanceCriteria")+'</h2><div class="info-box"><p style="font-size: 9pt; margin-bottom: 4px;"><strong>'+t("pdf.sow.accept.processTitle")+"</strong> "+t("pdf.sow.accept.processText")+'</p><p style="font-size: 9pt; margin-bottom: 0;"><strong>'+t("pdf.sow.accept.criteriaTitle")+"</strong> "+t("pdf.sow.accept.criteriaText")+"</p></div></div>",nt++,Ce+='<div class="section"><h2>'+nt+". "+t("pdf.sow.scopeChanges")+'</h2><div class="info-box"><p style="font-size: 9pt; margin-bottom: 4px;">'+t("pdf.sow.scopeChangesIntro")+'</p><p style="font-size: 9pt; margin-bottom: 0;"><strong>'+t("pdf.sow.scopeChangesProcessTitle")+"</strong> "+t("pdf.sow.scopeChangesProcessText")+"</p></div></div>",Ce+='<div class="signature-section"><h2>'+t("pdf.sow.signatures")+'</h2><p style="font-size: 9pt;">'+t("pdf.sow.signaturesIntro")+'</p><div class="signature-grid"><div class="signature-block"><h3>'+t("pdf.sow.developerLabel")+" Scarlo</h3>"+(He?'<p style="font-size: 9pt; margin-bottom: 8px;">&nbsp;</p>':"")+'<div class="signature-line">'+(V?'<img src="'+V+'" alt="Developer Signature" />':'<span style="font-style: italic;">'+t("pdf.sow.awaitingSignature")+"</span>")+'</div><div class="signature-label">'+t("pdf.sow.authorizedSignature")+'</div><div class="signature-name">'+X+'</div><div class="signature-date">'+t("common.date")+" "+(G||"_______________")+'</div></div><div class="signature-block"><h3>'+t("pdf.sow.clientLabel")+" "+(He?gt:y)+"</h3>"+(He?'<p style="font-size: 9pt; margin-bottom: 8px;">'+qt+(Lt?", "+Lt:"")+"</p>":"")+'<div class="signature-line">'+(z?'<img src="'+z+'" alt="Client Signature" />':'<span style="font-style: italic;">'+t("pdf.sow.awaitingSignature")+"</span>")+'</div><div class="signature-label">'+t("pdf.sow.authorizedSignature")+'</div><div class="signature-name">'+(He?t("common.by")+" "+Qe+", "+Ze:O)+'</div><div class="signature-date">'+t("common.date")+" "+(q||"_______________")+"</div></div></div></div>",d.payment&&d.payment.deferred&&d.payment.deferred.enabled){var Xe=d.payment.deferred,it=Xe.lateFeeWaived||Xe.feeWaived,Ge=Xe.deferredAmount*.1,rt=Xe.deferredAmount*.015;Ce+='<div class="signature-section" style="margin-top: 15px; border-top: 2px solid #f59e0b; padding-top: 10px;"><h2 style="color: #92400e; font-size: 11pt; margin-bottom: 8px;">'+t("pdf.sow.deferredAckTitle")+'</h2><div style="background: #fff8e6; padding: 10px; margin-bottom: 10px; border: 1px solid #f59e0b;"><p style="font-size: 8pt; margin: 0 0 5px; font-weight: bold;">'+t("pdf.sow.ack.bySigningBelow")+'</p><ul style="font-size: 8pt; margin: 0; padding-left: 18px; line-height: 1.4;"><li><strong>'+t("pdf.sow.ack.deferredLabel")+"</strong> $"+(Xe.deferredAmount||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+" "+t("pdf.sow.ack.perSchedule")+"</li><li><strong>"+t("pdf.sow.ack.lateFeeLabel")+"</strong> "+(it?t("pdf.sow.waived"):"10% ($"+Ge.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+") "+t("pdf.sow.ack.if5DaysLate"))+"</li><li><strong>"+t("pdf.sow.ack.interestLabel")+"</strong> 1.5%/"+t("pdf.sow.ack.month")+" (~$"+rt.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})+"/"+t("pdf.sow.ack.mo")+") "+t("pdf.sow.ack.after30Days")+"</li><li><strong>"+t("pdf.sow.ack.suspensionLabel")+"</strong> "+t("pdf.sow.ack.suspensionText")+"</li><li><strong>"+t("pdf.sow.ack.collectionLabel")+"</strong> "+t("pdf.sow.ack.collectionText")+"</li><li><strong>"+t("pdf.sow.ack.ipRightsLabel")+"</strong> "+t("pdf.sow.ack.ipRightsText")+'</li></ul></div><div class="signature-grid"><div class="signature-block"><h3>'+t("pdf.sow.clientAcknowledgment")+'</h3><div class="signature-line">'+(Xe.acknowledgmentSigned&&z?'<img src="'+z+'" alt="Client Acknowledgment" />':'<span style="font-style: italic;">'+t("pdf.sow.awaitingAcknowledgment")+"</span>")+'</div><div class="signature-label">'+t("pdf.sow.clientSignatureLabel")+'</div><div class="signature-name">'+(He?t("common.by")+" "+Qe:O)+'</div><div class="signature-date">'+t("common.date")+" "+(Xe.acknowledgmentDate||"_______________")+"</div></div></div></div>"}Ce+='<div class="footer"><p><strong> '+new Date().getFullYear()+" Scarlo</strong>  "+t("pdf.sow.footerTagline")+'</p><p class="sow-id">SOW: '+I+" | "+t("pdf.sow.footerGenerated")+" "+new Date().toLocaleString(Qt)+'</p><p style="font-size: 7pt; font-style: italic;">'+t("pdf.sow.footerValid")+"</p></div></div><script>window.onload = function() {  var images = document.images;  var loaded = 0;  var total = images.length;  if (total === 0) { setTimeout(function() { window.print(); }, 300); return; }  for (var i = 0; i < total; i++) {    if (images[i].complete) { loaded++; }    else { images[i].onload = images[i].onerror = function() { loaded++; if (loaded >= total) setTimeout(function() { window.print(); }, 300); }; }  }  if (loaded >= total) setTimeout(function() { window.print(); }, 300);};<\/script></body></html>";var dn=new Blob([Ce],{type:"text/html;charset=utf-8"}),pi=URL.createObjectURL(dn),Tr=window.open(pi,"_blank");if(!Tr){URL.revokeObjectURL(pi),alert(t("alert.allowPopups"));return}Tr.onload=function(){URL.revokeObjectURL(pi)}},A.prototype.generateSOWPDFFromData=function(d){console.log("Generating PDF from saved SOW data:",d.clientName),this.generateSOWPDF(d)},A.prototype.editSOW=function(d){var y=this;console.log(" Opening editor for SOW:",d.id,"-",d.clientName),this.showSOWCreator(),setTimeout(function(){console.log("Populating form fields...");var w={clientName:n("#sowClientName"),clientEmail:n("#sowClientEmail"),clientPhone:n("#sowClientPhone"),clientIdToggle:n("#clientIdTypeToggle"),emailLabel:n("#emailToggleLabel"),phoneLabel:n("#phoneToggleLabel"),package:n("#sowPackage"),weeks:n("#sowWeeks"),startDate:n("#sowStartDate"),notes:n("#sowNotes"),maintenance:n("#sowMaintenance"),customPrice:n("#sowCustomPrice"),customSection:n("#customPricingSection")};if(w.clientName&&(w.clientName.value=d.clientName||""),d.clientPhone&&!d.clientEmail?(w.clientIdToggle&&(w.clientIdToggle.checked=!0),w.clientEmail&&(w.clientEmail.style.display="none"),w.clientPhone&&(w.clientPhone.style.display="block",w.clientPhone.value=h(d.clientPhone)),w.emailLabel&&w.emailLabel.classList.remove("active"),w.phoneLabel&&w.phoneLabel.classList.add("active")):(w.clientIdToggle&&(w.clientIdToggle.checked=!1),w.clientPhone&&(w.clientPhone.style.display="none"),w.clientEmail&&(w.clientEmail.style.display="block",w.clientEmail.value=d.clientEmail||""),w.phoneLabel&&w.phoneLabel.classList.remove("active"),w.emailLabel&&w.emailLabel.classList.add("active")),w.weeks&&(w.weeks.value=d.estimatedWeeks||""),w.startDate&&(w.startDate.value=d.startDate||""),w.notes&&(w.notes.value=d.notes||""),w.package&&(w.package.value=d.packageType||"",d.packageType==="custom"&&(w.customSection&&(w.customSection.style.display="block"),w.customPrice&&d.payment))){var b=d.payment.breakdown&&d.payment.breakdown.basePrice?d.payment.breakdown.basePrice:d.payment.total;w.customPrice.value=b||""}w.maintenance&&(w.maintenance.value=d.maintenancePlan||"none");var _=n("#sowRetroactive"),E=n("#sowDevDuration"),S=n("#sowDevDurationUnit"),C=n("#retroactiveDurationFields"),F=n("#sowRetroactiveEndDate"),I=n("#sowWeeks"),z=I?I.parentElement:null;_&&d.isRetroactive&&(_.checked=!0,C&&(C.style.display="block"),z&&(z.style.display="none"),E&&d.devDuration&&(E.value=d.devDuration),S&&d.devDurationUnit&&(S.value=d.devDurationUnit),F&&(d.retroactiveEndDate||d.startDate)&&(F.value=d.retroactiveEndDate||d.startDate),typeof toggleRetroactiveFields=="function"&&toggleRetroactiveFields());var O=n("#sowEntityTypeToggle"),q=n("#sowIndividualFields"),V=n("#sowBusinessFields"),X=n("#sowIndividualLabel"),G=n("#sowBusinessLabel"),j=n("#sowBusinessName"),Y=n("#sowEntityType"),ie=n("#sowStateOfFormation"),ae=n("#sowRepName"),le=n("#sowRepTitle"),pe=n("#sowBusinessEmail"),_e=n("#sowBusinessPhone");if(d.isBusinessEntity&&O?(O.checked=!0,q&&(q.style.display="none"),V&&(V.style.display="block"),X&&X.classList.remove("active"),G&&G.classList.add("active"),j&&(j.value=d.businessName||""),Y&&(Y.value=d.entityType||""),ie&&(ie.value=d.stateOfFormation||""),ae&&(ae.value=d.representativeName||""),le&&(le.value=d.representativeTitle||""),d.clientPhone&&!d.clientEmail?(pe&&(pe.style.display="none"),_e&&(_e.style.display="block",_e.value=h(d.clientPhone))):(_e&&(_e.style.display="none"),pe&&(pe.style.display="block",pe.value=d.clientEmail||""))):O&&(O.checked=!1,V&&(V.style.display="none"),q&&(q.style.display="block"),G&&G.classList.remove("active"),X&&X.classList.add("active")),d.payment&&d.payment.deferred&&d.payment.deferred.enabled){var oe=d.payment.deferred,be=n("#sowDeferredPayment"),Ie=n("#deferredPaymentFields");if(be){be.checked=!0,Ie&&(Ie.style.display="block");var We=document.querySelector('input[name="deferred_split"][value="'+oe.splitType+'"]');We&&(We.checked=!0);var qe=n("#lumpSumFields"),tt=n("#recurringFields"),Ke=n("#customSplitFields");if(qe&&(qe.style.display="none"),tt&&(tt.style.display="none"),Ke&&(Ke.style.display="none"),oe.splitType==="custom"){Ke&&(Ke.style.display="block");var at=n("#customPaymentsList");at&&oe.customSchedule&&oe.customSchedule.length>0&&(at.innerHTML="",oe.customSchedule.forEach(function(Ce){if(typeof addCustomPaymentRow=="function"){addCustomPaymentRow();var Nt=at.lastElementChild;if(Nt){var nt=Nt.querySelector(".custom-payment-amount"),ht=Nt.querySelector(".custom-payment-date");nt&&(nt.value=Ce.amount||""),ht&&(ht.value=Ce.dueDate||"")}}}))}else if(oe.splitType==="recurring"){tt&&(tt.style.display="block");var Ye=n("#sowRecurringTotalAmount"),ot=n("#sowRecurringStartDate"),Ft=n("#sowRecurringFrequency"),zt=n("#sowRecurringCalcMode"),De=n("#sowRecurringPaymentAmount"),Pe=n("#sowRecurringPaymentCount");Ye&&(Ye.value=oe.deferredAmount||""),ot&&(ot.value=oe.startDate||""),Ft&&(Ft.value=oe.frequency||"biweekly"),zt&&(zt.value=oe.calculationMode||"amount"),typeof toggleRecurringCalcMode=="function"&&toggleRecurringCalcMode(),oe.calculationMode==="amount"?De&&(De.value=oe.amountPerPayment||""):Pe&&(Pe.value=oe.numberOfPayments||""),typeof updateRecurringSchedule=="function"&&updateRecurringSchedule()}else{qe&&(qe.style.display="block");var kt=n("#sowDeferredAmount"),He=n("#sowDeferredDueDate");kt&&(kt.value=oe.deferredAmount||""),He&&(He.value=oe.dueDate||"")}var gt=document.querySelectorAll(".deferred-type-card");gt.forEach(function(Ce){var Nt=Ce.querySelector('input[type="radio"]');Nt&&Nt.checked?(Ce.style.borderColor="#6366f1",Ce.style.background="rgba(99, 102, 241, 0.15)"):(Ce.style.borderColor="transparent",Ce.style.background="rgba(255, 255, 255, 0.03)")});var qt=n("#sowWaiveLateFee"),Lt=n("#sowAllowPartialPayments"),Qe=n("#sowMaintenanceDuringDeferral");qt&&(qt.checked=oe.lateFeeWaived||oe.feeWaived||!1),Lt&&(Lt.checked=oe.allowPartialPayments!==!1),Qe&&(Qe.checked=oe.maintenanceDuringDeferral!==!1),typeof calculateLateFee=="function"&&calculateLateFee()}}var Ze={essential:{min:1e3,max:3e3,default:2e3},starter:{min:3e3,max:6e3,default:4500},growth:{min:6e3,max:12e3,default:9e3},professional:{min:12e3,max:25e3,default:18500},enterprise:{min:25e3,max:5e4,default:37500}},ut={none:0,basic:167,professional:335,premium:670},Ht={responsive_design:{default:200,thirdParty:!1},custom_ui:{default:450,thirdParty:!1},animations:{default:275,thirdParty:!1},seo_optimization:{default:200,thirdParty:!1},analytics:{default:175,thirdParty:!1},contact_forms:{default:250,thirdParty:!1},firebase_auth:{default:350,thirdParty:!0,note:"Firebase costs"},firebase_db:{default:425,thirdParty:!0,note:"Firebase costs"},user_profiles:{default:550,thirdParty:!1},file_storage:{default:300,thirdParty:!0,note:"Firebase costs"},api_integration:{default:450,thirdParty:!1},email_integration:{default:325,thirdParty:!0,note:"SendGrid costs"},newsletter:{default:200,thirdParty:!1,addon:!0},user_roles:{default:450,thirdParty:!1},notifications:{default:400,thirdParty:!1},booking_basic:{default:450,thirdParty:!1,addon:!0},booking_system:{default:1100,thirdParty:!1,addon:!0},blog:{default:400,thirdParty:!1,addon:!0},cms_integration:{default:600,thirdParty:!1,addon:!0},gallery:{default:325,thirdParty:!1,addon:!0},music_media:{default:275,thirdParty:!1,addon:!0},social_feed:{default:250,thirdParty:!1,addon:!0}},Kt={none:{price:0,label:t("ecommerce.none")},basic_cart:{price:5500,label:t("ecommerce.basicCart"),thirdParty:!0,note:"Stripe fees"},full_store:{price:14e3,label:t("ecommerce.fullStore"),thirdParty:!0,note:"Stripe fees"}},Ot={essential:["responsive_design","contact_forms"],starter:["responsive_design","custom_ui","animations","seo_optimization","analytics","contact_forms"],growth:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","contact_forms"],professional:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","firebase_db","user_profiles","file_storage","api_integration","contact_forms","email_integration","newsletter"],enterprise:["responsive_design","custom_ui","animations","seo_optimization","analytics","firebase_auth","firebase_db","user_profiles","user_roles","file_storage","api_integration","contact_forms","email_integration","notifications","newsletter"],custom:[]},zn=d.packageType||"",pt=Ot[zn]||[];if(d.features&&d.features.length>0){console.log("Checking",d.features.length,"features");var Ri=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]');Ri.forEach(function(Ce){Ce.checked=!1,Ce.parentElement.classList.remove("feature-included");var Nt=Ce.parentElement.textContent.trim(),nt=Ce.parentElement.querySelector(".third-party-note");nt&&(Nt=Nt.replace(nt.textContent,"").trim()),d.features.some(function(ht){return ht.indexOf(Nt)!==-1||Nt.indexOf(ht)!==-1})&&(Ce.checked=!0),pt.indexOf(Ce.value)!==-1&&Ce.parentElement.classList.add("feature-included")})}var Vn="none";d.payment&&d.payment.breakdown&&d.payment.breakdown.ecommerceOption&&(Vn=d.payment.breakdown.ecommerceOption);var fi=document.querySelector('input[name="ecommerce_option"][value="'+Vn+'"]');fi&&(fi.checked=!0);var nn=n("#sowCouponSelect");nn&&d.couponCode&&(nn.value=d.couponCode),setTimeout(function(){y.updateSOWPricing(Ze,ut,Ht,Kt,Ot)},100);var _t=n(".sow-form-header h4");if(_t&&(_t.innerHTML=" Edit Statement of Work"),d.editingFromChangeRequest){var un=d.editingFromChangeRequest,$t={package:t("changeOrder.section.package"),features:t("changeOrder.section.features"),timeline:t("changeOrder.section.timeline"),payment:t("changeOrder.section.payment"),maintenance:t("changeOrder.section.maintenance"),other:t("changeOrder.section.other")},rn=un.sections.map(function(Ce){return'<span style="background: rgba(251, 191, 36, 0.2); color: #fbbf24; padding: 3px 8px; border-radius: 4px; font-size: 0.75rem; margin-right: 4px;">'+($t[Ce]||Ce)+"</span>"}).join(""),wn='<div id="changeRequestBanner" style="background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(245, 158, 11, 0.1) 100%); border: 1px solid rgba(251, 191, 36, 0.4); border-radius: 12px; padding: 1rem; margin-bottom: 1.25rem;"><div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.75rem;"><h5 style="margin: 0; color: #fbbf24; font-size: 0.95rem; display: flex; align-items: center; gap: 6px;"> Change Request from '+un.clientName+`</h5><button onclick="document.getElementById('changeRequestBanner').remove()" style="background: none; border: none; color: rgba(255,255,255,0.5); cursor: pointer; font-size: 1.25rem; line-height: 1; padding: 0;">&times;</button></div><div style="margin-bottom: 0.75rem;">`+rn+'</div><div style="background: rgba(0,0,0,0.2); border-radius: 8px; padding: 0.75rem; max-height: 120px; overflow-y: auto;"><p style="margin: 0; font-size: 0.85rem; color: rgba(255,255,255,0.9); white-space: pre-wrap; line-height: 1.5;">'+un.description+"</p></div></div>",sn=document.querySelector(".sow-creator-form");if(sn){var Qt=sn.querySelector(".sow-form-section");Qt&&Qt.insertAdjacentHTML("beforebegin",wn)}y.currentEditChangeRequestId=un.id}var Cn=n(".btn-save-sow");if(Cn){var bn=Cn.cloneNode(!0);Cn.parentNode.replaceChild(bn,Cn),bn.innerHTML='<span class="btn-icon"></span> Update SOW',bn.onclick=function(Ce){Ce.preventDefault(),y.updateSOW(d.id)}}console.log(" Form populated for editing")},250)},A.prototype.updateSOW=function(d){var y=n("#sowEntityTypeToggle")&&n("#sowEntityTypeToggle").checked,w=n("#sowClientName").value.trim(),b=n("#sowClientEmail").value.trim(),_=n("#sowClientPhone").value.trim(),E=n("#sowBusinessName")?n("#sowBusinessName").value.trim():"",S=n("#sowEntityType")?n("#sowEntityType").value:"",C=n("#sowStateOfFormation")?n("#sowStateOfFormation").value.trim():"",F=n("#sowRepName")?n("#sowRepName").value.trim():"",I=n("#sowRepTitle")?n("#sowRepTitle").value.trim():"",z=n("#sowBusinessEmail")?n("#sowBusinessEmail").value.trim():"",O=n("#sowBusinessPhone")?n("#sowBusinessPhone").value.trim():"",q=n("#sowPackage").value,V=n("#sowWeeks").value,X=n("#sowStartDate").value,G=n("#sowNotes").value.trim(),j=n("#sowMaintenance").value,Y=n("#sowRetroactive")&&n("#sowRetroactive").checked,ie=n("#sowDevDuration")?n("#sowDevDuration").value:"",ae=n("#sowRetroactiveEndDate")?n("#sowRetroactiveEndDate").value:"",le="";if(_){var pe=_.replace(/\D/g,"");pe.length===10?le="+1"+pe:pe.length===11&&pe.startsWith("1")?le="+"+pe:le=_}var _e="";if(O){var oe=O.replace(/\D/g,"");oe.length===10?_e="+1"+oe:oe.length===11&&oe.startsWith("1")?_e="+"+oe:_e=O}var be=[];if(y){if(E||be.push("Business Legal Name"),S||be.push("Entity Type"),F||be.push("Representative Name"),I||be.push("Representative Title"),q||be.push("Package Tier"),Y?ie||be.push("Development Duration"):V||be.push("Estimated Weeks"),be.length>0){alert(t("sow.val.fillRequired")+be.join(`
- `));return}if(!z&&!_e){alert(t("sow.val.businessEmailOrPhone"));return}}else{if(w||be.push("Client Name"),q||be.push("Package Tier"),Y?ie||be.push("Development Duration"):V||be.push("Estimated Weeks"),be.length>0){alert(t("sow.val.fillRequired")+be.join(`
- `));return}if(!b&&!le){alert(t("sow.val.clientEmailOrPhone"));return}}var Ie=[],We=document.querySelectorAll('.sow-checkboxes input[type="checkbox"]:checked');We.forEach(function(Ze){var ut=Ze.parentElement.textContent.trim(),Ht=Ze.parentElement.querySelector(".third-party-note");Ht&&(ut=ut.replace(Ht.textContent,"").trim()),Ie.push(ut)});var qe=document.querySelector('input[name="ecommerce_option"]:checked'),tt=qe?qe.value:"none",Ke=this.currentPricingData||{basePrice:0,addOns:[],discounts:[],ecommerceOption:tt,ecommercePrice:0,total:0},at=Ke.total,Ye=n("#sowCouponSelect"),ot=Ye?Ye.value:"",Ft=n("#sowDevDurationUnit")?n("#sowDevDurationUnit").value:"weeks",zt=ie&&parseInt(ie)||null,De=n("#sowDeferredPayment")&&n("#sowDeferredPayment").checked,Pe={enabled:De,splitType:"lump_sum",dueDate:null,deferredAmount:0,lateFee:0,lateFeeWaived:!1,allowPartialPayments:!0,maintenanceDuringDeferral:!0,customSchedule:[],frequency:null,startDate:null,calculationMode:null,amountPerPayment:null,numberOfPayments:null,acknowledgmentSigned:!1,acknowledgmentDate:null};if(De){var kt=document.querySelector('input[name="deferred_split"]:checked');if(Pe.splitType=kt?kt.value:"lump_sum",Pe.lateFeeWaived=n("#sowWaiveLateFee")&&n("#sowWaiveLateFee").checked,Pe.allowPartialPayments=n("#sowAllowPartialPayments")?n("#sowAllowPartialPayments").checked:!0,Pe.maintenanceDuringDeferral=n("#sowMaintenanceDuringDeferral")?n("#sowMaintenanceDuringDeferral").checked:!0,Pe.splitType==="custom"){var He=[],gt=document.querySelectorAll(".custom-payment-row");gt.forEach(function(Ze){var ut=Ze.querySelector(".custom-payment-amount"),Ht=Ze.querySelector(".custom-payment-date"),Kt=parseFloat(ut?ut.value:0)||0,Ot=Ht?Ht.value:null;Kt>0&&He.push({amount:Kt,dueDate:Ot})}),Pe.customSchedule=He,Pe.deferredAmount=He.reduce(function(Ze,ut){return Ze+ut.amount},0)}else if(Pe.splitType==="recurring"){Pe.deferredAmount=parseFloat(n("#sowRecurringTotalAmount")?n("#sowRecurringTotalAmount").value:0)||0,Pe.startDate=n("#sowRecurringStartDate")?n("#sowRecurringStartDate").value:null,Pe.frequency=n("#sowRecurringFrequency")?n("#sowRecurringFrequency").value:"biweekly",Pe.calculationMode=n("#sowRecurringCalcMode")?n("#sowRecurringCalcMode").value:"amount",Pe.calculationMode==="amount"?Pe.amountPerPayment=parseFloat(n("#sowRecurringPaymentAmount")?n("#sowRecurringPaymentAmount").value:0)||0:Pe.numberOfPayments=parseInt(n("#sowRecurringPaymentCount")?n("#sowRecurringPaymentCount").value:0)||0;var qt=Pe.calculationMode==="amount"?Pe.amountPerPayment:Pe.numberOfPayments;Pe.customSchedule=generateRecurringSchedule(Pe.deferredAmount,Pe.startDate,Pe.frequency,Pe.calculationMode,qt)}else Pe.deferredAmount=parseFloat(n("#sowDeferredAmount")?n("#sowDeferredAmount").value:0)||0,Pe.dueDate=n("#sowDeferredDueDate")?n("#sowDeferredDueDate").value:null;if(Pe.lateFee=Pe.lateFeeWaived?0:Pe.deferredAmount*.1,Pe.deferredAmount<=0){alert(t("sow.val.deferredAmount"));return}if(Pe.splitType==="lump_sum"&&!Pe.dueDate){alert(t("sow.val.deferredDueDate"));return}if(Pe.splitType==="custom"&&Pe.customSchedule.length===0){alert(t("sow.val.customSchedule"));return}if(Pe.splitType==="recurring"){if(!Pe.startDate){alert(t("sow.val.firstPaymentDate"));return}if(Pe.calculationMode==="amount"&&(!Pe.amountPerPayment||Pe.amountPerPayment<=0)){alert(t("sow.val.paymentAmount"));return}if(Pe.calculationMode==="count"&&(!Pe.numberOfPayments||Pe.numberOfPayments<2)){alert(t("sow.val.paymentCount"));return}if(Pe.customSchedule.length===0){alert(t("sow.val.scheduleError"));return}}if(Pe.deferredAmount>at){alert(t("sow.val.deferredExceedsTotal"));return}}var Lt={clientName:y?E:w,clientEmail:y?z||"":b||"",clientPhone:y?g(_e)||"":g(le)||"",packageType:q,estimatedWeeks:Y?zt||null:parseInt(V),startDate:Y?ae||null:X||null,features:Ie,notes:G,maintenancePlan:j,isRetroactive:Y,devDuration:zt,devDurationUnit:Ft,retroactiveEndDate:Y&&ae||null,couponCode:ot||null,isBusinessEntity:y,businessName:y?E:"",entityType:y?S:"",stateOfFormation:y?C:"",representativeName:y?F:"",representativeTitle:y?I:"",payment:{total:at,deposit:at*.5,milestone1:at*.25,final:at*.25,breakdown:{basePrice:Ke.basePrice,addOns:Ke.addOns,discounts:Ke.discounts,ecommerceOption:Ke.ecommerceOption,ecommercePrice:Ke.ecommercePrice,couponCode:ot||null,couponDiscount:Ke.couponDiscount||0},deferred:Pe},updatedAt:firebase.firestore.FieldValue.serverTimestamp()},Qe=this;firebase.firestore().collection("sow_documents").doc(d).update(Lt).then(function(){if(console.log("SOW updated successfully"),Qe.currentEditChangeRequestId)return firebase.firestore().collection("change_requests").doc(Qe.currentEditChangeRequestId).update({status:"completed",completedAt:firebase.firestore.FieldValue.serverTimestamp(),updatedAt:firebase.firestore.FieldValue.serverTimestamp()}).then(function(){return firebase.firestore().collection("sow_documents").doc(d).update({changeRequestStatus:"completed",lastChangeOrderApplied:firebase.firestore.FieldValue.serverTimestamp()})}).then(function(){Qe.currentEditChangeRequestId=null,alert(t("sow.msg.updateChangeSuccess"))});alert(t("sow.msg.updateSuccess"))}).then(function(){n("#sowCreatorContainer").style.display="none",Qe.loadSOWDocuments()}).catch(function(Ze){console.error("Error updating SOW:",Ze),alert(t("sow.err.update")+Ze.message)})},A.prototype.selectContractToSign=function(d,y){var w=y.find(function(E){return E.id===d});if(!w){alert(t("contract.err.notFound"));return}console.log("Selected contract to sign:",d),this.currentContract={id:d,data:w};var b=n("#developerDashboard");b&&(b.style.display="none");var _=n("#contractForm");_&&(_.style.display="block"),this.showContractSigningForm(w)},A.prototype.showContractSigningForm=function(d){var y=this,w=n("#contractForm");w&&(w.style.display="block");var b=n(".modal-header");b&&(b.style.display="block");var _=n(".modal-close");_&&(_.style.display="flex",_.style.position="",_.style.top="",_.style.alignSelf="",_.style.marginRight="",_.style.marginTop="",_.style.marginBottom="",_.style.flexShrink="");var E=n("#devSignatureBlock");if(E){E.style.display="block";var S=E.querySelectorAll("input");S.forEach(function(X){X.disabled=!1});var C=E.querySelector("h3");C&&(C.innerHTML=t("contract.label.devSig")+' <span style="font-size: 12px; color: #f59e0b;">'+t("contract.label.signBelow")+"</span>")}var F=new Date().toISOString().split("T")[0],I=n("#devDate");I&&(I.value=F),this.populateFormWithContract(d);var z=n("#submitBtn");z&&(z.style.display="inline-flex",z.disabled=!1,z.innerHTML='<span id="submitBtnText">'+t("contract.btn.uploadFinalize")+"</span>",z.style.background="");var O=n("#backToDashboard");O&&O.remove();var q=document.createElement("button");q.id="backToDashboard",q.className="btn btn-secondary",q.innerHTML=t("contract.btn.backDashboard"),q.style.marginRight="10px",q.onclick=function(X){X.preventDefault(),y.showDeveloperDashboard(),y.devSignaturePad&&y.devSignaturePad.clear()};var V=n(".action-buttons");V&&V.insertBefore(q,V.firstChild),setTimeout(function(){var X=document.getElementById("devSignaturePad");X&&(y.devSignaturePad=H(X),console.log("Dev signature pad initialized for signing"))},200)},A.prototype.viewCompletedContract=function(d,y){var w=y.find(function(b){return b.id===d});if(!w){alert(t("contract.err.notFound"));return}console.log("Viewing completed contract:",d),this.currentContract={id:d,data:w},this.generatePDF()},A.prototype.setupClientView=function(){console.log("Setting up client view - dual signing mode");var d=this,y=firebase.auth().currentUser,w=n(".modal-close");w&&(w.style.display="flex");var b=y.email,_=y.phoneNumber,E;if(b)console.log("Checking existing contracts by email:",b),E=firebase.firestore().collection("contracts").where("clientEmail","==",b).where("status","in",["pending_developer","completed"]).orderBy("timestamp","desc").limit(1);else if(_){var S=_.replace(/\D/g,""),C=S.length===11&&S.startsWith("1")?S.slice(1):S,F=[_,S,C,"("+C.slice(0,3)+") "+C.slice(3,6)+"-"+C.slice(6)];console.log("Checking existing contracts by phone formats:",F);var I=function(z){if(z>=F.length){console.log("No existing contract found for phone user"),d.proceedWithClientSetup();return}firebase.firestore().collection("contracts").where("clientPhone","==",F[z]).where("status","in",["pending_developer","completed"]).orderBy("timestamp","desc").limit(1).get().then(function(O){if(O.empty)I(z+1);else{var q=O.docs[0],V=q.data();V.id=q.id,console.log("Found existing contract with format:",F[z]);var X=document.getElementById("dualSigningCompleted");X?X.style.display="block":d.showExistingCompletion(V)}}).catch(function(){I(z+1)})};I(0);return}else return console.log("No email or phone - proceeding to setup"),d.proceedWithClientSetup();E.get().then(function(z){if(!z.empty){var O=z.docs[0],q=O.data();q.id=O.id,console.log("Found existing contract with status:",q.status);var V=document.getElementById("dualSigningCompleted");V?(V.style.display="block",console.log("Showing existing completion view")):d.showExistingCompletion(q);return}return d.proceedWithClientSetup()}).catch(function(z){console.error("Error checking existing contracts:",z),d.proceedWithClientSetup()})},A.prototype.proceedWithClientSetup=function(){var d=this,y=n("#clientSignatureBlock");y&&(y.style.display="block",y.style.pointerEvents="auto",y.classList.remove("signature-locked"));var w=n("#devSignatureBlock");if(w){w.style.display="none";var b=w.querySelectorAll("input");b.forEach(function(X){X.disabled=!0,X.removeAttribute("required")})}var _=n("#devPendingBlock");_&&(_.style.display="block");var E=n("#downloadBtn");E&&(E.style.display="none");var S=firebase.auth().currentUser,C=S.email,F=S.phoneNumber,I;if(C)console.log("Querying SOW by email:",C),I=firebase.firestore().collection("sow_documents").where("clientEmail","==",C).orderBy("createdAt","desc").limit(1);else if(F){var z=F.replace(/\D/g,""),O=z.length===11&&z.startsWith("1")?z.slice(1):z,q=[F,z,O,"("+O.slice(0,3)+") "+O.slice(3,6)+"-"+O.slice(6)];console.log("Querying SOW by phone formats:",q);var V=function(X){if(X>=q.length){console.log(" No SOW found for client (tried all phone formats)"),d.showNoSOWNotification();return}firebase.firestore().collection("sow_documents").where("clientPhone","==",q[X]).orderBy("createdAt","desc").limit(1).get().then(function(G){if(G.empty)V(X+1);else{var j=G.docs[0],Y=j.data();Y.id=j.id,console.log(" SOW found with format:",q[X],"ID:",Y.id),d.showDualSigningInterface(Y)}}).catch(function(G){console.error("Error querying SOW format",q[X],G),V(X+1)})};V(0);return}else{console.log("No email or phone found"),d.showNoSOWNotification();return}I.get().then(function(X){if(X.empty)console.log(" No SOW found for client"),d.showNoSOWNotification();else{var G=X.docs[0],j=G.data();j.id=G.id,d.showDualSigningInterface(j)}}).catch(function(X){console.error("Error fetching SOW:",X),d.showNoSOWNotification(X.message)})},A.prototype.showNoSOWNotification=function(d){console.log("Showing no-SOW notification");var y=n("#clientSignatureBlock");y&&(y.style.display="none");var w=n("#submitBtn");w&&(w.style.display="none",w.disabled=!0);var b='<div class="sow-missing-notification"><div class="notification-icon"></div><div class="notification-content"><h4>'+t("signing.sowRequired")+"</h4><p>"+t("signing.sowRequiredMsg")+'</p><p class="notification-action">'+t("signing.sowRequiredAction")+' <a href="#" class="request-help-link" style="color: #6366f1; text-decoration: underline; cursor: pointer; font-weight: 700;">'+t("signing.requestHelp")+"</a> "+t("signing.sowRequiredAction2")+"</p></div></div>",_=n("#contractForm");if(_){var E=n(".sow-missing-notification");E&&E.remove(),_.insertAdjacentHTML("afterbegin",b);var S=n(".request-help-link");S&&S.addEventListener("click",function(F){F.preventDefault();var I=n("#helpModal");if(I){I.classList.add("show"),document.body.style.overflow="hidden",document.body.classList.add("modal-open");var z=firebase.auth().currentUser;if(z){var O=n("#helpContact"),q=n("#helpContactLabel");O&&(z.email?(O.value=z.email,O.type="email",O.placeholder="your@email.com",q&&(q.textContent=t("help.label.email"))):z.phoneNumber&&(O.value=h(z.phoneNumber),O.type="tel",O.placeholder="(555) 123-4567",q&&(q.textContent=t("help.label.phone"))),O.setAttribute("readonly","readonly"),O.style.opacity="0.7")}}})}var C=n("#requestHelpBtn");C&&(C.style.animation="pulse 6s infinite",C.style.boxShadow="0 0 20px rgba(255, 255, 255, 0.18)")},A.prototype.showDualSigningInterface=function(d){var y=this;console.log("Showing dual signing interface for:",d.clientName),this.currentSOW=d,this.populateClientInfoFromSOW(d);var w=n("#contractForm");w&&(w.style.display="none");var b=n("#submitBtn");b&&(b.style.display="none");var _=n(".modal-content");if(_){var E=n("#clientSigningTabs");E&&(console.log("Removing existing tabs to prevent duplicates"),E.remove());var S=n("#closeModalBtn");S&&(S.style.position="sticky",S.style.top="1rem",S.style.alignSelf="flex-end",S.style.marginRight="1.5rem",S.style.marginTop="1rem",S.style.marginBottom="-2.5rem",S.style.flexShrink="0");var C=document.createElement("div");C.id="clientSigningTabs",C.className="client-signing-tabs",C.innerHTML='<div class="signing-tabs-header"><button class="signing-tab active" data-tab="contract"><span class="tab-icon"></span><span class="tab-title">'+t("signing.contractAgreement")+'</span><span class="tab-status" id="contractStatus">'+t("signing.pending")+'</span></button><button class="signing-tab" data-tab="sow"><span class="tab-icon"></span><span class="tab-title">'+t("signing.statementOfWork")+'</span><span class="tab-status" id="sowStatus">'+t("signing.pending")+'</span></button></div><div class="signing-tabs-content"><div class="signing-tab-pane active" data-tab="contract"><div id="contractSigningContent"></div></div><div class="signing-tab-pane" data-tab="sow"><div id="sowSigningContent"></div></div></div><div class="signing-footer"><div class="signing-progress"><div class="progress-indicator"><span class="progress-dot" id="contractDot"></span><span class="progress-line"></span><span class="progress-dot" id="sowDot"></span></div><p class="progress-text">'+t("signing.completeBoth")+'</p></div><button class="btn btn-primary" id="dualSignBtn"><span id="dualSignBtnText">'+t("signing.nextSignSOW")+"</span></button></div>",S&&S.nextSibling?_.insertBefore(C,S.nextSibling):_.appendChild(C);var F=n("#contractSigningContent");if(F){var I=document.createElement("div");I.className="modal-header",I.innerHTML="<h2>"+t("signing.contract")+'</h2><p class="modal-subtitle">Scarlo - Carlos Martin</p>',F.appendChild(I),F.appendChild(w),w.style.display="block";var z=document.getElementById("clientSignerName");z&&(z.disabled=!1,z.required=!0,z.style.pointerEvents="auto");var O=document.getElementById("clientDate");O&&(O.disabled=!1,O.required=!0,O.style.pointerEvents="auto",O.value||(O.value=new Date().toISOString().split("T")[0]));var q=document.querySelector(".acknowledgment");q&&(q.style.display="block");var V=document.getElementById("acknowledgment");V&&(V.disabled=!1,V.required=!0)}if(this.renderSOWForClientSigning(d),typeof getCurrentLang=="function"&&getCurrentLang()!=="en"){var X=window.navigation||window.navInstance;X&&X.applyLanguage?X.applyLanguage(getCurrentLang()):(document.querySelectorAll("[data-i18n]").forEach(function(j){var Y=j.getAttribute("data-i18n"),ie=t(Y);ie&&ie!==Y&&(j.textContent=ie)}),document.querySelectorAll("[data-i18n-html]").forEach(function(j){var Y=j.getAttribute("data-i18n-html"),ie=t(Y);ie&&ie!==Y&&(j.innerHTML=ie)}),document.querySelectorAll("[data-i18n-placeholder]").forEach(function(j){var Y=j.getAttribute("data-i18n-placeholder"),ie=t(Y);ie&&ie!==Y&&(j.placeholder=ie)}))}e(".signing-tab").forEach(function(j){j.addEventListener("click",function(){var Y=this.getAttribute("data-tab");y.switchSigningTab(Y)})});var G=n("#dualSignBtn");G&&G.addEventListener("click",function(j){j.preventDefault();var Y=n(".signing-tab.active"),ie=Y?Y.getAttribute("data-tab"):"contract";if(ie==="contract"){var ae=y.validateContractTab();if(ae.length>0){alert(t("signing.pleaseComplete")+`

`+ae.join(`
`));return}y.updateSignatureStatus("contract",!0),y.switchSigningTab("sow")}else y.submitBothSignatures()}),setTimeout(function(){console.log(" Initializing dual signature pads...");var j=document.getElementById("clientSignaturePad");if(j){console.log("Found contract canvas, initializing..."),j.style.pointerEvents="auto",j.style.touchAction="none",j.style.cursor="crosshair";var Y=j.closest(".signature-block");Y&&(Y.classList.remove("signature-locked"),Y.style.pointerEvents="auto"),y.clientSignaturePad=H(j),console.log(" Contract signature pad initialized");var ie=n('.clear-btn[data-canvas="clientSignaturePad"]');ie&&ie.addEventListener("click",function(be){be.preventDefault(),y.clientSignaturePad&&(y.clientSignaturePad.clear(),y.updateSignatureStatus("contract",!1))})}else console.error(" Contract signature canvas not found!");var ae=n('.clear-btn[data-canvas="sowClientSignaturePad"]');ae&&ae.addEventListener("click",function(be){be.preventDefault(),window.sowClientPad&&(window.sowClientPad.clear(),y.updateSignatureStatus("sow",!1))}),console.log(" SOW signature pad will be initialized when SOW tab is opened");var le=document.getElementById("clientSignerName");le&&(le.disabled=!1);var pe=document.getElementById("clientDate");pe&&(pe.disabled=!1,pe.value||(pe.value=new Date().toISOString().split("T")[0]));var _e=document.querySelector(".acknowledgment");_e&&(_e.style.display="block");var oe=document.getElementById("acknowledgment");oe&&(oe.disabled=!1),y.checkExistingSignatures()},400)}},A.prototype.renderSOWForClientSigning=function(d){var y=n("#sowSigningContent");if(y){var w={essential:t("pkg.essential"),starter:t("pkg.starter"),growth:t("pkg.growth"),professional:t("pkg.professional"),enterprise:t("pkg.enterprise"),custom:t("pkg.custom")},b={essential:{includes:[t("pkg.essential.i1"),t("pkg.essential.i2"),t("pkg.essential.i3"),t("pkg.essential.i4"),t("pkg.essential.i5"),t("pkg.essential.i6")]},starter:{includes:[t("pkg.starter.i1"),t("pkg.starter.i2"),t("pkg.starter.i3"),t("pkg.starter.i4"),t("pkg.starter.i5"),t("pkg.starter.i6"),t("pkg.starter.i7")]},growth:{includes:[t("pkg.growth.i1"),t("pkg.growth.i2"),t("pkg.growth.i3"),t("pkg.growth.i4"),t("pkg.growth.i5"),t("pkg.growth.i6"),t("pkg.growth.i7")]},professional:{includes:[t("pkg.professional.i1"),t("pkg.professional.i2"),t("pkg.professional.i3"),t("pkg.professional.i4"),t("pkg.professional.i5"),t("pkg.professional.i6"),t("pkg.professional.i7"),t("pkg.professional.i8")]},enterprise:{includes:[t("pkg.enterprise.i1"),t("pkg.enterprise.i2"),t("pkg.enterprise.i3"),t("pkg.enterprise.i4"),t("pkg.enterprise.i5"),t("pkg.enterprise.i6"),t("pkg.enterprise.i7"),t("pkg.enterprise.i8")]}},_=b[d.packageType]||{includes:[]},E=d.payment?d.payment.total:0,S=E*.5,C=E*.25,F=E*.25,I=d.payment&&d.payment.breakdown?d.payment.breakdown:null,z=I?I.basePrice:E,O=I?I.addOns:[],q=I?I.discounts:[],V=I?I.couponCode:null,X=I?I.couponDiscount:0,G='<div class="modal-header"><h2>'+t("sow.title")+'</h2><p class="modal-subtitle">Scarlo - Carlos Martin</p></div><section class="contract-section-inner"><h3>'+t("sow.clientInfo")+'</h3><div class="sow-info-grid"><div class="sow-info-item"><strong>'+t("sow.clientName")+"</strong> "+d.clientName+'</div><div class="sow-info-item"><strong>'+t("sow.contact")+"</strong> "+(d.clientEmail||d.clientPhone||t("common.na"))+'</div><div class="sow-info-item"><strong>'+t("sow.package")+"</strong> "+(w[d.packageType]||d.packageType)+'</div><div class="sow-info-item"><strong>'+t("sow.timeline")+"</strong> "+(d.estimatedWeeks||t("common.tbd"))+" "+t("sow.weeks")+'</div></div></section><section class="contract-section-inner"><h3>'+t("sow.packageIncludes")+'</h3><ul class="sow-list">';d.packageType==="custom"?d.features&&d.features.length>0&&d.features.forEach(function(Y){G+="<li>"+translateStoredFeature(Y)+"</li>"}):_.includes&&_.includes.length>0&&_.includes.forEach(function(Y){G+="<li>"+Y+"</li>"}),G+="</ul></section>",d.packageType!=="custom"&&d.features&&d.features.length>0&&(G+='<section class="contract-section-inner"><h3>'+t("sow.additionalFeatures")+'</h3><ul class="sow-list">',d.features.forEach(function(Y){G+="<li>"+translateStoredFeature(Y)+"</li>"}),G+="</ul></section>"),d.notes&&(G+='<section class="contract-section-inner"><h3>'+t("sow.specialRequirements")+"</h3><p>"+d.notes+"</p></section>"),G+='<section class="contract-section-inner"><h3>'+t("sow.pricingBreakdown")+'</h3><table class="sow-payment-table pricing-breakdown-table"><thead><tr><th>'+t("sow.item")+"</th><th>"+t("sow.description")+"</th><th>"+t("sow.amount")+'</th></tr></thead><tbody><tr class="base-package-row"><td><strong>'+(w[d.packageType]||t("common.package"))+"</strong></td><td>"+t("sow.basePackagePrice")+"</td><td><strong>$"+z.toFixed(0)+"</strong></td></tr>",O&&O.length>0&&O.forEach(function(Y){var ie=Y.thirdParty?' <span class="third-party-indicator">*</span>':"",ae=Y.key?translateAddonByKey(Y.key,Y.label):translateStoredFeature(Y.label);G+='<tr class="addon-row"><td>'+ae+ie+"</td><td>"+t("sow.additionalFeature")+'</td><td class="addon-price">+$'+Y.price.toFixed(0)+"</td></tr>"}),q&&q.length>0&&q.forEach(function(Y){var ie=Y.key?translateAddonByKey(Y.key,Y.label):translateStoredFeature(Y.label);G+='<tr class="discount-row"><td>'+ie+"</td><td>"+t("sow.featureRemoved")+'</td><td class="discount-price">-$'+Y.price.toFixed(0)+"</td></tr>"}),V&&X>0&&(G+='<tr class="coupon-row"><td>'+V+"</td><td>"+t("sow.couponDiscount")+'</td><td class="discount-price">-$'+X.toFixed(0)+"</td></tr>"),G+='<tr class="sow-total-row"><td colspan="2"><strong>'+t("sow.totalProjectCost")+"</strong></td><td><strong>$"+E.toFixed(0)+"</strong></td></tr></tbody></table>",O&&O.some(function(Y){return Y.thirdParty})&&(G+='<p class="third-party-note-text"><span class="third-party-indicator">*</span> '+t("sow.thirdPartyNote")+"</p>"),G+='<button type="button" class="view-industry-pricing-btn" onclick="window.contractFormHandler.showPricingComparisonModal()"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>'+t("sow.viewIndustryPricing")+"</button>",G+="</section>",G+='<section class="contract-section-inner"><h3>'+t("sow.paymentSchedule")+'</h3><table class="sow-payment-table"><thead><tr><th>'+t("sow.paymentMilestone")+"</th><th>"+t("sow.description")+"</th><th>"+t("sow.amount")+"</th></tr></thead><tbody><tr><td><strong>"+t("sow.initialDeposit")+"</strong></td><td>"+t("sow.dueBeforeWork")+"</td><td><strong>$"+S.toFixed(0)+"</strong></td></tr><tr><td><strong>"+t("sow.milestone1")+"</strong></td><td>"+t("sow.designApproval")+"</td><td><strong>$"+C.toFixed(0)+"</strong></td></tr><tr><td><strong>"+t("sow.finalPayment")+"</strong></td><td>"+t("sow.priorToDeployment")+"</td><td><strong>$"+F.toFixed(0)+"</strong></td></tr></tbody></table></section>",G+='<section class="contract-section-inner"><h3>'+t("sow.termsConditions")+"</h3><p>"+t("sow.termsText1")+" <strong>"+d.clientName+"</strong>"+t("sow.termsText2")+"</p><p>"+t("sow.termsText3")+'</p></section><section class="contract-section-inner signatures"><h3>'+t("sow.clientSignatureRequired")+"</h3><p>"+t("sow.signatureInstructions")+'</p><div class="signature-block"><h3>'+t("sow.clientSignature")+" "+d.clientName+'</h3><div class="form-row"><div class="form-group"><label>'+t("sow.fullName")+'</label><input type="text" id="sowClientName" value="'+d.clientName+'" required /></div><div class="form-group"><label>'+t("sow.date")+'</label><input type="date" id="sowClientDate" required /></div></div><div class="signature-pad-container"><canvas id="sowClientSignaturePad" class="signature-pad"></canvas><button class="clear-btn" data-canvas="sowClientSignaturePad">'+t("sow.clear")+"</button></div></div></section>",y.innerHTML=G;var j=n("#sowClientDate");j&&(j.value=new Date().toISOString().split("T")[0]),console.log(" SOW content rendered, signature pad will be initialized by parent function")}},A.prototype.switchSigningTab=function(d){var y=this;e(".signing-tab").forEach(function(E){E.classList.remove("active"),E.getAttribute("data-tab")===d&&E.classList.add("active")}),e(".signing-tab-pane").forEach(function(E){E.classList.remove("active"),E.getAttribute("data-tab")===d&&E.classList.add("active")}),d==="sow"&&setTimeout(function(){var E=document.getElementById("sowClientSignaturePad");if(E){console.log(" SOW tab opened - initializing signature pad"),E.style.pointerEvents="auto",E.style.touchAction="none",E.style.cursor="crosshair";var S=E.closest(".signature-block");S&&(S.classList.remove("signature-locked"),S.style.pointerEvents="auto"),E.style.display="block",E.style.width="100%",E.style.height="270px",requestAnimationFrame(function(){requestAnimationFrame(function(){!window.sowClientPad||typeof window.sowClientPad.resize!="function"?(window.sowClientPad=H(E),console.log(" SOW signature pad created")):(window.sowClientPad.resize(),console.log(" SOW signature pad resized"));var z=E.getBoundingClientRect();console.log("SOW canvas rect:",z.width,"x",z.height,"left:",z.left,"top:",z.top)})});var C=function(){var z=n("#dualSignBtn");if(z){var O=window.sowClientPad&&!window.sowClientPad.isEmpty();z.disabled=!O,z.style.opacity=O?"1":"0.5",console.log("SOW signature state:",O?"Signed ":"Empty ")}};E.addEventListener("mouseup",C),E.addEventListener("touchend",C);var F=n('.clear-btn[data-canvas="sowClientSignaturePad"]');if(F){var I=F.cloneNode(!0);F.parentNode.replaceChild(I,F),I.addEventListener("click",function(z){z.preventDefault(),window.sowClientPad&&(window.sowClientPad.clear(),y.updateSignatureStatus("sow",!1),C())})}C()}else console.error(" SOW signature canvas not found when switching to tab")},100);var w=n("#dualSignBtn"),b=n("#dualSignBtnText");if(d==="contract")b&&(b.textContent=t("signing.nextSignSOW")),w&&(w.disabled=!1,w.style.display="inline-flex");else if(d==="sow"){b&&(b.textContent=t("signing.submitForDev"));var _=window.sowClientPad&&!window.sowClientPad.isEmpty();w&&(w.disabled=!_,w.style.display="inline-flex",w.style.opacity=_?"1":"0.5")}},A.prototype.checkExistingSignatures=function(){var d=!1,y=!1;if(this.clientSignaturePad&&!this.clientSignaturePad.isEmpty()&&(d=!0,this.updateSignatureStatus("contract",!0)),window.sowClientPad&&!window.sowClientPad.isEmpty()&&(y=!0,this.updateSignatureStatus("sow",!0)),d&&y){var w=n("#submitBothBtn");w&&(w.style.display="inline-flex")}},A.prototype.updateSignatureStatus=function(d,y){var w=n("#"+d+"Status"),b=n("#"+d+"Dot");y?(w&&(w.textContent=t("signing.signed"),w.style.color="#10b981"),b&&b.classList.add("completed")):(w&&(w.textContent=t("signing.pending"),w.style.color="#f59e0b"),b&&b.classList.remove("completed"));var _=n("#contractStatus")&&n("#contractStatus").textContent.includes(""),E=n("#sowStatus")&&n("#sowStatus").textContent.includes(""),S=n(".signing-tab.active"),C=S&&S.getAttribute("data-tab")==="sow",F=n("#submitBothBtn");F&&(F.style.display=C&&_&&E?"inline-flex":"none")},A.prototype.validateContractTab=function(){var d=[],y=n("#clientName");(!y||!y.value.trim())&&d.push(" Client Name / Company Name is required");var w=n("#clientSignerName");(!w||!w.value.trim())&&d.push(" Your Full Name is required");var b=n("#clientDate");(!b||!b.value)&&d.push(" Signature Date is required");var _=n("#acknowledgment");return(!_||!_.checked)&&d.push(" You must acknowledge the terms and conditions"),(!this.clientSignaturePad||this.clientSignaturePad.isEmpty())&&d.push(" Your signature is required"),d},A.prototype.checkPendingClientContract=function(d){var y=this;firebase.firestore().collection("contracts").where("clientEmail","==",d).where("status","==","pending_developer").limit(1).get().then(function(w){w.empty||y.showPendingStatus()}).catch(function(w){console.error("Error checking pending contracts:",w)})},A.prototype.showCompletedContract=function(d,y){console.log("Showing completed contract");var w=this;this.isViewingCompletedContract=!0;var b=n("#devPendingBlock");b&&(b.style.display="none");var _=n(".acknowledgment");_&&(_.style.display="none");var E=n("#clientName");E&&(E.value=y.clientName||"",E.setAttribute("readonly","readonly"),E.disabled=!0);var S=n("#clientSubmitMessage");S&&(S.innerHTML="<p><strong>"+t("contract.msg.fullyExecuted")+"</strong></p><p>"+t("contract.msg.bothSigned")+"</p><p>"+t("contract.msg.contractDate")+(y.clientDate||"N/A")+"</p><p>"+t("common.finalized")+": "+(y.finalizedTimestamp?new Date(y.finalizedTimestamp.toDate()).toLocaleDateString():"N/A")+"</p>",S.style.display="block",S.style.background="rgba(46, 204, 113, 0.15)",S.style.borderColor="rgba(46, 204, 113, 0.4)"),this.currentContract={id:d,data:y};var C=n("#submitBtn");if(C){var F=C.cloneNode(!0);F.innerHTML="<span>"+t("contract.btn.downloadSigned")+"</span>",F.style.display="inline-flex",F.disabled=!1,F.style.background="linear-gradient(135deg, #10b981 0%, #059669 100%)",C.parentNode.replaceChild(F,C),F.addEventListener("click",function(I){I.preventDefault(),I.stopPropagation(),console.log("Download button clicked - generating PDF"),w.generatePDF()})}this.displayBothSignatures(y)},A.prototype.displayBothSignatures=function(d){var y=this;console.log("Displaying both signatures..."),console.log("Client signature exists:",!!d.clientSignature),console.log("Dev signature exists:",!!d.devSignature);var w=n("#clientSignatureBlock");if(w){w.style.display="block",w.style.opacity="1";var b=document.getElementById("clientSignaturePad");if(b){var _=b.cloneNode(!0);b.parentNode.replaceChild(_,b)}w.style.pointerEvents="none",w.classList.add("signature-locked");var E=n("#clientSignerName");E&&(E.value=d.clientSignerName||"",E.setAttribute("readonly","readonly"));var S=n("#clientDate");S&&(S.value=d.clientDate||"",S.setAttribute("readonly","readonly"))}var C=n("#devSignatureBlock");if(C){C.style.display="block",C.style.opacity="1";var F=document.getElementById("devSignaturePad");if(F){var I=F.cloneNode(!0);F.parentNode.replaceChild(I,F)}C.style.pointerEvents="none",C.classList.add("signature-locked");var z=n("#devName");z&&(z.value=d.devName||"Carlos Martin",z.setAttribute("readonly","readonly"));var O=n("#devDate");O&&(O.value=d.devDate||"",O.setAttribute("readonly","readonly"))}setTimeout(function(){if(d.clientSignature){var V=document.getElementById("clientSignaturePad");V&&y.drawSignatureOnCanvas(V,d.clientSignature)}if(d.devSignature){var X=document.getElementById("devSignaturePad");X&&y.drawSignatureOnCanvas(X,d.devSignature)}},300);var q=n("#devPendingBlock");q&&(q.style.display="none")},A.prototype.drawSignatureOnCanvas=function(d,y){if(!d||!y){console.log("Missing canvas or signature data");return}var w=d.getBoundingClientRect();console.log("Canvas rect:",w.width,w.height),(w.width===0||w.height===0)&&(d.style.width="100%",d.style.height="150px",w=d.getBoundingClientRect());var b=window.devicePixelRatio||1;d.width=w.width*b,d.height=w.height*b;var _=d.getContext("2d");_.scale(b,b),_.clearRect(0,0,w.width,w.height);var E=new Image;E.onload=function(){_.drawImage(E,0,0,w.width,w.height),console.log("Signature drawn on canvas")},E.onerror=function(){console.error("Failed to load signature image")},E.src=y},A.prototype.showPendingStatus=function(){console.log("Client has a pending contract");var d=n("#clientSignatureBlock");d&&(d.style.display="none");var y=n("#clientSubmitMessage");y&&(y.innerHTML="<p><strong>"+t("contract.msg.pendingDev")+"</strong></p><p>"+t("contract.msg.pendingDevDesc")+"</p><p>"+t("contract.msg.pendingDevDownload")+"</p>",y.style.display="block",y.style.background="rgba(241, 196, 15, 0.15)",y.style.borderColor="rgba(241, 196, 15, 0.4)");var w=n("#submitBtn");w&&(w.style.display="none")},A.prototype.loadPendingContract=function(){var d=this;console.log("Loading pending contracts..."),firebase.firestore().collection("contracts").where("status","==","pending_developer").orderBy("timestamp","desc").limit(1).get().then(function(y){if(y.empty)console.log("No pending contracts found");else{var w=y.docs[0];d.currentContract={id:w.id,data:w.data()},d.populateFormWithContract(d.currentContract.data),console.log("Loaded pending contract:",d.currentContract.id)}}).catch(function(y){console.error("Error loading pending contract:",y)})},A.prototype.populateFormWithContract=function(d){console.log("Populating form for developer with client data:",d.clientName);var y=document.createElement("div");y.id="pendingContractInfo",y.style.cssText="background: rgba(99, 102, 241, 0.15); border: 1px solid rgba(99, 102, 241, 0.4); border-radius: 8px; padding: 15px; margin-bottom: 20px; text-align: center;",y.innerHTML='<p style="margin: 0; color: #fff;"><strong>'+t("contract.msg.pendingFromClient")+'</strong></p><p style="margin: 5px 0 0 0; color: rgba(255,255,255,0.8);">'+t("common.client")+": <strong>"+(d.clientName||"N/A")+"</strong> | "+t("common.submitted")+": <strong>"+(d.clientDate||"N/A")+"</strong></p>";var w=n(".signatures");w&&!n("#pendingContractInfo")&&w.insertBefore(y,w.firstChild.nextSibling);var b=n("#clientName");b&&(b.value=d.clientName||"",b.setAttribute("readonly","readonly"),b.disabled=!0,b.style.opacity="0.7");var _=n("#clientNameDisplay");_&&(_.textContent=d.clientName||"Client Name");var E=n("#clientSignatureBlock");if(E&&d.clientSignature){E.style.display="block",E.style.opacity="0.7",E.style.pointerEvents="none";var S=E.querySelector("h3");S&&(S.innerHTML=t("contract.label.clientSig")+(d.clientName||t("common.client"))+' <span style="font-size: 12px; color: #10b981;">'+t("contract.label.signed")+"</span>");var C=n("#clientSignerName");C&&(C.value=d.clientSignerName||"",C.setAttribute("readonly","readonly"),C.disabled=!0);var F=n("#clientDate");F&&(F.value=d.clientDate||"",F.setAttribute("readonly","readonly"),F.disabled=!0);var I=document.getElementById("clientSignaturePad");I&&setTimeout(function(){var X=I.getBoundingClientRect(),G=window.devicePixelRatio||1;I.width=X.width*G,I.height=X.height*G;var j=I.getContext("2d");j.scale(G,G);var Y=new Image;Y.onload=function(){j.drawImage(Y,0,0,X.width,X.height)},Y.src=d.clientSignature},200);var z=n('.clear-btn[data-canvas="clientSignaturePad"]');z&&(z.style.display="none")}var O=n(".acknowledgment");O&&(O.style.display="none");var q=n("#devSignatureBlock");if(q){q.style.display="block",q.style.opacity="1";var V=q.querySelector("h3");V&&(V.innerHTML=t("contract.label.devSig")+' <span style="font-size: 12px; color: #f59e0b;">'+t("contract.label.signBelow")+"</span>")}console.log("Form populated with contract data for developer review")},A.prototype.handleClientSubmit=function(){if(console.log("Handling client submit..."),!this.currentSOW){alert(t("contract.val.sowRequired"));return}var d=[],y=n("#clientName");(!y||!y.value.trim())&&d.push(t("contract.val.clientInfoMissing"));var w=n("#acknowledgment");(!w||!w.checked)&&d.push(t("contract.val.acknowledgment"));var b=n("#clientSignerName");(!b||!b.value.trim())&&d.push(t("contract.val.enterName")),(!this.clientSignaturePad||this.clientSignaturePad.isEmpty())&&d.push(t("contract.val.signatureRequired"));var _=n("#clientDate");if((!_||!_.value)&&d.push(t("contract.val.dateRequired")),d.length>0){alert(t("contract.val.completeRequired")+d.join(`
`));return}this.submitClientSignature()},A.prototype.submitClientSignature=function(){this.currentSOW?this.submitBothSignatures():alert(t("contract.val.sowRequired"))},A.prototype.handleDeveloperSubmit=function(){console.log("Handling developer submit...");var d=[];(!this.devSignaturePad||this.devSignaturePad.isEmpty())&&d.push(t("contract.val.devSignRequired"));var y=n("#devDate");if((!y||!y.value)&&d.push(t("contract.val.devDateRequired")),this.currentContract||d.push(t("contract.val.noPending")),d.length>0){alert(t("contract.val.completeRequired")+d.join(`
`));return}this.finalizeContract()},A.prototype.submitBothSignatures=function(){var d=this;if(console.log("Submitting both contract and SOW signatures..."),!this.clientSignaturePad||this.clientSignaturePad.isEmpty()){alert(t("contract.val.signContract")),this.switchSigningTab("contract");return}var y=n("#sowClientName"),w=n("#sowClientDate");if(!y||!y.value.trim()){alert(t("contract.val.sowName"));return}if(!w||!w.value){alert(t("contract.val.sowDate"));return}if(!window.sowClientPad||window.sowClientPad.isEmpty()){alert(t("contract.val.signSow"));return}var b=n("#submitBothBtn");b&&(b.disabled=!0,b.innerHTML="<span>"+t("contract.btn.submitting")+"</span>");var _=firebase.auth().currentUser,E=_.email||"",S=_.phoneNumber||"",C=this.currentSOW||{},F=C.isBusinessEntity||!1,I=C.businessName||"",z=C.entityType||"",O=C.stateOfFormation||"",q=C.representativeName||"",V=C.representativeTitle||"",X={clientName:F?I:C.clientName,clientSignerName:F?q:n("#clientSignerName").value.trim(),clientDate:n("#clientDate").value,clientSignature:this.clientSignaturePad.toDataURL(),clientEmail:E,clientPhone:g(S),timestamp:firebase.firestore.FieldValue.serverTimestamp(),status:"pending_developer",isBusinessEntity:F,businessName:I,entityType:z,stateOfFormation:O,representativeName:q,representativeTitle:V},G=window.sowClientPad.toDataURL(),j=n("#sowClientName").value.trim(),Y=n("#sowClientDate").value,ie=null;firebase.firestore().collection("contracts").add(X).then(function(ae){return ie=ae.id,console.log(" Contract saved:",ie),firebase.firestore().collection("sow_documents").doc(d.currentSOW.id).update({clientSignature:G,clientSignerName:j,clientSignedDate:Y,clientSignedTimestamp:firebase.firestore.FieldValue.serverTimestamp(),linkedContract:ie,linkedContractEmail:E,linkedContractPhone:g(S),status:"pending_developer"})}).then(function(){console.log(" SOW updated and linked to contract");var ae={clientName:j,clientEmail:E,packageType:d.currentSOW.packageType,estimatedWeeks:d.currentSOW.estimatedWeeks,payment:d.currentSOW.payment,clientSignature:G,clientSignerName:j,clientSignedDate:Y};d.showDualSigningCompleted(X,ae)}).catch(function(ae){console.error("Error submitting signatures:",ae),alert(t("contract.err.prefix")+ae.message),b&&(b.disabled=!1,b.innerHTML="<span>"+t("contract.btn.submitForDev")+"</span>")})},A.prototype.showExistingCompletion=function(d){var y=this;console.log("Recreating completion view for existing submission"),this.currentContract={id:d.id,data:d};var w=n("#clientSigningTabs");w&&(w.style.display="none");var b=n("#contractForm");b&&(b.style.display="none");var _=d.status==="completed"&&d.devSignature;d.clientEmail?firebase.firestore().collection("sow_documents").where("clientEmail","==",d.clientEmail).where("linkedContract","==",d.id).limit(1).get().then(function(E){var S=null;E.empty||(S=E.docs[0].data(),S.id=E.docs[0].id),y.renderExistingCompletionView(d,S,_)}).catch(function(E){console.error("Error fetching SOW:",E),y.renderExistingCompletionView(d,null,_)}):d.clientPhone?firebase.firestore().collection("sow_documents").where("clientPhone","==",d.clientPhone).where("linkedContract","==",d.id).limit(1).get().then(function(E){var S=null;E.empty||(S=E.docs[0].data(),S.id=E.docs[0].id),y.renderExistingCompletionView(d,S,_)}).catch(function(E){console.error("Error fetching SOW by phone:",E),y.renderExistingCompletionView(d,null,_)}):y.renderExistingCompletionView(d,null,_)},A.prototype.renderExistingCompletionView=function(d,y,w){var b=this,_=n("#closeModalBtn");_&&(_.style.display="flex",_.style.position="sticky",_.style.top="1rem",_.style.alignSelf="flex-end",_.style.marginRight="1.5rem",_.style.marginTop="1rem",_.style.marginBottom="-2.5rem",_.style.flexShrink="0");var E=document.getElementById("dualSigningCompleted");if(!E){E=document.createElement("div"),E.id="dualSigningCompleted",E.className="dual-signing-completed";var S=n(".modal-content"),C=n("#closeModalBtn");C&&C.nextSibling?S.insertBefore(E,C.nextSibling):S&&S.appendChild(E)}var F=w?'<span class="doc-status completed"> Fully Signed</span>':'<span class="doc-status pending"> Awaiting Developer Signature</span>',I=w?"Documents Fully Executed!":"Documents Successfully Submitted!",z=w?"Both you and the developer have signed these documents. Download them below.":"The developer will review and countersign shortly.",O=b.calculatePaymentStatus(y),q=O.allPaid?"paid":O.paidCount>0?"partial":"unpaid",V=O.allPaid?"Paid":O.paidCount+"/"+O.totalCount,X=w&&y&&y.devSignature&&y.clientSignature,G='<div class="completion-header"><div class="completion-icon"></div><h2>'+I+'</h2><p class="completion-note">'+z+"</p>"+(X?'<button class="download-all-btn" id="downloadBothBtn"> Download All</button>':"")+'</div><div class="completion-tabs"><button class="completion-tab active" data-tab="documents"><span class="tab-icon"></span><span class="tab-label">Documents</span></button><button class="completion-tab" data-tab="payments"><span class="tab-icon"></span><span class="tab-label">Payment Status</span><span class="payment-badge '+q+'">'+V+'</span></button></div><div class="completion-tab-content"><div class="completion-tab-pane active" data-tab="documents"><div class="completed-documents"><div class="completed-doc-card"><div class="doc-card-header"><h3> Contract Agreement</h3>'+F+'</div><div class="doc-card-body"><div class="doc-field-row"><span class="field-label">Client:</span><span class="field-value">'+(d.clientName||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">'+(d.clientEmail?"Email:":"Phone:")+'</span><span class="field-value">'+(d.clientEmail||(d.clientPhone?h(d.clientPhone):"N/A"))+'</span></div><div class="doc-field-row"><span class="field-label">Client Signed:</span><span class="field-value">'+(d.clientDate||"N/A")+"</span></div>"+(w?'<div class="doc-field-row"><span class="field-label">Developer Signed:</span><span class="field-value">'+(d.devDate||"N/A")+"</span></div>":"")+'</div><div class="doc-signature-preview"><p class="signature-label">Your Signature:</p><img src="'+d.clientSignature+'" alt="Your signature" class="signature-image" style="width: 100%; max-width: 100%; height: auto; background: rgba(255, 255, 255, 0.05); border-radius: 6px; padding: 0.5rem; border: 1px solid rgba(255, 255, 255, 0.1);" /></div>';if(w&&(G+='<div class="doc-actions"><button class="doc-action-btn doc-download-btn" id="downloadContractBtn"> Download Contract</button></div>'),G+="</div>",y){var j=y.devSignature&&y.clientSignature,Y=j?'<span class="doc-status completed"> Fully Signed</span>':'<span class="doc-status pending"> Awaiting Developer Signature</span>';if(G+='<div class="completed-doc-card"><div class="doc-card-header"><h3> Statement of Work</h3>'+Y+'</div><div class="doc-card-body"><div class="doc-field-row"><span class="field-label">Client Name:</span><span class="field-value">'+(y.clientName||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Package:</span><span class="field-value">'+(y.packageType||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Total Cost:</span><span class="field-value">$'+(y.payment?y.payment.total.toFixed(0):"0")+'</span></div><div class="doc-field-row"><span class="field-label">Timeline:</span><span class="field-value">'+(y.estimatedWeeks||"TBD")+' weeks</span></div><div class="doc-field-row"><span class="field-label">Client Signed:</span><span class="field-value">'+(y.clientSignedDate||"N/A")+"</span></div>"+(j?'<div class="doc-field-row"><span class="field-label">Developer Signed:</span><span class="field-value">'+(y.devSignedDate||"N/A")+"</span></div>":"")+'</div><div class="doc-signature-preview"><p class="signature-label">Your Signature:</p><img src="'+y.clientSignature+'" alt="Your SOW signature" class="signature-image" style="width: 100%; max-width: 100%; height: auto; background: rgba(255, 255, 255, 0.05); border-radius: 6px; padding: 0.5rem; border: 1px solid rgba(255, 255, 255, 0.1);" /></div>',j){var ie="sowData_"+y.id.replace(/[^a-zA-Z0-9]/g,"_");if(window[ie]=y,G+='<div class="doc-actions doc-actions-split"><button type="button" class="doc-action-btn doc-download-btn" onclick="window.contractFormHandler.generateSOWPDF(window.'+ie+')"> Download SOW</button>',y.hasChangeRequest&&y.changeRequestId){var ae={pending:{bg:"linear-gradient(135deg, #f59e0b, #d97706)",text:" View Request"},approved:{bg:"linear-gradient(135deg, #10b981, #059669)",text:" View Approved"},rejected:{bg:"linear-gradient(135deg, #ef4444, #dc2626)",text:" View Response"},change_order:{bg:"linear-gradient(135deg, #6366f1, #4f46e5)",text:" View Order"}},le=ae[y.changeRequestStatus]||ae.pending;G+='<button type="button" id="changeRequestBtn-'+y.id+'" class="doc-action-btn doc-change-btn" style="background: '+le.bg+`;" onclick="window.contractFormHandler.viewChangeRequest('`+y.changeRequestId+`')">`+le.text+"</button>"}else G+='<button type="button" id="changeRequestBtn-'+y.id+'" class="doc-action-btn doc-change-btn" onclick="window.contractFormHandler.showChangeRequestModal(window.'+ie+')"> Request Change</button>';G+="</div>"}G+="</div>"}G+="</div>",G+="</div>",G+='<div class="completion-tab-pane" data-tab="payments">',G+=b.renderPaymentStatusContent(y,O),G+="</div>",G+="</div>",E.innerHTML=G,E.style.display="block";var pe=E.querySelectorAll(".completion-tab");pe.forEach(function(be){be.addEventListener("click",function(){var Ie=this.getAttribute("data-tab");pe.forEach(function(qe){qe.classList.remove("active")}),this.classList.add("active");var We=E.querySelectorAll(".completion-tab-pane");We.forEach(function(qe){qe.getAttribute("data-tab")===Ie?qe.classList.add("active"):qe.classList.remove("active")})})});var _e=document.getElementById("downloadContractBtn");_e&&_e.addEventListener("click",function(be){be.preventDefault(),b.generatePDF()});var oe=document.getElementById("downloadBothBtn");oe&&oe.addEventListener("click",function(be){be.preventDefault(),b.generateCombinedPDF(y)})},A.prototype.calculatePaymentStatus=function(d){var y={paidCount:0,totalCount:0,paidAmount:0,totalAmount:0,owedAmount:0,allPaid:!1,payments:[]};if(!d||!d.payment)return y;var w=d.payment,b=w.tracking||{},_=w.deferred&&w.deferred.enabled;if(_&&w.deferred.customSchedule&&w.deferred.customSchedule.length>0){var E=b.deferredPayments||[];w.deferred.customSchedule.forEach(function(C,F){var I=E[F]&&E[F].paid,z=E[F]?E[F].paidDate:null;y.payments.push({name:"Payment "+(F+1),amount:C.amount,dueDate:C.dueDate,paid:I,paidDate:z}),y.totalCount++,y.totalAmount+=C.amount,I&&(y.paidCount++,y.paidAmount+=C.amount)})}else{var S=[{key:"deposit",name:"Deposit (50%)",amount:w.deposit},{key:"milestone1",name:"Milestone (25%)",amount:w.milestone1},{key:"final",name:"Final (25%)",amount:w.final}];S.forEach(function(C){var F=b[C.key+"Paid"]||!1,I=b[C.key+"PaidDate"]||null;y.payments.push({name:C.name,amount:C.amount,paid:F,paidDate:I}),y.totalCount++,y.totalAmount+=C.amount,F&&(y.paidCount++,y.paidAmount+=C.amount)})}return y.owedAmount=y.totalAmount-y.paidAmount,y.allPaid=y.paidCount===y.totalCount&&y.totalCount>0,y},A.prototype.renderPaymentStatusContent=function(d,y){if(!d||!d.payment)return'<div class="payment-status-empty"><p>No payment information available.</p></div>';function w(z){if(!z)return"";var O=new Date(z+"T00:00:00"),q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],V=q[O.getMonth()]+" "+O.getDate()+", "+O.getFullYear(),X=new Date;X.setHours(0,0,0,0);var G=O.getTime()-X.getTime(),j=Math.ceil(G/(1e3*60*60*24)),Y="";return j===0?Y="today":j===1?Y="tomorrow":j>0?Y="in "+j+" days":j===-1?Y="1 day ago":Y=Math.abs(j)+" days ago","Due "+V+" ("+Y+")"}var b=[],_=[];y.payments.forEach(function(z){z.paid?b.push(z):_.push(z)});var E=_.length>0?_[0]:null,S=_.slice(1),C=y.totalAmount>0?Math.round(y.paidAmount/y.totalAmount*100):0,F='<div class="payment-status-container">';if(F+='<div class="payment-progress-summary"><div class="progress-amounts"><span class="progress-paid">$'+y.paidAmount.toFixed(2)+'</span><span class="progress-total">of $'+y.totalAmount.toFixed(2)+'</span></div><div class="progress-bar-minimal"><div class="progress-bar-fill" style="width: '+C+'%;"></div></div></div>',b.length>0&&(F+='<div class="completed-payments-section"><div class="completed-payments-row">',b.forEach(function(z){F+='<div class="completed-payment-chip"><span class="chip-name">'+z.name+'</span><span class="chip-amount">$'+z.amount.toFixed(2)+"</span></div>"}),F+="</div></div>"),E?F+='<div class="next-payment-card"><div class="next-payment-label">Next Payment</div><div class="next-payment-main"><div class="next-payment-amount">$'+E.amount.toFixed(2)+'</div><div class="next-payment-info"><span class="next-payment-name">'+E.name+"</span>"+(E.dueDate?'<span class="next-payment-due">'+w(E.dueDate)+"</span>":"")+"</div></div></div>":y.allPaid&&(F+='<div class="next-payment-card"><div class="next-payment-label">Complete</div><div class="next-payment-main"><div class="next-payment-amount" style="color: #10b981;"></div><div class="next-payment-info"><span class="next-payment-name">All payments received</span><span class="next-payment-due">Thank you</span></div></div></div>'),S.length>0){var I=S.reduce(function(z,O){return z+O.amount},0);F+='<div class="future-payments-summary"><span class="future-count">'+S.length+" more payment"+(S.length>1?"s":"")+'</span><span class="future-total">$'+I.toFixed(2)+" remaining</span></div>"}return F+="</div>",F},A.prototype.showDualSigningCompleted=function(d,y){console.log("Showing dual signing completed view"),this.currentContract={id:d.id||"pending",data:d};var w=n("#clientSigningTabs");w&&(w.style.display="none",w.remove());var b=n("#contractForm");b&&(b.style.display="none");var _=n("#closeModalBtn");_&&(_.style.display="flex",_.style.position="sticky",_.style.top="1rem",_.style.alignSelf="flex-end",_.style.marginRight="1.5rem",_.style.marginTop="1rem",_.style.marginBottom="-2.5rem",_.style.flexShrink="0");var E=n(".modal-content");if(E){var S=document.createElement("div");S.id="dualSigningCompleted",S.className="dual-signing-completed",S.innerHTML='<div class="completion-header"><div class="completion-icon"></div><h2>Documents Successfully Submitted!</h2><p>Both your Contract and Statement of Work have been signed and submitted.</p><p class="completion-note">The developer will review and countersign shortly. You can download the PDFs once both parties have signed.</p></div><div class="completed-documents"><div class="completed-doc-card"><div class="doc-card-header"><h3> Contract Agreement</h3><span class="doc-status pending"> Awaiting Developer Signature</span></div><div class="doc-card-body"><div class="doc-field-row"><span class="field-label">Client Name:</span><span class="field-value">'+(d.clientName||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Signer Name:</span><span class="field-value">'+(d.clientSignerName||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Date Signed:</span><span class="field-value">'+(d.clientDate||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">'+(d.clientEmail?"Email:":"Phone:")+'</span><span class="field-value">'+(d.clientEmail||(d.clientPhone?h(d.clientPhone):"N/A"))+'</span></div></div><div class="doc-signature-preview"><p class="signature-label">Your Signature:</p><img src="'+d.clientSignature+'" alt="Your signature" class="signature-image" /></div></div><div class="completed-doc-card"><div class="doc-card-header"><h3> Statement of Work</h3><span class="doc-status pending"> Awaiting Developer Signature</span></div><div class="doc-card-body"><div class="doc-field-row"><span class="field-label">Client Name:</span><span class="field-value">'+(y.clientName||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Package:</span><span class="field-value">'+(y.packageType||"N/A")+'</span></div><div class="doc-field-row"><span class="field-label">Total Cost:</span><span class="field-value">$'+(y.payment?y.payment.total.toFixed(0):"0")+'</span></div><div class="doc-field-row"><span class="field-label">Timeline:</span><span class="field-value">'+(y.estimatedWeeks||"TBD")+' weeks</span></div><div class="doc-field-row"><span class="field-label">Client Signed:</span><span class="field-value">'+(y.clientSignedDate||"N/A")+'</span></div></div><div class="doc-signature-preview"><p class="signature-label">Your Signature:</p><img src="'+y.clientSignature+'" alt="Your SOW signature" class="signature-image" /></div></div></div><div class="completion-actions"></div>';var C=n("#closeModalBtn");C&&C.nextSibling?E.insertBefore(S,C.nextSibling):E.appendChild(S),alert(t("contract.msg.submitSuccess"))}},A.prototype.finalizeContract=function(){var d=this,y=n("#submitBtn"),w=y?y.innerHTML:"";if(y&&(y.disabled=!0,y.innerHTML="<span>"+t("contract.btn.finalizing")+"</span>"),!this.currentContract){alert(t("contract.val.noPending")),y&&(y.disabled=!1,y.innerHTML=w);return}console.log("Finalizing contract:",this.currentContract.id);var b=this.devSignaturePad?this.devSignaturePad.toDataURL():"",_=n("#devDate")?n("#devDate").value:new Date().toISOString().split("T")[0],E={devName:"Carlos Martin",devSignature:b,devDate:_,devEmail:firebase.auth().currentUser.email,finalizedTimestamp:firebase.firestore.FieldValue.serverTimestamp(),status:"completed"},S=Object.assign({},this.currentContract.data,E);firebase.firestore().collection("contracts").doc(this.currentContract.id).update(E).then(function(){console.log("Contract finalized successfully in Firebase"),d.currentContract.data=S,d.showDeveloperSuccessMessage()}).catch(function(C){console.error("Error finalizing contract:",C),alert(t("contract.err.finalize")+C.message+t("contract.err.finalizeSuffix")),y&&(y.disabled=!1,y.innerHTML=w)})},A.prototype.showClientSuccessMessage=function(){var d=n("#clientSubmitMessage"),y=n("#clientEmailDisplay");if(d){var w=firebase.auth().currentUser;w&&y&&(y.textContent=w.email||w.phoneNumber||"your account"),d.style.display="block",d.scrollIntoView({behavior:"smooth",block:"center"})}var b=n("#clientSignatureBlock");b&&(b.style.display="none");var _=n("#devPendingBlock");_&&(_.style.display="none");var E=n(".acknowledgment");E&&(E.style.display="none")},A.prototype.showDeveloperSuccessMessage=function(){var d=this,y=n("#submitBtn");y&&(y.innerHTML="<span>"+t("contract.btn.uploadedDownload")+"</span>",y.style.background="linear-gradient(135deg, #10b981 0%, #059669 100%)",y.disabled=!1,y.onclick=function(b){b.preventDefault(),d.generatePDF()});var w=n("#downloadBtn");w&&(w.style.display="inline-flex",w.onclick=function(b){b.preventDefault(),d.generatePDF()}),alert(t("contract.msg.uploadSuccess"))},A.prototype.generatePDF=function(){var d=this.currentContract?this.currentContract.data:null,y=this.currentContract?this.currentContract.id:null;if(!d){alert(t("pdf.err.noContract"));return}var w=window.open("","_blank");if(!w){alert(t("pdf.err.popups"));return}var b=d.clientDate||"N/A",_=d.devDate||"N/A",E=d.clientName||"N/A",S=d.clientSignerName||"N/A",C=d.clientEmail||"",F=d.clientPhone||"",I=C||(F?h(F):"N/A"),z=C?"Email":"Phone",O=d.devName||"Carlos Martin",q=d.devEmail||"carlos@scarlo.dev",V=d.clientSignature||"",X=d.devSignature||"",G=d.isBusinessEntity||!1,j=d.businessName||"",Y=d.entityType||"",ie=d.stateOfFormation||"",ae=d.representativeName||"",le=d.representativeTitle||"",pe='<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=1024"><title>Website Development Agreement - '+(G?j:E)+'</title><link rel="icon" type="image/png" href="https://scarlo.dev/favicons/favicon-96x96.png"><style>* { margin: 0; padding: 0; box-sizing: border-box; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; text-size-adjust: 100%; }body { font-family: "Times New Roman", Times, serif; font-size: 11pt; line-height: 1.6; color: #000; background: #fff; padding: 0.75in 1in; }.contract-container { max-width: 750px; margin: 0 auto; }h1 { font-size: 18pt; text-align: center; margin-bottom: 8px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }h2 { font-size: 11pt; margin-top: 20px; margin-bottom: 10px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #000; padding-bottom: 4px; }h3 { font-size: 10.5pt; margin-top: 14px; margin-bottom: 6px; font-weight: bold; }p { margin-bottom: 10px; text-align: justify; }ul, ol { margin-left: 30px; margin-bottom: 10px; }li { margin-bottom: 5px; }.header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #000; }.subtitle { font-size: 11pt; margin-top: 6px; font-style: italic; }.parties { padding: 15px 20px; border: 1px solid #000; margin: 20px 0; }.section { margin-bottom: 18px; page-break-inside: avoid; }.caps-section { text-transform: uppercase; font-weight: bold; }.highlight-box { padding: 15px 20px; margin: 15px 0; border: 1px solid #000; border-left: 4px solid #000; }.signature-page { page-break-before: always; margin-top: 50px; }.signature-block { display: inline-block; width: 45%; vertical-align: top; margin: 20px 2%; }.signature-line { border-bottom: 1px solid #000; height: 70px; margin: 10px 0; display: flex; align-items: flex-end; justify-content: center; }.signature-line img { max-height: 60px; max-width: 100%; filter: invert(1) grayscale(1); }.signature-label { font-size: 9pt; margin-top: 5px; font-style: italic; }.signature-name { font-weight: bold; margin-top: 10px; font-size: 10pt; }.signature-date { margin-top: 5px; font-size: 10pt; }.signature-email { font-size: 9pt; font-style: italic; }.footer { margin-top: 50px; text-align: center; font-size: 9pt; border-top: 1px solid #000; padding-top: 20px; }.contract-id { font-size: 8pt; margin-top: 10px; font-style: italic; }.important { font-weight: bold; text-transform: uppercase; }.indented { margin-left: 25px; }.logo { max-width: 180px; max-height: 60px; margin-bottom: 15px; }@media print { body { padding: 0; margin: 0; } .contract-container { max-width: 100%; } .signature-page { page-break-before: always; } }@page { margin: 0.5in 0.6in; size: letter; }</style></head><body><div class="contract-container"><div class="header"><img src="'+u()+'" alt="Scarlo Logo" class="logo" /><h1>'+t("pdf.contract.title")+'</h1><div class="subtitle">'+t("pdf.contract.subtitle")+'</div></div><div class="section"><h2>'+t("pdf.contract.parties")+"</h2><p>"+t("pdf.contract.partiesIntro")+" <strong>"+b+"</strong> "+t("pdf.contract.between")+'</p><div class="parties"><p><strong>'+t("pdf.contract.developer")+"</strong> "+t("pdf.contract.developerDesc")+"</p>"+(G?"<p><strong>"+t("pdf.contract.client")+"</strong> "+j+", a "+Y+(ie?" "+t("common.formedIn")+" "+ie:"")+(C?" ("+C+")":"")+"</p>":"<p><strong>"+t("pdf.contract.client")+"</strong> "+E+(C?" ("+C+")":"")+"</p>")+'</div></div><div class="section"><h2>'+t("pdf.contract.scope")+"</h2><p>"+t("pdf.contract.scopeText")+'</p></div><div class="section"><h2>'+t("pdf.contract.paymentTerms")+"</h2><p><strong>"+t("pdf.contract.paymentSchedule")+"</strong></p><ul><li><strong>"+t("pdf.contract.depositLine")+"</strong> "+t("pdf.contract.depositDesc")+"</li><li><strong>"+t("pdf.contract.milestoneLine")+"</strong> "+t("pdf.contract.milestoneDesc")+"</li><li><strong>"+t("pdf.contract.finalLine")+"</strong> "+t("pdf.contract.finalDesc")+"</li></ul><p><strong>"+t("pdf.contract.cancellationPolicy")+"</strong> "+t("pdf.contract.cancellationText")+"</p><p><strong>"+t("pdf.contract.latePayments")+"</strong> "+t("pdf.contract.latePaymentsText")+'</p></div><div class="section"><h2>'+t("pdf.contract.ip")+"</h2><p><strong>"+t("pdf.contract.ipClient")+"</strong> "+t("pdf.contract.ipClientDesc")+"</p><p><strong>"+t("pdf.contract.ipDev")+"</strong> "+t("pdf.contract.ipDevDesc")+"</p><p><strong>"+t("pdf.contract.ipImportant")+"</strong> "+t("pdf.contract.ipImportantDesc")+'</p></div><div class="section"><h2>'+t("pdf.contract.revisions")+"</h2><p>"+t("pdf.contract.revisionsText")+'</p></div><div class="section"><h2>'+t("pdf.contract.warranty")+"</h2><p><strong>"+t("pdf.contract.warranty").split(".")[0]+":</strong> "+t("pdf.contract.warrantyText")+'</p><div class="highlight-box"><p class="caps-section"><strong>'+t("pdf.contract.warrantyDisclaimer")+"</strong> "+t("pdf.contract.warrantyDisclaimerText")+'</p><p class="caps-section" style="margin-top: 10px;"><strong>'+t("pdf.contract.liabilityLimit")+"</strong> "+t("pdf.contract.liabilityLimitText")+'</p></div></div><div class="section"><h2>'+t("pdf.contract.indemnification")+"</h2><p><strong>"+t("pdf.contract.clientIndemnifies")+"</strong> "+t("pdf.contract.clientIndemnifiesText")+"</p><p><strong>"+t("pdf.contract.devIndemnifies")+"</strong> "+t("pdf.contract.devIndemnifiesText")+'</p></div><div class="section"><h2>'+t("pdf.contract.termination")+"</h2><p><strong>"+t("pdf.contract.termByClient")+"</strong> "+t("pdf.contract.termByClientText")+"</p><p><strong>"+t("pdf.contract.termByDev")+"</strong> "+t("pdf.contract.termByDevText")+"</p><p><strong>"+t("pdf.contract.termForCause")+"</strong> "+t("pdf.contract.termForCauseText")+'</p></div><div class="section"><h2>'+t("pdf.contract.disputeResolution")+"</h2><p><strong>"+t("pdf.contract.disputeProcess")+"</strong> "+t("pdf.contract.disputeProcessText")+"</p><p><strong>"+t("pdf.contract.attorneysFees")+"</strong> "+t("pdf.contract.attorneysFeesText")+'</p></div><div class="section"><h2>'+t("pdf.contract.generalTerms")+"</h2><p><strong>"+t("pdf.contract.governingLaw")+"</strong> "+t("pdf.contract.governingLawText")+"</p><p><strong>"+t("pdf.contract.forceMajeure")+"</strong> "+t("pdf.contract.forceMajeureText")+"</p><p><strong>"+t("pdf.contract.assignment")+"</strong> "+t("pdf.contract.assignmentText")+"</p><p><strong>"+t("pdf.contract.severability")+"</strong> "+t("pdf.contract.severabilityText")+"</p><p><strong>"+t("pdf.contract.confidentiality")+"</strong> "+t("pdf.contract.confidentialityText")+"</p><p><strong>"+t("pdf.contract.independentContractor")+"</strong> "+t("pdf.contract.independentContractorText")+"</p><p><strong>"+t("pdf.contract.entireAgreement")+"</strong> "+t("pdf.contract.entireAgreementText")+'</p></div><div class="signature-page"><h2 style="text-align: center; border: none; margin-bottom: 20px;">'+t("pdf.contract.signaturePage")+'</h2><p style="text-align: center; margin-bottom: 30px;">'+t("pdf.contract.signatureIntro")+'</p><div style="display: flex; justify-content: space-between; margin-top: 30px;"><div class="signature-block"><h3 style="font-size: 10pt;">'+t("pdf.contract.devSignature")+'</h3><div class="signature-line">'+(X?'<img src="'+X+'" alt="Developer Signature" />':'<span style="font-style: italic;">'+t("pdf.contract.awaitingSignature")+"</span>")+'</div><div class="signature-label">'+t("pdf.contract.authorizedSignature")+'</div><div class="signature-name">'+O+'</div><div class="signature-date">'+t("common.date")+" "+_+'</div><div class="signature-email">'+t("common.email")+" "+q+'</div></div><div class="signature-block"><h3 style="font-size: 10pt;">'+t("pdf.contract.clientSignature")+" "+(G?j:E)+"</h3>"+(G?'<p style="font-size: 9pt; margin-bottom: 5px;">'+Y+(ie?" ("+ie+")":"")+"</p>":"")+'<div class="signature-line">'+(V?'<img src="'+V+'" alt="Client Signature" />':'<span style="font-style: italic;">'+t("pdf.contract.awaitingSignature")+"</span>")+'</div><div class="signature-label">'+t("pdf.contract.authorizedSignature")+'</div><div class="signature-name">'+(G?t("common.by")+" "+ae+", "+le:S)+'</div><div class="signature-date">'+t("common.date")+" "+b+'</div><div class="signature-email">'+z+": "+I+'</div></div></div></div><div class="footer"><p><strong> '+new Date().getFullYear()+" Scarlo  Carlos Martin</strong></p><p>"+t("pdf.contract.professionalServices")+'</p><p class="contract-id">Contract ID: '+(y||"DRAFT")+'</p><p class="contract-id">Generated: '+new Date().toLocaleString()+"</p></div></div><script>window.onload = function() {  var images = document.images;  var loaded = 0;  var total = images.length;  if (total === 0) { setTimeout(function() { window.print(); }, 300); return; }  for (var i = 0; i < total; i++) {    if (images[i].complete) { loaded++; }    else { images[i].onload = images[i].onerror = function() { loaded++; if (loaded >= total) setTimeout(function() { window.print(); }, 300); }; }  }  if (loaded >= total) setTimeout(function() { window.print(); }, 300);};<\/script></body></html>";w.document.write(pe),w.document.close()},A.prototype.generateCombinedPDF=function(d){var y=this,w=this.currentContract?this.currentContract.data:null;if(!w){alert(t("pdf.err.noContractData"));return}if(!d){alert(t("pdf.err.noSowData"));return}var b=window.open("","_blank");if(!b){alert(t("pdf.err.popups"));return}var _=w.clientDate||"N/A",E=w.devDate||"N/A",S=w.clientName||"N/A",C=w.clientSignerName||"N/A",F=w.clientEmail||"",I=w.clientPhone||"",z=F||(I?h(I):"N/A"),O=F?"Email":"Phone",q=w.devName||"Carlos Martin",V=w.devEmail||"N/A",X=w.clientSignature||"",G=w.devSignature||"",j=w.isBusinessEntity||d.isBusinessEntity||!1,Y=w.businessName||d.businessName||"",ie=w.entityType||d.entityType||"",ae=w.stateOfFormation||d.stateOfFormation||"",le=w.representativeName||d.representativeName||"",pe=w.representativeTitle||d.representativeTitle||"",_e={essential:t("pkg.essential"),starter:t("pkg.starter"),growth:t("pkg.growth"),professional:t("pkg.professional"),enterprise:t("pkg.enterprise"),custom:t("pkg.custom")},oe={essential:{includes:[t("pkg.essential.i1"),t("pkg.essential.i2"),t("pkg.essential.i3"),t("pkg.essential.i4"),t("pkg.essential.i5"),t("pkg.essential.i6")]},starter:{includes:[t("pkg.starter.i1"),t("pkg.starter.i2"),t("pkg.starter.i3"),t("pkg.starter.i4"),t("pkg.starter.i5"),t("pkg.starter.i6"),t("pkg.starter.i7")]},growth:{includes:[t("pkg.growth.i1"),t("pkg.growth.i2"),t("pkg.growth.i3"),t("pkg.growth.i4"),t("pkg.growth.i5"),t("pkg.growth.i6"),t("pkg.growth.i7")]},professional:{includes:[t("pkg.professional.i1"),t("pkg.professional.i2"),t("pkg.professional.i3"),t("pkg.professional.i4"),t("pkg.professional.i5"),t("pkg.professional.i6"),t("pkg.professional.i7"),t("pkg.professional.i8")]},enterprise:{includes:[t("pkg.enterprise.i1"),t("pkg.enterprise.i2"),t("pkg.enterprise.i3"),t("pkg.enterprise.i4"),t("pkg.enterprise.i5"),t("pkg.enterprise.i6"),t("pkg.enterprise.i7"),t("pkg.enterprise.i8")]}},be=oe[d.packageType]||{includes:[]},Ie=d.payment?d.payment.total:0,We=Ie*.5,qe=Ie*.25,tt=Ie*.25,Ke={none:{name:t("maint.none.name"),cost:t("maint.none.price")},basic:{name:t("maint.basic.name"),cost:t("maint.basic.price"),desc:t("maint.basic.desc")},professional:{name:t("maint.professional.name"),cost:t("maint.professional.price"),desc:t("maint.professional.desc")},premium:{name:t("maint.premium.name"),cost:t("maint.premium.price"),desc:t("maint.premium.desc")}},at=Ke[d.maintenancePlan||"none"]||Ke.none,Ye='<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=1024"><title>Complete Agreement Package - '+(j?Y:S)+'</title><link rel="icon" type="image/png" href="https://scarlo.dev/favicons/favicon-96x96.png"><style>* { margin: 0; padding: 0; box-sizing: border-box; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; text-size-adjust: 100%; }body { font-family: "Times New Roman", Times, serif; font-size: 11pt; line-height: 1.6; color: #000; background: #fff; padding: 0.75in 1in; }h1 { font-size: 18pt; text-align: center; margin-bottom: 8px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }h2 { font-size: 11pt; margin-top: 20px; margin-bottom: 10px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #000; padding-bottom: 4px; }h3 { font-size: 10.5pt; margin-top: 14px; margin-bottom: 6px; font-weight: bold; }p { margin-bottom: 10px; text-align: justify; }ul, ol { margin-left: 30px; margin-bottom: 10px; }li { margin-bottom: 5px; }.header { text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #000; }.subtitle { font-size: 11pt; margin-top: 6px; font-style: italic; }.parties { padding: 15px 20px; border: 1px solid #000; margin: 20px 0; }.section { margin-bottom: 18px; page-break-inside: avoid; }.signature-page { page-break-before: always; margin-top: 50px; }.signature-block { display: inline-block; width: 45%; vertical-align: top; margin: 20px 2%; }.signature-line { border-bottom: 1px solid #000; height: 70px; margin: 10px 0; display: flex; align-items: flex-end; justify-content: center; }.signature-line img { max-height: 60px; max-width: 100%; filter: invert(1) grayscale(1); }.signature-label { font-size: 9pt; margin-top: 5px; font-style: italic; }.signature-name { font-weight: bold; margin-top: 10px; font-size: 10pt; }.signature-date { margin-top: 5px; font-size: 10pt; }.signature-email { font-size: 9pt; font-style: italic; }.footer { margin-top: 50px; text-align: center; font-size: 9pt; border-top: 1px solid #000; padding-top: 20px; }.contract-id { font-size: 8pt; margin-top: 10px; font-style: italic; }.page-break { page-break-before: always; }.info-box { padding: 15px 20px; border: 1px solid #000; border-left: 4px solid #000; margin: 20px 0; }.info-box h3 { margin-top: 0; }.payment-table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 10pt; }.payment-table th, .payment-table td { border: 1px solid #000; padding: 10px 12px; text-align: left; }.payment-table th { font-weight: bold; }.total-row { font-weight: bold; font-size: 11pt; border-top: 2px solid #000; }.highlight { font-weight: bold; }.logo { max-width: 180px; max-height: 60px; margin-bottom: 15px; }@media print { body { padding: 0; margin: 0; } .signature-page, .page-break { page-break-before: always; } }@page { margin: 0.5in 0.6in; size: letter; }</style></head><body><div class="header"><img src="'+u()+'" alt="Scarlo Logo" class="logo" /><h1>'+t("pdf.contract.title")+'</h1><div class="subtitle">'+t("pdf.contract.subtitle")+'</div></div><div class="section"><h2>'+t("pdf.combined.partiesToAgreement")+"</h2><p>"+t("pdf.combined.partiesIntro")+" <strong>"+_+"</strong> "+t("pdf.combined.effectiveDate")+'</p><div class="parties"><p><strong>Scarlo</strong>, '+t("pdf.combined.devDesc")+"</p><p>"+t("pdf.combined.and")+"</p>"+(j?"<p><strong>"+Y+"</strong>, a "+ie+(ae?" "+t("common.formedIn")+" "+ae:"")+" "+t("pdf.combined.theClient")+"</p>":"<p><strong>"+S+"</strong> "+t("pdf.combined.theClient")+"</p>")+'<p style="font-size: 10pt; font-style: italic; margin-top: 10px;">'+t("pdf.combined.partyNote")+'</p></div></div><div class="section"><h2>'+t("pdf.combined.projectScope")+"</h2><h3>"+t("pdf.combined.overview")+"</h3><p>"+t("pdf.combined.overviewText")+"</p><h3>"+t("pdf.combined.sowSection")+"</h3><p>"+t("pdf.combined.sowText")+"</p><h3>"+t("pdf.combined.scopeLimitations")+"</h3><p>"+t("pdf.combined.scopeLimitationsText")+'</p></div><div class="section"><h2>'+t("pdf.combined.packagesPricing")+"</h2><p>"+t("pdf.combined.packagesPricingText")+'</p></div><div class="section"><h2>'+t("pdf.combined.paymentTerms")+"</h2><p>"+t("pdf.combined.unlessSpecified")+"</p><h3>"+t("pdf.combined.deposit")+"</h3><p>"+t("pdf.combined.depositText")+"</p><h3>"+t("pdf.combined.milestonePayments")+"</h3><p>"+t("pdf.combined.milestonePaymentsIntro")+"</p><ul><li>"+t("pdf.combined.milestonePayment1")+"</li><li>"+t("pdf.combined.milestonePayment2")+"</li></ul><h3>"+t("pdf.combined.latePayments")+"</h3><p>"+t("pdf.combined.latePaymentsText")+'</p></div><div class="section"><h2>'+t("pdf.combined.clientResponsibilities")+"</h2><p>"+t("pdf.combined.clientRespText")+"</p><p>"+t("pdf.combined.clientRespText2")+'</p></div><div class="section"><h2>'+t("pdf.combined.revisions")+"</h2><p>"+t("pdf.combined.revisionsIntro")+"</p><ul><li>"+t("pdf.combined.revision1")+"</li><li>"+t("pdf.combined.revision2")+'</li></ul></div><div class="section"><h2>'+t("pdf.combined.ipRights")+"</h2><h3>"+t("pdf.combined.devOwnership")+"</h3><p>"+t("pdf.combined.devOwnershipText")+"</p><h3>"+t("pdf.combined.clientOwnership")+"</h3><p>"+t("pdf.combined.clientOwnershipText")+'</p></div><div class="section"><h2>'+t("pdf.combined.maintenanceSupport")+"</h2><p>"+t("pdf.combined.maintenanceSupportText")+'</p></div><div class="section"><h2>'+t("pdf.combined.timelineDelivery")+"</h2><p>"+t("pdf.combined.timelineDeliveryText")+'</p></div><div class="section"><h2>'+t("pdf.combined.changeOrders")+"</h2><p>"+t("pdf.combined.changeOrdersText")+'</p></div><div class="section"><h2>'+t("pdf.combined.warrantyLimitations")+"</h2><h3>"+t("pdf.combined.devWarranty")+"</h3><p>"+t("pdf.combined.devWarrantyText")+"</p><h3>"+t("pdf.combined.exclusions")+"</h3><p>"+t("pdf.combined.exclusionsText")+"</p><h3>"+t("pdf.combined.liabilityLimitations")+"</h3><p>"+t("pdf.combined.liabilityLimitationsText")+'</p></div><div class="section"><h2>'+t("pdf.combined.confidentiality")+"</h2><p>"+t("pdf.combined.confidentialityText")+'</p></div><div class="section"><h2>'+t("pdf.combined.indemnification")+"</h2><p>"+t("pdf.combined.indemnificationText")+'</p></div><div class="section"><h2>'+t("pdf.combined.termination")+"</h2><p>"+t("pdf.combined.terminationText")+'</p></div><div class="section"><h2>'+t("pdf.combined.governingLaw")+"</h2><p>"+t("pdf.combined.governingLawText")+'</p></div><div class="section"><h2>'+t("pdf.combined.entireAgreement")+"</h2><p>"+t("pdf.combined.entireAgreementText")+'</p></div><div class="signature-page"><h2 style="text-align: center; border: none;">'+t("pdf.combined.contractSignatures")+'</h2><p style="text-align: center; margin-bottom: 30px;">'+t("pdf.combined.contractSignIntro")+'</p><div style="display: flex; justify-content: space-between; margin-top: 40px;"><div class="signature-block"><h3>'+t("pdf.combined.devSignature")+'</h3><div class="signature-line">'+(G?'<img src="'+G+'" alt="Developer Signature" />':'<span style="font-style: italic;">'+t("pdf.combined.pending")+"</span>")+'</div><div class="signature-label">'+t("pdf.combined.signature")+'</div><div class="signature-name">'+q+'</div><div class="signature-date">'+t("common.date")+" "+E+'</div><div class="signature-email">'+V+'</div></div><div class="signature-block"><h3>'+t("pdf.combined.clientSignature")+" "+(j?Y:S)+"</h3>"+(j?'<p style="font-size: 9pt; margin-bottom: 5px;">'+ie+(ae?" ("+ae+")":"")+"</p>":"")+'<div class="signature-line">'+(X?'<img src="'+X+'" alt="Client Signature" />':'<span style="font-style: italic;">'+t("pdf.combined.pending")+"</span>")+'</div><div class="signature-label">'+t("pdf.combined.signature")+'</div><div class="signature-name">'+(j?t("common.by")+" "+le+", "+pe:C)+'</div><div class="signature-date">'+t("common.date")+" "+_+'</div><div class="signature-email">'+O+": "+z+'</div></div></div></div><div class="page-break"></div><div class="header"><img src="'+u()+'" alt="Scarlo Logo" class="logo" /><h1>'+t("pdf.combined.sowSection2")+'</h1><div class="subtitle">'+t("pdf.combined.sowSubtitle")+'</div><div style="font-size: 10pt; font-style: italic; margin-top: 10px;">'+t("pdf.sow.generated")+" "+new Date().toLocaleDateString(getCurrentLang()==="es"?"es-MX":"en-US",{year:"numeric",month:"long",day:"numeric"})+'</div></div><div class="info-box"><h3>'+t("pdf.combined.clientInfo")+"</h3>"+(j?"<p><strong>"+t("pdf.sow.businessName")+"</strong> "+Y+"</p><p><strong>"+t("pdf.sow.entityType")+"</strong> "+ie+(ae?" ("+ae+")":"")+"</p><p><strong>"+t("pdf.sow.representative")+"</strong> "+le+", "+pe+"</p>":"<p><strong>"+t("pdf.sow.clientName")+"</strong> "+(d.clientName||S)+"</p>")+"<p><strong>"+t("pdf.sow.contact")+"</strong> "+(d.clientEmail||d.clientPhone||F||t("common.na"))+"</p><p><strong>"+t("sow.package")+"</strong> "+(_e[d.packageType]||d.packageType)+' <span class="highlight">$'+Ie.toFixed(0)+"</span></p><p><strong>"+t("pdf.sow.estimatedTimeline")+"</strong> "+(d.estimatedWeeks||t("common.tbd"))+" "+t("sow.weeks")+(d.startDate?" ("+new Date(d.startDate).toLocaleDateString()+")":"")+'</p></div><div class="section"><h2>'+t("pdf.combined.packageIncludes")+"</h2><ul>";d.packageType==="custom"?d.features&&d.features.length>0&&d.features.forEach(function(ot){Ye+="<li>"+translateStoredFeature(ot)+"</li>"}):be.includes&&be.includes.length>0&&be.includes.forEach(function(ot){Ye+="<li>"+ot+"</li>"}),Ye+="</ul></div>",d.packageType!=="custom"&&d.features&&d.features.length>0&&(Ye+='<div class="section"><h2>'+t("pdf.combined.additionalFeatures")+"</h2><ul>",d.features.forEach(function(ot){Ye+="<li>"+translateStoredFeature(ot)+"</li>"}),Ye+="</ul></div>"),d.notes&&(Ye+='<div class="section"><h2>'+t("pdf.combined.specialRequirements")+"</h2><p>"+d.notes+"</p></div>"),Ye+='<div class="section"><h2>'+t("pdf.combined.paymentStructure")+'</h2><table class="payment-table"><thead><tr><th>'+t("pdf.combined.paymentMilestone")+"</th><th>"+t("sow.description")+"</th><th>"+t("sow.amount")+"</th></tr></thead><tbody><tr><td><strong>"+t("pdf.combined.initialDeposit")+"</strong></td><td>"+t("pdf.combined.dueBeforeWork")+"</td><td><strong>$"+We.toFixed(0)+"</strong></td></tr><tr><td><strong>"+t("pdf.combined.milestone1")+"</strong></td><td>"+t("pdf.combined.designApproval")+"</td><td><strong>$"+qe.toFixed(0)+"</strong></td></tr><tr><td><strong>"+t("pdf.combined.finalPayment")+"</strong></td><td>"+t("pdf.combined.priorToDeployment")+"</td><td><strong>$"+tt.toFixed(0)+'</strong></td></tr><tr class="total-row"><td colspan="2">'+t("pdf.combined.totalProjectCost")+"</td><td>$"+Ie.toFixed(0)+"</td></tr></tbody></table></div>",d.maintenancePlan==="none"?Ye+='<div class="section"><h2>'+t("pdf.combined.ongoingMaintenance")+'</h2><div class="info-box" style="background: #fff3cd; border-color: #856404;"><h3 style="color: #856404;">'+t("pdf.combined.noMaintenanceTitle")+'</h3><p style="color: #856404;"><strong>'+t("pdf.combined.noMaintenanceWarning")+"</strong> "+t("pdf.combined.noMaintenanceText")+"</p></div></div>":d.maintenancePlan&&(Ye+='<div class="section"><h2>'+t("pdf.combined.ongoingMaintenance")+'</h2><div class="info-box"><h3>'+at.name+"  "+at.cost+"</h3><p>"+(at.desc||"")+"</p></div></div>"),Ye+='<div class="section"><h2>'+t("pdf.combined.termsConditions")+"</h2><p>"+t("sow.termsText1")+" <strong>"+S+"</strong>"+t("sow.termsText2")+"</p><p>"+t("sow.termsText3")+"</p></div>",Ye+='<div class="signature-page"><h2 style="text-align: center; border: none;">'+t("pdf.combined.sowSignatures")+'</h2><p style="text-align: center; margin-bottom: 30px;">'+t("pdf.combined.sowSignIntro")+'</p><div style="display: flex; justify-content: space-between; margin-top: 40px;"><div class="signature-block"><h3>'+t("pdf.combined.devSignature")+'</h3><div class="signature-line">'+(d.devSignature?'<img src="'+d.devSignature+'" alt="Developer Signature" />':'<span style="font-style: italic;">'+t("pdf.combined.pending")+"</span>")+'</div><div class="signature-label">'+t("pdf.combined.signature")+'</div><div class="signature-name">'+(d.devSignerName||"Carlos Martin")+'</div><div class="signature-date">'+t("common.date")+" "+(d.devSignedDate||t("common.na"))+'</div></div><div class="signature-block"><h3>'+t("pdf.combined.clientSignature")+" "+(j?Y:S)+"</h3>"+(j?'<p style="font-size: 9pt; margin-bottom: 5px;">'+ie+(ae?" ("+ae+")":"")+"</p>":"")+'<div class="signature-line">'+(d.clientSignature?'<img src="'+d.clientSignature+'" alt="Client Signature" />':'<span style="font-style: italic;">'+t("pdf.combined.pending")+"</span>")+'</div><div class="signature-label">'+t("pdf.combined.signature")+'</div><div class="signature-name">'+(j?t("common.by")+" "+le+", "+pe:d.clientSignerName||S)+'</div><div class="signature-date">'+t("common.date")+" "+(d.clientSignedDate||t("common.na"))+'</div></div></div></div><div class="footer"><p><strong> '+new Date().getFullYear()+" Scarlo</strong>  "+t("pdf.combined.footer")+'</p><p style="margin-top: 8px;">'+t("pdf.combined.footerDev")+'</p><p class="contract-id">Contract ID: '+(y.currentContract?y.currentContract.id:t("common.na"))+" | SOW ID: "+d.id+"</p></div><script>window.onload = function() {  var images = document.images;  var loaded = 0;  var total = images.length;  if (total === 0) { setTimeout(function() { window.print(); }, 300); return; }  for (var i = 0; i < total; i++) {    if (images[i].complete) { loaded++; }    else { images[i].onload = images[i].onerror = function() { loaded++; if (loaded >= total) setTimeout(function() { window.print(); }, 300); }; }  }  if (loaded >= total) setTimeout(function() { window.print(); }, 300);};<\/script></body></html>",b.document.write(Ye),b.document.close()};var ne=function(){window.addEventListener("load",function(){document.body.classList.add("loaded")})},ee=function(){if("ontouchstart"in window&&!window.matchMedia("(pointer: fine)").matches){console.log("Custom cursor disabled - touch-only device");return}console.log("Custom cursor enabled - mouse devices only"),this.cursor=document.createElement("div"),this.cursor.className="custom-cursor",this.cursor.style.cssText="position:fixed;left:0;top:0;width:10px;height:10px;background:rgba(255,255,255,0.9);border-radius:50%;pointer-events:none;z-index:99999;opacity:0;mix-blend-mode:difference;transition:width 0.2s cubic-bezier(0.4,0,0.2,1),height 0.2s cubic-bezier(0.4,0,0.2,1),opacity 0.15s ease-out;will-change:transform;backface-visibility:hidden;transform:translate3d(0,0,0);",document.body.appendChild(this.cursor),this.position={x:0,y:0},this.target={x:0,y:0},this.currentSize=10,this.isVisible=!1,this.isHovering=!1,this.isAnimating=!1,this.hoverCheckFrame=0,this.interactiveSelectors="a, button, input, textarea, select, canvas, .clear-btn, .modal-close, .auth-close, .nav-link, .btn, .hamburger, .item, .item__image, .enlarge",this.init(),this.handleResize()};ee.prototype.init=function(){var d=this,y=document.createElement("style");y.id="custom-cursor-style",y.textContent="@media (min-width: 1024px) {  body:not(.modal-open):not(.custom-cursor-hidden) * { cursor: none !important; }  body.modal-open, body.modal-open * { cursor: auto !important; }  body.modal-open .signature-pad { cursor: crosshair !important; }  body.custom-cursor-hidden, body.custom-cursor-hidden * { cursor: auto !important; }}",document.head.appendChild(y);var w=!1;document.addEventListener("pointermove",function(b){if(b.pointerType!=="mouse"){d.isVisible&&(d.cursor.style.opacity="0",d.isVisible=!1,d.isAnimating=!1);return}var _=document.body.classList.contains("modal-open");if(w&&!_&&(d.isVisible=!0,d.cursor.style.opacity="1",document.body.classList.remove("custom-cursor-hidden")),w=_,_){d.cursor.style.opacity="0",d.isAnimating=!1,document.body.classList.add("custom-cursor-hidden");return}if(d.target.x=b.clientX,d.target.y=b.clientY,d.isVisible||(d.position.x=b.clientX,d.position.y=b.clientY,d.updateCursorPosition(),d.isVisible=!0,d.cursor.style.opacity="1"),d.isAnimating||(d.isAnimating=!0,d.animate()),d.hoverCheckFrame++,d.hoverCheckFrame%2===0){var E=document.elementFromPoint(b.clientX,b.clientY);d.checkHoverState(E)}},{passive:!0}),document.addEventListener("pointerleave",function(){d.isVisible=!1,d.isAnimating=!1,d.cursor.style.opacity="0",document.body.classList.add("custom-cursor-hidden")}),document.addEventListener("pointerenter",function(){document.body.classList.remove("custom-cursor-hidden")})},ee.prototype.handleResize=function(){},ee.prototype.checkHoverState=function(d){if(!(!d||document.body.classList.contains("modal-open"))){var y=!!d.closest(this.interactiveSelectors);y!==this.isHovering&&(this.isHovering=y,y?(this.cursor.style.width="40px",this.cursor.style.height="40px",this.currentSize=40):(this.cursor.style.width="10px",this.cursor.style.height="10px",this.currentSize=10),this.updateCursorPosition())}},ee.prototype.updateCursorPosition=function(){var d=this.currentSize/2;this.cursor.style.transform="translate3d("+(this.position.x-d)+"px, "+(this.position.y-d)+"px, 0)"},ee.prototype.animate=function(){if(this.isAnimating){var d=this,y=.65,w=.5,b=this.target.x-this.position.x,_=this.target.y-this.position.y,E=Math.sqrt(b*b+_*_);if(E<w){this.position.x=this.target.x,this.position.y=this.target.y,this.updateCursorPosition(),this.isAnimating=!1;return}this.position.x+=b*y,this.position.y+=_*y,this.updateCursorPosition(),requestAnimationFrame(function(){d.animate()})}};var Q=function(){this.setVH();var d=this;window.addEventListener("resize",a(function(){d.setVH()},250))};Q.prototype.setVH=function(){var d=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",d+"px")};var ce=function(){var d=window.matchMedia("(prefers-reduced-motion: reduce)");d.matches&&document.body.classList.add("reduce-motion"),document.addEventListener("keydown",function(y){y.key==="Tab"&&document.body.classList.add("keyboard-nav")}),document.addEventListener("mousedown",function(){document.body.classList.remove("keyboard-nav")})},me=function(){console.log("Initializing Section Separator Glow...");var d=e("section");if(!(!d||d.length===0)){var y=window.innerWidth<=1024,w=y?20:50,b=function(){var E=window.innerHeight;d.forEach(function(S){if(!S.classList.contains("separator-visible")&&!S.classList.contains("footer")){var C=S.getBoundingClientRect(),F=C.bottom>0&&C.bottom<E*.85;F&&(S.classList.add("separator-visible"),console.log("Section separator triggered:",S.id||S.className))}})},_=!1;window.addEventListener("scroll",function(){window.pageYOffset<w||_||(requestAnimationFrame(function(){b(),_=!1}),_=!0)},{passive:!0})}},ve=function(){var d=n(".footer-back-to-top");if(d){var y=300,w=!1,b=function(){var _=window.pageYOffset>y;_!==w&&(w=_,_?d.classList.add("visible"):d.classList.remove("visible"))};window.addEventListener("scroll",r(b,100),{passive:!0}),b()}},ke=function(){console.log("Scarlo - Crafted with precision"),c(),console.log("Device: "+(k.isMobile()?"Mobile":"Desktop")),console.log("Screen width:",window.innerWidth);var d=n(".navbar-logo-ambient"),y=n(".navbar-text-ambient");d&&y&&requestAnimationFrame(function(){d.style.animation="none",y.style.animation="none",requestAnimationFrame(function(){d.style.animation="navbarAmbientPulse 3s ease-in-out infinite",y.style.animation="navbarAmbientPulse 3s ease-in-out infinite"})}),new W,new T,window.rotatingText=new P,new M,new D,new R,new N,window.contractFormHandler=new A,new ne,new ee,new Q,new ce,new me,new ve};function we(){window.firebaseReady?window.firebaseReady.then(ke).catch(function(d){console.error("Firebase initialization failed, starting app anyway:",d),ke()}):ke()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",we):we()})();const La=document.getElementById("message");La&&(La.addEventListener("input",function(){this.style.height="auto",this.style.height=Math.min(this.scrollHeight,400)+"px"}),La.style.height="auto",La.style.height=Math.min(La.scrollHeight,400)+"px");(function(){var n="scarlo_cookie_consent",e="userPreferences",r=7,a=r*24*60*60*1e3,o=document.getElementById("cookieConsent"),c=document.getElementById("cookieSettingsBtn"),u=document.getElementById("cookieAccept"),p=document.getElementById("cookieDecline"),h=document.getElementById("cookieAnalytics"),g=document.getElementById("cookieMarketing");if(!o)return;function v(Q){return Q&&Q.analytics===!0&&Q.marketing===!0}function k(Q){if(!Q)return!0;if(v(Q))return!1;var ce=Date.now()-(Q.timestamp||0);return ce>=a}function T(){try{var Q=localStorage.getItem(n);return Q?JSON.parse(Q):null}catch{return null}}function P(Q){try{localStorage.setItem(n,JSON.stringify(Q))}catch{}}function M(){return window.auth&&window.auth.currentUser?window.auth.currentUser:null}function D(Q){var ce=M();return!ce||!window.db?Promise.resolve():window.db.collection(e).doc(ce.uid).set({cookieConsent:Q,updatedAt:firebase.firestore.FieldValue.serverTimestamp()},{merge:!0}).catch(function(me){console.warn("Failed to save cookie consent to Firestore:",me)})}function R(){var Q=M();return!Q||!window.db?Promise.resolve(null):window.db.collection(e).doc(Q.uid).get().then(function(ce){return ce.exists&&ce.data().cookieConsent?ce.data().cookieConsent:null}).catch(function(ce){return console.warn("Failed to load cookie consent from Firestore:",ce),null})}function N(){o.classList.add("visible"),o.setAttribute("aria-hidden","false"),c.classList.remove("visible"),c.setAttribute("aria-hidden","true")}function H(){o.classList.remove("visible"),o.setAttribute("aria-hidden","true"),c.classList.add("visible"),c.setAttribute("aria-hidden","false")}function A(Q){Q&&(h.checked=Q.analytics,g.checked=Q.marketing)}function W(Q){window.dispatchEvent(new CustomEvent("cookieConsentUpdated",{detail:Q})),Q.analytics,Q.marketing}function U(Q){P(Q),D(Q)}function Z(){var Q=T();k(Q)?(A(Q),N()):(A(Q),c.classList.add("visible"),c.setAttribute("aria-hidden","false"),W(Q))}function ne(Q){Q&&R().then(function(ce){var me=T(),ve=null;ce&&me?ce.timestamp>me.timestamp?(ve=ce,P(ce)):(ve=me,D(me)):ce&&!me?(ve=ce,P(ce)):!ce&&me&&(ve=me,D(me)),ve&&(A(ve),k(ve)?N():(o.classList.remove("visible"),c.classList.add("visible"),c.setAttribute("aria-hidden","false"),W(ve)))})}function ee(){window.auth&&window.auth.onAuthStateChanged(ne)}u.addEventListener("click",function(){var Q={essential:!0,analytics:h.checked,marketing:g.checked,timestamp:new Date().toLocaleString()};U(Q),H(),W(Q)}),p.addEventListener("click",function(){var Q={essential:!0,analytics:!1,marketing:!1,timestamp:new Date().toLocaleString()};h.checked=!1,g.checked=!1,U(Q),H(),W(Q)}),c.addEventListener("click",function(){var Q=T();A(Q),N()}),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Z):Z(),window.firebaseReady?window.firebaseReady.then(ee).catch(function(){}):window.addEventListener("firebaseReady",ee)})();
